(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-Apply-Apply~pages-editshop-editshop~pages-publish-publish~pages-release-release~pages-stalllis~b5d2b851"],{"1ea2":function(e,t,r){"use strict";var n=r("af9e"),i=r("1c06"),a=r("ada5"),o=r("5d6e"),u=Object.isExtensible,c=n((function(){u(1)}));e.exports=c||o?function(e){return!!i(e)&&((!o||"ArrayBuffer"!==a(e))&&(!u||u(e)))}:u},3639:function(e,t,r){r("bf0f"),r("18f7"),r("d0af"),r("de6c"),r("6a54"),r("9a2c");var n=r("bdbb")["default"];function i(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}e.exports=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!==typeof e)return{default:e};var r=i(t);if(r&&r.has(e))return r.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var c=o?Object.getOwnPropertyDescriptor(e,u):null;c&&(c.get||c.set)?Object.defineProperty(a,u,c):a[u]=e[u]}return a["default"]=e,r&&r.set(e,a),a},e.exports.__esModule=!0,e.exports["default"]=e.exports},4085:function(e,t,r){"use strict";var n=r("8bdb"),i=r("85c1");n({global:!0,forced:i.globalThis!==i},{globalThis:i})},5075:function(e,t,r){"use strict";var n=r("ae5c"),i=r("71e9"),a=r("e7e3"),o=r("52df"),u=r("81a7"),c=r("1fc1"),s=r("1297"),f=r("d67c"),l=r("5112"),h=r("7e91"),d=TypeError,b=function(e,t){this.stopped=e,this.result=t},p=b.prototype;e.exports=function(e,t,r){var v,g,w,m,y,O,x,j=r&&r.that,k=!(!r||!r.AS_ENTRIES),E=!(!r||!r.IS_RECORD),U=!(!r||!r.IS_ITERATOR),A=!(!r||!r.INTERRUPTED),T=n(t,j),B=function(e){return v&&h(v,"normal",e),new b(!0,e)},P=function(e){return k?(a(e),A?T(e[0],e[1],B):T(e[0],e[1])):A?T(e,B):T(e)};if(E)v=e.iterator;else if(U)v=e;else{if(g=l(e),!g)throw new d(o(e)+" is not iterable");if(u(g)){for(w=0,m=c(e);m>w;w++)if(y=P(e[w]),y&&s(p,y))return y;return new b(!1)}v=f(e,g)}O=E?e.next:v.next;while(!(x=i(O,v)).done){try{y=P(x.value)}catch(R){h(v,"throw",R)}if("object"==typeof y&&y&&s(p,y))return y}return new b(!1)}},"5d6e":function(e,t,r){"use strict";var n=r("af9e");e.exports=n((function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}))},"64af":function(e,t,r){"use strict";r("6a54");var n=r("3639").default,i=r("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.compressPictures=void 0,t.getPlatform=s,t.useUpload=void 0;var a=i(r("2634")),o=i(r("2fdc"));r("bf0f");var u=n(r("4860")),c=i(r("e270"));function s(){return 2}t.useUpload=function(e){var t=e.uploadPath,r=(e.tempFilePaths,e.FormData,e.file);return{upload:function(){return new Promise(function(){var e=(0,o.default)((0,a.default)().mark((function e(n,i){return(0,a.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:uni.showLoading({title:"上传中",mask:!0}),e.t0=s(),e.next=1===e.t0?4:2===e.t0?5:3===e.t0?16:27;break;case 4:return e.abrupt("break",27);case 5:return e.t1=uni,e.t2=u.default.UPLOAD_URL+t,e.next=9,f(r);case 9:return e.t3=e.sent,e.t4={output:"json2"},e.t5=function(e){uni.showToast({title:"上传成功"}),uni.hideLoading(),n(null===e||void 0===e?void 0:e.data)},e.t6=function(e){console.log(e),uni.showToast({title:"上传失败",icon:"error"}),uni.hideLoading()},e.t7={url:e.t2,name:"file",file:e.t3,formData:e.t4,success:e.t5,fail:e.t6},e.t1.uploadFile.call(e.t1,e.t7),e.abrupt("break",27);case 16:return e.t8=uni,e.t9=u.default.UPLOAD_URL+t,e.next=20,f(r);case 20:return e.t10=e.sent,e.t11={output:"json2"},e.t12=function(e){uni.showToast({title:"上传成功"}),uni.hideLoading(),n(null===e||void 0===e?void 0:e.data)},e.t13=function(e){console.log(e),uni.showToast({title:"上传失败",icon:"error"}),uni.hideLoading()},e.t14={url:e.t9,name:"file",filePath:e.t10,formData:e.t11,success:e.t12,fail:e.t13},e.t8.uploadFile.call(e.t8,e.t14),e.abrupt("break",27);case 27:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}())}}};var f=function(e){switch(s()){case 1:break;case 2:return new Promise((function(t,r){new c.default(e,{quality:.6,convertSize:!1,success:function(e){var r=new File([e],e.name,{type:e.type});console.log(r),t(r)},error:function(e){r("图片压缩失败")}})}));case 3:return new Promise((function(t,r){uni.compressImage({src:e.path,quality:30,success:function(e){t(e.tempFilePath)}})}))}};t.compressPictures=f},7658:function(e,t,r){"use strict";var n=r("8bdb"),i=r("85c1"),a=r("bb80"),o=r("8466"),u=r("81a9"),c=r("d0b1"),s=r("5075"),f=r("b720"),l=r("474f"),h=r("1eb8"),d=r("1c06"),b=r("af9e"),p=r("29ba"),v=r("181d"),g=r("dcda");e.exports=function(e,t,r){var w=-1!==e.indexOf("Map"),m=-1!==e.indexOf("Weak"),y=w?"set":"add",O=i[e],x=O&&O.prototype,j=O,k={},E=function(e){var t=a(x[e]);u(x,e,"add"===e?function(e){return t(this,0===e?0:e),this}:"delete"===e?function(e){return!(m&&!d(e))&&t(this,0===e?0:e)}:"get"===e?function(e){return m&&!d(e)?void 0:t(this,0===e?0:e)}:"has"===e?function(e){return!(m&&!d(e))&&t(this,0===e?0:e)}:function(e,r){return t(this,0===e?0:e,r),this})},U=o(e,!l(O)||!(m||x.forEach&&!b((function(){(new O).entries().next()}))));if(U)j=r.getConstructor(t,e,w,y),c.enable();else if(o(e,!0)){var A=new j,T=A[y](m?{}:-0,1)!==A,B=b((function(){A.has(1)})),P=p((function(e){new O(e)})),R=!m&&b((function(){var e=new O,t=5;while(t--)e[y](t,t);return!e.has(-0)}));P||(j=t((function(e,t){f(e,x);var r=g(new O,e,j);return h(t)||s(t,r[y],{that:r,AS_ENTRIES:w}),r})),j.prototype=x,x.constructor=j),(B||R)&&(E("delete"),E("has"),w&&E("get")),(R||T)&&E(y),m&&x.clear&&delete x.clear}return k[e]=j,n({global:!0,constructor:!0,forced:j!==O},k),v(j,e),m||r.setStrong(j,e,w),j}},b3e2:function(e,t,r){"use strict";var n,i=r("c238"),a=r("85c1"),o=r("bb80"),u=r("a74c"),c=r("d0b1"),s=r("7658"),f=r("d871c"),l=r("1c06"),h=r("235c").enforce,d=r("af9e"),b=r("a20b"),p=Object,v=Array.isArray,g=p.isExtensible,w=p.isFrozen,m=p.isSealed,y=p.freeze,O=p.seal,x=!a.ActiveXObject&&"ActiveXObject"in a,j=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},k=s("WeakMap",j,f),E=k.prototype,U=o(E.set);if(b)if(x){n=f.getConstructor(j,"WeakMap",!0),c.enable();var A=o(E["delete"]),T=o(E.has),B=o(E.get);u(E,{delete:function(e){if(l(e)&&!g(e)){var t=h(this);return t.frozen||(t.frozen=new n),A(this,e)||t.frozen["delete"](e)}return A(this,e)},has:function(e){if(l(e)&&!g(e)){var t=h(this);return t.frozen||(t.frozen=new n),T(this,e)||t.frozen.has(e)}return T(this,e)},get:function(e){if(l(e)&&!g(e)){var t=h(this);return t.frozen||(t.frozen=new n),T(this,e)?B(this,e):t.frozen.get(e)}return B(this,e)},set:function(e,t){if(l(e)&&!g(e)){var r=h(this);r.frozen||(r.frozen=new n),T(this,e)?U(this,e,t):r.frozen.set(e,t)}else U(this,e,t);return this}})}else(function(){return i&&d((function(){var e=y([]);return U(new k,e,1),!w(e)}))})()&&u(E,{set:function(e,t){var r;return v(e)&&(w(e)?r=y:m(e)&&(r=O)),U(this,e,t),r&&r(e),this}})},c238:function(e,t,r){"use strict";var n=r("af9e");e.exports=!n((function(){return Object.isExtensible(Object.preventExtensions({}))}))},d0af:function(e,t,r){"use strict";r("b3e2")},d0b1:function(e,t,r){"use strict";var n=r("8bdb"),i=r("bb80"),a=r("11bf"),o=r("1c06"),u=r("338c"),c=r("d6b1").f,s=r("80bb"),f=r("8449"),l=r("1ea2"),h=r("d7b4"),d=r("c238"),b=!1,p=h("meta"),v=0,g=function(e){c(e,p,{value:{objectID:"O"+v++,weakData:{}}})},w=e.exports={enable:function(){w.enable=function(){},b=!0;var e=s.f,t=i([].splice),r={};r[p]=1,e(r).length&&(s.f=function(r){for(var n=e(r),i=0,a=n.length;i<a;i++)if(n[i]===p){t(n,i,1);break}return n},n({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:f.f}))},fastKey:function(e,t){if(!o(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!u(e,p)){if(!l(e))return"F";if(!t)return"E";g(e)}return e[p].objectID},getWeakData:function(e,t){if(!u(e,p)){if(!l(e))return!0;if(!t)return!1;g(e)}return e[p].weakData},onFreeze:function(e){return d&&b&&l(e)&&!u(e,p)&&g(e),e}};a[p]=!0},d871c:function(e,t,r){"use strict";var n=r("bb80"),i=r("a74c"),a=r("d0b1").getWeakData,o=r("b720"),u=r("e7e3"),c=r("1eb8"),s=r("1c06"),f=r("5075"),l=r("4d16"),h=r("338c"),d=r("235c"),b=d.set,p=d.getterFor,v=l.find,g=l.findIndex,w=n([].splice),m=0,y=function(e){return e.frozen||(e.frozen=new O)},O=function(){this.entries=[]},x=function(e,t){return v(e.entries,(function(e){return e[0]===t}))};O.prototype={get:function(e){var t=x(this,e);if(t)return t[1]},has:function(e){return!!x(this,e)},set:function(e,t){var r=x(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=g(this.entries,(function(t){return t[0]===e}));return~t&&w(this.entries,t,1),!!~t}},e.exports={getConstructor:function(e,t,r,n){var l=e((function(e,i){o(e,d),b(e,{type:t,id:m++,frozen:void 0}),c(i)||f(i,e[n],{that:e,AS_ENTRIES:r})})),d=l.prototype,v=p(t),g=function(e,t,r){var n=v(e),i=a(u(t),!0);return!0===i?y(n).set(t,r):i[n.id]=r,e};return i(d,{delete:function(e){var t=v(this);if(!s(e))return!1;var r=a(e);return!0===r?y(t)["delete"](e):r&&h(r,t.id)&&delete r[t.id]},has:function(e){var t=v(this);if(!s(e))return!1;var r=a(e);return!0===r?y(t).has(e):r&&h(r,t.id)}}),i(d,r?{get:function(e){var t=v(this);if(s(e)){var r=a(e);return!0===r?y(t).get(e):r?r[t.id]:void 0}},set:function(e,t){return g(this,e,t)}}:{add:function(e){return g(this,e,!0)}}),l}}},e270:function(e,t,r){var n,i,a=r("bdbb").default;r("4085"),r("dc8a"),r("01a2"),r("8f71"),r("bf0f"),r("9a2c"),r("aa9c"),r("2797"),r("a644"),r("a03a"),r("6a54"),r("7a76"),r("c9b5"),r("9e15"),r("884b"),r("e39c"),r("64aa"),r("4db2"),r("c976"),r("4d8f"),r("7b97"),r("668a"),r("c5b7"),r("8ff5"),r("2378"),r("641a"),r("64e0"),r("cce3"),r("efba"),r("d009"),r("bd7d"),r("7edd"),r("d798"),r("f547"),r("5e54"),r("b60a"),r("8c18"),r("12973"),r("f991"),r("198e"),r("8557"),r("63b1"),r("1954"),r("1cf1"),r("15d1"),r("d5c6"),r("5a56"),r("f074"),r("80e3"),r("5c47"),r("2c10"),r("f7a5"),r("08eb"),r("18f7"),r("0506"),r("c223"),r("473f"),r("5ef2"),r("a1c1"),
/*!
 * Compressor.js v1.2.1
 * https://fengyuanchen.github.io/compressorjs
 *
 * Copyright 2018-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2023-02-28T14:09:41.732Z
 */
function(o,u){"object"===a(t)&&"undefined"!==typeof e?e.exports=u():(n=u,i="function"===typeof n?n.call(t,r,t,e):n,void 0===i||(e.exports=i))}(0,(function(){"use strict";function e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function t(t){for(var r=1;r<arguments.length;r++){var i=null!=arguments[r]?arguments[r]:{};r%2?e(Object(i),!0).forEach((function(e){n(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o(n.key),n)}}function n(e,t,r){return t=o(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i.apply(this,arguments)}function o(e){var t=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===a(t)?t:String(t)}var u={exports:{}};(function(e){"undefined"!==typeof window&&function(t){var r=t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype,n=t.Blob&&function(){try{return Boolean(new Blob)}catch(e){return!1}}(),i=n&&t.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(e){return!1}}(),a=t.BlobBuilder||t.WebKitBlobBuilder||t.MozBlobBuilder||t.MSBlobBuilder,o=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,u=(n||a)&&t.atob&&t.ArrayBuffer&&t.Uint8Array&&function(e){var t,r,u,c,s,f,l,h,d;if(t=e.match(o),!t)throw new Error("invalid data URI");for(r=t[2]?t[1]:"text/plain"+(t[3]||";charset=US-ASCII"),u=!!t[4],c=e.slice(t[0].length),s=u?atob(c):decodeURIComponent(c),f=new ArrayBuffer(s.length),l=new Uint8Array(f),h=0;h<s.length;h+=1)l[h]=s.charCodeAt(h);return n?new Blob([i?l:f],{type:r}):(d=new a,d.append(f),d.getBlob(r))};t.HTMLCanvasElement&&!r.toBlob&&(r.mozGetAsFile?r.toBlob=function(e,t,n){var i=this;setTimeout((function(){n&&r.toDataURL&&u?e(u(i.toDataURL(t,n))):e(i.mozGetAsFile("blob",t))}))}:r.toDataURL&&u&&(r.msToBlob?r.toBlob=function(e,t,n){var i=this;setTimeout((function(){(t&&"image/png"!==t||n)&&r.toDataURL&&u?e(u(i.toDataURL(t,n))):e(i.msToBlob(t))}))}:r.toBlob=function(e,t,r){var n=this;setTimeout((function(){e(u(n.toDataURL(t,r)))}))})),e.exports?e.exports=u:t.dataURLtoBlob=u}(window)})(u);var c=u.exports,s={strict:!0,checkOrientation:!0,retainExif:!1,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},f="undefined"!==typeof window&&"undefined"!==typeof window.document,l=f?window:{},h=function(e){return e>0&&e<1/0},d=Array.prototype.slice;function b(e){return Array.from?Array.from(e):d.call(e)}var p=/^image\/.+$/;function v(e){return p.test(e)}var g=String.fromCharCode;var w=l.btoa;function m(e,t){var r=[],n=new Uint8Array(e);while(n.length>0)r.push(g.apply(null,b(n.subarray(0,8192)))),n=n.subarray(8192);return"data:".concat(t,";base64,").concat(w(r.join("")))}function y(e){var t,r=new DataView(e);try{var n,i,a;if(255===r.getUint8(0)&&216===r.getUint8(1)){var o=r.byteLength,u=2;while(u+1<o){if(255===r.getUint8(u)&&225===r.getUint8(u+1)){i=u;break}u+=1}}if(i){var c=i+4,s=i+10;if("Exif"===function(e,t,r){var n,i="";for(r+=t,n=t;n<r;n+=1)i+=g(e.getUint8(n));return i}(r,c,4)){var f=r.getUint16(s);if(n=18761===f,(n||19789===f)&&42===r.getUint16(s+2,n)){var l=r.getUint32(s+4,n);l>=8&&(a=s+l)}}}if(a){var h,d,b=r.getUint16(a,n);for(d=0;d<b;d+=1)if(h=a+12*d+2,274===r.getUint16(h,n)){h+=8,t=r.getUint16(h,n),r.setUint16(h,1,n);break}}}catch(p){t=1}return t}var O=/\.\d*(?:0|9){12}\d*$/;function x(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return O.test(e)?Math.round(e*t)/t:e}function j(e){var t=e.aspectRatio,r=e.height,n=e.width,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none",a=h(n),o=h(r);if(a&&o){var u=r*t;("contain"===i||"none"===i)&&u>n||"cover"===i&&u<n?r=n/t:n=r*t}else a?r=n/t:o&&(n=r*t);return{width:n,height:r}}var k=l.ArrayBuffer,E=l.FileReader,U=l.URL||l.webkitURL,A=/\.\w+$/,T=l.Compressor,B=function(){function e(r,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.file=r,this.exif=[],this.image=new Image,this.options=t(t({},s),n),this.aborted=!1,this.result=null,this.init()}return function(e,t,n){t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"init",value:function(){var e=this,t=this.file,r=this.options;if(function(e){return"undefined"!==typeof Blob&&(e instanceof Blob||"[object Blob]"===Object.prototype.toString.call(e))}(t)){var n=t.type;if(v(n))if(U&&E){k||(r.checkOrientation=!1,r.retainExif=!1);var a="image/jpeg"===n,o=a&&r.checkOrientation,u=a&&r.retainExif;if(!U||o||u){var c=new E;this.reader=c,c.onload=function(r){var a=r.target,c=a.result,s={},f=1;o&&(f=y(c),f>1&&i(s,function(e){var t=0,r=1,n=1;switch(e){case 2:r=-1;break;case 3:t=-180;break;case 4:n=-1;break;case 5:t=90,n=-1;break;case 6:t=90;break;case 7:t=90,r=-1;break;case 8:t=-90;break}return{rotate:t,scaleX:r,scaleY:n}}(f))),u&&(e.exif=function(e){var t=b(new Uint8Array(e)),r=t.length,n=[],i=0;while(i+3<r){var a=t[i],o=t[i+1];if(255===a&&218===o)break;if(255===a&&216===o)i+=2;else{var u=256*t[i+2]+t[i+3],c=i+u+2,s=t.slice(i,c);n.push(s),i=c}}return n.reduce((function(e,t){return 255===t[0]&&225===t[1]?e.concat(t):e}),[])}(c)),s.url=o||u?!U||f>1?m(c,n):U.createObjectURL(t):c,e.load(s)},c.onabort=function(){e.fail(new Error("Aborted to read the image with FileReader."))},c.onerror=function(){e.fail(new Error("Failed to read the image with FileReader."))},c.onloadend=function(){e.reader=null},o||u?c.readAsArrayBuffer(t):c.readAsDataURL(t)}else this.load({url:U.createObjectURL(t)})}else this.fail(new Error("The current browser does not support image compression."));else this.fail(new Error("The first argument must be an image File or Blob object."))}else this.fail(new Error("The first argument must be a File or Blob object."))}},{key:"load",value:function(e){var r=this,n=this.file,i=this.image;i.onload=function(){r.draw(t(t({},e),{},{naturalWidth:i.naturalWidth,naturalHeight:i.naturalHeight}))},i.onabort=function(){r.fail(new Error("Aborted to load the image."))},i.onerror=function(){r.fail(new Error("Failed to load the image."))},l.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(l.navigator.userAgent)&&(i.crossOrigin="anonymous"),i.alt=n.name,i.src=e.url}},{key:"draw",value:function(e){var t=this,r=e.naturalWidth,n=e.naturalHeight,i=e.rotate,a=void 0===i?0:i,o=e.scaleX,u=void 0===o?1:o,s=e.scaleY,f=void 0===s?1:s,l=this.file,d=this.image,p=this.options,g=document.createElement("canvas"),w=g.getContext("2d"),y=Math.abs(a)%180===90,O=("contain"===p.resize||"cover"===p.resize)&&h(p.width)&&h(p.height),k=Math.max(p.maxWidth,0)||1/0,U=Math.max(p.maxHeight,0)||1/0,A=Math.max(p.minWidth,0)||0,T=Math.max(p.minHeight,0)||0,B=r/n,P=p.width,R=p.height;if(y){var D=[U,k];k=D[0],U=D[1];var z=[T,A];A=z[0],T=z[1];var M=[R,P];P=M[0],R=M[1]}O&&(B=P/R);var L=j({aspectRatio:B,width:k,height:U},"contain");k=L.width,U=L.height;var S=j({aspectRatio:B,width:A,height:T},"cover");if(A=S.width,T=S.height,O){var F=j({aspectRatio:B,width:P,height:R},p.resize);P=F.width,R=F.height}else{var W=j({aspectRatio:B,width:P,height:R}),I=W.width;P=void 0===I?r:I;var C=W.height;R=void 0===C?n:C}P=Math.floor(x(Math.min(Math.max(P,A),k))),R=Math.floor(x(Math.min(Math.max(R,T),U)));var H=-P/2,_=-R/2,N=P,q=R,X=[];if(O){var K,$,G,J,Y=j({aspectRatio:B,width:r,height:n},{contain:"cover",cover:"contain"}[p.resize]);G=Y.width,J=Y.height,K=(r-G)/2,$=(n-J)/2,X.push(K,$,G,J)}if(X.push(H,_,N,q),y){var V=[R,P];P=V[0],R=V[1]}g.width=P,g.height=R,v(p.mimeType)||(p.mimeType=l.type);var Q="transparent";l.size>p.convertSize&&p.convertTypes.indexOf(p.mimeType)>=0&&(p.mimeType="image/jpeg");var Z="image/jpeg"===p.mimeType;if(Z&&(Q="#fff"),w.fillStyle=Q,w.fillRect(0,0,P,R),p.beforeDraw&&p.beforeDraw.call(this,w,g),!this.aborted&&(w.save(),w.translate(P/2,R/2),w.rotate(a*Math.PI/180),w.scale(u,f),w.drawImage.apply(w,[d].concat(X)),w.restore(),p.drew&&p.drew.call(this,w,g),!this.aborted)){var ee=function(e){if(!t.aborted){var i=function(e){return t.done({naturalWidth:r,naturalHeight:n,result:e})};if(e&&Z&&p.retainExif&&t.exif&&t.exif.length>0){var a=function(e){return i(c(m(function(e,t){var r=b(new Uint8Array(e));if(255!==r[2]||224!==r[3])return e;var n=256*r[4]+r[5],i=[255,216].concat(t,r.slice(4+n));return new Uint8Array(i)}(e,t.exif),p.mimeType)))};if(e.arrayBuffer)e.arrayBuffer().then(a).catch((function(){t.fail(new Error("Failed to read the compressed image with Blob.arrayBuffer()."))}));else{var o=new E;t.reader=o,o.onload=function(e){var t=e.target;a(t.result)},o.onabort=function(){t.fail(new Error("Aborted to read the compressed image with FileReader."))},o.onerror=function(){t.fail(new Error("Failed to read the compressed image with FileReader."))},o.onloadend=function(){t.reader=null},o.readAsArrayBuffer(e)}}else i(e)}};g.toBlob?g.toBlob(ee,p.mimeType,p.quality):ee(c(g.toDataURL(p.mimeType,p.quality)))}}},{key:"done",value:function(e){var t=e.naturalWidth,r=e.naturalHeight,n=e.result,i=this.file,a=this.image,o=this.options;if(U&&0===a.src.indexOf("blob:")&&U.revokeObjectURL(a.src),n)if(o.strict&&!o.retainExif&&n.size>i.size&&o.mimeType===i.type&&!(o.width>t||o.height>r||o.minWidth>t||o.minHeight>r||o.maxWidth<t||o.maxHeight<r))n=i;else{var u=new Date;n.lastModified=u.getTime(),n.lastModifiedDate=u,n.name=i.name,n.name&&n.type!==i.type&&(n.name=n.name.replace(A,function(e){var t=v(e)?e.substr(6):"";return"jpeg"===t&&(t="jpg"),".".concat(t)}(n.type)))}else n=i;this.result=n,o.success&&o.success.call(this,n)}},{key:"fail",value:function(e){var t=this.options;if(!t.error)throw e;t.error.call(this,e)}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=T,e}},{key:"setDefaults",value:function(e){i(s,e)}}]),e}();return B}))}}]);