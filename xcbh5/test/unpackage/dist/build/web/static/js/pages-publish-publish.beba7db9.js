(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-publish-publish"],{"0829":function(t,e,i){"use strict";var n=i("8bdb"),a=i("ea07").entries;n({target:"Object",stat:!0},{entries:function(t){return a(t)}})},"12f1":function(t,e,i){"use strict";i.r(e);var n=i("2ed0"),a=i("9383");for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);i("33f9");var s=i("828b"),r=Object(s["a"])(a["default"],n["b"],n["c"],!1,null,"1df172d4",null,!1,n["a"],void 0);e["default"]=r.exports},"1beb":function(t,e,i){var n=i("ac6f");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var a=i("967d").default;a("1647fa70",n,!0,{sourceMap:!1,shadowMode:!1})},"2ed0":function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){return n}));var n={uniIcons:i("a7f4").default},a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"me-container"},[i("v-uni-scroll-view",{staticClass:"Stallholder",style:{height:"100vh"},attrs:{"scroll-y":"true","lower-threshold":"10"},on:{scrolltolower:function(e){arguments[0]=e=t.$handleEvent(e),t.handleScrollToLower.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"disheslist"},[t._l(t.pageData,(function(e){return i("v-uni-view",{key:e.id,staticClass:"type"},[t.isloaded?i("v-uni-image",{staticClass:"type-image",attrs:{"lazy-load":!0,src:e.imglogo,mode:"scaleToFill"}}):t._e(),i("v-uni-view",{staticClass:"regard"},[i("v-uni-view",{staticClass:"typetitle"},[t._v(t._s(e.goodsname))])],1),i("v-uni-view",{staticClass:"function"},[i("v-uni-view",{staticClass:"rigicon",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.edit(e)}}},[t._v("修改")]),i("v-uni-view",{staticClass:"rigicon",staticStyle:{"background-color":"#67c23a"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.shelves(e)}}},[t._v("上架")]),i("v-uni-view",{staticClass:"rigicon",staticStyle:{"background-color":"#f56c6c"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.removeItem(e)}}},[t._v("删除")])],1)],1)})),t.pageLoading?i("v-uni-view",{staticClass:"loading"},[t._v("加载中...")]):t._e(),t.hasMore?t._e():i("v-uni-view",{staticClass:"loading"},[t._v("没有更多了")])],2)],1),i("v-uni-view",{staticClass:"butt",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.goTorelePage.apply(void 0,arguments)}}},[t._v("点击新增菜品")]),t.showEditPopup?i("v-uni-view",{staticClass:"popup-overlay",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closePopup.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"popup",on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e)}}},[i("v-uni-view",{staticClass:"close-button",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closePopup.apply(void 0,arguments)}}},[t._v("×")]),i("v-uni-view",{staticClass:"popup-content"},[i("v-uni-view",{staticClass:"content"},[i("v-uni-view",{staticClass:"cuisine"},[i("v-uni-view",{staticClass:"title"},[t._v("菜名")]),i("v-uni-view",{staticClass:"shuru"},[i("v-uni-input",{staticClass:"shurucon",attrs:{type:"text"},model:{value:t.currentItem.goodsname,callback:function(e){t.$set(t.currentItem,"goodsname",e)},expression:"currentItem.goodsname"}})],1)],1),i("v-uni-view",{staticClass:"class"},[i("v-uni-view",{staticClass:"title"},[t._v("分类")]),i("v-uni-picker",{staticClass:"picker",attrs:{range:t.pickerRange,value:t.selectedCategoryIndex},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.onCategoryChange.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"picker-text"},[t._v(t._s(t.pickerRange[t.selectedCategoryIndex]))])],1)],1),i("v-uni-view",{staticClass:"editimg"},[i("v-uni-view",{staticClass:"title"},[t._v("图片")]),i("v-uni-image",{staticClass:"cimg",attrs:{src:t.currentItem.imglogo,mode:"aspectFit"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.uploadcuisine.apply(void 0,arguments)}}})],1)],1)],1),i("v-uni-view",{staticClass:"popup-footer"},[i("v-uni-button",{on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closePopup.apply(void 0,arguments)}}},[t._v("取消")]),i("v-uni-button",{staticStyle:{"background-color":"#007aff",color:"white"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.confirmEdit.apply(void 0,arguments)}}},[t._v("确认")])],1)],1)],1):t._e(),t.showEditPopup1?i("v-uni-view",{staticClass:"popup-overlay",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closePopup.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"popup",on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e)}}},[i("v-uni-view",{staticClass:"close-button",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closePopup.apply(void 0,arguments)}}},[t._v("×")]),i("v-uni-view",{staticClass:"popup-header"},[t._v(t._s(t.currentItem.goodsname))]),i("v-uni-view",{staticClass:"popup-content"},[i("v-uni-view",{staticClass:"content"},[i("v-uni-view",{staticClass:"cuisine"},[i("v-uni-view",{staticClass:"title"},[t._v("选择摊位")]),i("v-uni-picker",{staticClass:"picker1",attrs:{range:t.pickerRange1,value:t.selectedCategoryIndex1},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.onMarketChange.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"picker-text"},[t._v(t._s(t.pickerRange1[t.selectedCategoryIndex1]))])],1)],1),i("v-uni-view",{staticClass:"editimg"},[i("v-uni-view",{staticClass:"title"},[t._v("菜品价格")]),i("v-uni-view",{staticClass:"shuru"},[i("v-uni-input",{staticClass:"shurucon",attrs:{type:"text",placeholder:"请输入价格"},model:{value:t.itemPrice,callback:function(e){t.itemPrice=e},expression:"itemPrice"}})],1),i("v-uni-view",{staticClass:"unit"},[t._v("元/")]),i("v-uni-view",{staticClass:"example-body",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.clicKexampleBody.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"unit"},[t._v(t._s(t.unit?t.unit:"单位"))]),i("v-uni-view",{staticClass:"icon"},[i("uni-icons",{attrs:{type:t.iconStatus?"up":"down",size:"20"}})],1)],1),i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:t.isShowItems,expression:"isShowItems"}],staticClass:"items"},t._l(t.candidates,(function(e){return i("v-uni-view",{staticClass:"item",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.selectItem(e)}}},[t._v(t._s(e))])})),1)],1)],1)],1),i("v-uni-view",{staticClass:"popup-footer"},[i("v-uni-button",{on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closePopup.apply(void 0,arguments)}}},[t._v("取消")]),i("v-uni-button",{staticStyle:{"background-color":"#007aff",color:"white"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.confirmShelves.apply(void 0,arguments)}}},[t._v("确认")])],1)],1)],1):t._e()],1)},o=[]},"30f7":function(t,e,i){"use strict";i("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},i("7a76"),i("c9b5")},"33f9":function(t,e,i){"use strict";var n=i("1beb"),a=i.n(n);a.a},4733:function(t,e,i){"use strict";i("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){if(Array.isArray(t))return(0,n.default)(t)};var n=function(t){return t&&t.__esModule?t:{default:t}}(i("8d0b"))},"7b93":function(t,e,i){"use strict";i("6a54");var n=i("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("fd3c"),i("bd06"),i("e838");var a=n(i("9b1b")),o=n(i("b7c7")),s=n(i("2634")),r=n(i("2fdc")),c=i("4860"),d=n(i("fce1")),u=i("64af"),l={data:function(){return{pageData:[],showEditPopup:!1,currentItem:{},categories:[],pickerRange:[],selectedCategoryIndex:0,imageUploaded:!1,showEditPopup1:!1,pickerRange1:[],selectedCategoryIndex1:0,itemDescription:"",itemPrice:"",marketList:[],candidates:["千克",,"克","斤","两","瓶","桶","个"],candidate2:["元"],unit:"",unit2:"",tijiaoPrice:"",isloaded:!1,iconStatus:!0,isShowItems:!1}},mixins:[d.default],onLoad:function(){this.isloaded=!0},onShow:function(){this.reloadData()},methods:{removeItem:function(t){var e=this;return(0,r.default)((0,s.default)().mark((function i(){var n,a;return(0,s.default)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return n={id:t.id,isshow:2},console.log(t,n),i.next=4,c.api.editgoods(n);case 4:a=i.sent,200==a.code?(uni.showToast({title:"删除成功",icon:"success"}),e.reloadData()):uni.showToast({title:"删除失败",icon:"error"});case 6:case"end":return i.stop()}}),i)})))()},clicKexampleBody:function(){this.iconStatus=!this.iconStatus,this.isShowItems=!this.isShowItems},selectItem:function(t){this.unit=t,this.iconStatus=!this.iconStatus,this.isShowItems=!this.isShowItems},fetchCategories:function(){var t=this;c.api.cglist().then((function(e){if(200===e.code){var i=e.data.listdata.map((function(t){return{id:t.id,content:t.content}}));t.categories=i,t.pickerRange=(0,o.default)(i.map((function(t){return t.content})))}}))},fetchMarketList:function(){var t=this;return(0,r.default)((0,s.default)().mark((function e(){var i,n,r;return(0,s.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,uni.getStorageSync("token"),i={limit:100,page:1},e.next=5,c.api.getMyShops((0,a.default)({token:t.token},i));case 5:n=e.sent,200===n.code?(r=n.data.listdata.map((function(t){return{id:t.id,title:t.title}})),t.marketList=r,t.pickerRange1=(0,o.default)(r.map((function(t){return t.title})))):console.error("Failed to fetch market list:",n.msg),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](0),console.error("Error fetching market list:",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))()},onCategoryChange:function(t){this.selectedCategoryIndex=t.detail.value,this.currentItem.category_id=this.categories[this.selectedCategoryIndex].id},onMarketChange:function(t){this.selectedCategoryIndex1=t.detail.value,this.currentItem.market_id=this.marketList[this.selectedCategoryIndex1].id},fetchData:function(t){return(0,r.default)((0,s.default)().mark((function e(){var i;return(0,s.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c.api.getCommdityList(t);case 2:return i=e.sent,e.abrupt("return",i.data);case 4:case"end":return e.stop()}}),e)})))()},goTorelePage:function(){uni.navigateTo({url:"/pages/release/release"})},edit:function(t){this.currentItem=(0,a.default)({},t),this.fetchCategories(),this.showEditPopup=!0,this.fetchCommodityDetails(t.id)},fetchCommodityDetails:function(t){var e=this;c.api.getCommodityDetails(t).then((function(t){if(200===t.code){var i=t.data.listdata[0];e.currentItem.goodsname=i.goodsname,e.currentItem.imglogo=i.imglogo;var n=e.categories.findIndex((function(t){return t.id===i.category_id}));-1!==n&&(e.selectedCategoryIndex=n)}}))},uploadcuisine:function(){var t=this;uni.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(e){var i=e.tempFilePaths;if(i.length>0){console.log(66676,e.tempFiles[0]);var n=(0,u.useUpload)({uploadPath:"/group1/upload",tempFilePaths:i[0],file:e.tempFiles[0]}),a=n.upload;n.request;a().then((function(e){e=JSON.parse(e),t.currentItem.imglogo=e.data.url}))}}})},shelves:function(t){this.currentItem=(0,a.default)({},t),console.log(this.currentItem),this.showEditPopup1=!0,this.fetchMarketList()},closePopup:function(){this.showEditPopup=!1,this.showEditPopup1=!1,this.itemPrice=""},confirmEdit:function(){var t=this;if(this.currentItem.id)if(this.imageUploaded||this.currentItem.imglogo){var e=this.currentItem,i=e.id,n=e.category_id,a=e.goodsname,o=e.imglogo;c.api.editGoods({id:i,category_id:n,goodsname:a,imglogo:o}).then((function(e){200===e.code?(uni.showToast({title:"商品修改成功",icon:"success"}),t.reloadData(),t.closePopup()):uni.showToast({title:e.msg||"商品修改失败",icon:"none"})}))}else uni.showToast({title:"请上传图片",icon:"none"});else uni.showToast({title:"商品 ID 不正确",icon:"none"})},confirmShelves:function(){var t=this;console.log("Goods ID:",this.currentItem.id),this.itemPrice?this.unit?c.api.addCommodityToShop({goods_id:this.currentItem.id,shop_id:this.marketList[this.selectedCategoryIndex1].id,content:this.itemDescription,price:parseFloat(this.itemPrice),weight_name:this.unit}).then((function(e){200===e.code?(uni.showToast({title:"上架成功"}),t.closePopup(),t.reloadData()):uni.showToast({title:"上架失败",icon:"none"})})):uni.showToast({title:"请选择单位",icon:"none"}):uni.showToast({title:"请填写价格",icon:"none"})}}};e.default=l},9383:function(t,e,i){"use strict";i.r(e);var n=i("7b93"),a=i.n(n);for(var o in n)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(o);e["default"]=a.a},ac6f:function(t,e,i){var n=i("c86c");e=n(!1),e.push([t.i,".items[data-v-1df172d4]{border-radius:%?5?%;z-index:10000;position:absolute;top:%?232?%;left:%?468?%;width:15%;padding:%?10?%;background-color:#fff;border:1px solid grey}.item[data-v-1df172d4]{width:100%;border-bottom:1px dashed grey}.me-container[data-v-1df172d4]{\n\t/* overflow: hidden; */width:100%;box-sizing:border-box;padding:%?0?% %?40?% 0 %?40?%;color:#fff;z-index:1;background-color:#f8f8f8;display:flex;flex-direction:column;justify-content:flex-start;position:relative;height:calc(100vh %?-10?%)}.butt[data-v-1df172d4]{position:fixed;bottom:%?20?%;right:%?20?%;padding:%?30?% %?30?%;background-color:#007bff;color:#fff;border:none;border-radius:5px;cursor:pointer;box-shadow:0 4px 6px rgba(0,0,0,.1);z-index:1000}.disheslist[data-v-1df172d4]{width:100%;height:%?1200?%;display:flex;flex-direction:column;margin-top:%?20?%}.type[data-v-1df172d4]{padding:%?10?%;height:12%;\n\t/* width: 90%; */display:flex;flex-direction:row;background-color:#fff;justify-content:flex-start;align-items:center;margin-bottom:%?30?%;box-shadow:%?5?% %?5?% %?5?% rgba(0,0,0,.3);border-radius:%?5?%}.type-image[data-v-1df172d4]{height:%?130?%;width:%?130?%;border-radius:%?20?%;background-color:#007aff}.regard[data-v-1df172d4]{width:30%;height:%?180?%;color:#000;font-size:%?30?%;position:relative;top:%?60?%;left:%?20?%}\n\n/* .price {\n\talign-self: self-start;\n} */.function[data-v-1df172d4]{display:flex;height:100%;width:%?250?%;margin-left:auto;justify-content:space-around;align-items:center}.rigicon[data-v-1df172d4]{font-weight:700;font-size:%?25?%;height:%?70?%;width:%?150?%;background-color:#007aff;display:flex;justify-content:center;align-items:center;border-radius:%?20?%;margin-left:%?5?%}.loading[data-v-1df172d4]{text-align:center;padding:%?20?%;color:#999}.popup-overlay[data-v-1df172d4]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.5);display:flex;justify-content:center;align-items:center;z-index:1000;color:#000}.popup[data-v-1df172d4]{position:relative;width:80%;max-width:%?600?%;background-color:#fff;border-radius:%?20?%;padding:%?20?%;box-shadow:0 0 15px rgba(0,0,0,.2)}.popup-header[data-v-1df172d4]{font-size:%?36?%;font-weight:700;margin-bottom:%?20?%;text-align:center}.popup-content[data-v-1df172d4]{\n\t/* 这里你可以添加弹出层内容的样式 */display:flex;width:100%;padding:%?30?%;box-sizing:border-box;justify-content:center;align-items:center}.popup-footer[data-v-1df172d4]{display:flex;justify-content:space-between;margin-top:%?10?%}.close-button[data-v-1df172d4]{padding:%?10?%;position:absolute;top:%?10?%;right:%?10?%;font-size:%?50?%;color:#000;cursor:pointer;z-index:10;width:%?50?%;height:%?50?%;text-align:center;line-height:%?45?%;background-color:#fff;border-radius:50%;box-shadow:0 0 %?10?% rgba(0,0,0,.1)}.content[data-v-1df172d4]{width:100%;height:%?300?%}.cuisine[data-v-1df172d4]{width:100%;height:%?100?%;display:flex;justify-content:space-between;align-items:center}.class[data-v-1df172d4]{width:100%;height:%?100?%;display:flex;justify-content:space-between;align-items:center}.editimg[data-v-1df172d4]{width:100%;height:%?100?%;display:flex;justify-content:space-between;align-items:center}.cimg[data-v-1df172d4]{width:%?100?%;height:%?100?%}.picker[data-v-1df172d4]{width:%?100?%;height:%?100?%;display:flex;justify-content:end;align-items:center;font-size:%?35?%}.shuru[data-v-1df172d4]{width:auto;height:%?100?%;display:flex;justify-content:end;align-items:center}.example-body[data-v-1df172d4]{border-radius:%?10?%;padding:%?10?%;margin:%?10?% 0 0 %?20?%;border:1px solid grey;background-color:#fff;display:flex;justify-content:space-between;min-width:%?100?%}.unit[data-v-1df172d4]{font-size:%?28?%}.shurucon[data-v-1df172d4]{text-align:end;font-size:%?30?%}.title[data-v-1df172d4]{width:40%;font-size:%?30?%}.picker1[data-v-1df172d4]{width:%?300?%;height:%?100?%;display:flex;justify-content:end;align-items:center;font-size:%?30?%}",""]),t.exports=e},b7c7:function(t,e,i){"use strict";i("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return(0,n.default)(t)||(0,a.default)(t)||(0,o.default)(t)||(0,s.default)()};var n=r(i("4733")),a=r(i("d14d")),o=r(i("5d6b")),s=r(i("30f7"));function r(t){return t&&t.__esModule?t:{default:t}}},d14d:function(t,e,i){"use strict";i("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)},i("01a2"),i("e39c"),i("bf0f"),i("844d"),i("18f7"),i("de6c"),i("08eb")},fb2c:function(t,e,i){"use strict";var n=i("8bdb"),a=i("5075"),o=i("85f7");n({target:"Object",stat:!0},{fromEntries:function(t){var e={};return a(t,(function(t,i){o(e,t,i)}),{AS_ENTRIES:!0}),e}})},fce1:function(t,e,i){"use strict";i("6a54");var n=i("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n(i("2634")),o=n(i("2fdc")),s=n(i("9b1b")),r=n(i("5de6"));i("fb2c"),i("8f71"),i("bf0f"),i("0829"),i("7a76"),i("c9b5"),i("c223");var c={data:function(){return{page:1,limit:10,totalnum:0,pageData:[],pageLoading:!1,hasMore:!0,searchParams:{}}},computed:{queryParams:function(){var t=Object.fromEntries(Object.entries(this.searchParams).filter((function(t){var e=(0,r.default)(t,2),i=(e[0],e[1]);return""!==i})));return(0,s.default)({page:this.page,limit:this.limit,isshow:1},t)}},methods:{loadPageData:function(){var t=this;return(0,o.default)((0,a.default)().mark((function e(){var i;return(0,a.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.hasMore&&!t.pageLoading){e.next=2;break}return e.abrupt("return");case 2:return t.pageLoading=!0,e.prev=3,e.next=6,t.fetchData(t.queryParams);case 6:i=e.sent,t.querySuccess(i),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](3),t.handleFetchError(e.t0);case 13:return e.prev=13,t.pageLoading=!1,e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[3,10,13,16]])})))()},fetchData:function(t){return(0,o.default)((0,a.default)().mark((function t(){return(0,a.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:throw new Error("fetchData 方法未实现");case 1:case"end":return t.stop()}}),t)})))()},querySuccess:function(t){null!==t&&void 0!==t&&t.listdata&&(this.pageData=1===this.page?t.listdata:this.pageData.concat(t.listdata),this.totalnum=t.totalnum||0,this.hasMore=this.pageData.length<this.totalnum)},handleScrollToLower:function(){!this.pageLoading&&this.hasMore&&(this.page+=1,this.loadPageData())},handleFetchError:function(t){console.error("Error loading data:",t)},resetPagination:function(){this.page=1,this.pageData=[],this.totalnum=0,this.hasMore=!0},reloadData:function(){this.resetPagination(),this.loadPageData()}}};e.default=c}}]);