(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-index-index"],{"0e82":function(e,t,a){"use strict";a("7a82");var n=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("c7eb")),r=n(a("1da1")),o=n(a("5530")),s=n(a("3835"));a("c1f9"),a("4de4"),a("d3b7"),a("4fad"),a("d9e2"),a("d401"),a("99af");var l={data:function(){return{page:1,limit:8,totalnum:0,pageData:[],pageLoading:!1,hasMore:!0,searchParams:{}}},computed:{queryParams:function(){var e=Object.fromEntries(Object.entries(this.searchParams).filter((function(e){var t=(0,s.default)(e,2),a=(t[0],t[1]);return""!==a})));return(0,o.default)({page:this.page,limit:this.limit},e)}},methods:{loadPageData:function(){var e=this;return(0,r.default)((0,i.default)().mark((function t(){var a;return(0,i.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.hasMore&&!e.pageLoading){t.next=2;break}return t.abrupt("return");case 2:return e.pageLoading=!0,t.prev=3,t.next=6,e.fetchData(e.queryParams);case 6:a=t.sent,e.querySuccess(a),t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](3),e.handleFetchError(t.t0);case 13:return t.prev=13,e.pageLoading=!1,t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[3,10,13,16]])})))()},fetchData:function(e){return(0,r.default)((0,i.default)().mark((function e(){return(0,i.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:throw new Error("fetchData 方法未实现");case 1:case"end":return e.stop()}}),e)})))()},querySuccess:function(e){null!==e&&void 0!==e&&e.listdata&&(this.pageData=1===this.page?e.listdata:this.pageData.concat(e.listdata),this.totalnum=e.totalnum||0,this.hasMore=this.pageData.length<this.totalnum)},handleScrollToLower:function(){!this.pageLoading&&this.hasMore&&(this.page+=1,this.loadPageData())},handleFetchError:function(e){console.error("Error loading data:",e)},resetPagination:function(){this.page=1,this.pageData=[],this.totalnum=0,this.hasMore=!0},reloadData:function(){this.resetPagination(),this.loadPageData()}}};t.default=l},1865:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return n}));var n={uniIcons:a("0dac").default},i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"container"},[a("v-uni-view",{staticClass:"locating"},[a("v-uni-view",{staticClass:"targeting",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.toindex1.apply(void 0,arguments)}}},[a("uni-icons",{attrs:{type:"location-filled",size:"25",color:"#007aff"}})],1),a("v-uni-view",{staticClass:"current "},[e._v(e._s(e.currentMarketName))])],1),a("v-uni-view",{staticClass:"search"},[a("v-uni-view",{staticClass:"sousuokuang"},[a("uni-icons",{staticClass:"search-icon",attrs:{type:"search",size:"20",color:"#999"}}),a("v-uni-input",{staticClass:"uni-input",attrs:{placeholder:"请输入搜索条件"},model:{value:e.searchParams.title,callback:function(t){e.$set(e.searchParams,"title",t)},expression:"searchParams.title"}}),a("v-uni-button",{staticClass:"searchbt",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.reloadData.apply(void 0,arguments)}}},[e._v("搜索")])],1),a("uni-icons",{staticClass:"buycar",attrs:{type:"scan",size:"30"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.scan.apply(void 0,arguments)}}})],1),a("v-uni-view",{staticClass:"uni-margin-wrap"},[a("v-uni-scroll-view",{staticClass:"swiper",attrs:{"scroll-x":"true","scroll-y":"false","show-scrollbar":"false"}},e._l(e.categories,(function(t){return a("v-uni-view",{key:t.id,staticClass:"swiper-item",on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.filterByCategory(t.id)}}},[a("v-uni-view",{staticClass:"item-title"},[a("v-uni-text",{class:["classify",{selected:t.id===e.selectedCategoryId}]},[e._v(e._s(t.title))])],1)],1)})),1)],1),a("v-uni-scroll-view",{staticClass:"Stallholder",style:{height:"100vh"},attrs:{"scroll-y":"true"},on:{scrolltolower:function(t){arguments[0]=t=e.$handleEvent(t),e.handleScrollToLower.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"Stallholder-content"},e._l(e.pageData,(function(t){return a("v-uni-view",{key:t.id,staticClass:"Stallholder-item",on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.navigateToShopDetails(t.id)}}},[e.isloaded?a("v-uni-image",{staticClass:"standimg",attrs:{"lazy-load":!0,src:t.logo,mode:"aspectFill"}}):e._e(),a("v-uni-view",{staticClass:"standtitle"},[e._v("地区名称："+e._s(t.area_name))]),a("v-uni-view",{staticClass:"standtitle"},[e._v("摊位名称："+e._s(t.title))]),a("v-uni-view",{staticClass:"standtitle"},[e._v("所售类目："+e._s(t.category_name||"未知类目"))])],1)})),1),e.pageLoading?a("v-uni-view",{staticClass:"loading"},[e._v("加载中...")]):e._e(),e.hasMore?e._e():a("v-uni-view",{staticClass:"loading"},[e._v("没有更多了")])],1)],1)},r=[]},"1cf7":function(e,t,a){var n=a("f2e0");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var i=a("4f06").default;i("14b769a7",n,!0,{sourceMap:!1,shadowMode:!1})},2909:function(e,t,a){"use strict";a("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,n.default)(e)||(0,i.default)(e)||(0,r.default)(e)||(0,o.default)()};var n=s(a("6005")),i=s(a("db90")),r=s(a("06c5")),o=s(a("3427"));function s(e){return e&&e.__esModule?e:{default:e}}},3427:function(e,t,a){"use strict";a("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},a("d9e2"),a("d401")},"4fad":function(e,t,a){var n=a("23e7"),i=a("6f53").entries;n({target:"Object",stat:!0},{entries:function(e){return i(e)}})},6005:function(e,t,a){"use strict";a("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(Array.isArray(e))return(0,n.default)(e)};var n=function(e){return e&&e.__esModule?e:{default:e}}(a("6b75"))},"86e3":function(e,t,a){"use strict";var n=a("1cf7"),i=a.n(n);i.a},"91cd":function(e,t,a){"use strict";a.r(t);var n=a("e9ba"),i=a.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(r);t["default"]=i.a},c1f9:function(e,t,a){var n=a("23e7"),i=a("2266"),r=a("8418");n({target:"Object",stat:!0},{fromEntries:function(e){var t={};return i(e,(function(e,a){r(t,e,a)}),{AS_ENTRIES:!0}),t}})},db90:function(e,t,a){"use strict";a("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0"),a("a630")},e9ba:function(e,t,a){"use strict";a("7a82");var n=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("99af"),a("e25e"),a("7db0"),a("d3b7"),a("2ca0"),a("c975");var i=n(a("2909")),r=n(a("c7eb")),o=n(a("1da1")),s=a("6c0c"),l=n(a("0e82")),c={data:function(){return{selectedCategoryId:"",categories:[],pageData:[],currentMarketName:"",searchParams:{title:"",category_id:"",market_id:""},isloaded:!1}},onLoad:function(){this.isloaded=!0},onShow:function(){this.fetchMarketName(),this.fetchCategories(),this.setDefaultMarketId(),this.reloadData()},onPullDownRefresh:function(){setTimeout((function(){uni.stopPullDownRefresh()}),1e3)},mixins:[l.default],methods:{fetchData:function(e){return(0,o.default)((0,r.default)().mark((function t(){var a;return(0,r.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,s.api.marketShopList(e);case 2:return a=t.sent,t.abrupt("return",a.data);case 4:case"end":return t.stop()}}),t)})))()},setDefaultMarketId:function(){var e=uni.getStorageSync("userSelection"),t=e.market_id;this.searchParams.market_id=t},fetchCategories:function(){var e=this;return(0,o.default)((0,r.default)().mark((function t(){var a;return(0,r.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,s.api.cglist();case 2:a=t.sent,e.categories=[{id:0,title:"全选"}].concat((0,i.default)(a.data.listdata||[]));case 4:case"end":return t.stop()}}),t)})))()},filterByCategory:function(e){var t=this;return(0,o.default)((0,r.default)().mark((function a(){return(0,r.default)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.searchParams.category_id=e,t.selectedCategoryId=e,t.reloadData();case 3:case"end":return a.stop()}}),a)})))()},fetchMarketName:function(){var e=this;return(0,o.default)((0,r.default)().mark((function t(){var a,n,i,o,l;return(0,r.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,a=uni.getStorageSync("userSelection"),a){t.next=5;break}return console.warn("未找到 userSelection"),t.abrupt("return");case 5:if(n=a.market_id,i=a.area_id,n&&i){t.next=9;break}return console.warn("未找到市场 ID 或区域 ID"),t.abrupt("return");case 9:return t.next=11,s.api.marketlist(parseInt(i));case 11:o=t.sent,l=o.data.listdata.find((function(e){return e.id===parseInt(n)})),l?e.currentMarketName=l.marketname||"未知市场":(console.warn("未找到对应的市场"),e.currentMarketName="未知市场"),t.next=19;break;case 16:t.prev=16,t.t0=t["catch"](0),console.error("获取市场名称失败:",t.t0);case 19:case"end":return t.stop()}}),t,null,[[0,16]])})))()},navigateToShopDetails:function(e){uni.navigateTo({url:"/pages/ShopDetails/ShopDetails?id=".concat(e)})},toindex1:function(){uni.switchTab({url:"/pages/index1/index1"})},scan:function(){uni.scanCode({onlyFromCamera:!0,success:function(e){console.log(1),console.log("条码类型："+e.scanType),console.log("条码内容："+e.result);var t=e.result;if(t.startsWith("http")){console.log("这是一个有效的 URL");var a=decodeURIComponent(t);console.log("解码后的 URL:",a);var n=a.indexOf("#");if(-1!==n){var i=a.substring(n+1);console.log("提取到的页面路径:",i),uni.navigateTo({url:i})}else console.warn("未能解析到有效的页面路径")}else console.warn("扫码结果不是有效的链接:",t)},fail:function(e){console.error("扫码失败:",e)}})}}};t.default=c},f2e0:function(e,t,a){var n=a("24fb");t=n(!1),t.push([e.i,".container[data-v-2ef9372e]{display:flex;flex-direction:column;margin:%?2?% %?10?%}.locating[data-v-2ef9372e]{height:%?70?%;margin:%?10?% 0;display:flex;flex-direction:row;font-size:%?28?%;font-weight:600;line-height:%?70?%}.targeting[data-v-2ef9372e]{margin-left:%?30?%;color:#1296db}.current[data-v-2ef9372e]{margin-left:auto;color:#000;margin-right:%?30?%}.search[data-v-2ef9372e]{width:100%;\n\t/* position: relative; */display:flex;align-items:center}.sousuokuang[data-v-2ef9372e]{width:86%;\n\t/* position: relative; */display:flex;flex-direction:row;justify-content:center;align-items:center;border:1px solid #ff3030;border-radius:%?20?%;padding:%?10?% %?10?%}.search-icon[data-v-2ef9372e]{height:%?60?%;width:10%;line-height:%?60?%;\n\t/* position: absolute; */left:%?10?%\n\t/* background-color: #1296db; */}.uni-input[data-v-2ef9372e]{width:70% ;height:%?60?%;line-height:%?60?%;\n\t/* height: 80rpx; */\n\t/* padding-left: 60rpx; */padding-right:%?100?%\n\t/* box-sizing: border-box; */\n\t/* background-color: #FF3030; */}.searchbt[data-v-2ef9372e]{\n\t/* position: absolute; */\n\t/* right: 95rpx; */height:%?60?%;line-height:%?60?%;text-align:center;width:%?120?%;border:none;background-color:#ff3030;color:#fff;border-radius:%?25?%;font-size:%?24?%}.buycar[data-v-2ef9372e]{flex:1;\n\t/* width: 100rpx; */\n\t/* margin: 0 10rpx; */margin-left:auto;height:%?80?%;line-height:%?80?%;text-align:center}.uni-margin-wrap[data-v-2ef9372e]{height:%?120?%}.swiper[data-v-2ef9372e]{display:flex;flex-direction:row;justify-content:center;align-items:center;overflow-x:scroll;height:100%;white-space:nowrap}.swiper-item[data-v-2ef9372e]{display:inline-block;height:100%;width:%?120?%;\n\t/* line-height: 100%; */margin:0 %?20?%;text-align:center;vertical-align:middle}.item-title[data-v-2ef9372e]{display:inline-block;box-sizing:border-box;vertical-align:middle;line-height:%?120?%}.classify[data-v-2ef9372e]{margin-top:10%;font-size:%?35?%;font-weight:600}.classify.selected[data-v-2ef9372e]{color:#1296db}.Stallholder[data-v-2ef9372e]{display:flex;flex-direction:column;height:100vh;overflow-y:auto}.Stallholder-content[data-v-2ef9372e]{\n\t/* display: flex;\n\tflex-wrap: wrap;\n\tjustify-content: space-between; */padding:%?10?%;box-sizing:border-box;-webkit-column-count:2;column-count:2;-webkit-column-gap:%?20?%;column-gap:%?20?%\n\t/* background-color: #FF3030; */}.Stallholder-item[data-v-2ef9372e]{width:100%;height:%?480?%;-webkit-column-break-inside:avoid;break-inside:avoid;margin-bottom:%?20?%;\n\t/* line-height: 100%;\n\ttext-align: center; */background-color:#fff;display:flex;flex-direction:column;align-items:center}.Stallholder-content .Stallholder-item[data-v-2ef9372e]:nth-child(2n+1){height:%?510?%}.Stallholder-content .Stallholder-item[data-v-2ef9372e]:nth-child(3n+1){height:%?540?%}.standimg[data-v-2ef9372e]{\n\t/* height: 300rpx; */width:100%;border-radius:%?20?%\n\t/* background-color: #1296db; */}.standtitle[data-v-2ef9372e]{width:90%;height:%?100?%;line-height:%?70?%;\n\t/* background-color: white; */\n\t/* background-color: antiquewhite; */overflow:hidden; /* 隐藏超出的内容 */white-space:nowrap; /* 强制不换行 */text-overflow:ellipsis; /* 显示省略号 */font-size:%?30?%\n\t/* background-color: aqua; */}.loading[data-v-2ef9372e]{text-align:center;padding:%?20?%;color:#999}",""]),e.exports=t},f9d4:function(e,t,a){"use strict";a.r(t);var n=a("1865"),i=a("91cd");for(var r in i)["default"].indexOf(r)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(r);a("86e3");var o=a("f0c5"),s=Object(o["a"])(i["default"],n["b"],n["c"],!1,null,"2ef9372e",null,!1,n["a"],void 0);t["default"]=s.exports}}]);