(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-Apply-Apply"],{2213:function(e,t,i){"use strict";i.r(t);var n=i("9aaf"),a=i("6727");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("f8ce");var c=i("f0c5"),o=Object(c["a"])(a["default"],n["b"],n["c"],!1,null,"37d418c4",null,!1,n["a"],void 0);t["default"]=o.exports},2909:function(e,t,i){"use strict";i("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,n.default)(e)||(0,a.default)(e)||(0,r.default)(e)||(0,c.default)()};var n=o(i("6005")),a=o(i("db90")),r=o(i("06c5")),c=o(i("3427"));function o(e){return e&&e.__esModule?e:{default:e}}},3427:function(e,t,i){"use strict";i("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},i("d9e2"),i("d401")},5263:function(e,t,i){var n=i("ad80");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var a=i("4f06").default;a("b9cdbe5c",n,!0,{sourceMap:!1,shadowMode:!1})},6005:function(e,t,i){"use strict";i("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(Array.isArray(e))return(0,n.default)(e)};var n=function(e){return e&&e.__esModule?e:{default:e}}(i("6b75"))},6727:function(e,t,i){"use strict";i.r(t);var n=i("ac6d"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t["default"]=a.a},"9aaf":function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",{staticClass:"me-container"},[i("v-uni-view",{staticClass:"basicsinfo"},[i("v-uni-text",{staticStyle:{margin:"0rpx 20rpx"}},[e._v("基本信息")]),i("v-uni-view",{staticClass:"item-info"},[i("v-uni-view",{staticClass:"name"},[i("v-uni-text",[e._v("联系人:")]),i("v-uni-input",{attrs:{type:"text",placeholder:"请填写联系人"},model:{value:e.contactpeople,callback:function(t){e.contactpeople=t},expression:"contactpeople"}})],1),i("v-uni-view",{staticClass:"phone"},[i("v-uni-text",[e._v("联系电话:")]),i("v-uni-input",{attrs:{type:"text",placeholder:"请填写联系人电话"},model:{value:e.contactphone,callback:function(t){e.contactphone=t},expression:"contactphone"}})],1)],1)],1),i("v-uni-view",{staticClass:"store"},[i("v-uni-text",{staticStyle:{margin:"10rpx 20rpx"}},[e._v("摊铺信息")]),i("v-uni-view",{staticClass:"storename"},[i("v-uni-text",[e._v("摊铺名称:")]),i("v-uni-input",{attrs:{type:"text",placeholder:"请填写摊铺名称"},model:{value:e.title,callback:function(t){e.title=t},expression:"title"}})],1),i("v-uni-view",{staticClass:"area"},[i("v-uni-text",[e._v("所在地区:")]),i("v-uni-picker",{staticClass:"picker",attrs:{mode:"multiSelector",range:e.multiArray,value:e.multiIndex},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.bindMultiPickerChange.apply(void 0,arguments)},columnchange:function(t){arguments[0]=t=e.$handleEvent(t),e.bindMultiPickerColumnChange.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"picker-text"},[e._v(e._s(e.multiArray[0][e.multiIndex[0]])+" - "+e._s(e.multiArray[1][e.multiIndex[1]])+" -\n\t\t\t\t\t\t"+e._s(e.multiArray[2][e.multiIndex[2]]))])],1)],1),i("v-uni-view",{staticClass:"Address"},[i("v-uni-text",[e._v("选择菜市场:")]),i("v-uni-picker",{staticClass:"picker",attrs:{mode:"selector",range:e.marketList,value:e.selectedMarketIndex},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.bindMarketChange.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"picker-text"},[e._v(e._s(e.marketList[e.selectedMarketIndex]))])],1)],1),i("v-uni-view",{staticClass:"Category"},[i("v-uni-text",[e._v("所售类目:")]),i("v-uni-picker",{staticClass:"Categorypicker",attrs:{mode:"selector",range:e.categoryList},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.bindCategoryChange.apply(void 0,arguments)}}},[i("v-uni-view",[e._v(e._s(e.selectedCategory))])],1)],1),i("v-uni-view",{staticClass:"stallphone"},[i("v-uni-text",[e._v("摊主电话:")]),i("v-uni-input",{attrs:{type:"text",placeholder:"请填写摊主电话"},model:{value:e.phone,callback:function(t){e.phone=t},expression:"phone"}})],1),i("v-uni-view",{staticClass:"BL1"},[i("v-uni-text",[e._v("摊位图片:")]),i("v-uni-view",{staticClass:"BLpicker",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.chooseImage.apply(void 0,arguments)}}},[e._v(e._s(e.isImageSelected?"已选择":"选择图片"))])],1)],1),i("v-uni-button",{staticClass:"submit",attrs:{type:"primary",disabled:e.isSubmitting},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.submitForm.apply(void 0,arguments)}}},[e._v("提交")])],1)},a=[]},ac6d:function(e,t,i){"use strict";i("7a82");var n=i("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i("d81d"),i("d9e2"),i("d401"),i("13d5"),i("d3b7"),i("99af");var a=n(i("2909")),r=n(i("c7eb")),c=n(i("1da1")),o=i("6c0c"),s=i("a15b"),d={data:function(){return{multiArray:[[],[],[]],multiIndex:[0,0,0],categoryList:["请选择分类"],categoryIdMap:{},selectedCategory:"请选择分类",provinceList:[],cityList:[],districtList:[],marketList:[],marketIdMap:{},selectedMarketIndex:0,contactpeople:"",contactphone:"",title:"",logo:"",phone:"",content:"",area_id:null,market_id:null,category_id:null,isSubmitting:!1,businessLicense:"",isImageSelected:!1}},mounted:function(){this.initializePicker(),this.fetchCategories(),this.fetchMarkets()},onShow:function(){this.checkToken()&&uni.navigateTo({url:"/pages/login/login"})},methods:{checkToken:function(){var e=uni.getStorageSync("token");return!e},customizeBack:function(){return(0,c.default)((0,r.default)().mark((function e(){var t;return(0,r.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,getCurrentPages();case 2:t=e.sent,t&&t.length>1?uni.navigateBack():history.back();case 4:case"end":return e.stop()}}),e)})))()},initializePicker:function(){var e=this;return(0,c.default)((0,r.default)().mark((function t(){var i,n,a;return(0,r.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.fetchProvinces();case 3:return i=t.sent,e.multiArray[0]=i.map((function(e){return e.name})),t.next=7,e.fetchCities(i[0].id);case 7:return n=t.sent,e.multiArray[1]=n.map((function(e){return e.name})),t.next=11,e.fetchAreas(n[0].id);case 11:a=t.sent,e.multiArray[2]=a.map((function(e){return e.name})),e.multiIndex=[0,0,0],t.next=19;break;case 16:t.prev=16,t.t0=t["catch"](0),console.error("Failed to initialize picker:",t.t0);case 19:case"end":return t.stop()}}),t,null,[[0,16]])})))()},fetchProvinces:function(){var e=this;return(0,c.default)((0,r.default)().mark((function t(){var i;return(0,r.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,o.api.citylist({level:1,limit:100});case 3:if(i=t.sent,200!==i.code){t.next=7;break}return e.provinceList=i.data.listdata,t.abrupt("return",e.provinceList);case 7:throw new Error("Failed to fetch provinces");case 10:throw t.prev=10,t.t0=t["catch"](0),console.error("Failed to fetch provinces:",t.t0),t.t0;case 14:case"end":return t.stop()}}),t,null,[[0,10]])})))()},fetchCities:function(e){return(0,c.default)((0,r.default)().mark((function t(){var i;return(0,r.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,o.api.citytree(e);case 3:if(i=t.sent,200!==i.code||!Array.isArray(i.data)){t.next=8;break}return t.abrupt("return",i.data);case 8:return console.error("No cities data found"),t.abrupt("return",[]);case 10:t.next=16;break;case 12:return t.prev=12,t.t0=t["catch"](0),console.error("Failed to fetch cities:",t.t0),t.abrupt("return",[]);case 16:case"end":return t.stop()}}),t,null,[[0,12]])})))()},fetchAreas:function(e){return(0,c.default)((0,r.default)().mark((function t(){var i;return(0,r.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,o.api.citytree(e);case 3:if(i=t.sent,200!==i.code||!Array.isArray(i.data)){t.next=8;break}return t.abrupt("return",i.data);case 8:return console.error("No areas data found"),t.abrupt("return",[]);case 10:t.next=16;break;case 12:return t.prev=12,t.t0=t["catch"](0),console.error("Failed to fetch areas:",t.t0),t.abrupt("return",[]);case 16:case"end":return t.stop()}}),t,null,[[0,12]])})))()},bindMultiPickerChange:function(e){this.multiIndex=e.detail.value;var t=this.multiArray[0][this.multiIndex[0]],i=this.multiArray[1][this.multiIndex[1]],n=this.multiArray[2][this.multiIndex[2]],a=this.districtList[this.multiIndex[2]].id;console.log("选择的省市区:",t,i,n),this.area_id=a,this.fetchMarkets(a)},bindMultiPickerColumnChange:function(e){var t=this;return(0,c.default)((0,r.default)().mark((function i(){var n,c,o,s,d,l;return(0,r.default)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(n=e.detail.column,c=e.detail.value,t.multiIndex[n]=c,0!==n){i.next=15;break}return o=t.provinceList[c].id,i.next=7,t.fetchCities(o);case 7:s=i.sent,t.cityList=s,t.multiArray[1]=s.map((function(e){return e.name})),t.multiArray[2]=[],t.multiIndex[1]=0,t.multiIndex[2]=0,i.next=23;break;case 15:if(1!==n){i.next=23;break}return d=t.cityList[c].id,i.next=19,t.fetchAreas(d);case 19:l=i.sent,t.districtList=l,t.multiArray[2]=l.map((function(e){return e.name})),t.multiIndex[2]=0;case 23:t.multiIndex=(0,a.default)(t.multiIndex);case 24:case"end":return i.stop()}}),i)})))()},fetchMarkets:function(e){var t=this;return(0,c.default)((0,r.default)().mark((function i(){var n;return(0,r.default)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.prev=0,100,i.next=4,o.api.marketlist(e,100);case 4:n=i.sent,200===n.code?(t.marketData=n.data.listdata,t.marketList=n.data.listdata.map((function(e){return e.marketname})),t.marketIdMap=t.marketData.reduce((function(e,t){return e[t.marketname]=t.id,e}),{})):console.error("Failed to fetch markets:",n.message),i.next=11;break;case 8:i.prev=8,i.t0=i["catch"](0),console.error("Failed to fetch markets:",i.t0);case 11:case"end":return i.stop()}}),i,null,[[0,8]])})))()},bindMarketChange:function(e){this.selectedMarketIndex=e.detail.value;var t=this.marketList[this.selectedMarketIndex];this.market_id=this.marketIdMap[t]||null},fetchCategories:function(){var e=this;return(0,c.default)((0,r.default)().mark((function t(){var i,n;return(0,r.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,o.api.cglist();case 3:if(i=t.sent,200!==i.code){t.next=10;break}n=i.data.listdata,e.categoryList=["请选择分类"].concat((0,a.default)(n.map((function(e){return e.title})))),e.categoryIdMap=n.reduce((function(e,t){return e[t.title]=t.id,e}),{}),t.next=11;break;case 10:throw new Error("Failed to fetch categories");case 11:t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](0),console.error("Failed to fetch categories:",t.t0);case 16:case"end":return t.stop()}}),t,null,[[0,13]])})))()},bindCategoryChange:function(e){var t=e.detail.value;this.selectedCategory=this.categoryList[t],this.category_id=this.categoryIdMap[this.selectedCategory]},chooseImage:function(){var e=this;uni.chooseImage({count:1,sizeType:["compressed","original"],sourceType:["album","camera"],success:function(t){var i=t.tempFilePaths;if(i.length>0){var n=(0,s.useUpload)({uploadPath:"/group1/upload",tempFilePaths:i[0],file:t.tempFiles[0]}),a=n.upload;n.request;a().then((function(t){var i=JSON.parse(t);e.logo=o.UPLOAD_URL+i.data.path,e.isImageSelected=!0}))}}})},submitForm:function(){var e=this;return(0,c.default)((0,r.default)().mark((function t(){var i,n;return(0,r.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.isSubmitting){t.next=2;break}return t.abrupt("return");case 2:if(e.contactpeople&&e.contactphone&&e.title&&e.phone&&e.area_id&&e.market_id&&e.category_id&&e.logo){t.next=5;break}return uni.showToast({title:"请填写完整的信息",icon:"none"}),t.abrupt("return");case 5:return e.isSubmitting=!0,t.prev=6,i={contactpeople:e.contactpeople,contactphone:e.contactphone,title:e.title,logo:e.logo,phone:e.phone,content:e.content,area_id:e.area_id,market_id:e.market_id,category_id:e.category_id},t.next=10,o.api.addshop(i);case 10:n=t.sent,200===n.code?(uni.showToast({title:"摊位申请成功",icon:"success",duration:2e3}),setTimeout((function(){e.customizeBack()}),2e3)):uni.showToast({title:n.msg||"提交失败",icon:"none"}),t.next=18;break;case 14:t.prev=14,t.t0=t["catch"](6),console.error("提交失败:",t.t0),uni.showToast({title:"提交失败",icon:"none"});case 18:return t.prev=18,e.isSubmitting=!1,t.finish(18);case 21:case"end":return t.stop()}}),t,null,[[6,14,18,21]])})))()}}};t.default=d},ad80:function(e,t,i){var n=i("24fb");t=n(!1),t.push([e.i,".me-container[data-v-37d418c4]{overflow:hidden;width:100%;box-sizing:border-box;padding:%?0?% %?40?% 0 %?40?%;color:#fff;z-index:1;background-color:#f8f8f8;display:flex;flex-direction:column;justify-content:center}.basicsinfo[data-v-37d418c4]{height:%?250?%;width:100%;display:flex;flex-direction:column;justify-content:center;margin-top:%?20?%;border:1px solid #ccc}uni-text[data-v-37d418c4]{color:#000;height:%?50?%;line-height:%?50?%}.item-info[data-v-37d418c4]{height:%?200?%;width:100%;background-color:#fff}.name[data-v-37d418c4]{height:%?100?%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;border-bottom:1px solid #ccc;margin:0 %?20?%}.name>uni-text[data-v-37d418c4]{height:%?100?%;width:%?200?%;line-height:%?100?%;text-align:left}.name>uni-input[data-v-37d418c4]{height:%?100?%;width:100%;color:#000}.phone[data-v-37d418c4]{height:%?100?%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;margin:0 %?20?%}.phone>uni-text[data-v-37d418c4]{height:%?100?%;width:%?200?%;line-height:%?100?%;text-align:left}.phone>uni-input[data-v-37d418c4]{height:%?100?%;width:100%;color:#000}.store[data-v-37d418c4]{height:%?685?%;width:100%;display:flex;flex-direction:column;justify-content:center;margin-top:%?30?%;border:1px solid #ccc}.storename[data-v-37d418c4]{height:%?100?%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;\n\t/* margin: 0 20rpx; */padding:0 %?20?%;border-bottom:1px solid #ccc;background-color:#fff}.storename>uni-text[data-v-37d418c4]{height:%?100?%;width:%?200?%;line-height:%?100?%;text-align:left}.storename>uni-input[data-v-37d418c4]{height:%?100?%;width:100%;color:#000}.area[data-v-37d418c4]{height:%?100?%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;\n\t/* margin: 0 20rpx; */padding:0 %?20?%;border-bottom:1px solid #ccc;background-color:#fff}.area>uni-text[data-v-37d418c4]{height:%?100?%;width:%?200?%;line-height:%?100?%;text-align:left}.picker[data-v-37d418c4]{height:%?100?%;width:100%;color:#000;line-height:%?100?%;box-sizing:border-box;overflow:hidden /* 隐藏超出部分 */}.picker-text[data-v-37d418c4]{white-space:nowrap; /* 禁止换行 */overflow:hidden; /* 隐藏超出部分 */text-overflow:ellipsis; /* 超出部分显示省略号 */line-height:%?100?%;box-sizing:border-box\n  /* font-size: 30rpx; */\n  /* padding: 0 10rpx; */}.Address[data-v-37d418c4]{height:%?100?%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;\n\t/* margin: 0 20rpx; */padding:0 %?20?%;border-bottom:1px solid #ccc;background-color:#fff}.Address>uni-text[data-v-37d418c4]{height:%?100?%;width:%?200?%;line-height:%?100?%;text-align:left}\n\n/* .Address>input {\n\theight: 100rpx;\n\twidth: 100%;\n\tcolor: black;\n} */.Category[data-v-37d418c4]{height:%?100?%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;\n\t/* margin: 0 20rpx; */padding:0 %?20?%;border-bottom:1px solid #ccc;background-color:#fff}.Category>uni-text[data-v-37d418c4]{height:%?100?%;width:%?200?%;line-height:%?100?%;text-align:left}.Categorypicker[data-v-37d418c4]{height:%?100?%;width:100%;color:#000;line-height:%?100?%;box-sizing:border-box}.stallphone[data-v-37d418c4]{height:%?100?%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;border-bottom:1px solid #ccc;\n\t/* margin: 0 20rpx; */padding:0 %?20?%;background-color:#fff}.stallphone>uni-text[data-v-37d418c4]{height:%?100?%;width:%?200?%;line-height:%?100?%;text-align:left}.stallphone>uni-input[data-v-37d418c4]{height:%?100?%;width:100%;color:#000}.BL[data-v-37d418c4]{height:%?100?%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;\n\t/* margin: 0 20rpx; */padding:0 %?20?%;border-bottom:1px solid #ccc;background-color:#fff}.BL>uni-text[data-v-37d418c4]{height:%?100?%;width:%?200?%;line-height:%?100?%;text-align:left}.BLpicker[data-v-37d418c4]{height:%?100?%;width:100%;color:#000;line-height:%?100?%;box-sizing:border-box}.BL1[data-v-37d418c4]{height:%?100?%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;\n\t/* margin: 0 20rpx; */padding:0 %?20?%;background-color:#fff;border-bottom:1px solid #ccc}.BL1>uni-text[data-v-37d418c4]{height:%?100?%;width:%?200?%;line-height:%?100?%;text-align:left}.BLpicker[data-v-37d418c4]{height:%?100?%;width:100%;color:#000;line-height:%?100?%;box-sizing:border-box}.illustrate[data-v-37d418c4]{height:%?200?%;width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:left;\n\t/* margin: 0 20rpx; */padding:0 %?20?%;box-sizing:border-box;background-color:#fff}.illustrate>uni-text[data-v-37d418c4]{height:%?200?%;width:%?200?%;max-width:%?200?%;\n\t/* 或者一个适合的最大宽度 */line-height:1.2;text-align:left;box-sizing:border-box;word-wrap:break-word;\n\t/* 允许长单词换行 */overflow-wrap:break-word;display:flex;align-items:center;border-right:1px solid #ccc}.illustrate>uni-textarea[data-v-37d418c4]{height:%?100?%;width:100%;color:#000}.submit[data-v-37d418c4]{overflow:hidden;width:100%;box-sizing:border-box;padding:%?0?% %?40?% 0 %?40?%;margin-top:%?30?%}",""]),e.exports=t},db90:function(e,t,i){"use strict";i("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},i("a4d3"),i("e01a"),i("d3b7"),i("d28b"),i("3ca3"),i("ddb0"),i("a630")},f8ce:function(e,t,i){"use strict";var n=i("5263"),a=i.n(n);a.a}}]);