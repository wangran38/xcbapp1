(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-stalllist-stalllist"],{"0094":function(t,e,n){"use strict";var i,a=n("da84"),o=n("e330"),r=n("6964"),s=n("f183"),c=n("6d61"),u=n("acac"),d=n("861d"),l=n("4fadd"),f=n("69f3").enforce,h=n("cdce"),p=!a.ActiveXObject&&"ActiveXObject"in a,v=function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},g=c("WeakMap",v,u);if(h&&p){i=u.getConstructor(v,"WeakMap",!0),s.enable();var b=g.prototype,w=o(b["delete"]),m=o(b.has),x=o(b.get),y=o(b.set);r(b,{delete:function(t){if(d(t)&&!l(t)){var e=f(this);return e.frozen||(e.frozen=new i),w(this,t)||e.frozen["delete"](t)}return w(this,t)},has:function(t){if(d(t)&&!l(t)){var e=f(this);return e.frozen||(e.frozen=new i),m(this,t)||e.frozen.has(t)}return m(this,t)},get:function(t){if(d(t)&&!l(t)){var e=f(this);return e.frozen||(e.frozen=new i),m(this,t)?x(this,t):e.frozen.get(t)}return x(this,t)},set:function(t,e){if(d(t)&&!l(t)){var n=f(this);n.frozen||(n.frozen=new i),m(this,t)?y(this,t,e):n.frozen.set(t,e)}else y(this,t,e);return this}})}},"0e82":function(t,e,n){"use strict";n("7a82");var i=n("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=i(n("c7eb")),o=i(n("1da1")),r=i(n("5530")),s=i(n("3835"));n("c1f9"),n("4de4"),n("d3b7"),n("4fad"),n("d9e2"),n("d401"),n("99af");var c={data:function(){return{page:1,limit:8,totalnum:0,pageData:[],pageLoading:!1,hasMore:!0,searchParams:{}}},computed:{queryParams:function(){var t=Object.fromEntries(Object.entries(this.searchParams).filter((function(t){var e=(0,s.default)(t,2),n=(e[0],e[1]);return""!==n})));return(0,r.default)({page:this.page,limit:this.limit},t)}},methods:{loadPageData:function(){var t=this;return(0,o.default)((0,a.default)().mark((function e(){var n;return(0,a.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.hasMore&&!t.pageLoading){e.next=2;break}return e.abrupt("return");case 2:return t.pageLoading=!0,e.prev=3,e.next=6,t.fetchData(t.queryParams);case 6:n=e.sent,t.querySuccess(n),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](3),t.handleFetchError(e.t0);case 13:return e.prev=13,t.pageLoading=!1,e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[3,10,13,16]])})))()},fetchData:function(t){return(0,o.default)((0,a.default)().mark((function t(){return(0,a.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:throw new Error("fetchData 方法未实现");case 1:case"end":return t.stop()}}),t)})))()},querySuccess:function(t){null!==t&&void 0!==t&&t.listdata&&(this.pageData=1===this.page?t.listdata:this.pageData.concat(t.listdata),this.totalnum=t.totalnum||0,this.hasMore=this.pageData.length<this.totalnum)},handleScrollToLower:function(){!this.pageLoading&&this.hasMore&&(this.page+=1,this.loadPageData())},handleFetchError:function(t){console.error("Error loading data:",t)},resetPagination:function(){this.page=1,this.pageData=[],this.totalnum=0,this.hasMore=!0},reloadData:function(){this.resetPagination(),this.loadPageData()}}};e.default=c},"10d1":function(t,e,n){n("0094")},"3a17":function(t,e,n){var i=n("5d65");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var a=n("4f06").default;a("bd11106a",i,!0,{sourceMap:!1,shadowMode:!1})},"4fad":function(t,e,n){var i=n("23e7"),a=n("6f53").entries;i({target:"Object",stat:!0},{entries:function(t){return a(t)}})},"4fadd":function(t,e,n){var i=n("d039"),a=n("861d"),o=n("c6b6"),r=n("d86b"),s=Object.isExtensible,c=i((function(){s(1)}));t.exports=c||r?function(t){return!!a(t)&&((!r||"ArrayBuffer"!=o(t))&&(!s||s(t)))}:s},"5d65":function(t,e,n){var i=n("24fb");e=i(!1),e.push([t.i,".me-container[data-v-5d3846cb]{overflow:hidden;width:100%;box-sizing:border-box;padding:%?0?% %?30?% 0 %?30?%;color:#fff;z-index:1;background-color:#f4f4f4;display:flex;flex-direction:column;justify-content:center}.item-list[data-v-5d3846cb]{height:%?200?%;width:100%;margin-top:%?15?%;display:flex;flex-direction:row;justify-content:flex-start;align-items:center;background-color:#fff;border-radius:%?20?%}.logo[data-v-5d3846cb]{height:%?180?%;width:30%;text-align:center;line-height:%?200?%;background-color:#1296db;border-radius:%?20?%\n\t/* padding: 10rpx 10rpx; */}.logos[data-v-5d3846cb]{height:%?180?%;width:100%;border-radius:%?20?%}.info[data-v-5d3846cb]{height:%?200?%;width:50%;margin-left:%?10?%;\n\t/* 设置info和logo之间的间距 */display:flex;flex-direction:column;\n\t/* justify-content: space-between; */flex:1;\n\t/* 确保info占据剩余空间 */overflow:hidden\n\t/* 确保内容不溢出 */}.message[data-v-5d3846cb]{width:100%;margin:%?10?%;\n\t/* 调整这个值以改变上下间距 */color:#000;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.interface[data-v-5d3846cb]{height:100%;width:20%;display:flex;flex-direction:column;justify-content:center;align-items:center;margin-left:auto;\n\t/* 设置interface与info的间距 */position:relative\n\t/* margin-right: 0rpx; */\n\t/* background-color: #1296db; */}.interface>.edit[data-v-5d3846cb]{text-align:center;color:#fff;font-size:%?30?%;width:%?100?%;height:%?50?%;line-height:%?50?%;background-color:#1296db;border-radius:%?20?%;margin-bottom:%?20?%}.interface>.delete[data-v-5d3846cb]{text-align:center;color:#fff;font-size:%?30?%;width:%?100?%;height:%?50?%;line-height:%?50?%;background-color:#ff1909;border-radius:%?20?%}.loading[data-v-5d3846cb]{text-align:center;padding:%?20?%;color:#999}.popup-overlay[data-v-5d3846cb]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.5);display:flex;justify-content:center;align-items:center;z-index:1000;color:#000}.popup[data-v-5d3846cb]{position:relative;width:80%;max-width:%?600?%;background-color:#fff;border-radius:%?20?%;padding:%?20?%;box-shadow:0 0 15px rgba(0,0,0,.2)}.popup-header[data-v-5d3846cb]{font-size:%?36?%;font-weight:700;margin-bottom:%?20?%;text-align:center}.popup-content[data-v-5d3846cb]{\n\t/* 这里你可以添加弹出层内容的样式 */display:flex;width:100%;padding:%?30?%;box-sizing:border-box;justify-content:center;align-items:center}.popup-footer[data-v-5d3846cb]{display:flex;justify-content:space-between;margin-top:%?10?%}.close-button[data-v-5d3846cb]{position:absolute;top:%?5?%;right:%?5?%;font-size:%?40?%;color:#000;cursor:pointer;z-index:10;width:%?80?%;height:%?80?%;display:flex;justify-content:center;align-items:center;background-color:#fff;border-radius:50%;box-shadow:0 0 %?10?% rgba(0,0,0,.1)}.cimg[data-v-5d3846cb]{width:%?100?%;height:%?100?%}.content[data-v-5d3846cb]{width:100%;height:%?200?%}.cuisine[data-v-5d3846cb]{width:100%;height:%?100?%;display:flex;justify-content:space-between;align-items:center}.editimg[data-v-5d3846cb]{width:100%;height:%?100?%;display:flex;justify-content:space-between;align-items:center}.title[data-v-5d3846cb]{font-size:%?35?%}.shuru[data-v-5d3846cb]{width:auto;height:%?100?%;display:flex;justify-content:end;align-items:center}.shurucon[data-v-5d3846cb]{text-align:end;font-size:%?35?%}",""]),t.exports=e},"5e7f":function(t,e,n){"use strict";n.r(e);var i=n("965f"),a=n("d39d");for(var o in a)["default"].indexOf(o)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(o);n("d036");var r=n("f0c5"),s=Object(r["a"])(a["default"],i["b"],i["c"],!1,null,"5d3846cb",null,!1,i["a"],void 0);e["default"]=s.exports},"6d61":function(t,e,n){"use strict";var i=n("23e7"),a=n("da84"),o=n("e330"),r=n("94ca"),s=n("cb2d"),c=n("f183"),u=n("2266"),d=n("19aa"),l=n("1626"),f=n("7234"),h=n("861d"),p=n("d039"),v=n("1c7e"),g=n("d44e"),b=n("7156");t.exports=function(t,e,n){var w=-1!==t.indexOf("Map"),m=-1!==t.indexOf("Weak"),x=w?"set":"add",y=a[t],k=y&&y.prototype,P=y,S={},_=function(t){var e=o(k[t]);s(k,t,"add"==t?function(t){return e(this,0===t?0:t),this}:"delete"==t?function(t){return!(m&&!h(t))&&e(this,0===t?0:t)}:"get"==t?function(t){return m&&!h(t)?void 0:e(this,0===t?0:t)}:"has"==t?function(t){return!(m&&!h(t))&&e(this,0===t?0:t)}:function(t,n){return e(this,0===t?0:t,n),this})},j=r(t,!l(y)||!(m||k.forEach&&!p((function(){(new y).entries().next()}))));if(j)P=n.getConstructor(e,t,w,x),c.enable();else if(r(t,!0)){var E=new P,C=E[x](m?{}:-0,1)!=E,O=p((function(){E.has(1)})),z=v((function(t){new y(t)})),D=!m&&p((function(){var t=new y,e=5;while(e--)t[x](e,e);return!t.has(-0)}));z||(P=e((function(t,e){d(t,k);var n=b(new y,t,P);return f(e)||u(e,n[x],{that:n,AS_ENTRIES:w}),n})),P.prototype=k,k.constructor=P),(O||D)&&(_("delete"),_("has"),w&&_("get")),(D||C)&&_(x),m&&k.clear&&delete k.clear}return S[t]=P,i({global:!0,constructor:!0,forced:P!=y},S),g(P,t),m||n.setStrong(P,t,w),P}},7131:function(t,e,n){"use strict";n("7a82");var i=n("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=i(n("c7eb")),o=i(n("5530")),r=i(n("1da1")),s=n("6c0c"),c=i(n("0e82")),u=n("a15b"),d={data:function(){return{pageData:[],shopList:[],token:"",imageUploaded:!1,showEditPopup:!1,currentShopTitle:"",currentShopLogo:"",isloaded:!1}},mixins:[c.default],onLoad:function(){this.isloaded=!0},created:function(){this.token=uni.getStorageSync("token"),this.reloadData()},methods:{fetchData:function(t){var e=this;return(0,r.default)((0,a.default)().mark((function n(){var i;return(0,a.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,s.api.getMyShops((0,o.default)({token:e.token},t));case 3:return i=n.sent,n.abrupt("return",i.data);case 7:n.prev=7,n.t0=n["catch"](0),console.error("获取摊位列表失败",n.t0),uni.showToast({title:"获取摊位列表失败",icon:"none"});case 11:case"end":return n.stop()}}),n,null,[[0,7]])})))()},editShop:function(t){this.currentShopId=t.id,this.currentShopTitle=t.title,this.currentShopLogo=t.logo,this.showEditPopup=!0},closePopup:function(){this.showEditPopup=!1},confirmEdit:function(t){var e=this;return(0,r.default)((0,a.default)().mark((function t(){var n;return(0,a.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.currentShopTitle){t.next=3;break}return uni.showToast({title:"请输入摊位名称",icon:"none"}),t.abrupt("return");case 3:if(e.imageUploaded||e.currentShopLogo){t.next=6;break}return uni.showToast({title:"请上传图片",icon:"none"}),t.abrupt("return");case 6:return t.prev=6,console.log("Calling editshop API"),t.next=10,s.api.editshop({id:e.currentShopId,title:e.currentShopTitle,logo:e.currentShopLogo});case 10:n=t.sent,200===n.code?(uni.showToast({title:"摊位信息修改成功",icon:"success"}),e.reloadData(),e.closePopup()):uni.showToast({title:n.msg||"摊位信息修改失败",icon:"none"}),t.next=17;break;case 14:t.prev=14,t.t0=t["catch"](6),uni.showToast({title:"修改失败，请稍后重试",icon:"none"});case 17:case"end":return t.stop()}}),t,null,[[6,14]])})))()},uploadcuisine:function(){var t=this;uni.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(e){var n=e.tempFilePaths;if(n.length>0){var i=(0,u.useUpload)({uploadPath:"/group1/upload",tempFilePaths:n[0]}),a=i.upload;i.request;a().then((function(e){console.log(e),t.currentShopLogo=e,console.log("更新后的图片路径:",t.currentShopLogo),t.isImageSelected=!0,t.imageUploaded=!0}))}}})},gotostaldis:function(t){uni.navigateTo({url:"/pages/Stalls-dishes/Stalls-dishes?id=".concat(t)})}}};e.default=d},"965f":function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){}));var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"me-container"},[n("v-uni-scroll-view",{staticClass:"Stallholder",style:{height:"100vh"},attrs:{"scroll-y":"true"},on:{scrolltolower:function(e){arguments[0]=e=t.$handleEvent(e),t.handleScrollToLower.apply(void 0,arguments)}}},[t._l(t.pageData,(function(e){return n("v-uni-view",{key:e.id,staticClass:"item-list"},[n("v-uni-view",{staticClass:"logo",on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.gotostaldis(e.id)}}},[t.isloaded?n("v-uni-image",{staticClass:"logos",attrs:{"lazy-load":!0,src:e.logo,mode:"aspectFill"}}):t._e()],1),n("v-uni-view",{staticClass:"info",on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.gotostaldis(e.id)}}},[n("v-uni-view",{staticClass:"message"},[t._v("菜市场名称："+t._s(e.market_name))]),n("v-uni-view",{staticClass:"message"},[t._v("摊位名称："+t._s(e.title))]),n("v-uni-view",{staticClass:"message"},[t._v("摊位编号："+t._s(e.id))])],1),n("v-uni-view",{staticClass:"interface"},[n("v-uni-view",{staticClass:"edit",on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.editShop(e)}}},[t._v("编辑")]),n("v-uni-view",{staticClass:"delete",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.deleteShop.apply(void 0,arguments)}}},[t._v("删除")])],1)],1)})),t.pageLoading?n("v-uni-view",{staticClass:"loading"},[t._v("加载中...")]):t._e(),t.hasMore?t._e():n("v-uni-view",{staticClass:"loading"},[t._v("没有更多了")])],2),t.showEditPopup?n("v-uni-view",{staticClass:"popup-overlay",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closePopup.apply(void 0,arguments)}}},[n("v-uni-view",{staticClass:"popup",on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e)}}},[n("v-uni-view",{staticClass:"close-button",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closePopup.apply(void 0,arguments)}}},[t._v("×")]),n("v-uni-view",{staticClass:"popup-content"},[n("v-uni-view",{staticClass:"content"},[n("v-uni-view",{staticClass:"cuisine"},[n("v-uni-view",{staticClass:"title"},[t._v("摊位名称")]),n("v-uni-view",{staticClass:"shuru"},[n("v-uni-input",{staticClass:"shurucon",attrs:{type:"text"},model:{value:t.currentShopTitle,callback:function(e){t.currentShopTitle=e},expression:"currentShopTitle"}})],1)],1),n("v-uni-view",{staticClass:"editimg"},[n("v-uni-view",{staticClass:"title"},[t._v("摊位图片")]),n("v-uni-image",{staticClass:"cimg",attrs:{src:t.currentShopLogo,mode:"aspectFit"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.uploadcuisine.apply(void 0,arguments)}}})],1)],1)],1),n("v-uni-view",{staticClass:"popup-footer"},[n("v-uni-button",{on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closePopup.apply(void 0,arguments)}}},[t._v("取消")]),n("v-uni-button",{staticStyle:{"background-color":"#007aff",color:"white"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.confirmEdit.apply(void 0,arguments)}}},[t._v("确认")])],1)],1)],1):t._e()],1)},a=[]},a15b:function(t,e,n){"use strict";n("7a82");var i=n("dbce").default,a=n("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.useUpload=void 0;var o=a(n("c7eb")),r=a(n("1da1"));n("d3b7");var s=i(n("6c0c"));e.useUpload=function(t){var e=t.uploadPath,n=t.tempFilePaths,i=(t.FormData,t.file);return{upload:function(){return new Promise(function(){var t=(0,r.default)((0,o.default)().mark((function t(a,r){return(0,o.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:uni.showLoading({title:"上传中",mask:!0}),uni.uploadFile({url:s.default.UPLOAD_URL+e,name:"file",file:i,filePath:n,formData:{output:"json2"},header:{},success:function(t){uni.showToast({title:"上传成功"}),uni.hideLoading(),a(null===t||void 0===t?void 0:t.data)},fail:function(t){console.log(t),uni.showToast({title:"上传失败",icon:"error"}),uni.hideLoading()}});case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}}}},acac:function(t,e,n){"use strict";var i=n("e330"),a=n("6964"),o=n("f183").getWeakData,r=n("19aa"),s=n("825a"),c=n("7234"),u=n("861d"),d=n("2266"),l=n("b727"),f=n("1a2d"),h=n("69f3"),p=h.set,v=h.getterFor,g=l.find,b=l.findIndex,w=i([].splice),m=0,x=function(t){return t.frozen||(t.frozen=new y)},y=function(){this.entries=[]},k=function(t,e){return g(t.entries,(function(t){return t[0]===e}))};y.prototype={get:function(t){var e=k(this,t);if(e)return e[1]},has:function(t){return!!k(this,t)},set:function(t,e){var n=k(this,t);n?n[1]=e:this.entries.push([t,e])},delete:function(t){var e=b(this.entries,(function(e){return e[0]===t}));return~e&&w(this.entries,e,1),!!~e}},t.exports={getConstructor:function(t,e,n,i){var l=t((function(t,a){r(t,h),p(t,{type:e,id:m++,frozen:void 0}),c(a)||d(a,t[i],{that:t,AS_ENTRIES:n})})),h=l.prototype,g=v(e),b=function(t,e,n){var i=g(t),a=o(s(e),!0);return!0===a?x(i).set(e,n):a[i.id]=n,t};return a(h,{delete:function(t){var e=g(this);if(!u(t))return!1;var n=o(t);return!0===n?x(e)["delete"](t):n&&f(n,e.id)&&delete n[e.id]},has:function(t){var e=g(this);if(!u(t))return!1;var n=o(t);return!0===n?x(e).has(t):n&&f(n,e.id)}}),a(h,n?{get:function(t){var e=g(this);if(u(t)){var n=o(t);return!0===n?x(e).get(t):n?n[e.id]:void 0}},set:function(t,e){return b(this,t,e)}}:{add:function(t){return b(this,t,!0)}}),l}}},bb2f:function(t,e,n){var i=n("d039");t.exports=!i((function(){return Object.isExtensible(Object.preventExtensions({}))}))},c1f9:function(t,e,n){var i=n("23e7"),a=n("2266"),o=n("8418");i({target:"Object",stat:!0},{fromEntries:function(t){var e={};return a(t,(function(t,n){o(e,t,n)}),{AS_ENTRIES:!0}),e}})},d036:function(t,e,n){"use strict";var i=n("3a17"),a=n.n(i);a.a},d39d:function(t,e,n){"use strict";n.r(e);var i=n("7131"),a=n.n(i);for(var o in i)["default"].indexOf(o)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(o);e["default"]=a.a},d86b:function(t,e,n){var i=n("d039");t.exports=i((function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}}))},dbce:function(t,e,n){n("d3b7"),n("3ca3"),n("10d1"),n("ddb0"),n("7a82"),n("e439");var i=n("7037")["default"];function a(t){if("function"!==typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(a=function(t){return t?n:e})(t)}t.exports=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!==typeof t)return{default:t};var n=a(e);if(n&&n.has(t))return n.get(t);var o={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var c=r?Object.getOwnPropertyDescriptor(t,s):null;c&&(c.get||c.set)?Object.defineProperty(o,s,c):o[s]=t[s]}return o["default"]=t,n&&n.set(t,o),o},t.exports.__esModule=!0,t.exports["default"]=t.exports},f183:function(t,e,n){var i=n("23e7"),a=n("e330"),o=n("d012"),r=n("861d"),s=n("1a2d"),c=n("9bf2").f,u=n("241c"),d=n("057f"),l=n("4fadd"),f=n("90e3"),h=n("bb2f"),p=!1,v=f("meta"),g=0,b=function(t){c(t,v,{value:{objectID:"O"+g++,weakData:{}}})},w=t.exports={enable:function(){w.enable=function(){},p=!0;var t=u.f,e=a([].splice),n={};n[v]=1,t(n).length&&(u.f=function(n){for(var i=t(n),a=0,o=i.length;a<o;a++)if(i[a]===v){e(i,a,1);break}return i},i({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:d.f}))},fastKey:function(t,e){if(!r(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!s(t,v)){if(!l(t))return"F";if(!e)return"E";b(t)}return t[v].objectID},getWeakData:function(t,e){if(!s(t,v)){if(!l(t))return!0;if(!e)return!1;b(t)}return t[v].weakData},onFreeze:function(t){return h&&p&&l(t)&&!s(t,v)&&b(t),t}};o[v]=!0}}]);