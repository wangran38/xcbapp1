(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-user-edit-user-edit"],{"0094":function(t,e,n){"use strict";var i,a=n("da84"),r=n("e330"),o=n("6964"),s=n("f183"),u=n("6d61"),c=n("acac"),f=n("861d"),d=n("4fadd"),l=n("69f3").enforce,h=n("cdce"),v=!a.ActiveXObject&&"ActiveXObject"in a,p=function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},b=u("WeakMap",p,c);if(h&&v){i=c.getConstructor(p,"WeakMap",!0),s.enable();var g=b.prototype,m=r(g["delete"]),x=r(g.has),w=r(g.get),y=r(g.set);o(g,{delete:function(t){if(f(t)&&!d(t)){var e=l(this);return e.frozen||(e.frozen=new i),m(this,t)||e.frozen["delete"](t)}return m(this,t)},has:function(t){if(f(t)&&!d(t)){var e=l(this);return e.frozen||(e.frozen=new i),x(this,t)||e.frozen.has(t)}return x(this,t)},get:function(t){if(f(t)&&!d(t)){var e=l(this);return e.frozen||(e.frozen=new i),x(this,t)?w(this,t):e.frozen.get(t)}return w(this,t)},set:function(t,e){if(f(t)&&!d(t)){var n=l(this);n.frozen||(n.frozen=new i),x(this,t)?y(this,t,e):n.frozen.set(t,e)}else y(this,t,e);return this}})}},"10d1":function(t,e,n){n("0094")},4401:function(t,e,n){"use strict";n.r(e);var i=n("a2f9"),a=n("bb74");for(var r in a)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(r);n("5c69");var o=n("f0c5"),s=Object(o["a"])(a["default"],i["b"],i["c"],!1,null,"b50df8da",null,!1,i["a"],void 0);e["default"]=s.exports},4957:function(t,e,n){var i=n("24fb");e=i(!1),e.push([t.i,".me-container[data-v-b50df8da]{overflow:hidden;width:100%;box-sizing:border-box;padding:%?0?% %?40?% 0 %?40?%;color:#fff;z-index:1;background-color:#f8f8f8;display:flex;flex-direction:column;justify-content:center}.content[data-v-b50df8da]{height:%?500?%;display:flex;flex-direction:column;background-color:#fff;color:#000;padding:%?20?%;flex:5}.name[data-v-b50df8da],\n.phone[data-v-b50df8da],\n.sex[data-v-b50df8da],\n.avatar[data-v-b50df8da]{flex:1;display:flex;flex-direction:row;align-items:center;justify-content:space-between}.name-item[data-v-b50df8da]{height:%?100?%;width:50%;display:flex;flex-direction:row;justify-content:center;align-items:center\n\t/* background-color: aqua; */}.avatar-box[data-v-b50df8da]{height:%?100?%;width:%?100?%;display:flex;flex-direction:row;justify-content:center;align-items:center;box-sizing:border-box\n\t/* background-color: aqua; */}.avatar-image[data-v-b50df8da]{width:100%;height:100%;object-fit:cover;border-radius:50%}.title[data-v-b50df8da]{height:%?100?%;width:%?80?%;text-align:center;line-height:%?100?%;font-size:%?34?%;color:#666\n\t/* background-color: #007aff; */}.input-text[data-v-b50df8da]{height:%?80?%;width:100%;color:#000;text-align:right;line-height:%?80?%;margin-right:%?20?%\n\t/* background-color: #007aff; */}.rigicon[data-v-b50df8da]{height:%?80?%;width:%?50?%;text-align:center;line-height:%?80?%}.submit[data-v-b50df8da]{height:%?80?%;text-align:center;line-height:%?80?%;color:#fff;font-size:%?36?%;font-weight:500;margin:%?20?% 0;background-color:#007aff;border-radius:%?20?%}.submit[disabled][data-v-b50df8da]{color:#ccc /* 提交按钮禁用时的颜色 */}",""]),t.exports=e},"4fadd":function(t,e,n){var i=n("d039"),a=n("861d"),r=n("c6b6"),o=n("d86b"),s=Object.isExtensible,u=i((function(){s(1)}));t.exports=u||o?function(t){return!!a(t)&&((!o||"ArrayBuffer"!=r(t))&&(!s||s(t)))}:s},5643:function(t,e,n){var i=n("4957");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var a=n("4f06").default;a("cb5b064c",i,!0,{sourceMap:!1,shadowMode:!1})},"5c69":function(t,e,n){"use strict";var i=n("5643"),a=n.n(i);a.a},"6d61":function(t,e,n){"use strict";var i=n("23e7"),a=n("da84"),r=n("e330"),o=n("94ca"),s=n("cb2d"),u=n("f183"),c=n("2266"),f=n("19aa"),d=n("1626"),l=n("7234"),h=n("861d"),v=n("d039"),p=n("1c7e"),b=n("d44e"),g=n("7156");t.exports=function(t,e,n){var m=-1!==t.indexOf("Map"),x=-1!==t.indexOf("Weak"),w=m?"set":"add",y=a[t],k=y&&y.prototype,O=y,C={},j=function(t){var e=r(k[t]);s(k,t,"add"==t?function(t){return e(this,0===t?0:t),this}:"delete"==t?function(t){return!(x&&!h(t))&&e(this,0===t?0:t)}:"get"==t?function(t){return x&&!h(t)?void 0:e(this,0===t?0:t)}:"has"==t?function(t){return!(x&&!h(t))&&e(this,0===t?0:t)}:function(t,n){return e(this,0===t?0:t,n),this})},z=o(t,!d(y)||!(x||k.forEach&&!v((function(){(new y).entries().next()}))));if(z)O=n.getConstructor(e,t,m,w),u.enable();else if(o(t,!0)){var _=new O,P=_[w](x?{}:-0,1)!=_,S=v((function(){_.has(1)})),D=p((function(t){new y(t)})),E=!x&&v((function(){var t=new y,e=5;while(e--)t[w](e,e);return!t.has(-0)}));D||(O=e((function(t,e){f(t,k);var n=g(new y,t,O);return l(e)||c(e,n[w],{that:n,AS_ENTRIES:m}),n})),O.prototype=k,k.constructor=O),(S||E)&&(j("delete"),j("has"),m&&j("get")),(E||P)&&j(w),x&&k.clear&&delete k.clear}return C[t]=O,i({global:!0,constructor:!0,forced:O!=y},C),b(O,t),x||n.setStrong(O,t,m),O}},a15b:function(t,e,n){"use strict";n("7a82");var i=n("dbce").default,a=n("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.useUpload=void 0;var r=a(n("c7eb")),o=a(n("1da1"));n("d3b7");var s=i(n("6c0c"));e.useUpload=function(t){var e=t.uploadPath,n=t.tempFilePaths,i=(t.FormData,t.file);return{upload:function(){return new Promise(function(){var t=(0,o.default)((0,r.default)().mark((function t(a,o){return(0,r.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:uni.showLoading({title:"上传中",mask:!0}),uni.uploadFile({url:s.default.UPLOAD_URL+e,name:"file",file:i,filePath:n,formData:{output:"json2"},header:{},success:function(t){uni.showToast({title:"上传成功"}),uni.hideLoading(),a(null===t||void 0===t?void 0:t.data)},fail:function(t){console.log(t),uni.showToast({title:"上传失败",icon:"error"}),uni.hideLoading()}});case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}}}},a2f9:function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return i}));var i={uniIcons:n("0dac").default},a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"me-container"},[n("v-uni-view",{staticClass:"content"},[n("v-uni-view",{staticClass:"avatar"},[n("v-uni-view",{staticClass:"title"},[t._v("头像")]),n("v-uni-view",{staticClass:"avatar-box",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.chooseImage.apply(void 0,arguments)}}},[n("v-uni-image",{staticClass:"avatar-image",attrs:{src:t.user.Headimgurl||"http://h5.xcbdsc.com/static/morentouxiang.jpg",mode:"aspectFill"}})],1)],1),n("v-uni-view",{staticClass:"name"},[n("v-uni-view",{staticClass:"title"},[t._v("昵称")]),n("v-uni-view",{staticClass:"name-item"},[n("v-uni-input",{staticClass:"input-text",attrs:{type:"text",placeholder:"请输入昵称"},model:{value:t.user.nickname,callback:function(e){t.$set(t.user,"nickname",e)},expression:"user.nickname"}}),n("uni-icons",{staticClass:"rigicon",attrs:{type:"right",size:"14",color:"rgb(229, 229, 229)"}})],1)],1),n("v-uni-view",{staticClass:"phone"},[n("v-uni-view",{staticClass:"title"},[t._v("电话")]),n("v-uni-view",{staticClass:"name-item"},[n("v-uni-input",{staticClass:"input-text",attrs:{type:"text",placeholder:"请输入电话"},model:{value:t.user.phone,callback:function(e){t.$set(t.user,"phone",e)},expression:"user.phone"}}),n("uni-icons",{staticClass:"rigicon",attrs:{type:"right",size:"14",color:"rgb(229, 229, 229)"}})],1)],1),n("v-uni-view",{staticClass:"sex"},[n("v-uni-view",{staticClass:"title"},[t._v("性别")]),n("v-uni-view",{staticClass:"name-item"},[n("v-uni-picker",{staticClass:"input-text",attrs:{range:t.sexOptions},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.handleSexChange.apply(void 0,arguments)}}},[t._v(t._s(t.sexOptions[t.user.sex]))]),n("uni-icons",{staticClass:"rigicon",attrs:{type:"right",size:"14",color:"rgb(229, 229, 229)"}})],1)],1),n("v-uni-button",{staticClass:"submit",attrs:{disabled:t.isSubmitting},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.submitForm.apply(void 0,arguments)}}},[t._v("提交")])],1)],1)},r=[]},acac:function(t,e,n){"use strict";var i=n("e330"),a=n("6964"),r=n("f183").getWeakData,o=n("19aa"),s=n("825a"),u=n("7234"),c=n("861d"),f=n("2266"),d=n("b727"),l=n("1a2d"),h=n("69f3"),v=h.set,p=h.getterFor,b=d.find,g=d.findIndex,m=i([].splice),x=0,w=function(t){return t.frozen||(t.frozen=new y)},y=function(){this.entries=[]},k=function(t,e){return b(t.entries,(function(t){return t[0]===e}))};y.prototype={get:function(t){var e=k(this,t);if(e)return e[1]},has:function(t){return!!k(this,t)},set:function(t,e){var n=k(this,t);n?n[1]=e:this.entries.push([t,e])},delete:function(t){var e=g(this.entries,(function(e){return e[0]===t}));return~e&&m(this.entries,e,1),!!~e}},t.exports={getConstructor:function(t,e,n,i){var d=t((function(t,a){o(t,h),v(t,{type:e,id:x++,frozen:void 0}),u(a)||f(a,t[i],{that:t,AS_ENTRIES:n})})),h=d.prototype,b=p(e),g=function(t,e,n){var i=b(t),a=r(s(e),!0);return!0===a?w(i).set(e,n):a[i.id]=n,t};return a(h,{delete:function(t){var e=b(this);if(!c(t))return!1;var n=r(t);return!0===n?w(e)["delete"](t):n&&l(n,e.id)&&delete n[e.id]},has:function(t){var e=b(this);if(!c(t))return!1;var n=r(t);return!0===n?w(e).has(t):n&&l(n,e.id)}}),a(h,n?{get:function(t){var e=b(this);if(c(t)){var n=r(t);return!0===n?w(e).get(t):n?n[e.id]:void 0}},set:function(t,e){return g(this,t,e)}}:{add:function(t){return g(this,t,!0)}}),d}}},b104:function(t,e,n){"use strict";n("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("a9e3"),n("d3b7");var i=n("6c0c"),a=n("a15b"),r={data:function(){return{user:{Headimgurl:"",nickname:"",phone:"",sex:""},sexOptions:["未知","男","女"],isSubmitting:!1}},onLoad:function(){var t=this;console.log("UPLOAD_URL:",i.UPLOAD_URL);var e=uni.getStorageSync("token");e?i.api.getUserProfile(e).then((function(e){console.log("用户数据:",e.data),t.user=e.data,t.user.nickname=e.data.name,t.user.sex=t.mapSexFromBackend(e.data.sex)})).catch((function(t){console.error("获取用户数据失败",t),uni.showToast({title:"获取用户数据失败",icon:"none"})})):uni.showToast({title:"请先登录",icon:"none"})},methods:{handleSexChange:function(t){this.user.sex=Number(t.detail.value)},mapSexFromBackend:function(t){return 2===t?2:1===t?1:0},mapSexToBackend:function(t){return 2===t?2:1===t?1:0},chooseImage:function(){var t=this;uni.chooseImage({count:1,sizeType:["compressed","original"],sourceType:["album","camera"],success:function(e){var n=e.tempFilePaths;if(n.length>0){console.log(n);var r=(0,a.useUpload)({uploadPath:"/group1/upload",tempFilePaths:n[0]}),o=r.upload;r.request;o().then((function(e){var n=JSON.parse(e);t.user.Headimgurl=i.UPLOAD_URL+n.data.path}))}}})},submitForm:function(){var t=this;this.isSubmitting=!0,i.api.editUserProfile(this.user).then((function(t){console.log("修改成功",t),uni.showToast({title:"修改成功",icon:"success"})})).catch((function(t){console.error("修改失败",t),uni.showToast({title:"修改失败",icon:"none"})})).finally((function(){t.isSubmitting=!1}))}}};e.default=r},bb2f:function(t,e,n){var i=n("d039");t.exports=!i((function(){return Object.isExtensible(Object.preventExtensions({}))}))},bb74:function(t,e,n){"use strict";n.r(e);var i=n("b104"),a=n.n(i);for(var r in i)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(r);e["default"]=a.a},d86b:function(t,e,n){var i=n("d039");t.exports=i((function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}}))},dbce:function(t,e,n){n("d3b7"),n("3ca3"),n("10d1"),n("ddb0"),n("7a82"),n("e439");var i=n("7037")["default"];function a(t){if("function"!==typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(a=function(t){return t?n:e})(t)}t.exports=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!==typeof t)return{default:t};var n=a(e);if(n&&n.has(t))return n.get(t);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var u=o?Object.getOwnPropertyDescriptor(t,s):null;u&&(u.get||u.set)?Object.defineProperty(r,s,u):r[s]=t[s]}return r["default"]=t,n&&n.set(t,r),r},t.exports.__esModule=!0,t.exports["default"]=t.exports},f183:function(t,e,n){var i=n("23e7"),a=n("e330"),r=n("d012"),o=n("861d"),s=n("1a2d"),u=n("9bf2").f,c=n("241c"),f=n("057f"),d=n("4fadd"),l=n("90e3"),h=n("bb2f"),v=!1,p=l("meta"),b=0,g=function(t){u(t,p,{value:{objectID:"O"+b++,weakData:{}}})},m=t.exports={enable:function(){m.enable=function(){},v=!0;var t=c.f,e=a([].splice),n={};n[p]=1,t(n).length&&(c.f=function(n){for(var i=t(n),a=0,r=i.length;a<r;a++)if(i[a]===p){e(i,a,1);break}return i},i({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:f.f}))},fastKey:function(t,e){if(!o(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!s(t,p)){if(!d(t))return"F";if(!e)return"E";g(t)}return t[p].objectID},getWeakData:function(t,e){if(!s(t,p)){if(!d(t))return!0;if(!e)return!1;g(t)}return t[p].weakData},onFreeze:function(t){return h&&v&&d(t)&&!s(t,p)&&g(t),t}};r[p]=!0}}]);