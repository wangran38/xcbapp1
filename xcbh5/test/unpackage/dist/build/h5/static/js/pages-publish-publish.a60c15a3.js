(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-publish-publish"],{"0e82":function(t,e,i){"use strict";i("7a82");var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(i("c7eb")),o=a(i("1da1")),s=a(i("5530")),c=a(i("3835"));i("c1f9"),i("4de4"),i("d3b7"),i("4fad"),i("d9e2"),i("d401"),i("99af");var r={data:function(){return{page:1,limit:10,totalnum:0,pageData:[],pageLoading:!1,hasMore:!0,searchParams:{}}},computed:{queryParams:function(){var t=Object.fromEntries(Object.entries(this.searchParams).filter((function(t){var e=(0,c.default)(t,2),i=(e[0],e[1]);return""!==i})));return(0,s.default)({page:this.page,limit:this.limit,isshow:1},t)}},methods:{loadPageData:function(){var t=this;return(0,o.default)((0,n.default)().mark((function e(){var i;return(0,n.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.hasMore&&!t.pageLoading){e.next=2;break}return e.abrupt("return");case 2:return t.pageLoading=!0,e.prev=3,e.next=6,t.fetchData(t.queryParams);case 6:i=e.sent,t.querySuccess(i),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](3),t.handleFetchError(e.t0);case 13:return e.prev=13,t.pageLoading=!1,e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[3,10,13,16]])})))()},fetchData:function(t){return(0,o.default)((0,n.default)().mark((function t(){return(0,n.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:throw new Error("fetchData 方法未实现");case 1:case"end":return t.stop()}}),t)})))()},querySuccess:function(t){null!==t&&void 0!==t&&t.listdata&&(this.pageData=1===this.page?t.listdata:this.pageData.concat(t.listdata),this.totalnum=t.totalnum||0,this.hasMore=this.pageData.length<this.totalnum)},handleScrollToLower:function(){!this.pageLoading&&this.hasMore&&(this.page+=1,this.loadPageData())},handleFetchError:function(t){console.error("Error loading data:",t)},resetPagination:function(){this.page=1,this.pageData=[],this.totalnum=0,this.hasMore=!0},reloadData:function(){this.resetPagination(),this.loadPageData()}}};e.default=r},2661:function(t,e,i){"use strict";i("7a82");var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("d81d"),i("c740"),i("acd8");var n=a(i("5530")),o=a(i("2909")),s=a(i("c7eb")),c=a(i("1da1")),r=i("6c0c"),d=a(i("0e82")),u=i("a15b"),l={data:function(){return{pageData:[],showEditPopup:!1,currentItem:{},categories:[],pickerRange:[],selectedCategoryIndex:0,imageUploaded:!1,showEditPopup1:!1,pickerRange1:[],selectedCategoryIndex1:0,itemDescription:"",itemPrice:"",marketList:[],candidates:["斤","两","瓶","桶","个"],candidate2:["元"],unit:"",unit2:"",tijiaoPrice:"",isloaded:!1,iconStatus:!0,isShowItems:!1}},mixins:[d.default],onLoad:function(){this.isloaded=!0},onShow:function(){this.reloadData()},methods:{removeItem:function(t){var e=this;return(0,c.default)((0,s.default)().mark((function i(){var a,n;return(0,s.default)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return a={id:t.id,isshow:2},console.log(t,a),i.next=4,r.api.editgoods(a);case 4:n=i.sent,200==n.code?(uni.showToast({title:"删除成功",icon:"success"}),e.reloadData()):uni.showToast({title:"删除失败",icon:"error"});case 6:case"end":return i.stop()}}),i)})))()},clicKexampleBody:function(){this.iconStatus=!this.iconStatus,this.isShowItems=!this.isShowItems},selectItem:function(t){this.unit=t,this.iconStatus=!this.iconStatus,this.isShowItems=!this.isShowItems},fetchCategories:function(){var t=this;r.api.cglist().then((function(e){if(200===e.code){var i=e.data.listdata.map((function(t){return{id:t.id,content:t.content}}));t.categories=i,t.pickerRange=(0,o.default)(i.map((function(t){return t.content})))}}))},fetchMarketList:function(){var t=this;return(0,c.default)((0,s.default)().mark((function e(){var i,a,c;return(0,s.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,uni.getStorageSync("token"),i={limit:100,page:1},e.next=5,r.api.getMyShops((0,n.default)({token:t.token},i));case 5:a=e.sent,200===a.code?(c=a.data.listdata.map((function(t){return{id:t.id,title:t.title}})),t.marketList=c,t.pickerRange1=(0,o.default)(c.map((function(t){return t.title})))):console.error("Failed to fetch market list:",a.msg),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](0),console.error("Error fetching market list:",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))()},onCategoryChange:function(t){this.selectedCategoryIndex=t.detail.value,this.currentItem.category_id=this.categories[this.selectedCategoryIndex].id},onMarketChange:function(t){this.selectedCategoryIndex1=t.detail.value,this.currentItem.market_id=this.marketList[this.selectedCategoryIndex1].id},fetchData:function(t){return(0,c.default)((0,s.default)().mark((function e(){var i;return(0,s.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r.api.getCommdityList(t);case 2:return i=e.sent,e.abrupt("return",i.data);case 4:case"end":return e.stop()}}),e)})))()},goTorelePage:function(){uni.navigateTo({url:"/pages/release/release"})},edit:function(t){this.currentItem=(0,n.default)({},t),this.fetchCategories(),this.showEditPopup=!0,this.fetchCommodityDetails(t.id)},fetchCommodityDetails:function(t){var e=this;r.api.getCommodityDetails(t).then((function(t){if(200===t.code){var i=t.data.listdata[0];e.currentItem.goodsname=i.goodsname,e.currentItem.imglogo=i.imglogo;var a=e.categories.findIndex((function(t){return t.id===i.category_id}));-1!==a&&(e.selectedCategoryIndex=a)}}))},uploadcuisine:function(){var t=this;uni.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(e){var i=e.tempFilePaths;if(i.length>0){console.log(66676,e.tempFiles[0]);var a=(0,u.useUpload)({uploadPath:"/group1/upload",tempFilePaths:i[0],file:e.tempFiles[0]}),n=a.upload;a.request;n().then((function(e){e=JSON.parse(e),t.currentItem.imglogo=e.data.url}))}}})},shelves:function(t){this.currentItem=(0,n.default)({},t),console.log(this.currentItem),this.showEditPopup1=!0,this.fetchMarketList()},closePopup:function(){this.showEditPopup=!1,this.showEditPopup1=!1,this.itemPrice=""},confirmEdit:function(){var t=this;if(this.currentItem.id)if(this.imageUploaded||this.currentItem.imglogo){var e=this.currentItem,i=e.id,a=e.category_id,n=e.goodsname,o=e.imglogo;r.api.editGoods({id:i,category_id:a,goodsname:n,imglogo:o}).then((function(e){200===e.code?(uni.showToast({title:"商品修改成功",icon:"success"}),t.reloadData(),t.closePopup()):uni.showToast({title:e.msg||"商品修改失败",icon:"none"})}))}else uni.showToast({title:"请上传图片",icon:"none"});else uni.showToast({title:"商品 ID 不正确",icon:"none"})},confirmShelves:function(){var t=this;console.log("Goods ID:",this.currentItem.id),this.itemPrice?this.unit?r.api.addCommodityToShop({goods_id:this.currentItem.id,shop_id:this.marketList[this.selectedCategoryIndex1].id,content:this.itemDescription,price:parseFloat(this.itemPrice),weight_name:this.unit}).then((function(e){200===e.code?(uni.showToast({title:"上架成功"}),t.closePopup(),t.reloadData()):uni.showToast({title:"上架失败",icon:"none"})})):uni.showToast({title:"请选择单位",icon:"none"}):uni.showToast({title:"请填写价格",icon:"none"})}}};e.default=l},"27ea":function(t,e,i){var a=i("45f8");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=i("4f06").default;n("09079a27",a,!0,{sourceMap:!1,shadowMode:!1})},2909:function(t,e,i){"use strict";i("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return(0,a.default)(t)||(0,n.default)(t)||(0,o.default)(t)||(0,s.default)()};var a=c(i("6005")),n=c(i("db90")),o=c(i("06c5")),s=c(i("3427"));function c(t){return t&&t.__esModule?t:{default:t}}},"29e6":function(t,e,i){"use strict";i.r(e);var a=i("2661"),n=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);e["default"]=n.a},3427:function(t,e,i){"use strict";i("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},i("d9e2"),i("d401")},"367b":function(t,e,i){"use strict";var a=i("27ea"),n=i.n(a);n.a},"45f8":function(t,e,i){var a=i("24fb");e=a(!1),e.push([t.i,".items[data-v-56e4acd2]{border-radius:%?5?%;z-index:10000;position:absolute;top:%?232?%;left:%?468?%;width:15%;padding:%?10?%;background-color:#fff;border:1px solid grey}.item[data-v-56e4acd2]{width:100%;border-bottom:1px dashed grey}.me-container[data-v-56e4acd2]{\n\t/* overflow: hidden; */width:100%;box-sizing:border-box;padding:%?0?% %?40?% 0 %?40?%;color:#fff;z-index:1;background-color:#f8f8f8;display:flex;flex-direction:column;justify-content:flex-start;position:relative;height:calc(100vh %?-10?%)}.butt[data-v-56e4acd2]{position:fixed;bottom:%?20?%;right:%?20?%;padding:%?30?% %?30?%;background-color:#007bff;color:#fff;border:none;border-radius:5px;cursor:pointer;box-shadow:0 4px 6px rgba(0,0,0,.1);z-index:1000}.disheslist[data-v-56e4acd2]{width:100%;height:%?1200?%;display:flex;flex-direction:column;margin-top:%?20?%}.type[data-v-56e4acd2]{padding:%?10?%;height:12%;\n\t/* width: 90%; */display:flex;flex-direction:row;background-color:#fff;justify-content:flex-start;align-items:center;margin-bottom:%?30?%;box-shadow:%?5?% %?5?% %?5?% rgba(0,0,0,.3);border-radius:%?5?%}.type-image[data-v-56e4acd2]{height:%?130?%;width:%?130?%;border-radius:%?20?%;background-color:#007aff}.regard[data-v-56e4acd2]{width:30%;height:%?180?%;color:#000;font-size:%?30?%;position:relative;top:%?60?%;left:%?20?%}\n\n/* .price {\n\talign-self: self-start;\n} */.function[data-v-56e4acd2]{display:flex;height:100%;width:%?250?%;margin-left:auto;justify-content:space-around;align-items:center}.rigicon[data-v-56e4acd2]{font-weight:700;font-size:%?25?%;height:%?70?%;width:%?150?%;background-color:#007aff;display:flex;justify-content:center;align-items:center;border-radius:%?20?%;margin-left:%?5?%}.loading[data-v-56e4acd2]{text-align:center;padding:%?20?%;color:#999}.popup-overlay[data-v-56e4acd2]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.5);display:flex;justify-content:center;align-items:center;z-index:1000;color:#000}.popup[data-v-56e4acd2]{position:relative;width:80%;max-width:%?600?%;background-color:#fff;border-radius:%?20?%;padding:%?20?%;box-shadow:0 0 15px rgba(0,0,0,.2)}.popup-header[data-v-56e4acd2]{font-size:%?36?%;font-weight:700;margin-bottom:%?20?%;text-align:center}.popup-content[data-v-56e4acd2]{\n\t/* 这里你可以添加弹出层内容的样式 */display:flex;width:100%;padding:%?30?%;box-sizing:border-box;justify-content:center;align-items:center}.popup-footer[data-v-56e4acd2]{display:flex;justify-content:space-between;margin-top:%?10?%}.close-button[data-v-56e4acd2]{padding:%?10?%;position:absolute;top:%?10?%;right:%?10?%;font-size:%?50?%;color:#000;cursor:pointer;z-index:10;width:%?50?%;height:%?50?%;text-align:center;line-height:%?45?%;background-color:#fff;border-radius:50%;box-shadow:0 0 %?10?% rgba(0,0,0,.1)}.content[data-v-56e4acd2]{width:100%;height:%?300?%}.cuisine[data-v-56e4acd2]{width:100%;height:%?100?%;display:flex;justify-content:space-between;align-items:center}.class[data-v-56e4acd2]{width:100%;height:%?100?%;display:flex;justify-content:space-between;align-items:center}.editimg[data-v-56e4acd2]{width:100%;height:%?100?%;display:flex;justify-content:space-between;align-items:center}.cimg[data-v-56e4acd2]{width:%?100?%;height:%?100?%}.picker[data-v-56e4acd2]{width:%?100?%;height:%?100?%;display:flex;justify-content:end;align-items:center;font-size:%?35?%}.shuru[data-v-56e4acd2]{width:auto;height:%?100?%;display:flex;justify-content:end;align-items:center}.example-body[data-v-56e4acd2]{border-radius:%?10?%;padding:%?10?%;margin:%?10?% 0 0 %?20?%;border:1px solid grey;background-color:#fff;display:flex;justify-content:space-between;min-width:%?100?%}.unit[data-v-56e4acd2]{font-size:%?28?%}.shurucon[data-v-56e4acd2]{text-align:end;font-size:%?30?%}.title[data-v-56e4acd2]{width:40%;font-size:%?30?%}.picker1[data-v-56e4acd2]{width:%?300?%;height:%?100?%;display:flex;justify-content:end;align-items:center;font-size:%?30?%}",""]),t.exports=e},"4fad":function(t,e,i){var a=i("23e7"),n=i("6f53").entries;a({target:"Object",stat:!0},{entries:function(t){return n(t)}})},6005:function(t,e,i){"use strict";i("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){if(Array.isArray(t))return(0,a.default)(t)};var a=function(t){return t&&t.__esModule?t:{default:t}}(i("6b75"))},a8f5:function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){return a}));var a={uniIcons:i("0dac").default},n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"me-container"},[i("v-uni-scroll-view",{staticClass:"Stallholder",style:{height:"100vh"},attrs:{"scroll-y":"true","lower-threshold":"10"},on:{scrolltolower:function(e){arguments[0]=e=t.$handleEvent(e),t.handleScrollToLower.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"disheslist"},[t._l(t.pageData,(function(e){return i("v-uni-view",{key:e.id,staticClass:"type"},[t.isloaded?i("v-uni-image",{staticClass:"type-image",attrs:{"lazy-load":!0,src:e.imglogo,mode:"scaleToFill"}}):t._e(),i("v-uni-view",{staticClass:"regard"},[i("v-uni-view",{staticClass:"typetitle"},[t._v(t._s(e.goodsname))])],1),i("v-uni-view",{staticClass:"function"},[i("v-uni-view",{staticClass:"rigicon",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.edit(e)}}},[t._v("修改")]),i("v-uni-view",{staticClass:"rigicon",staticStyle:{"background-color":"#67c23a"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.shelves(e)}}},[t._v("上架")]),i("v-uni-view",{staticClass:"rigicon",staticStyle:{"background-color":"#f56c6c"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.removeItem(e)}}},[t._v("删除")])],1)],1)})),t.pageLoading?i("v-uni-view",{staticClass:"loading"},[t._v("加载中...")]):t._e(),t.hasMore?t._e():i("v-uni-view",{staticClass:"loading"},[t._v("没有更多了")])],2)],1),i("v-uni-view",{staticClass:"butt",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.goTorelePage.apply(void 0,arguments)}}},[t._v("点击新增菜品")]),t.showEditPopup?i("v-uni-view",{staticClass:"popup-overlay",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closePopup.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"popup",on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e)}}},[i("v-uni-view",{staticClass:"close-button",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closePopup.apply(void 0,arguments)}}},[t._v("×")]),i("v-uni-view",{staticClass:"popup-content"},[i("v-uni-view",{staticClass:"content"},[i("v-uni-view",{staticClass:"cuisine"},[i("v-uni-view",{staticClass:"title"},[t._v("菜名")]),i("v-uni-view",{staticClass:"shuru"},[i("v-uni-input",{staticClass:"shurucon",attrs:{type:"text"},model:{value:t.currentItem.goodsname,callback:function(e){t.$set(t.currentItem,"goodsname",e)},expression:"currentItem.goodsname"}})],1)],1),i("v-uni-view",{staticClass:"class"},[i("v-uni-view",{staticClass:"title"},[t._v("分类")]),i("v-uni-picker",{staticClass:"picker",attrs:{range:t.pickerRange,value:t.selectedCategoryIndex},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.onCategoryChange.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"picker-text"},[t._v(t._s(t.pickerRange[t.selectedCategoryIndex]))])],1)],1),i("v-uni-view",{staticClass:"editimg"},[i("v-uni-view",{staticClass:"title"},[t._v("图片")]),i("v-uni-image",{staticClass:"cimg",attrs:{src:t.currentItem.imglogo,mode:"aspectFit"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.uploadcuisine.apply(void 0,arguments)}}})],1)],1)],1),i("v-uni-view",{staticClass:"popup-footer"},[i("v-uni-button",{on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closePopup.apply(void 0,arguments)}}},[t._v("取消")]),i("v-uni-button",{staticStyle:{"background-color":"#007aff",color:"white"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.confirmEdit.apply(void 0,arguments)}}},[t._v("确认")])],1)],1)],1):t._e(),t.showEditPopup1?i("v-uni-view",{staticClass:"popup-overlay",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closePopup.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"popup",on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e)}}},[i("v-uni-view",{staticClass:"close-button",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closePopup.apply(void 0,arguments)}}},[t._v("×")]),i("v-uni-view",{staticClass:"popup-header"},[t._v(t._s(t.currentItem.goodsname))]),i("v-uni-view",{staticClass:"popup-content"},[i("v-uni-view",{staticClass:"content"},[i("v-uni-view",{staticClass:"cuisine"},[i("v-uni-view",{staticClass:"title"},[t._v("选择摊位")]),i("v-uni-picker",{staticClass:"picker1",attrs:{range:t.pickerRange1,value:t.selectedCategoryIndex1},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.onMarketChange.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"picker-text"},[t._v(t._s(t.pickerRange1[t.selectedCategoryIndex1]))])],1)],1),i("v-uni-view",{staticClass:"editimg"},[i("v-uni-view",{staticClass:"title"},[t._v("菜品价格")]),i("v-uni-view",{staticClass:"shuru"},[i("v-uni-input",{staticClass:"shurucon",attrs:{type:"text",placeholder:"请输入价格"},model:{value:t.itemPrice,callback:function(e){t.itemPrice=e},expression:"itemPrice"}})],1),i("v-uni-view",{staticClass:"unit"},[t._v("元/")]),i("v-uni-view",{staticClass:"example-body",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.clicKexampleBody.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"unit"},[t._v(t._s(t.unit?t.unit:"单位"))]),i("v-uni-view",{staticClass:"icon"},[i("uni-icons",{attrs:{type:t.iconStatus?"up":"down",size:"20"}})],1)],1),i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:t.isShowItems,expression:"isShowItems"}],staticClass:"items"},t._l(t.candidates,(function(e){return i("v-uni-view",{staticClass:"item",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.selectItem(e)}}},[t._v(t._s(e))])})),1)],1)],1)],1),i("v-uni-view",{staticClass:"popup-footer"},[i("v-uni-button",{on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closePopup.apply(void 0,arguments)}}},[t._v("取消")]),i("v-uni-button",{staticStyle:{"background-color":"#007aff",color:"white"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.confirmShelves.apply(void 0,arguments)}}},[t._v("确认")])],1)],1)],1):t._e()],1)},o=[]},bb9c:function(t,e,i){"use strict";i.r(e);var a=i("a8f5"),n=i("29e6");for(var o in n)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(o);i("367b");var s=i("f0c5"),c=Object(s["a"])(n["default"],a["b"],a["c"],!1,null,"56e4acd2",null,!1,a["a"],void 0);e["default"]=c.exports},c1f9:function(t,e,i){var a=i("23e7"),n=i("2266"),o=i("8418");a({target:"Object",stat:!0},{fromEntries:function(t){var e={};return n(t,(function(t,i){o(e,t,i)}),{AS_ENTRIES:!0}),e}})},db90:function(t,e,i){"use strict";i("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)},i("a4d3"),i("e01a"),i("d3b7"),i("d28b"),i("3ca3"),i("ddb0"),i("a630")}}]);