(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/editshop/editshop"],{"09e3":function(e,t,n){"use strict";n.r(t);var a=n("a098"),r=n.n(a);for(var o in a)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(o);t["default"]=r.a},"14c9":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){}));var a=function(){var e=this.$createElement;this._self._c},r=[]},"157f":function(e,t,n){"use strict";var a=n("a8b9"),r=n.n(a);r.a},"45e7":function(e,t,n){"use strict";(function(e,t){var a=n("4ea4");n("88ba");a(n("66fd"));var r=a(n("ffee"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(r.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},a098:function(e,t,n){"use strict";(function(e){var a=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n("2eee")),o=a(n("448a")),i=a(n("9523")),c=a(n("c973")),s=n("6c0c"),u=n("a15b");function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){(0,i.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d={data:function(){return{marketList:[],pickerRange1:[],selectedCategoryIndex1:0,isImageSelected:!1,isImageSelected2:!1,facelogo:"",isSubmitting:!1,businesslogo:""}},mounted:function(){this.fetchMarketList()},methods:{customizeBack:function(){return(0,c.default)(r.default.mark((function t(){var n;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,getCurrentPages();case 2:n=t.sent,console.log(n),n&&n.length>1?e.navigateBack():history.back();case 5:case"end":return t.stop()}}),t)})))()},onMarketChange:function(e){this.selectedCategoryIndex1=e.detail.value},fetchMarketList:function(){var e=this;return(0,c.default)(r.default.mark((function t(){var n,a,i;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,n={limit:100,page:1},t.next=4,s.api.getMyShops(f({},n));case 4:a=t.sent,200===a.code?(i=a.data.listdata.map((function(e){return{id:e.id,title:e.title}})),e.marketList=i,e.pickerRange1=(0,o.default)(i.map((function(e){return e.title})))):console.error("Failed to fetch market list:",a.msg),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),console.error("Error fetching market list:",t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},bindCategoryChange:function(e){var t=e.detail.value;this.selectedCategory=this.categoryList[t],this.category_id=this.categoryIdMap[this.selectedCategory]},chooseImage:function(){var t=this;e.chooseImage({count:1,sizeType:["compressed","original"],sourceType:["album","camera"],success:function(e){var n=e.tempFilePaths;if(n.length>0){console.log(n);var a=(0,u.useUpload)({uploadPath:"/group1/upload",tempFilePaths:n[0]}),r=a.upload;a.request;r().then((function(e){var n=JSON.parse(e);t.facelogo=s.UPLOAD_URL+n.data.path,t.isImageSelected=!0}))}}})},chooseImage2:function(){var t=this;e.chooseImage({count:1,sizeType:["compressed","original"],sourceType:["album","camera"],success:function(e){var n=e.tempFilePaths;if(n.length>0){console.log(n);var a=(0,u.useUpload)({uploadPath:"/group1/upload",tempFilePaths:n[0]}),r=a.upload;a.request;r().then((function(e){var n=JSON.parse(e);t.businesslogo=s.UPLOAD_URL+n.data.path,t.isImageSelected2=!0}))}}})},submitForm:function(){var t=this;return(0,c.default)(r.default.mark((function n(){var a,o;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!t.isSubmitting){n.next=2;break}return n.abrupt("return");case 2:if(t.facelogo&&t.businesslogo&&t.marketList[t.selectedCategoryIndex1]){n.next=5;break}return e.showToast({title:"请填写完整的信息",icon:"none"}),n.abrupt("return");case 5:return t.isSubmitting=!0,n.prev=6,a={facelogo:t.facelogo,id:t.marketList[t.selectedCategoryIndex1].id,businesslogo:t.businesslogo},n.next=10,s.api.editshop(a);case 10:o=n.sent,200===o.code?(e.showToast({title:"补充成功",icon:"success",duration:2e3}),setTimeout((function(){t.customizeBack()}),2e3)):e.showToast({title:o.msg||"提交失败",icon:"none"}),n.next=18;break;case 14:n.prev=14,n.t0=n["catch"](6),console.error("提交失败:",n.t0),e.showToast({title:"提交失败",icon:"none"});case 18:return n.prev=18,t.isSubmitting=!1,n.finish(18);case 21:case"end":return n.stop()}}),n,null,[[6,14,18,21]])})))()}}};t.default=d}).call(this,n("543d")["default"])},a8b9:function(e,t,n){},ffee:function(e,t,n){"use strict";n.r(t);var a=n("14c9"),r=n("09e3");for(var o in r)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(o);n("157f");var i=n("f0c5"),c=Object(i["a"])(r["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],void 0);t["default"]=c.exports}},[["45e7","common/runtime","common/vendor"]]]);