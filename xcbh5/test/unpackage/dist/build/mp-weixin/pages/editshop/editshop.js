(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/editshop/editshop"],{"09e3":function(e,t,a){"use strict";a.r(t);var n=a("a098"),r=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t["default"]=r.a},"157f":function(e,t,a){"use strict";var n=a("a8b9"),r=a.n(n);r.a},"45e7":function(e,t,a){"use strict";(function(e,t){var n=a("4ea4");a("88ba");n(a("66fd"));var r=n(a("ffee"));e.__webpack_require_UNI_MP_PLUGIN__=a,t(r.default)}).call(this,a("bc2e")["default"],a("543d")["createPage"])},a098:function(e,t,a){"use strict";(function(e){var n=a("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a("2eee")),o=n(a("448a")),i=n(a("9523")),s=n(a("c973")),c=a("6c0c"),u=a("a15b");function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function f(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){(0,i.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var d={data:function(){return{marketList:[],pickerRange1:[],selectedCategoryIndex1:0,isImageSelected:!1,isImageSelected2:!1,facelogo:"",isSubmitting:!1,businesslogo:""}},mounted:function(){this.fetchMarketList()},methods:{customizeBack:function(){return(0,s.default)(r.default.mark((function t(){var a;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,getCurrentPages();case 2:a=t.sent,console.log(a),a&&a.length>1?e.navigateBack():history.back();case 5:case"end":return t.stop()}}),t)})))()},onMarketChange:function(e){this.selectedCategoryIndex1=e.detail.value},fetchMarketList:function(){var e=this;return(0,s.default)(r.default.mark((function t(){var a,n,i;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,a={limit:100,page:1},t.next=4,c.api.getMyShops(f({},a));case 4:n=t.sent,200===n.code?(i=n.data.listdata.map((function(e){return{id:e.id,title:e.title}})),e.marketList=i,e.pickerRange1=(0,o.default)(i.map((function(e){return e.title})))):console.error("Failed to fetch market list:",n.msg),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),console.error("Error fetching market list:",t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},bindCategoryChange:function(e){var t=e.detail.value;this.selectedCategory=this.categoryList[t],this.category_id=this.categoryIdMap[this.selectedCategory]},chooseImage:function(){var t=this;e.chooseImage({count:1,sizeType:["compressed","original"],sourceType:["album","camera"],success:function(e){var a=e.tempFilePaths;if(a.length>0){var n=(0,u.useUpload)({uploadPath:"/group1/upload",tempFilePaths:a[0],file:e.tempFiles[0]}),r=n.upload;n.request;r().then((function(e){var a=JSON.parse(e);t.facelogo=c.UPLOAD_URL+a.data.path,t.isImageSelected=!0}))}}})},chooseImage2:function(){var t=this;e.chooseImage({count:1,sizeType:["compressed","original"],sourceType:["album","camera"],success:function(e){var a=e.tempFilePaths;if(a.length>0){var n=(0,u.useUpload)({uploadPath:"/group1/upload",tempFilePaths:a[0],file:e.tempFiles[0]}),r=n.upload;n.request;r().then((function(e){var a=JSON.parse(e);t.businesslogo=c.UPLOAD_URL+a.data.path,t.isImageSelected2=!0}))}}})},submitForm:function(){var t=this;return(0,s.default)(r.default.mark((function a(){var n,o;return r.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!t.isSubmitting){a.next=2;break}return a.abrupt("return");case 2:if(t.facelogo&&t.businesslogo&&t.marketList[t.selectedCategoryIndex1]){a.next=5;break}return e.showToast({title:"请填写完整的信息",icon:"none"}),a.abrupt("return");case 5:return t.isSubmitting=!0,a.prev=6,n={facelogo:t.facelogo,id:t.marketList[t.selectedCategoryIndex1].id,businesslogo:t.businesslogo},a.next=10,c.api.editshop(n);case 10:o=a.sent,200===o.code?(e.showToast({title:"补充成功",icon:"success",duration:2e3}),setTimeout((function(){t.customizeBack()}),2e3)):e.showToast({title:o.msg||"提交失败",icon:"none"}),a.next=18;break;case 14:a.prev=14,a.t0=a["catch"](6),console.error("提交失败:",a.t0),e.showToast({title:"提交失败",icon:"none"});case 18:return a.prev=18,t.isSubmitting=!1,a.finish(18);case 21:case"end":return a.stop()}}),a,null,[[6,14,18,21]])})))()}}};t.default=d}).call(this,a("543d")["default"])},a8b9:function(e,t,a){},fae0:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){}));var n=function(){var e=this.$createElement;this._self._c},r=[]},ffee:function(e,t,a){"use strict";a.r(t);var n=a("fae0"),r=a("09e3");for(var o in r)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return r[e]}))}(o);a("157f");var i=a("f0c5"),s=Object(i["a"])(r["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],void 0);t["default"]=s.exports}},[["45e7","common/runtime","common/vendor"]]]);