(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/billRecord/billRecord"],{"1fe2":function(t,e,n){"use strict";(function(t){var i=n("47a9");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=i(n("7eb4")),a=i(n("af34")),o=i(n("ee10")),u={data:function(){return{statusBarHeight:20,typeOptions:["全部","收入","支出"],typeIndex:0,currentDate:this.formatDate(new Date),bills:[],pageSize:10,currentPage:1,loading:!1,hasMore:!0,themeColor:{primary:"#409EFF",danger:"#F56C6C"}}},computed:{rightTextStyle:function(){return{income:{color:this.themeColor.primary},expense:{color:this.themeColor.danger}}},filteredBills:function(){var t=this,e=this.bills.filter((function(e){var n=0===t.typeIndex||1===t.typeIndex&&"income"===e.type||2===t.typeIndex&&"expense"===e.type,i=new Date(e.date).getMonth()===new Date(t.currentDate).getMonth();return n&&i}));return e.slice(0,this.currentPage*this.pageSize)},totalIncome:function(){return this.bills.filter((function(t){return"income"===t.type})).reduce((function(t,e){return t+Number(e.amount)}),0).toFixed(2)},totalExpense:function(){return this.bills.filter((function(t){return"expense"===t.type})).reduce((function(t,e){return t+Number(e.amount)}),0).toFixed(2)},navBarStyle:function(){return{paddingTop:"".concat(this.statusBarHeight,"px"),height:"44px",background:this.themeColor.primary}}},methods:{formatDate:function(t){var e=new Date(t);return"".concat(e.getFullYear(),"-").concat((e.getMonth()+1).toString().padStart(2,"0"))},typeChange:function(t){this.typeIndex=t.detail.value,this.resetPagination()},dateChange:function(t){this.currentDate=t.detail.value,this.resetPagination()},resetPagination:function(){this.currentPage=1,this.hasMore=!0,this.bills=[],this.loadMore()},handleItemClick:function(e){t.navigateTo({url:"/pages/bill/detail?id=".concat(e.id)})},getSystemInfo:function(){var e=t.getSystemInfoSync();this.statusBarHeight=e.statusBarHeight||20},loadMore:function(){var t=this;return(0,o.default)(r.default.mark((function e(){var n;return r.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.loading&&t.hasMore){e.next=2;break}return e.abrupt("return");case 2:return t.loading=!0,e.prev=3,e.next=6,t.mockFetchData();case 6:n=e.sent,t.bills=[].concat((0,a.default)(t.bills),(0,a.default)(n)),t.hasMore=n.length>=t.pageSize,t.currentPage++,e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](3),console.error(e.t0);case 15:return e.prev=15,t.loading=!1,e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[3,12,15,18]])})))()},mockFetchData:function(){var t=this;return new Promise((function(e){setTimeout((function(){var n=Array.from({length:t.pageSize},(function(t,e){return{id:Date.now()+e,type:Math.random()>.5?"income":"expense",category:["工资","餐饮","交通","购物"][Math.floor(4*Math.random())],amount:(2e3*Math.random()+100).toFixed(2),date:new Date((new Date).setDate(Math.floor(30*Math.random()+1))).toISOString().split("T")[0],remark:Math.random()>.7?"测试备注":""}}));e(n)}),800)}))}},onLoad:function(){this.getSystemInfo(),this.loadMore()},onReachBottom:function(){this.loadMore()}};e.default=u}).call(this,n("df3c")["default"])},5335:function(t,e,n){"use strict";(function(t,e){var i=n("47a9");n("89ee");i(n("3240"));var r=i(n("af8b"));t.__webpack_require_UNI_MP_PLUGIN__=n,e(r.default)}).call(this,n("3223")["default"],n("df3c")["createPage"])},af8b:function(t,e,n){"use strict";n.r(e);var i=n("f9e9"),r=n("d944");for(var a in r)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return r[t]}))}(a);n("d898");var o=n("828b"),u=Object(o["a"])(r["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],void 0);e["default"]=u.exports},b3a3:function(t,e,n){},d898:function(t,e,n){"use strict";var i=n("b3a3"),r=n.n(i);r.a},d944:function(t,e,n){"use strict";n.r(e);var i=n("1fe2"),r=n.n(i);for(var a in i)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(a);e["default"]=r.a},f9e9:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return i}));var i={uniIcons:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uni-icons/components/uni-icons/uni-icons")]).then(n.bind(null,"a7f4"))},uniList:function(){return n.e("uni_modules/uni-list/components/uni-list/uni-list").then(n.bind(null,"95ef"))},uniListItem:function(){return n.e("uni_modules/uni-list/components/uni-list-item/uni-list-item").then(n.bind(null,"a200"))}},r=function(){var t=this,e=t.$createElement,n=(t._self._c,t.filteredBills.length),i=n?t.__map(t.filteredBills,(function(e,n){var i=t.__get_orig(e),r=t.formatDate(e.date);return{$orig:i,m0:r}})):null,r=!t.hasMore&&t.filteredBills.length,a=!t.loading&&!t.filteredBills.length;t.$mp.data=Object.assign({},{$root:{g0:n,l0:i,g1:r,g2:a}})},a=[]}},[["5335","common/runtime","common/vendor"]]]);