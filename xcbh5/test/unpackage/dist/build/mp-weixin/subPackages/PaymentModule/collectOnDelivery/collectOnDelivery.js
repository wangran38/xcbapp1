(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["subPackages/PaymentModule/collectOnDelivery/collectOnDelivery"],{6976:function(t,e,n){"use strict";n.r(e);var o=n("9202"),a=n("9321");for(var r in a)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(r);n("a412");var c=n("828b"),u=Object(c["a"])(a["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],void 0);e["default"]=u.exports},"6f23":function(t,e,n){"use strict";(function(t,e){var o=n("47a9");n("89ee");o(n("3240"));var a=o(n("6976"));t.__webpack_require_UNI_MP_PLUGIN__=n,e(a.default)}).call(this,n("3223")["default"],n("df3c")["createPage"])},9202:function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return o}));var o={uniIcons:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uni-icons/components/uni-icons/uni-icons")]).then(n.bind(null,"a7f4"))}},a=function(){var t=this.$createElement,e=(this._self._c,this.initTime(this.createtime));this.$mp.data=Object.assign({},{$root:{m0:e}})},r=[]},9321:function(t,e,n){"use strict";n.r(e);var o=n("f6b4"),a=n.n(o);for(var r in o)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(r);e["default"]=a.a},a412:function(t,e,n){"use strict";var o=n("cb94"),a=n.n(o);a.a},cb94:function(t,e,n){},f6b4:function(t,e,n){"use strict";(function(t){var o=n("47a9");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=o(n("7eb4")),r=o(n("ee10")),c=n("4860"),u={data:function(){return{isPayment:!1,out_trade_no:null,createtime:null,productList:[],totalPrice:0,otherFees:0,totalAmount:0,countDownTime:15,countDown:null,isTimeOut:!1,formattedCountDown:"",paymentMethods:[{title:"微信支付",code:1},{title:"积分支付",code:2},{title:"数字人名币",code:3}],selectedPaymentMethod:2,supportMethod:[2]}},mounted:function(){this.startCountDown()},beforeDestroy:function(){this.clearCountDown()},onLoad:function(e){var n=this;return(0,r.default)(a.default.mark((function o(){var r,u;return a.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return n.out_trade_no=e.out_trade_no,o.next=3,c.api.myorders(e);case 3:r=o.sent,200==r.code?(u=r.data.listdata[0],n.createtime=u.createtime,n.productList=u.list_arr,n.totalPrice=u.price,n.totalAmount=n.totalPrice+n.otherFees,console.log(r)):t.showToast({title:r.msg||r.message});case 5:case"end":return o.stop()}}),o)})))()},methods:{initTime:function(t){var e=new Date(t).getTime(),n=10===String(e).length?new Date(1e3*parseInt(e)):new Date(parseInt(e)),o=n.getFullYear(),a=n.getMonth()+1;a<10&&(a="0"+a);var r=n.getDate();r<10&&(r="0"+r);var c=n.getHours();c<10&&(c="0"+c);var u=n.getMinutes();u<10&&(u="0"+u);var i=n.getSeconds();i<10&&(i="0"+i);var s=o+"-"+a+"-"+r+" "+c+":"+u+":"+i;return s},goBack:function(){t.navigateBack()},selectPaymentMethod:function(t){this.selectedPaymentMethod=t.code},prepay:function(){var e=this;return(0,r.default)(a.default.mark((function n(){var o;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!e.supportMethod.includes(e.selectedPaymentMethod)){n.next=15;break}n.t0=e.selectedPaymentMethod,n.next=1===n.t0?4:2===n.t0?6:3===n.t0?11:13;break;case 4:return console.log("微信支付"),n.abrupt("break",13);case 6:return n.next=8,c.api.payscore({out_trade_no:e.out_trade_no});case 8:return o=n.sent,200==o.code?(t.showToast({title:"支付成功",icon:"success"}),e.isPayment=!0,e.clearCountDown(),setTimeout((function(){e.goBack(),e.goBack()}),2e3)):t.showToast({title:o.msg||o.message,icon:"error"}),n.abrupt("break",13);case 11:return console.log("数字人名币"),n.abrupt("break",13);case 13:n.next=16;break;case 15:t.showToast({title:"暂未开通"+e.paymentMethods[e.selectedPaymentMethod-1].title,icon:"error"});case 16:case"end":return n.stop()}}),n)})))()},startCountDown:function(){var t=this,e=60*this.countDownTime;this.countDown=setInterval((function(){if(e<=0)return t.isTimeOut=!0,t.clearCountDown(),void console.log("订单超时，已自动取消");var n=Math.floor(e/60),o=e%60;t.formattedCountDown="".concat(t.padZero(n),":").concat(t.padZero(o)),e--}),1e3)},clearCountDown:function(){this.countDown&&clearInterval(this.countDown)},padZero:function(t){return t<10?"0".concat(t):t.toString()}}};e.default=u}).call(this,n("df3c")["default"])}},[["6f23","common/runtime","common/vendor"]]]);