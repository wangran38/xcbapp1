(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["subPackages-aHouseholder-Traceability-Traceability"],{"2b25":function(n,t,i){"use strict";i.r(t);var e=i("8f3c"),s=i("33ef");for(var a in s)["default"].indexOf(a)<0&&function(n){i.d(t,n,(function(){return s[n]}))}(a);i("b5ba");var c=i("828b"),o=Object(c["a"])(s["default"],e["b"],e["c"],!1,null,"34e045c3",null,!1,e["a"],void 0);t["default"]=o.exports},"33ef":function(n,t,i){"use strict";i.r(t);var e=i("ec4c"),s=i.n(e);for(var a in e)["default"].indexOf(a)<0&&function(n){i.d(t,n,(function(){return e[n]}))}(a);t["default"]=s.a},"630a":function(n,t,i){var e=i("c86c");t=e(!1),t.push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/* 页面整体样式 */.traceability-page[data-v-34e045c3]{padding:%?30?%;background-color:#f5f7fa;min-height:100vh}\n/* 顶部状态与标题 */.header-container[data-v-34e045c3]{margin-bottom:%?30?%}.progress-bar[data-v-34e045c3]{height:%?12?%;background-color:#e5e9f2;border-radius:%?6?%;margin-bottom:%?20?%;overflow:hidden}.progress-value[data-v-34e045c3]{height:100%;background-color:#36a3ff;border-radius:%?6?%;transition:width .3s ease}.header-content[data-v-34e045c3]{background-color:#fff;border-radius:%?16?%;padding:%?30?%;box-shadow:0 %?4?% %?16?% rgba(0,0,0,.05)}.header-title[data-v-34e045c3]{font-size:%?36?%;font-weight:700;color:#333;margin-bottom:%?10?%}.header-subtitle[data-v-34e045c3]{font-size:%?26?%;color:#666}\n/* 消费视角提示 */.consumer-tip[data-v-34e045c3]{background-color:#fffbeb;border-radius:%?12?%;padding:%?20?% %?30?%;margin-bottom:%?30?%}.tip-text[data-v-34e045c3]{font-size:%?26?%;color:#8c6d31;line-height:1.5}\n/* 表单容器 */.form-container[data-v-34e045c3]{background-color:#fff;border-radius:%?16?%;padding:%?30?%;box-shadow:0 %?4?% %?16?% rgba(0,0,0,.05)}\n/* 表单分区 */.form-section[data-v-34e045c3]{margin-bottom:%?40?%}.section-header[data-v-34e045c3]{display:flex;align-items:center;justify-content:space-between;padding-bottom:%?20?%;border-bottom:%?1?% solid #eee;margin-bottom:%?30?%}.section-title[data-v-34e045c3]{font-size:%?32?%;font-weight:700;color:#333}.section-desc[data-v-34e045c3]{font-size:%?24?%;color:#999;padding:%?4?% %?12?%;background-color:#f5f7fa;border-radius:%?8?%}\n/* 表单项目 */.form-item[data-v-34e045c3]{margin-bottom:%?30?%}.item-label[data-v-34e045c3]{font-size:%?28?%;color:#333;margin-bottom:%?16?%;display:flex;align-items:center}.required-mark[data-v-34e045c3]{color:#ff4d4f;margin-left:%?4?%}.item-content[data-v-34e045c3]{position:relative}\n/* 选择器样式 */.picker-text[data-v-34e045c3]{padding:%?24?% 0;border-bottom:%?1?% solid #eee;font-size:%?28?%;color:#666;position:relative}.picker-text[data-v-34e045c3]::after{content:\"\";position:absolute;right:0;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);width:%?24?%;height:%?24?%;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Cpath fill='%23999' d='M7 10l5 5 5-5z'/%3E%3C/svg%3E\")}\n/* 位置选择器 */.location-picker[data-v-34e045c3]{padding:%?24?% 0;border-bottom:%?1?% solid #eee;font-size:%?28?%;color:#666;display:flex;align-items:center;justify-content:space-between}.location-text[data-v-34e045c3]{flex:1}\n/* 输入字段 */.input-field[data-v-34e045c3]{padding:%?24?% 0;border-bottom:%?1?% solid #eee;font-size:%?28?%;color:#666;position:relative}.input-field[data-v-34e045c3]::after{content:\"\";position:absolute;right:0;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);width:%?24?%;height:%?24?%;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Cpath fill='%23999' d='M7 10l5 5 5-5z'/%3E%3C/svg%3E\")}\n/* 上传容器 */.upload-container[data-v-34e045c3]{display:flex;flex-wrap:wrap;gap:%?20?%}.upload-box[data-v-34e045c3]{width:calc(33.33% - %?14?%);height:%?200?%;border-radius:%?12?%;position:relative;overflow:hidden;background-color:#f5f7fa;border:%?1?% dashed #ddd}.upload-image[data-v-34e045c3]{width:100%;height:100%;object-fit:cover}.delete-btn[data-v-34e045c3]{position:absolute;top:%?8?%;right:%?8?%;width:%?32?%;height:%?32?%;border-radius:50%;background-color:rgba(0,0,0,.6);display:flex;align-items:center;justify-content:center}.add-box[data-v-34e045c3]{display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer}.upload-text[data-v-34e045c3]{margin-top:%?10?%;font-size:%?24?%;color:#999}\n/* 提交按钮 */.submit-container[data-v-34e045c3]{margin:%?40?% 0}.submit-button[data-v-34e045c3]{width:100%;height:%?90?%;background-color:#36a3ff;color:#fff;border-radius:%?12?%;font-size:%?32?%;font-weight:500;display:flex;align-items:center;justify-content:center;border:none;box-shadow:0 %?8?% %?24?% rgba(54,163,255,.3);transition:all .3s ease}.submit-button[data-v-34e045c3]:active{background-color:#1890ff;box-shadow:0 %?4?% %?12?% rgba(54,163,255,.3)}.submit-button[data-v-34e045c3]:disabled{background-color:#e6f7ff;color:#36a3ff;box-shadow:none;cursor:not-allowed}\n/* 底部提示 */.footer-tip[data-v-34e045c3]{font-size:%?24?%;color:#999;text-align:center;margin-bottom:%?40?%}\n/* 弹出层样式 */.popup-content[data-v-34e045c3]{padding:%?40?% %?30?%;background-color:#fff;width:100%;box-sizing:border-box}.popup-input[data-v-34e045c3]{width:100%;height:%?88?%;border:none;border-bottom:%?1?% solid #eee;font-size:%?32?%;color:#333;outline:none}",""]),n.exports=t},"8f3c":function(n,t,i){"use strict";i.d(t,"b",(function(){return s})),i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){return e}));var e={uniDatetimePicker:i("173b").default,uniPopup:i("8858").default},s=function(){var n=this,t=n.$createElement,i=n._self._c||t;return i("v-uni-view",{staticClass:"traceability-page"},[i("v-uni-view",{staticClass:"header-container"},[i("v-uni-view",{staticClass:"progress-bar"},[i("v-uni-view",{staticClass:"progress-value",style:{width:n.formCompletionRate+"%"}})],1),i("v-uni-view",{staticClass:"header-content"},[i("v-uni-text",{staticClass:"header-title"},[n._v("菜品溯源信息")]),i("v-uni-text",{staticClass:"header-subtitle"},[n._v("填写越完整，消费者越放心")])],1)],1),i("v-uni-view",{staticClass:"consumer-tip"},[i("v-uni-text",{staticClass:"tip-text"},[n._v("消费者最关心：产地环境、种植/养殖方式、农药/饲料使用、检测报告")])],1),i("v-uni-view",{staticClass:"form-container"},[i("v-uni-view",{staticClass:"form-section"},[i("v-uni-view",{staticClass:"section-header"},[i("v-uni-text",{staticClass:"section-title"},[n._v("基本信息")]),i("v-uni-text",{staticClass:"section-desc"},[n._v("消费者必看")])],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("产品名称"),i("v-uni-text",{staticClass:"required-mark"},[n._v("*")])],1),i("v-uni-view",{staticClass:"item-content"})],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("产品分类"),i("v-uni-text",{staticClass:"required-mark"},[n._v("*")])],1),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-picker",{attrs:{range:n.CLASSIFICATION,value:n.classificationIndex},on:{change:function(t){arguments[0]=t=n.$handleEvent(t),n.changeClassification.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"picker-text"},[n._v(n._s(n.CLASSIFICATION[n.classificationIndex]||"请选择分类"))])],1)],1)],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("产地"),i("v-uni-text",{staticClass:"required-mark"},[n._v("*")])],1),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-view",{staticClass:"location-picker",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.openLocationPicker.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"location-text"},[n._v(n._s(n.TraceabilityInfo.Students||"点击选择产地"))]),n.TraceabilityInfo.Students?i("v-uni-icon",{attrs:{type:"location",size:"16",color:"#36a3ff"}}):n._e()],1)],1)],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("生产日期"),i("v-uni-text",{staticClass:"required-mark"},[n._v("*")])],1),i("v-uni-view",{staticClass:"item-content"},[i("uni-datetime-picker",{staticClass:"date-picker",attrs:{type:"date","clear-icon":!1,"return-type":"timestamp",placeholder:"选择生产日期"},model:{value:n.TraceabilityInfo.productionDate,callback:function(t){n.$set(n.TraceabilityInfo,"productionDate",t)},expression:"TraceabilityInfo.productionDate"}})],1)],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("批次号")]),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-view",{staticClass:"input-field",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.openPopup("batchNumber")}}},[i("v-uni-text",{staticClass:"input-text"},[n._v(n._s(n.TraceabilityInfo.batchNumber||"点击输入批次号"))])],1)],1)],1)],1),0===n.classificationIndex?i("v-uni-view",{staticClass:"form-section"},[i("v-uni-view",{staticClass:"section-header"},[i("v-uni-text",{staticClass:"section-title"},[n._v("种植信息")]),i("v-uni-text",{staticClass:"section-desc"},[n._v("消费者最关心农药使用")])],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("农药名称"),i("v-uni-text",{staticClass:"required-mark"},[n._v("*")])],1),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-view",{staticClass:"input-field",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.openPopup("pesticideName")}}},[i("v-uni-text",{staticClass:"input-text"},[n._v(n._s(n.TraceabilityInfo.pesticideName||"点击输入农药名称"))])],1)],1)],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("农药使用次数")]),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-view",{staticClass:"input-field",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.openPopup("pesticideTimes")}}},[i("v-uni-text",{staticClass:"input-text"},[n._v(n._s(n.TraceabilityInfo.pesticideTimes||"点击输入使用次数"))])],1)],1)],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("最后施药日期")]),i("v-uni-view",{staticClass:"item-content"},[i("uni-datetime-picker",{staticClass:"date-picker",attrs:{type:"date","clear-icon":!1,"return-type":"timestamp",placeholder:"选择日期"},model:{value:n.TraceabilityInfo.lastPesticideDate,callback:function(t){n.$set(n.TraceabilityInfo,"lastPesticideDate",t)},expression:"TraceabilityInfo.lastPesticideDate"}})],1)],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("农残检测报告"),i("v-uni-text",{staticClass:"required-mark"},[n._v("*")])],1),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-view",{staticClass:"upload-container"},[n._l(n.pesticideCertImages,(function(t,e){return i("v-uni-view",{key:e,staticClass:"upload-box"},[i("v-uni-image",{staticClass:"upload-image",attrs:{src:t,mode:"aspectFill"}}),i("v-uni-view",{staticClass:"delete-btn",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.deleteCertificate(e,"pesticide")}}},[i("v-uni-icon",{attrs:{type:"cancel",size:"16",color:"#fff"}})],1)],1)})),i("v-uni-view",{staticClass:"upload-box add-box",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.choosePesticideCertificate.apply(void 0,arguments)}}},[i("v-uni-icon",{attrs:{type:"camera",size:"24",color:"#999"}}),i("v-uni-text",{staticClass:"upload-text"},[n._v("上传报告")])],1)],2)],1)],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("灌溉水源")]),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-view",{staticClass:"input-field",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.openPopup("irrigationWater")}}},[i("v-uni-text",{staticClass:"input-text"},[n._v(n._s(n.TraceabilityInfo.irrigationWater||"点击输入灌溉水源"))])],1)],1)],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("种植周期(天)")]),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-view",{staticClass:"input-field",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.openPopup("plantingCycle")}}},[i("v-uni-text",{staticClass:"input-text"},[n._v(n._s(n.TraceabilityInfo.plantingCycle||"点击输入种植周期"))])],1)],1)],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("土壤类型")]),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-view",{staticClass:"input-field",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.openPopup("soilType")}}},[i("v-uni-text",{staticClass:"input-text"},[n._v(n._s(n.TraceabilityInfo.soilType||"点击输入土壤类型"))])],1)],1)],1)],1):n._e(),1===n.classificationIndex?i("v-uni-view",{staticClass:"form-section"},[i("v-uni-view",{staticClass:"section-header"},[i("v-uni-text",{staticClass:"section-title"},[n._v("养殖信息")]),i("v-uni-text",{staticClass:"section-desc"},[n._v("消费者最关心饲料与养殖环境")])],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("饲料名称"),i("v-uni-text",{staticClass:"required-mark"},[n._v("*")])],1),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-view",{staticClass:"input-field",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.openPopup("feedName")}}},[i("v-uni-text",{staticClass:"input-text"},[n._v(n._s(n.TraceabilityInfo.feedName||"点击输入饲料名称"))])],1)],1)],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("饲料来源"),i("v-uni-text",{staticClass:"required-mark"},[n._v("*")])],1),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-view",{staticClass:"input-field",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.openPopup("feedSource")}}},[i("v-uni-text",{staticClass:"input-text"},[n._v(n._s(n.TraceabilityInfo.feedSource||"点击输入饲料来源"))])],1)],1)],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("饲料检测报告"),i("v-uni-text",{staticClass:"required-mark"},[n._v("*")])],1),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-view",{staticClass:"upload-container"},[n._l(n.feedCertImages,(function(t,e){return i("v-uni-view",{key:e,staticClass:"upload-box"},[i("v-uni-image",{staticClass:"upload-image",attrs:{src:t,mode:"aspectFill"}}),i("v-uni-view",{staticClass:"delete-btn",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.deleteCertificate(e,"feed")}}},[i("v-uni-icon",{attrs:{type:"cancel",size:"16",color:"#fff"}})],1)],1)})),i("v-uni-view",{staticClass:"upload-box add-box",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.chooseFeedCertificate.apply(void 0,arguments)}}},[i("v-uni-icon",{attrs:{type:"camera",size:"24",color:"#999"}}),i("v-uni-text",{staticClass:"upload-text"},[n._v("上传报告")])],1)],2)],1)],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("养殖周期(天)")]),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-view",{staticClass:"input-field",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.openPopup("breedingCycle")}}},[i("v-uni-text",{staticClass:"input-text"},[n._v(n._s(n.TraceabilityInfo.breedingCycle||"点击输入养殖周期"))])],1)],1)],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("防疫记录")]),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-view",{staticClass:"input-field",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.openPopup("epidemicPrevention")}}},[i("v-uni-text",{staticClass:"input-text"},[n._v(n._s(n.TraceabilityInfo.epidemicPrevention||"点击输入防疫情况"))])],1)],1)],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("养殖环境描述")]),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-view",{staticClass:"input-field",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.openPopup("breedingEnvironment")}}},[i("v-uni-text",{staticClass:"input-text"},[n._v(n._s(n.TraceabilityInfo.breedingEnvironment||"点击输入环境描述"))])],1)],1)],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("养殖方式")]),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-view",{staticClass:"input-field",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.openPopup("breedingMethod")}}},[i("v-uni-text",{staticClass:"input-text"},[n._v(n._s(n.TraceabilityInfo.breedingMethod||"点击输入养殖方式"))])],1)],1)],1)],1):n._e(),2===n.classificationIndex?i("v-uni-view",{staticClass:"form-section"},[i("v-uni-view",{staticClass:"section-header"},[i("v-uni-text",{staticClass:"section-title"},[n._v("加工信息")]),i("v-uni-text",{staticClass:"section-desc"},[n._v("消费者最关心添加剂与卫生情况")])],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("加工原料"),i("v-uni-text",{staticClass:"required-mark"},[n._v("*")])],1),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-view",{staticClass:"input-field",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.openPopup("processingMaterials")}}},[i("v-uni-text",{staticClass:"input-text"},[n._v(n._s(n.TraceabilityInfo.processingMaterials||"点击输入加工原料"))])],1)],1)],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("食品添加剂")]),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-view",{staticClass:"input-field",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.openPopup("foodAdditives")}}},[i("v-uni-text",{staticClass:"input-text"},[n._v(n._s(n.TraceabilityInfo.foodAdditives||"点击输入添加剂信息"))])],1)],1)],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("加工工艺")]),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-view",{staticClass:"input-field",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.openPopup("processingTechnology")}}},[i("v-uni-text",{staticClass:"input-text"},[n._v(n._s(n.TraceabilityInfo.processingTechnology||"点击输入加工工艺"))])],1)],1)],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("加工环境检测")]),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-view",{staticClass:"input-field",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.openPopup("processingEnvironment")}}},[i("v-uni-text",{staticClass:"input-text"},[n._v(n._s(n.TraceabilityInfo.processingEnvironment||"点击输入检测结果"))])],1)],1)],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("加工设备编号")]),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-view",{staticClass:"input-field",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.openPopup("processingEquipment")}}},[i("v-uni-text",{staticClass:"input-text"},[n._v(n._s(n.TraceabilityInfo.processingEquipment||"点击输入设备编号"))])],1)],1)],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("加工卫生许可证")]),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-view",{staticClass:"upload-container"},[n._l(n.processingCertImages,(function(t,e){return i("v-uni-view",{key:e,staticClass:"upload-box"},[i("v-uni-image",{staticClass:"upload-image",attrs:{src:t,mode:"aspectFill"}}),i("v-uni-view",{staticClass:"delete-btn",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.deleteCertificate(e,"processing")}}},[i("v-uni-icon",{attrs:{type:"cancel",size:"16",color:"#fff"}})],1)],1)})),i("v-uni-view",{staticClass:"upload-box add-box",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.chooseProcessingCertificate.apply(void 0,arguments)}}},[i("v-uni-icon",{attrs:{type:"camera",size:"24",color:"#999"}}),i("v-uni-text",{staticClass:"upload-text"},[n._v("上传证书")])],1)],2)],1)],1)],1):n._e(),3===n.classificationIndex?i("v-uni-view",{staticClass:"form-section"},[i("v-uni-view",{staticClass:"section-header"},[i("v-uni-text",{staticClass:"section-title"},[n._v("产品信息")]),i("v-uni-text",{staticClass:"section-desc"},[n._v("消费者最关心材质与安全性")])],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("产品材质"),i("v-uni-text",{staticClass:"required-mark"},[n._v("*")])],1),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-view",{staticClass:"input-field",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.openPopup("productMaterial")}}},[i("v-uni-text",{staticClass:"input-text"},[n._v(n._s(n.TraceabilityInfo.productMaterial||"点击输入产品材质"))])],1)],1)],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("生产厂家"),i("v-uni-text",{staticClass:"required-mark"},[n._v("*")])],1),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-view",{staticClass:"input-field",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.openPopup("manufacturer")}}},[i("v-uni-text",{staticClass:"input-text"},[n._v(n._s(n.TraceabilityInfo.manufacturer||"点击输入生产厂家"))])],1)],1)],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("生产地址"),i("v-uni-text",{staticClass:"required-mark"},[n._v("*")])],1),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-view",{staticClass:"input-field",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.openPopup("manufacturerAddress")}}},[i("v-uni-text",{staticClass:"input-text"},[n._v(n._s(n.TraceabilityInfo.manufacturerAddress||"点击输入生产地址"))])],1)],1)],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("联系方式")]),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-view",{staticClass:"input-field",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.openPopup("manufacturerPhone")}}},[i("v-uni-text",{staticClass:"input-text"},[n._v(n._s(n.TraceabilityInfo.manufacturerPhone||"点击输入联系电话"))])],1)],1)],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("产品认证")]),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-view",{staticClass:"input-field",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.openPopup("productCertification")}}},[i("v-uni-text",{staticClass:"input-text"},[n._v(n._s(n.TraceabilityInfo.productCertification||"点击输入认证信息"))])],1)],1)],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("安全检测报告")]),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-view",{staticClass:"upload-container"},[n._l(n.otherCertImages,(function(t,e){return i("v-uni-view",{key:e,staticClass:"upload-box"},[i("v-uni-image",{staticClass:"upload-image",attrs:{src:t,mode:"aspectFill"}}),i("v-uni-view",{staticClass:"delete-btn",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.deleteCertificate(e,"other")}}},[i("v-uni-icon",{attrs:{type:"cancel",size:"16",color:"#fff"}})],1)],1)})),i("v-uni-view",{staticClass:"upload-box add-box",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.chooseOtherCertificate.apply(void 0,arguments)}}},[i("v-uni-icon",{attrs:{type:"camera",size:"24",color:"#999"}}),i("v-uni-text",{staticClass:"upload-text"},[n._v("上传报告")])],1)],2)],1)],1)],1):n._e(),i("v-uni-view",{staticClass:"form-section"},[i("v-uni-view",{staticClass:"section-header"},[i("v-uni-text",{staticClass:"section-title"},[n._v("通用信息")]),i("v-uni-text",{staticClass:"section-desc"},[n._v("消费者关注的附加信息")])],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("运输方式")]),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-view",{staticClass:"input-field",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.openPopup("transportMethod")}}},[i("v-uni-text",{staticClass:"input-text"},[n._v(n._s(n.TraceabilityInfo.transportMethod||"点击输入运输方式"))])],1)],1)],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("储存条件")]),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-view",{staticClass:"input-field",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.openPopup("storageConditions")}}},[i("v-uni-text",{staticClass:"input-text"},[n._v(n._s(n.TraceabilityInfo.storageConditions||"点击输入储存条件"))])],1)],1)],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("保质期(天)")]),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-view",{staticClass:"input-field",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.openPopup("shelfLife")}}},[i("v-uni-text",{staticClass:"input-text"},[n._v(n._s(n.TraceabilityInfo.shelfLife||"点击输入保质期"))])],1)],1)],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("营养价值")]),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-view",{staticClass:"input-field",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.openPopup("nutritionValue")}}},[i("v-uni-text",{staticClass:"input-text"},[n._v(n._s(n.TraceabilityInfo.nutritionValue||"点击输入营养价值"))])],1)],1)],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("食用方法")]),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-view",{staticClass:"input-field",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.openPopup("cookingMethod")}}},[i("v-uni-text",{staticClass:"input-text"},[n._v(n._s(n.TraceabilityInfo.cookingMethod||"点击输入食用方法"))])],1)],1)],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("溯源凭证")]),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-view",{staticClass:"upload-container"},[n._l(n.certificateImages,(function(t,e){return i("v-uni-view",{key:e,staticClass:"upload-box"},[i("v-uni-image",{staticClass:"upload-image",attrs:{src:t,mode:"aspectFill"}}),i("v-uni-view",{staticClass:"delete-btn",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.deleteCertificate(e,"general")}}},[i("v-uni-icon",{attrs:{type:"cancel",size:"16",color:"#fff"}})],1)],1)})),i("v-uni-view",{staticClass:"upload-box add-box",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.chooseCertificateImage.apply(void 0,arguments)}}},[i("v-uni-icon",{attrs:{type:"camera",size:"24",color:"#999"}}),i("v-uni-text",{staticClass:"upload-text"},[n._v("上传凭证")])],1)],2)],1)],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"item-label"},[n._v("备注信息")]),i("v-uni-view",{staticClass:"item-content"},[i("v-uni-view",{staticClass:"input-field",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.openPopup("notes")}}},[i("v-uni-text",{staticClass:"input-text"},[n._v(n._s(n.TraceabilityInfo.notes||"点击输入备注信息"))])],1)],1)],1)],1)],1),i("v-uni-view",{staticClass:"submit-container"},[i("v-uni-button",{staticClass:"submit-button",attrs:{disabled:n.isSubmitting},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.submit.apply(void 0,arguments)}}},[n._v(n._s(n.isSubmitting?"提交中...":"提交溯源信息"))])],1),i("v-uni-view",{staticClass:"footer-tip"},[i("v-uni-text",[n._v("注："),i("v-uni-text",{staticClass:"required-mark"},[n._v("*")]),n._v("为必填项，完整填写可提升消费者信任度")],1)],1),i("uni-popup",{ref:"popup",attrs:{type:"bottom","border-radius":"12rpx 12rpx 0 0"}},[i("v-uni-view",{staticClass:"popup-content"},[i("v-uni-input",{staticClass:"popup-input",attrs:{placeholder:"请输入"},on:{confirm:function(t){arguments[0]=t=n.$handleEvent(t),n.handleInputConfirm.apply(void 0,arguments)},blur:function(t){arguments[0]=t=n.$handleEvent(t),n.handleInputBlur.apply(void 0,arguments)}},model:{value:n.currentInputValue,callback:function(t){n.currentInputValue=t},expression:"currentInputValue"}})],1)],1)],1)},a=[]},b5ba:function(n,t,i){"use strict";var e=i("becf"),s=i.n(e);s.a},becf:function(n,t,i){var e=i("630a");e.__esModule&&(e=e.default),"string"===typeof e&&(e=[[n.i,e,""]]),e.locals&&(n.exports=e.locals);var s=i("967d").default;s("139c4f03",e,!0,{sourceMap:!1,shadowMode:!1})},ec4c:function(n,t,i){"use strict";i("6a54");var e=i("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=e(i("9b1b"));i("bf0f"),i("2797"),i("fd3c"),i("c223"),i("dd2b"),i("aa9c"),i("18f7"),i("de6c"),i("7a76"),i("c9b5");var a=i("4860"),c={data:function(){return{TraceabilityInfo:{Students:"",productionDate:"",batchNumber:"",pesticideName:"",pesticideTimes:"",lastPesticideDate:"",irrigationWater:"",plantingCycle:"",soilType:"",feedName:"",feedSource:"",breedingCycle:"",epidemicPrevention:"",breedingEnvironment:"",breedingMethod:"",processingMaterials:"",foodAdditives:"",processingTechnology:"",processingEnvironment:"",processingEquipment:"",productMaterial:"",manufacturer:"",manufacturerAddress:"",manufacturerPhone:"",productCertification:"",transportMethod:"",storageConditions:"",shelfLife:"",nutritionValue:"",cookingMethod:"",notes:""},CLASSIFICATION:["种植","养殖","加工","其他"],classificationIndex:0,index:0,commodityLis:[],commodityTempLis:[],currentInputValue:"",currentInputField:"",isSubmitting:!1,certificateImages:[],feedCertImages:[],pesticideCertImages:[],processingCertImages:[],otherCertImages:[]}},computed:{formCompletionRate:function(){var n=this,t=["Students","productionDate",{key:"feedName",show:1===this.classificationIndex},{key:"pesticideName",show:0===this.classificationIndex},{key:"processingMaterials",show:2===this.classificationIndex},{key:"productMaterial",show:3===this.classificationIndex},{key:"feedCertImages",show:1===this.classificationIndex,check:function(){return n.feedCertImages.length>0}},{key:"pesticideCertImages",show:0===this.classificationIndex,check:function(){return n.pesticideCertImages.length>0}},{key:"processingCertImages",show:2===this.classificationIndex,check:function(){return n.processingCertImages.length>0}},{key:"otherCertImages",show:3===this.classificationIndex,check:function(){return n.otherCertImages.length>0}}],i=0,e=0;return t.forEach((function(t){(void 0===t.show||t.show)&&(e++,t.check?i+=t.check()?1:0:i+=n.TraceabilityInfo[t.key]?1:0)})),Math.round(i/e*100)}},onLoad:function(){this.loadCommodityList()},methods:{loadCommodityList:function(){var n=this;a.api.myShoplist({isshow:1}).then((function(t){n.commodityLis=t.data.listdata||[],n.commodityTempLis=n.commodityLis.map((function(n){return n.commodity_name}))})).catch((function(n){console.error("加载商品列表失败",n)}))},changeClassification:function(n){this.classificationIndex=n.detail.value},openLocationPicker:function(){var n=this;wx.chooseLocation({success:function(t){n.TraceabilityInfo.Students=t.name+t.address,wx.showToast({title:"已选择地址",icon:"success",duration:1500})}})},chooseFeedCertificate:function(){var n=this;wx.chooseImage({count:3-this.feedCertImages.length,success:function(t){n.feedCertImages=n.feedCertImages.concat(t.tempFilePaths)}})},choosePesticideCertificate:function(){var n=this;wx.chooseImage({count:3-this.pesticideCertImages.length,success:function(t){n.pesticideCertImages=n.pesticideCertImages.concat(t.tempFilePaths)}})},chooseProcessingCertificate:function(){var n=this;wx.chooseImage({count:3-this.processingCertImages.length,success:function(t){n.processingCertImages=n.processingCertImages.concat(t.tempFilePaths)}})},chooseOtherCertificate:function(){var n=this;wx.chooseImage({count:3-this.otherCertImages.length,success:function(t){n.otherCertImages=n.otherCertImages.concat(t.tempFilePaths)}})},chooseCertificateImage:function(){var n=this;wx.chooseImage({count:3-this.certificateImages.length,success:function(t){n.certificateImages=n.certificateImages.concat(t.tempFilePaths)}})},deleteCertificate:function(n,t){"feed"===t?this.feedCertImages.splice(n,1):"pesticide"===t?this.pesticideCertImages.splice(n,1):"processing"===t?this.processingCertImages.splice(n,1):"other"===t?this.otherCertImages.splice(n,1):this.certificateImages.splice(n,1)},submit:function(){var n=this;if(this.TraceabilityInfo.Students)if(this.TraceabilityInfo.productionDate){if(1===this.classificationIndex){if(!this.TraceabilityInfo.feedName)return void wx.showToast({title:"请填写饲料名称",icon:"none"});if(!this.TraceabilityInfo.feedSource)return void wx.showToast({title:"请填写饲料来源",icon:"none"});if(0===this.feedCertImages.length)return void wx.showToast({title:"请上传饲料检测报告",icon:"none"})}if(0===this.classificationIndex){if(!this.TraceabilityInfo.pesticideName)return void wx.showToast({title:"请填写农药名称",icon:"none"});if(0===this.pesticideCertImages.length)return void wx.showToast({title:"请上传农残检测报告",icon:"none"})}if(2===this.classificationIndex){if(!this.TraceabilityInfo.processingMaterials)return void wx.showToast({title:"请填写加工原料",icon:"none"});if(0===this.processingCertImages.length)return void wx.showToast({title:"请上传加工卫生许可证",icon:"none"})}if(3===this.classificationIndex){if(!this.TraceabilityInfo.productMaterial)return void wx.showToast({title:"请填写产品材质",icon:"none"});if(!this.TraceabilityInfo.manufacturer)return void wx.showToast({title:"请填写生产厂家",icon:"none"});if(!this.TraceabilityInfo.manufacturerAddress)return void wx.showToast({title:"请填写生产地址",icon:"none"});if(0===this.otherCertImages.length)return void wx.showToast({title:"请上传安全检测报告",icon:"none"})}this.isSubmitting=!0;var t=(0,s.default)((0,s.default)({},this.TraceabilityInfo),{},{commodity_id:this.commodityLis[this.index].commodity_id,classification:this.classificationIndex,formCompletionRate:this.formCompletionRate}),i=[];this.certificateImages.length>0&&i.push(this.uploadImages(this.certificateImages,"certificate")),0===this.classificationIndex&&this.pesticideCertImages.length>0&&i.push(this.uploadImages(this.pesticideCertImages,"pesticide")),1===this.classificationIndex&&this.feedCertImages.length>0&&i.push(this.uploadImages(this.feedCertImages,"feed")),2===this.classificationIndex&&this.processingCertImages.length>0&&i.push(this.uploadImages(this.processingCertImages,"processing")),3===this.classificationIndex&&this.otherCertImages.length>0&&i.push(this.uploadImages(this.otherCertImages,"other")),Promise.all(i).then((function(i){i.forEach((function(n){"certificate"===n.type?t.certificateUrls=n.urls:"pesticide"===n.type?t.pesticideCertUrls=n.urls:"feed"===n.type?t.feedCertUrls=n.urls:"processing"===n.type?t.processingCertUrls=n.urls:"other"===n.type&&(t.otherCertUrls=n.urls)})),a.api.submitTraceabilityInfo(t).then((function(n){wx.showToast({title:"提交成功",icon:"success",duration:2e3}),setTimeout((function(){wx.navigateBack()}),2e3)})).catch((function(n){wx.showToast({title:"提交失败",icon:"none",duration:2e3}),console.error("提交失败",n)})).finally((function(){n.isSubmitting=!1}))})).catch((function(t){wx.showToast({title:"图片上传失败",icon:"none",duration:2e3}),console.error("图片上传失败",t),n.isSubmitting=!1}))}else wx.showToast({title:"请选择生产日期",icon:"none"});else wx.showToast({title:"请填写产地",icon:"none"})},uploadImages:function(n,t){return new Promise((function(i,e){var s=[],a=0;n.forEach((function(c,o){wx.uploadFile({url:"https://your-api-domain.com/upload",filePath:c,name:"file",formData:{type:t},success:function(n){var t=JSON.parse(n.data);0===t.code?s.push(t.data.url):e(new Error("图片上传失败: ".concat(t.msg)))},fail:function(n){e(n)},complete:function(){a++,a===n.length&&i({type:t,urls:s})}})}))}))},openPopup:function(n){this.currentInputField=n,this.currentInputValue=this.TraceabilityInfo[n]||"",this.$refs.popup.open()},handleInputConfirm:function(){this.currentInputField&&(this.TraceabilityInfo[this.currentInputField]=this.currentInputValue),this.$refs.popup.close()}}};t.default=c}}]);