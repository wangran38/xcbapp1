(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-stalllist-stalllist"],{"0829":function(t,e,i){"use strict";var a=i("8bdb"),n=i("ea07").entries;a({target:"Object",stat:!0},{entries:function(t){return n(t)}})},"1a48":function(t,e,i){"use strict";i.r(e);var a=i("3c2c"),n=i("5603");for(var o in n)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(o);i("72de");var s=i("828b"),r=Object(s["a"])(n["default"],a["b"],a["c"],!1,null,"fdb78006",null,!1,a["a"],void 0);e["default"]=r.exports},"3c2c":function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return n})),i.d(e,"a",(function(){}));var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"me-container"},[i("v-uni-scroll-view",{staticClass:"Stallholder",style:{height:"100vh"},attrs:{"scroll-y":"true"},on:{scrolltolower:function(e){arguments[0]=e=t.$handleEvent(e),t.handleScrollToLower.apply(void 0,arguments)}}},[t._l(t.pageData,(function(e){return i("v-uni-view",{key:e.id,staticClass:"item-list"},[i("v-uni-view",{staticClass:"logo",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.gotostaldis(e.id)}}},[t.isloaded?i("v-uni-image",{staticClass:"logos",attrs:{"lazy-load":!0,src:e.logo,mode:"aspectFill"}}):t._e()],1),i("v-uni-view",{staticClass:"info",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.gotostaldis(e.id)}}},[i("v-uni-view",{staticClass:"message"},[t._v("菜市场名称："+t._s(e.market_name))]),i("v-uni-view",{staticClass:"message"},[t._v("摊位名称："+t._s(e.title))]),i("v-uni-view",{staticClass:"message"},[t._v("摊位编号："+t._s(e.id))])],1),i("v-uni-view",{staticClass:"interface"},[i("v-uni-view",{staticClass:"edit",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.editShop(e)}}},[t._v("编辑")]),i("v-uni-view",{staticClass:"delete",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.deleteShop(e)}}},[t._v("删除")])],1)],1)})),t.pageLoading?i("v-uni-view",{staticClass:"loading"},[t._v("加载中...")]):t._e(),t.hasMore?t._e():i("v-uni-view",{staticClass:"loading"},[t._v("没有更多了")])],2),t.showEditPopup?i("v-uni-view",{staticClass:"popup-overlay",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closePopup.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"popup",on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e)}}},[i("v-uni-view",{staticClass:"close-button",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closePopup.apply(void 0,arguments)}}},[t._v("×")]),i("v-uni-view",{staticClass:"popup-content"},[i("v-uni-view",{staticClass:"content"},[i("v-uni-view",{staticClass:"cuisine"},[i("v-uni-view",{staticClass:"title"},[t._v("摊位名称")]),i("v-uni-view",{staticClass:"shuru"},[i("v-uni-input",{staticClass:"shurucon",attrs:{type:"text"},model:{value:t.currentShopTitle,callback:function(e){t.currentShopTitle=e},expression:"currentShopTitle"}})],1)],1),i("v-uni-view",{staticClass:"editimg"},[i("v-uni-view",{staticClass:"title"},[t._v("摊位图片")]),i("v-uni-image",{staticClass:"cimg",attrs:{src:t.currentShopLogo,mode:"aspectFit"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.uploadcuisine.apply(void 0,arguments)}}})],1)],1)],1),i("v-uni-view",{staticClass:"popup-footer"},[i("v-uni-button",{on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closePopup.apply(void 0,arguments)}}},[t._v("取消")]),i("v-uni-button",{staticStyle:{"background-color":"#007aff",color:"white"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.confirmEdit.apply(void 0,arguments)}}},[t._v("确认")])],1)],1)],1):t._e()],1)},n=[]},5603:function(t,e,i){"use strict";i.r(e);var a=i("72c7"),n=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);e["default"]=n.a},"72c7":function(t,e,i){"use strict";i("6a54");var a=i("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(i("9b1b")),o=a(i("2634")),s=a(i("2fdc")),r=i("4860"),c=a(i("fce1")),l=i("64af"),u={data:function(){return{pageData:[],shopList:[],imageUploaded:!1,showEditPopup:!1,currentShopTitle:"",currentShopLogo:"",isloaded:!1}},mixins:[c.default],onLoad:function(){this.isloaded=!0},created:function(){this.reloadData()},methods:{deleteShop:function(t){var e=this;return(0,s.default)((0,o.default)().mark((function i(){var a;return(0,o.default)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,r.api.editshop({id:t.id,isshow:2});case 2:a=i.sent,200==a.code&&(uni.showToast({title:"删除成功",icon:"success"}),e.reloadData());case 4:case"end":return i.stop()}}),i)})))()},fetchData:function(t){return(0,s.default)((0,o.default)().mark((function e(){var i;return(0,o.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.api.getMyShops((0,n.default)({},t));case 3:return i=e.sent,e.abrupt("return",i.data);case 7:e.prev=7,e.t0=e["catch"](0),console.error("获取摊位列表失败",e.t0),uni.showToast({title:"获取摊位列表失败",icon:"none"});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))()},editShop:function(t){this.currentShopId=t.id,this.currentShopTitle=t.title,this.currentShopLogo=t.logo,this.showEditPopup=!0},closePopup:function(){this.showEditPopup=!1},confirmEdit:function(t){var e=this;return(0,s.default)((0,o.default)().mark((function t(){var i;return(0,o.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.currentShopTitle){t.next=3;break}return uni.showToast({title:"请输入摊位名称",icon:"none"}),t.abrupt("return");case 3:if(e.imageUploaded||e.currentShopLogo){t.next=6;break}return uni.showToast({title:"请上传图片",icon:"none"}),t.abrupt("return");case 6:return t.prev=6,console.log("Calling editshop API"),t.next=10,r.api.editshop({id:e.currentShopId,title:e.currentShopTitle,logo:e.currentShopLogo});case 10:i=t.sent,200===i.code?(uni.showToast({title:"摊位信息修改成功",icon:"success"}),e.reloadData(),e.closePopup()):uni.showToast({title:i.msg||"摊位信息修改失败",icon:"none"}),t.next=17;break;case 14:t.prev=14,t.t0=t["catch"](6),uni.showToast({title:"修改失败，请稍后重试",icon:"none"});case 17:case"end":return t.stop()}}),t,null,[[6,14]])})))()},uploadcuisine:function(){var t=this;uni.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(e){var i=e.tempFilePaths;if(i.length>0){var a=(0,l.useUpload)({uploadPath:"/group1/upload",file:e.tempFiles[0],tempFilePaths:i[0]}),n=a.upload;a.request;n().then((function(e){e=JSON.parse(e),t.currentShopLogo=e.data.url,console.log("更新后的图片路径:",t.currentShopLogo),t.isImageSelected=!0,t.imageUploaded=!0}))}}})},gotostaldis:function(t){uni.navigateTo({url:"/pages/Stalls-dishes/Stalls-dishes?id=".concat(t)})}}};e.default=u},"72de":function(t,e,i){"use strict";var a=i("8232"),n=i.n(a);n.a},8232:function(t,e,i){var a=i("8432");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=i("967d").default;n("0b37d4c7",a,!0,{sourceMap:!1,shadowMode:!1})},8432:function(t,e,i){var a=i("c86c");e=a(!1),e.push([t.i,".me-container[data-v-fdb78006]{overflow:hidden;width:100%;box-sizing:border-box;padding:%?0?% %?30?% 0 %?30?%;color:#fff;z-index:1;background-color:#f4f4f4;display:flex;flex-direction:column;justify-content:center}.item-list[data-v-fdb78006]{height:%?200?%;width:100%;margin-top:%?15?%;display:flex;flex-direction:row;justify-content:flex-start;align-items:center;background-color:#fff;border-radius:%?20?%}.logo[data-v-fdb78006]{height:%?180?%;width:30%;text-align:center;line-height:%?200?%;background-color:#1296db;border-radius:%?20?%\n\t/* padding: 10rpx 10rpx; */}.logos[data-v-fdb78006]{height:%?180?%;width:100%;border-radius:%?20?%}.info[data-v-fdb78006]{height:%?200?%;width:50%;margin-left:%?10?%;\n\t/* 设置info和logo之间的间距 */display:flex;flex-direction:column;\n\t/* justify-content: space-between; */flex:1;\n\t/* 确保info占据剩余空间 */overflow:hidden\n\t/* 确保内容不溢出 */}.message[data-v-fdb78006]{width:100%;margin:%?10?%;\n\t/* 调整这个值以改变上下间距 */color:#000;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.interface[data-v-fdb78006]{height:100%;width:20%;display:flex;flex-direction:column;justify-content:center;align-items:center;margin-left:auto;\n\t/* 设置interface与info的间距 */position:relative\n\t/* margin-right: 0rpx; */\n\t/* background-color: #1296db; */}.interface>.edit[data-v-fdb78006]{text-align:center;color:#fff;font-size:%?30?%;width:%?100?%;height:%?50?%;line-height:%?50?%;background-color:#1296db;border-radius:%?20?%;margin-bottom:%?20?%}.interface>.delete[data-v-fdb78006]{text-align:center;color:#fff;font-size:%?30?%;width:%?100?%;height:%?50?%;line-height:%?50?%;background-color:#ff1909;border-radius:%?20?%}.loading[data-v-fdb78006]{text-align:center;padding:%?20?%;color:#999}.popup-overlay[data-v-fdb78006]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.5);display:flex;justify-content:center;align-items:center;z-index:1000;color:#000}.popup[data-v-fdb78006]{position:relative;width:80%;max-width:%?600?%;background-color:#fff;border-radius:%?20?%;padding:%?20?%;box-shadow:0 0 15px rgba(0,0,0,.2)}.popup-header[data-v-fdb78006]{font-size:%?36?%;font-weight:700;margin-bottom:%?20?%;text-align:center}.popup-content[data-v-fdb78006]{\n\t/* 这里你可以添加弹出层内容的样式 */display:flex;width:100%;padding:%?30?%;box-sizing:border-box;justify-content:center;align-items:center}.popup-footer[data-v-fdb78006]{display:flex;justify-content:space-between;margin-top:%?10?%}.close-button[data-v-fdb78006]{position:absolute;top:%?5?%;right:%?5?%;font-size:%?40?%;color:#000;cursor:pointer;z-index:10;width:%?80?%;height:%?80?%;display:flex;justify-content:center;align-items:center;background-color:#fff;border-radius:50%;box-shadow:0 0 %?10?% rgba(0,0,0,.1)}.cimg[data-v-fdb78006]{width:%?100?%;height:%?100?%}.content[data-v-fdb78006]{width:100%;height:%?200?%}.cuisine[data-v-fdb78006]{height:%?100?%;display:flex;justify-content:space-between;align-items:center}.editimg[data-v-fdb78006]{width:100%;height:%?100?%;display:flex;justify-content:space-between;align-items:center}.title[data-v-fdb78006]{font-size:%?35?%}.shuru[data-v-fdb78006]{width:auto;height:%?100?%;display:flex;justify-content:end;align-items:center}.shurucon[data-v-fdb78006]{text-align:right;font-size:%?35?%}",""]),t.exports=e},fb2c:function(t,e,i){"use strict";var a=i("8bdb"),n=i("5075"),o=i("85f7");a({target:"Object",stat:!0},{fromEntries:function(t){var e={};return n(t,(function(t,i){o(e,t,i)}),{AS_ENTRIES:!0}),e}})},fce1:function(t,e,i){"use strict";i("6a54");var a=i("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(i("2634")),o=a(i("2fdc")),s=a(i("9b1b")),r=a(i("5de6"));i("fb2c"),i("8f71"),i("bf0f"),i("0829"),i("c223");var c={data:function(){return{page:1,limit:10,totalnum:0,pageData:[],pageLoading:!1,hasMore:!0,searchParams:{}}},computed:{queryParams:function(){var t=Object.fromEntries(Object.entries(this.searchParams).filter((function(t){var e=(0,r.default)(t,2),i=(e[0],e[1]);return""!==i})));return(0,s.default)({page:this.page,limit:this.limit,isshow:1},t)}},methods:{loadPageData:function(){var t=this;return(0,o.default)((0,n.default)().mark((function e(){var i;return(0,n.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.hasMore&&!t.pageLoading){e.next=2;break}return e.abrupt("return");case 2:return t.pageLoading=!0,e.prev=3,e.next=6,t.fetchData(t.queryParams);case 6:i=e.sent,t.querySuccess(i),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](3),t.handleFetchError(e.t0);case 13:return e.prev=13,t.pageLoading=!1,e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[3,10,13,16]])})))()},fetchData:function(t){return(0,o.default)((0,n.default)().mark((function t(){return(0,n.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})))()},querySuccess:function(t){null!==t&&void 0!==t&&t.listdata&&(this.pageData=1===this.page?t.listdata:this.pageData.concat(t.listdata),this.totalnum=t.totalnum||0,this.hasMore=this.pageData.length<this.totalnum)},handleScrollToLower:function(){!this.pageLoading&&this.hasMore&&(this.page+=1,this.loadPageData())},handleFetchError:function(t){console.error("Error loading data:",t)},resetPagination:function(){this.page=1,this.pageData=[],this.totalnum=0,this.hasMore=!0},reloadData:function(){this.resetPagination(),this.loadPageData()}}};e.default=c}}]);