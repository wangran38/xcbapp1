(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/editshop/editshop"],{"3c40":function(e,t,n){"use strict";var r=n("59c4"),a=n.n(r);a.a},"59c4":function(e,t,n){},"59df":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){}));var r=function(){var e=this.$createElement;this._self._c},a=[]},"9cc2":function(e,t,n){"use strict";n.r(t);var r=n("d001"),a=n.n(r);for(var o in r)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(o);t["default"]=a.a},bf39:function(e,t,n){"use strict";(function(e,t){var r=n("47a9");n("89ee");r(n("3240"));var a=r(n("f57e"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(a.default)}).call(this,n("3223")["default"],n("df3c")["createPage"])},d001:function(e,t,n){"use strict";(function(e){var r=n("47a9");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n("7eb4")),o=r(n("af34")),i=r(n("7ca3")),c=r(n("ee10")),s=n("4860"),u=n("64af");function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){(0,i.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d={data:function(){return{marketList:[],pickerRange1:[],selectedCategoryIndex1:0,isImageSelected:!1,isImageSelected2:!1,facelogo:"",isSubmitting:!1,businesslogo:""}},mounted:function(){this.fetchMarketList()},methods:{customizeBack:function(){return(0,c.default)(a.default.mark((function t(){var n;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,getCurrentPages();case 2:n=t.sent,console.log(n),n&&n.length>1?e.navigateBack():history.back();case 5:case"end":return t.stop()}}),t)})))()},onMarketChange:function(e){this.selectedCategoryIndex1=e.detail.value},fetchMarketList:function(){var e=this;return(0,c.default)(a.default.mark((function t(){var n,r,i;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,n={limit:100,page:1},t.next=4,s.api.getMyShops(f({},n));case 4:r=t.sent,200===r.code?(i=r.data.listdata.map((function(e){return{id:e.id,title:e.title}})),e.marketList=i,e.pickerRange1=(0,o.default)(i.map((function(e){return e.title})))):console.error("Failed to fetch market list:",r.msg),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),console.error("Error fetching market list:",t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},bindCategoryChange:function(e){var t=e.detail.value;this.selectedCategory=this.categoryList[t],this.category_id=this.categoryIdMap[this.selectedCategory]},chooseImage:function(){var t=this;e.chooseImage({count:1,sizeType:["compressed","original"],sourceType:["album","camera"],success:function(e){var n=e.tempFilePaths;if(n.length>0){var r=(0,u.useUpload)({uploadPath:"/group1/upload",tempFilePaths:n[0],file:e.tempFiles[0]}),a=r.upload;r.request;a().then((function(e){var n=JSON.parse(e);t.facelogo=s.UPLOAD_URL+n.data.path,t.isImageSelected=!0}))}}})},chooseImage2:function(){var t=this;e.chooseImage({count:1,sizeType:["compressed","original"],sourceType:["album","camera"],success:function(e){var n=e.tempFilePaths;if(n.length>0){var r=(0,u.useUpload)({uploadPath:"/group1/upload",tempFilePaths:n[0],file:e.tempFiles[0]}),a=r.upload;r.request;a().then((function(e){var n=JSON.parse(e);t.businesslogo=s.UPLOAD_URL+n.data.path,t.isImageSelected2=!0}))}}})},submitForm:function(){var t=this;return(0,c.default)(a.default.mark((function n(){var r,o;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!t.isSubmitting){n.next=2;break}return n.abrupt("return");case 2:if(t.facelogo&&t.businesslogo&&t.marketList[t.selectedCategoryIndex1]){n.next=5;break}return e.showToast({title:"请填写完整的信息",icon:"none"}),n.abrupt("return");case 5:return t.isSubmitting=!0,n.prev=6,r={facelogo:t.facelogo,id:t.marketList[t.selectedCategoryIndex1].id,businesslogo:t.businesslogo},n.next=10,s.api.editshop(r);case 10:o=n.sent,200===o.code?(e.showToast({title:"补充成功",icon:"success",duration:2e3}),setTimeout((function(){t.customizeBack()}),2e3)):e.showToast({title:o.msg||"提交失败",icon:"none"}),n.next=18;break;case 14:n.prev=14,n.t0=n["catch"](6),console.error("提交失败:",n.t0),e.showToast({title:"提交失败",icon:"none"});case 18:return n.prev=18,t.isSubmitting=!1,n.finish(18);case 21:case"end":return n.stop()}}),n,null,[[6,14,18,21]])})))()}}};t.default=d}).call(this,n("df3c")["default"])},f57e:function(e,t,n){"use strict";n.r(t);var r=n("59df"),a=n("9cc2");for(var o in a)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(o);n("3c40");var i=n("828b"),c=Object(i["a"])(a["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],void 0);t["default"]=c.exports}},[["bf39","common/runtime","common/vendor"]]]);