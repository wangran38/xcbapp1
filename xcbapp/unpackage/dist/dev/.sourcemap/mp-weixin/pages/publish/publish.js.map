{"version":3,"file":"publish.js","sources":["pages/publish/publish.vue","D:/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvcHVibGlzaC9wdWJsaXNoLnZ1ZQ"],"sourcesContent":["<template>\r\n\t<view class=\"me-container\">\r\n\t\t<!-- 其他内容 -->\r\n\t\t<scroll-view class=\"Stallholder\" scroll-y=\"true\" @scrolltolower=\"handleScrollToLower\"\r\n\t\t\t:style=\"{ height: '100vh' }\" lower-threshold=\"10\">\r\n\t\t\t<view class=\"disheslist\">\r\n\t\t\t\t<view class=\"type\" v-for=\"item in pageData\" :key=\"item.id\">\r\n\t\t\t\t\t<image class=\"type-image\" v-if=\"isloaded\" lazy-load :src=\"item.imglogo \" mode=\"scaleToFill\"></image>\r\n\t\t\t\t\t<view class=\"regard\">\r\n\t\t\t\t\t\t<view class=\"typetitle\">\r\n\t\t\t\t\t\t\t{{item.goodsname}}\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t<view class=\"function\">\r\n\t\t\t\t\t\t<view class=\"rigicon\" @click=\"operation(item)\">操作</view>\r\n\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view v-if=\"pageLoading\" class=\"loading\">加载中...</view>\r\n\t\t\t\t<view v-if=\"!hasMore\" class=\"loading\">没有更多了</view>\r\n\t\t\t</view>\r\n\r\n\t\t</scroll-view>\r\n\r\n\t\t<view class=\"butt\" @click=\"goTorelePage\">\r\n\t\t\t点击新增菜品\r\n\t\t</view>\r\n\r\n\t\t<view v-if=\"showEditPopup2\" class=\"popup-overlay\" @click=\"closePopup\">\r\n\t\t\t<view style=\"background-color: white; width: 300rpx; height: 600rpx; border-radius: 5%; position: relative;\"\r\n\t\t\t\t@click.stop>\r\n\t\t\t\t<view\r\n\t\t\t\t\tstyle=\"position: absolute; right: 15rpx; top: 10rpx;background-color: red;color: white; padding: 5rpx;\"\r\n\t\t\t\t\t@click=\"closePopup\">关闭</view>\r\n\t\t\t\t<view class=\"btns\"\r\n\t\t\t\t\tstyle=\"display: flex; align-items: center; height: 100%; justify-content: center; flex-wrap: wrap;\">\r\n\t\t\t\t\t<view class=\"rigicon\" style=\"margin-top: 50rpx;color: white;\" @click=\"edit\">修改</view>\r\n\t\t\t\t\t<view class=\"rigicon\" style=\"background-color: #67c23a;color: white;\" @click=\"shelves\">上架\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"rigicon\" style=\"background-color: #f56c6c;color: white;\" @click=\"removeItem\">删除\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"rigicon\" style=\"background-color: #5daaa8;color: white;\" @click=\"routerPush\">补充溯源\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<!-- 编辑弹出层 -->\r\n\t\t<view v-if=\"showEditPopup\" class=\"popup-overlay\" @click=\"closePopup\">\r\n\t\t\t<view class=\"popup\" @click.stop>\r\n\t\t\t\t<view class=\"close-button\" @click=\"closePopup\">×</view>\r\n\t\t\t\t<!-- <view class=\"popup-header\">修改商品信息</view> -->\r\n\r\n\t\t\t\t<!-- 在这里添加你的表单内容 -->\r\n\t\t\t\t<view class=\"popup-content\">\r\n\t\t\t\t\t<!-- 表单或其他内容 -->\r\n\r\n\t\t\t\t\t<view class=\"content\">\r\n\t\t\t\t\t\t<view class=\"cuisine\">\r\n\t\t\t\t\t\t\t<view class=\"title\">菜名</view>\r\n\t\t\t\t\t\t\t<view class=\"shuru\"><input class=\"shurucon\" type=\"text\" v-model=\"currentItem.goodsname\" />\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"class\">\r\n\t\t\t\t\t\t\t<view class=\"title\">分类</view>\r\n\t\t\t\t\t\t\t<picker class=\"picker\" :range=\"pickerRange\" :value=\"selectedCategoryIndex\"\r\n\t\t\t\t\t\t\t\t@change=\"onCategoryChange\">\r\n\t\t\t\t\t\t\t\t<view class=\"picker-text\">{{ pickerRange[selectedCategoryIndex] }}</view>\r\n\t\t\t\t\t\t\t</picker>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"editimg\">\r\n\t\t\t\t\t\t\t<view class=\"title\">图片</view>\r\n\t\t\t\t\t\t\t<image class=\"cimg\" :src=\"currentItem.imglogo\" mode=\"aspectFit\" @tap=\"uploadcuisine\">\r\n\t\t\t\t\t\t\t</image>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"popup-footer\">\r\n\t\t\t\t\t<button @click=\"closePopup\">取消</button>\r\n\t\t\t\t\t<button @click=\"confirmEdit\" style=\"background-color: #007aff;color: white;\">确认</button>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<!-- 上架弹出层 -->\r\n\t\t<view v-if=\"showEditPopup1\" class=\"popup-overlay\" @click=\"closePopup\">\r\n\t\t\t<view class=\"popup\" @click.stop>\r\n\t\t\t\t<view class=\"close-button\" @click=\"closePopup\">×</view>\r\n\t\t\t\t<view class=\"popup-header\">{{currentItem.goodsname}}</view>\r\n\t\t\t\t<!-- 在这里添加你的表单内容 -->\r\n\t\t\t\t<view class=\"popup-content\">\r\n\t\t\t\t\t<!-- 表单或其他内容 -->\r\n\t\t\t\t\t<view class=\"content\">\r\n\t\t\t\t\t\t<view class=\"cuisine\">\r\n\t\t\t\t\t\t\t<view class=\"title\">选择摊位</view>\r\n\r\n\t\t\t\t\t\t\t<picker class=\"picker1\" :range=\"pickerRange1\" :value=\"selectedCategoryIndex1\"\r\n\t\t\t\t\t\t\t\t@change=\"onMarketChange\">\r\n\t\t\t\t\t\t\t\t<view class=\"picker-text\">{{ pickerRange1[selectedCategoryIndex1]}}</view>\r\n\t\t\t\t\t\t\t</picker>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"editimg\">\r\n\t\t\t\t\t\t\t<view class=\"title\">菜品价格</view>\r\n\t\t\t\t\t\t\t<view class=\"shuru\"><input class=\"shurucon\" type=\"text\" placeholder=\"请输入价格\"\r\n\t\t\t\t\t\t\t\t\tv-model=\"itemPrice\" /></view>\r\n\t\t\t\t\t\t\t<view class=\"unit\">元/</view>\r\n\t\t\t\t\t\t\t<view class=\"example-body\" @click=\"clicKexampleBody\">\r\n\t\t\t\t\t\t\t\t<view class=\"unit\">{{unit?unit:'单位'}}</view>\r\n\t\t\t\t\t\t\t\t<view class=\"icon\"><uni-icons :type=\"iconStatus ? 'up':'down'\" size=\"20\"></uni-icons>\r\n\t\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<view class=\"items\" v-show=\"isShowItems\">\r\n\t\t\t\t\t\t\t\t<view class=\"item\" v-for=\"pop in candidates\" @click=\"selectItem(pop)\">\r\n\t\t\t\t\t\t\t\t\t{{pop}}\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"popup-footer\">\r\n\t\t\t\t\t<button @click=\"closePopup\">取消</button>\r\n\t\t\t\t\t<button @click=\"confirmShelves\" style=\"background-color: #007aff;color: white;\">确认</button>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport {\r\n\t\tapi\r\n\t} from '@/api/index'\r\n\timport usePage from '@/hooks/usePage';\r\n\timport {\r\n\t\tuseUpload\r\n\t} from \"@/hooks/useUpload\"\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tpageData: [],\r\n\t\t\t\tshowEditPopup: false,\r\n\t\t\t\tcurrentItem: {},\r\n\t\t\t\tcategories: [],\r\n\t\t\t\tpickerRange: [],\r\n\t\t\t\tselectedCategoryIndex: 0,\r\n\t\t\t\timageUploaded: false,\r\n\t\t\t\t// imglogo: '',\r\n\t\t\t\tshowEditPopup1: false,\r\n\t\t\t\tshowEditPopup2: false,\r\n\t\t\t\tpickerRange1: [],\r\n\t\t\t\tselectedCategoryIndex1: 0,\r\n\t\t\t\titemDescription: '', // 上架时的详细说明\r\n\t\t\t\titemPrice: '', // 上架时的价格\r\n\t\t\t\tmarketList: [], // 存储摊位列表\r\n\t\t\t\tcandidates: ['斤', '瓶', '桶', '个'],\r\n\t\t\t\tcandidate2: ['元'],\r\n\t\t\t\tunit: '',\r\n\t\t\t\tunit2: '',\r\n\t\t\t\ttijiaoPrice: '',\r\n\t\t\t\tisloaded: false,\r\n\t\t\t\ticonStatus: true,\r\n\t\t\t\tisShowItems: false,\r\n\t\t\t\ttempItem:null\r\n\t\t\t}\r\n\t\t},\r\n\t\tmixins: [usePage],\r\n\t\tonLoad() {\r\n\t\t\tthis.isloaded = true;\r\n\t\t},\r\n\t\tonShow() {\r\n\t\t\tthis.reloadData()\r\n\t\t},\r\n\r\n\t\tmethods: {\r\n\t\t\toperation(item){\r\n\t\t\t\tthis.showEditPopup2 = true\r\n\t\t\t\tthis.tempItem = item\r\n\t\t\t},\r\n\t\t\trouterPush(){\r\n\t\t\t\t// console.log(this.tempItem)\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl:`/subPackages/aHouseholder/Traceability/Traceability?id=${this.tempItem.id}&goodsname=${this.tempItem.goodsname}`\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tasync removeItem() {\r\n\t\t\t\tlet requestsData = {\r\n\t\t\t\t\tid: this.tempItem.id,\r\n\t\t\t\t\tisshow: 2\r\n\t\t\t\t}\r\n\t\t\t\tlet res = await api.editgoods(requestsData)\r\n\t\t\t\tif (res.code == 200) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '删除成功',\r\n\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t})\r\n\t\t\t\t\t// 重新加载数据\r\n\t\t\t\t\tthis.reloadData()\r\n\t\t\t\t\tthis.closePopup()\r\n\t\t\t\t} else {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '删除失败',\r\n\t\t\t\t\t\ticon: 'error'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\t\t\t// 打开选择单位\r\n\t\t\tclicKexampleBody() {\r\n\t\t\t\tthis.iconStatus = !this.iconStatus\r\n\t\t\t\tthis.isShowItems = !this.isShowItems\r\n\t\t\t},\r\n\t\t\t// 选择单位\r\n\t\t\tselectItem(val) {\r\n\t\t\t\tthis.unit = val\r\n\t\t\t\tthis.iconStatus = !this.iconStatus\r\n\t\t\t\tthis.isShowItems = !this.isShowItems\r\n\t\t\t},\r\n\t\t\tfetchCategories() {\r\n\t\t\t\tapi.cglist().then(res => {\r\n\t\t\t\t\tif (res.code === 200) {\r\n\t\t\t\t\t\t// 获取分类数据\r\n\t\t\t\t\t\tconst categories = res.data.listdata.map(item => ({\r\n\t\t\t\t\t\t\tid: item.id,\r\n\t\t\t\t\t\t\tcontent: item.content\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t// 存储分类数据\r\n\t\t\t\t\t\tthis.categories = categories;\r\n\t\t\t\t\t\t// 初始化 picker 的范围数据，包括默认提示项\r\n\t\t\t\t\t\tthis.pickerRange = [...categories.map(category => category.content)];\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tasync fetchMarketList() {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst token = uni.getStorageSync('token'); // 请根据实际情况获取 token\r\n\t\t\t\t\tconst params = {\r\n\t\t\t\t\t\tlimit: 100, // 设置你需要的 limit\r\n\t\t\t\t\t\tpage: 1 // 设置你需要的 page\r\n\t\t\t\t\t};\r\n\t\t\t\t\tconst res = await api.getMyShops({\r\n\t\t\t\t\t\ttoken: this.token,\r\n\t\t\t\t\t\t...params\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (res.code === 200) {\r\n\t\t\t\t\t\tconst marketList = res.data.listdata.map(item => ({\r\n\t\t\t\t\t\t\tid: item.id,\r\n\t\t\t\t\t\t\ttitle: item.title\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t\tthis.marketList = marketList;\r\n\t\t\t\t\t\tthis.pickerRange1 = [...marketList.map(market => market.title)];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconsole.error('Failed to fetch market list:', res.msg);\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error('Error fetching market list:', error);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tonCategoryChange(e) {\r\n\t\t\t\tthis.selectedCategoryIndex = e.detail.value;\r\n\t\t\t\tthis.currentItem.category_id = this.categories[this.selectedCategoryIndex].id;\r\n\t\t\t},\r\n\t\t\tonMarketChange(e) {\r\n\t\t\t\tthis.selectedCategoryIndex1 = e.detail.value;\r\n\t\t\t\tthis.currentItem.market_id = this.marketList[this.selectedCategoryIndex1].id;\r\n\t\t\t},\r\n\t\t\tasync fetchData(params) {\r\n\t\t\t\tconst response = await api.getCommdityList(params)\r\n\t\t\t\treturn response.data\r\n\r\n\t\t\t},\r\n\t\t\t// 你的方法\r\n\t\t\tgoTorelePage() {\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: '/pages/release/release'\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tedit() {\r\n\t\t\t\tthis.currentItem = {\r\n\t\t\t\t\t...this.tempItem\r\n\t\t\t\t};\r\n\t\t\t\tthis.fetchCategories(); // 获取分类数据\r\n\t\t\t\tthis.showEditPopup = true; // 显示弹出层\r\n\t\t\t\t// 调用获取菜品详情的方法\r\n\t\t\t\tthis.fetchCommodityDetails(this.tempItem.id);\r\n\t\t\t\t// 检查用户是否选择了有效的分类（跳过第一个默认项）\r\n\t\t\t},\r\n\t\t\tfetchCommodityDetails(id) {\r\n\t\t\t\tapi.getCommodityDetails(id).then(res => {\r\n\t\t\t\t\tif (res.code === 200) {\r\n\t\t\t\t\t\tconst commodity = res.data.listdata[0];\r\n\t\t\t\t\t\tthis.currentItem.goodsname = commodity.goodsname;\r\n\t\t\t\t\t\tthis.currentItem.imglogo = commodity.imglogo;\r\n\r\n\t\t\t\t\t\t// 根据分类 ID 找到对应的分类索引\r\n\t\t\t\t\t\tconst categoryIndex = this.categories.findIndex(cat => cat.id === commodity.category_id);\r\n\t\t\t\t\t\tif (categoryIndex !== -1) {\r\n\t\t\t\t\t\t\tthis.selectedCategoryIndex = categoryIndex;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tuploadcuisine() {\r\n\t\t\t\tuni.chooseImage({\r\n\t\t\t\t\tcount: 1,\r\n\t\t\t\t\tsizeType: ['original', 'compressed'],\r\n\t\t\t\t\tsourceType: ['album', 'camera'],\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t// const tempFilePaths = res.tempFilePaths;\r\n\t\t\t\t\t\t// this.uploadImage(tempFilePaths[0]);\r\n\t\t\t\t\t\t// this.isImageSelected = true; // 更新图片选择状态\r\n\t\t\t\t\t\tconst tempFilePaths = res.tempFilePaths;\r\n\t\t\t\t\t\tif (tempFilePaths.length > 0) {\r\n\t\t\t\t\t\t\tconsole.log(66676, res.tempFiles[0]);\r\n\t\t\t\t\t\t\tconst {\r\n\t\t\t\t\t\t\t\tupload,\r\n\t\t\t\t\t\t\t\trequest\r\n\t\t\t\t\t\t\t} = useUpload({\r\n\t\t\t\t\t\t\t\tuploadPath: '/group1/upload',\r\n\t\t\t\t\t\t\t\ttempFilePaths: tempFilePaths[0],\r\n\t\t\t\t\t\t\t\tfile: res.tempFiles[0]\r\n\t\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t\tupload().then((res) => {\r\n\t\t\t\t\t\t\t\tres = JSON.parse(res)\r\n\t\t\t\t\t\t\t\tthis.currentItem.imglogo = res.data.url;\r\n\t\t\t\t\t\t\t\t// console.log('更新后的图片路径:', this.currentItem.imglogo);\r\n\t\t\t\t\t\t\t\t// this.isImageSelected = true;\r\n\t\t\t\t\t\t\t\t// this.imageUploaded = true; // 更新图片上传状态\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t// api.uploadImage(tempFilePaths[0])\r\n\t\t\t\t\t\t\t// \t.then(data => {\r\n\t\t\t\t\t\t\t// \t\tthis.user.headimgurl = data.url; // 更新头像 URL\r\n\t\t\t\t\t\t\t// \t})\r\n\t\t\t\t\t\t\t// \t.catch(error => {\r\n\t\t\t\t\t\t\t// \t\tuni.showToast({\r\n\t\t\t\t\t\t\t// \t\t\ttitle: '上传失败',\r\n\t\t\t\t\t\t\t// \t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t// \t\t});\r\n\t\t\t\t\t\t\t// \t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\tshelves() {\r\n\t\t\t\tthis.currentItem = {\r\n\t\t\t\t\t...this.tempItem\r\n\t\t\t\t};\r\n\t\t\t\tconsole.log(this.currentItem)\r\n\t\t\t\tthis.showEditPopup1 = true; // 显示弹出层\r\n\t\t\t\tthis.fetchMarketList(); // 获取摊位列表\r\n\t\t\t},\r\n\t\t\tclosePopup() {\r\n\t\t\t\tthis.showEditPopup = false; // 隐藏弹出层\r\n\t\t\t\tthis.showEditPopup1 = false;\r\n\t\t\t\tthis.showEditPopup2 = false\r\n\t\t\t\t// 清空值\r\n\t\t\t\tthis.itemPrice = ''\r\n\t\t\t},\r\n\t\t\t//确认事件\r\n\t\t\tconfirmEdit() {\r\n\t\t\t\t// 在这里处理修改的确认逻辑\r\n\t\t\t\t// 检查当前商品 ID 是否有效\r\n\t\t\t\tif (!this.currentItem.id) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '商品 ID 不正确',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 检查图片上传状态或显示上传错误\r\n\t\t\t\tif (!this.imageUploaded && !this.currentItem.imglogo) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '请上传图片',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 调用 editGoods API 进行修改\r\n\t\t\t\tconst {\r\n\t\t\t\t\tid,\r\n\t\t\t\t\tcategory_id,\r\n\t\t\t\t\tgoodsname,\r\n\t\t\t\t\timglogo\r\n\t\t\t\t} = this.currentItem;\r\n\t\t\t\tapi.editGoods({\r\n\t\t\t\t\tid,\r\n\t\t\t\t\tcategory_id,\r\n\t\t\t\t\tgoodsname,\r\n\t\t\t\t\timglogo\r\n\t\t\t\t}).then(res => {\r\n\t\t\t\t\tif (res.code === 200) {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '商品修改成功',\r\n\t\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthis.reloadData(); // 重新加载数据\r\n\t\t\t\t\t\tthis.closePopup(); // 关闭弹出层\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: res.msg || '商品修改失败',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\tconfirmShelves() {\r\n\t\t\t\tconsole.log('Goods ID:', this.currentItem.id);\r\n\r\n\t\t\t\tif (!this.itemPrice) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '请填写价格',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (!this.unit) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '请选择单位',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tapi.addCommodityToShop({\r\n\t\t\t\t\tgoods_id: this.currentItem.id,\r\n\t\t\t\t\tshop_id: this.marketList[this.selectedCategoryIndex1].id,\r\n\t\t\t\t\tcontent: this.itemDescription,\r\n\t\t\t\t\tprice: parseFloat(this.itemPrice),\r\n\t\t\t\t\tweight_name: this.unit\r\n\t\t\t\t}).then(res => {\r\n\t\t\t\t\tif (res.code === 200) {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '上架成功'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthis.closePopup();\r\n\t\t\t\t\t\tthis.reloadData();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '上架失败',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t.items {\r\n\t\tborder-radius: 5rpx;\r\n\t\tz-index: 10000;\r\n\t\tposition: absolute;\r\n\t\ttop: 232rpx;\r\n\t\tleft: 468rpx;\r\n\t\twidth: 15%;\r\n\t\tpadding: 10rpx;\r\n\t\tbackground-color: white;\r\n\t\tborder: 1px solid gray;\r\n\t}\r\n\r\n\t.item {\r\n\t\twidth: 100%;\r\n\t\tborder-bottom: 1px dashed gray;\r\n\t}\r\n\r\n\t.me-container {\r\n\t\t/* overflow: hidden; */\r\n\t\twidth: 100%;\r\n\t\tbox-sizing: border-box;\r\n\t\tpadding: 0rpx 40rpx 0 40rpx;\r\n\t\tcolor: white;\r\n\t\tz-index: 1;\r\n\t\tbackground-color: #f8f8f8;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tjustify-content: flex-start;\r\n\t\tposition: relative;\r\n\t\theight: calc(100vh - 10rpx);\r\n\t}\r\n\r\n\t.butt {\r\n\t\tposition: fixed;\r\n\t\tbottom: 20rpx;\r\n\t\tright: 20rpx;\r\n\t\tpadding: 30rpx 30rpx;\r\n\t\tbackground-color: #007BFF;\r\n\t\tcolor: white;\r\n\t\tborder: none;\r\n\t\tborder-radius: 5px;\r\n\t\tcursor: pointer;\r\n\t\tbox-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\r\n\t\tz-index: 1000;\r\n\t}\r\n\r\n\t.disheslist {\r\n\t\twidth: 100%;\r\n\t\theight: 1200rpx;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tmargin-top: 20rpx;\r\n\t}\r\n\r\n\t.type {\r\n\t\tpadding: 10rpx;\r\n\t\theight: 12%;\r\n\t\t/* width: 90%; */\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: row;\r\n\t\tbackground-color: white;\r\n\t\tjustify-content: flex-start;\r\n\t\talign-items: center;\r\n\t\tmargin-bottom: 30rpx;\r\n\t\tbox-shadow: 5rpx 5rpx 5rpx rgba(0, 0, 0, .3);\r\n\t\tborder-radius: 5rpx;\r\n\t}\r\n\r\n\t.type-image {\r\n\t\theight: 130rpx;\r\n\t\twidth: 130rpx;\r\n\t\tborder-radius: 20rpx;\r\n\t\tbackground-color: #007aff;\r\n\t}\r\n\r\n\t.regard {\r\n\t\twidth: 30%;\r\n\t\theight: 180rpx;\r\n\t\tcolor: black;\r\n\t\tfont-size: 30rpx;\r\n\t\tposition: relative;\r\n\t\ttop: 60rpx;\r\n\t\tleft: 20rpx;\r\n\t}\r\n\r\n\r\n\r\n\t/* .price {\r\n\t\talign-self: self-start;\r\n\t} */\r\n\t.function {\r\n\t\tdisplay: flex;\r\n\t\theight: 100%;\r\n\t\twidth: 250rpx;\r\n\t\tmargin-left: auto;\r\n\t\tjustify-content: space-around;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.rigicon {\r\n\t\tfont-weight: bold;\r\n\t\tfont-size: 25rpx;\r\n\t\theight: 70rpx;\r\n\t\twidth: 150rpx;\r\n\t\tbackground-color: #007aff;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tborder-radius: 20rpx;\r\n\t\tmargin-left: 5rpx;\r\n\t}\r\n\r\n\t.loading {\r\n\t\ttext-align: center;\r\n\t\tpadding: 20rpx;\r\n\t\tcolor: #999;\r\n\t}\r\n\r\n\r\n\t.popup-overlay {\r\n\t\tposition: fixed;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tbackground-color: rgba(0, 0, 0, 0.5);\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tz-index: 1000;\r\n\t\tcolor: black;\r\n\t}\r\n\r\n\t.popup {\r\n\t\tposition: relative;\r\n\t\twidth: 80%;\r\n\t\tmax-width: 600rpx;\r\n\t\tbackground-color: white;\r\n\t\tborder-radius: 20rpx;\r\n\t\tpadding: 20rpx;\r\n\t\tbox-shadow: 0 0 15px rgba(0, 0, 0, 0.2);\r\n\t}\r\n\r\n\t.popup-header {\r\n\t\tfont-size: 36rpx;\r\n\t\tfont-weight: bold;\r\n\t\tmargin-bottom: 20rpx;\r\n\t\ttext-align: center;\r\n\t}\r\n\r\n\t.popup-content {\r\n\t\t/* 这里你可以添加弹出层内容的样式 */\r\n\t\tdisplay: flex;\r\n\t\twidth: 100%;\r\n\t\tpadding: 30rpx;\r\n\t\tbox-sizing: border-box;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.popup-footer {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\tmargin-top: 10rpx;\r\n\t}\r\n\r\n\t.close-button {\r\n\t\tpadding: 10rpx;\r\n\t\tposition: absolute;\r\n\t\ttop: 10rpx;\r\n\t\tright: 10rpx;\r\n\t\tfont-size: 50rpx;\r\n\t\tcolor: black;\r\n\t\tcursor: pointer;\r\n\t\tz-index: 10;\r\n\t\twidth: 50rpx;\r\n\t\theight: 50rpx;\r\n\t\ttext-align: center;\r\n\t\tline-height: 45rpx;\r\n\t\tbackground-color: #ffffff;\r\n\t\tborder-radius: 50%;\r\n\t\tbox-shadow: 0 0 10rpx rgba(0, 0, 0, 0.1);\r\n\t}\r\n\r\n\t.content {\r\n\t\twidth: 100%;\r\n\t\theight: 300rpx;\r\n\t}\r\n\r\n\t.cuisine {\r\n\t\twidth: 100%;\r\n\t\theight: 100rpx;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.class {\r\n\t\twidth: 100%;\r\n\t\theight: 100rpx;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.editimg {\r\n\t\twidth: 100%;\r\n\t\theight: 100rpx;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.cimg {\r\n\t\twidth: 100rpx;\r\n\t\theight: 100rpx;\r\n\t}\r\n\r\n\t.picker {\r\n\t\twidth: 100rpx;\r\n\t\theight: 100rpx;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: end;\r\n\t\talign-items: center;\r\n\t\tfont-size: 35rpx;\r\n\t}\r\n\r\n\t.shuru {\r\n\t\twidth: auto;\r\n\t\theight: 100rpx;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: end;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.example-body {\r\n\t\tborder-radius: 10rpx;\r\n\t\tpadding: 10rpx;\r\n\t\tmargin: 10rpx 0 0 20rpx;\r\n\t\tborder: 1px solid gray;\r\n\t\tbackground-color: white;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\tmin-width: 100rpx;\r\n\t}\r\n\r\n\t.unit {\r\n\t\tfont-size: 28rpx;\r\n\t}\r\n\r\n\t.shurucon {\r\n\t\ttext-align: end;\r\n\t\tfont-size: 30rpx;\r\n\t}\r\n\r\n\t.title {\r\n\t\twidth: 40%;\r\n\t\tfont-size: 30rpx;\r\n\t}\r\n\r\n\t.picker1 {\r\n\t\twidth: 300rpx;\r\n\t\theight: 100rpx;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: end;\r\n\t\talign-items: center;\r\n\t\tfont-size: 30rpx;\r\n\t}\r\n</style>","import MiniProgramPage from 'E:/小程序转app/xcbapp/pages/publish/publish.vue'\nwx.createPage(MiniProgramPage)"],"names":["usePage","uni","api","useUpload","res"],"mappings":"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"}