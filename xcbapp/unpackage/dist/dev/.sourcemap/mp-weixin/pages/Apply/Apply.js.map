{"version":3,"file":"Apply.js","sources":["pages/Apply/Apply.vue","D:/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvQXBwbHkvQXBwbHkudnVl"],"sourcesContent":["<template>\r\n\t<view class=\"me-container\">\r\n\t\t<!-- 基本信息卡片 -->\r\n\t\t<view class=\"form-card\">\r\n\t\t\t<view class=\"section-title\">\r\n\t\t\t\t<text class=\"title-icon\">｜</text>\r\n\t\t\t\t<text class=\"title-text\">基本信息</text>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<view class=\"item-label\">\r\n\t\t\t\t\t<uni-icons type=\"person\" size=\"18\" color=\"#666\" />\r\n\t\t\t\t\t<text>联系人</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<input class=\"form-input\" v-model=\"contactpeople\" placeholder=\"请输入联系人姓名\"\r\n\t\t\t\t\tplaceholder-style=\"color: #c0c4cc\" />\r\n\t\t\t</view>\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<view class=\"item-label\">\r\n\t\t\t\t\t<uni-icons type=\"phone\" size=\"18\" color=\"#666\" />\r\n\t\t\t\t\t<text>联系电话</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<input class=\"form-input\" v-model=\"contactphone\" type=\"number\" placeholder=\"请输入联系人电话\"\r\n\t\t\t\t\tplaceholder-style=\"color: #c0c4cc\" />\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\r\n\t\t<view class=\"form-card\">\r\n\t\t\t<view class=\"section-title\">\r\n\t\t\t\t<text class=\"title-icon\">｜</text>\r\n\t\t\t\t<text class=\"title-text\">所在地</text>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"form-item picker-item compact\">\r\n\t\t\t\t<view class=\"item-label\">\r\n\t\t\t\t\t<uni-icons type=\"location\" size=\"18\" color=\"#666\" />\r\n\t\t\t\t\t<text>所在地区</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<picker mode=\"multiSelector\" :range=\"multiArray\" :value=\"multiIndex\" @change=\"bindMultiPickerChange\"\r\n\t\t\t\t\t@columnchange=\"bindMultiPickerColumnChange\">\r\n\t\t\t\t\t<view class=\"compact-picker\">\r\n\t\t\t\t\t\t<view>\r\n\t\t\t\t\t\t\t<text class=\"province\">{{ multiArray[0][multiIndex[0]] || '省' }}</text>\r\n\t\t\t\t\t\t\t<text class=\"separator\">/</text>\r\n\t\t\t\t\t\t\t<text class=\"city\">{{ multiArray[1][multiIndex[1]] || '市' }}</text>\r\n\t\t\t\t\t\t\t<text class=\"separator\">/</text>\r\n\t\t\t\t\t\t\t<text class=\"district\">{{ multiArray[2][multiIndex[2]] || '区' }}</text>\r\n\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t<view>\r\n\t\t\t\t\t\t\t<uni-icons type=\"arrowright\" size=\"18\" color=\"#999\" />\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</picker>\r\n\t\t\t</view>\r\n\r\n\r\n\t\t\t<view class=\"form-item picker-item\">\r\n\t\t\t\t<view class=\"item-label\">\r\n\t\t\t\t\t<uni-icons type=\"flag\" size=\"18\" color=\"#666\" />\r\n\t\t\t\t\t<text>选择菜市场</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<picker mode=\"selector\" :range=\"marketList\" :value=\"selectedMarketIndex\" @change=\"bindMarketChange\">\r\n\t\t\t\t\t<view class=\"picker-content\">\r\n\t\t\t\t\t\t<text class=\"picker-text\">{{ marketList[selectedMarketIndex] || '请选择菜市场' }}</text>\r\n\t\t\t\t\t\t<uni-icons type=\"arrowright\" size=\"18\" color=\"#999\" />\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</picker>\r\n\t\t\t</view>\r\n\r\n\t\t</view>\r\n\r\n\r\n\t\t<!-- 摊铺信息卡片 -->\r\n\t\t<view class=\"form-card\">\r\n\t\t\t<view class=\"section-title\">\r\n\t\t\t\t<text class=\"title-icon\">｜</text>\r\n\t\t\t\t<text class=\"title-text\">摊铺信息</text>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 摊铺名称 -->\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<view class=\"item-label\">\r\n\t\t\t\t\t<uni-icons type=\"shop\" size=\"18\" color=\"#666\" />\r\n\t\t\t\t\t<text>摊铺名称</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<input class=\"form-input\" v-model=\"title\" placeholder=\"请输入摊铺名称\" placeholder-style=\"color: #c0c4cc\" />\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 地区选择 -->\r\n\r\n\t\t\t<!-- 类目选择 -->\r\n\t\t\t<view class=\"form-item picker-item\">\r\n\t\t\t\t<view class=\"item-label\">\r\n\t\t\t\t\t<uni-icons type=\"list\" size=\"18\" color=\"#666\" />\r\n\t\t\t\t\t<text>所售类目</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<picker mode=\"selector\" :range=\"categoryList\" @change=\"bindCategoryChange\">\r\n\t\t\t\t\t<view class=\"picker-content\">\r\n\t\t\t\t\t\t<text class=\"picker-text\">{{ selectedCategory || '请选择经营类目' }}</text>\r\n\t\t\t\t\t\t<uni-icons type=\"arrowright\" size=\"18\" color=\"#999\" />\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</picker>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 摊主电话 -->\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<view class=\"item-label\">\r\n\t\t\t\t\t<uni-icons type=\"phone\" size=\"18\" color=\"#666\" />\r\n\t\t\t\t\t<text>摊主电话</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<input class=\"form-input\" v-model=\"phone\" type=\"number\" placeholder=\"请输入摊主联系电话\"\r\n\t\t\t\t\tplaceholder-style=\"color: #c0c4cc\" />\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 图片上传 -->\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<view class=\"item-label\">\r\n\t\t\t\t\t<uni-icons type=\"image\" size=\"18\" color=\"#666\" />\r\n\t\t\t\t\t<text>摊位图片</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"upload-btn\" :class=\"{ 'uploaded': isImageSelected }\" @tap=\"chooseImage\">\r\n\t\t\t\t\t<uni-icons :type=\"isImageSelected ? 'checkmarkempty' : 'plusempty'\" size=\"24\"\r\n\t\t\t\t\t\t:color=\"isImageSelected ? '#67C23A' : '#999'\" />\r\n\t\t\t\t\t<text>{{ isImageSelected ? '已上传' : '点击上传' }}</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 提交按钮 -->\r\n\t\t<view class=\"submit-wrapper\">\r\n\t\t\t<button class=\"submit-btn\" :class=\"{ 'disabled': isSubmitting }\" @click=\"submitForm\">\r\n\t\t\t\t{{ isSubmitting ? '提交中...' : '立即提交' }}\r\n\t\t\t\t<text class=\"loading-icon\" v-if=\"isSubmitting\">◌</text>\r\n\t\t\t</button>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport {\r\n\t\tapi,\r\n\t\tUPLOAD_URL\r\n\t} from '../../api/index.js';\r\n\timport {\r\n\t\tuseUpload\r\n\t} from \"@/hooks/useUpload\"\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tmultiArray: [\r\n\t\t\t\t\t[],\r\n\t\t\t\t\t[],\r\n\t\t\t\t\t[]\r\n\t\t\t\t],\r\n\t\t\t\tmultiIndex: [0, 0, 0],\r\n\t\t\t\tcategoryList: ['请选择分类'],\r\n\t\t\t\tcategoryIdMap: {}, // 分类名称到ID的映射\r\n\t\t\t\tselectedCategory: '请选择分类',\r\n\t\t\t\tprovinceList: [],\r\n\t\t\t\tcityList: [],\r\n\t\t\t\tdistrictList: [],\r\n\t\t\t\tmarketList: [], // 添加市场列表\r\n\t\t\t\tmarketIdMap: {}, // 菜市场名称到ID的映射\r\n\t\t\t\tselectedMarketIndex: 0, // 记录当前选择的市场索引\r\n\t\t\t\tcontactpeople: '',\r\n\t\t\t\tcontactphone: '',\r\n\t\t\t\ttitle: '',\r\n\t\t\t\tlogo: '', // 摊位图片\r\n\t\t\t\tphone: '',\r\n\t\t\t\tcontent: '',\r\n\t\t\t\tarea_id: null,\r\n\t\t\t\tmarket_id: null,\r\n\t\t\t\tcategory_id: null,\r\n\t\t\t\tisSubmitting: false,\r\n\t\t\t\tbusinessLicense: '', // 营业执照\r\n\t\t\t\tisImageSelected: false\r\n\t\t\t};\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\tthis.initializePicker();\r\n\t\t\tthis.fetchCategories();\r\n\t\t\tthis.fetchMarkets(); // 获取市场列表\r\n\t\t},\r\n\t\tonShow() {\r\n\t\t\tif (this.checkToken()) {\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: '/pages/login/login'\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t// 检查是否token存在，存在则已登陆\r\n\t\t\tcheckToken() {\r\n\t\t\t\tconst token = uni.getStorageSync('token');\r\n\t\t\t\tif (!token) {\r\n\t\t\t\t\treturn true\r\n\t\t\t\t}\r\n\t\t\t\treturn false\r\n\t\t\t},\r\n\t\t\t// 返回上一页\r\n\t\t\tasync customizeBack() {\r\n\t\t\t\tlet canNavBack = await getCurrentPages()\r\n\t\t\t\tif (canNavBack && canNavBack.length > 1) {\r\n\t\t\t\t\tuni.navigateBack()\r\n\t\t\t\t} else {\r\n\t\t\t\t\thistory.back();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tasync initializePicker() {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst provinces = await this.fetchProvinces();\r\n\t\t\t\t\tthis.multiArray[0] = provinces.map(item => item.name);\r\n\t\t\t\t\tconst cities = await this.fetchCities(provinces[0].id);\r\n\t\t\t\t\tthis.multiArray[1] = cities.map(item => item.name);\r\n\t\t\t\t\tconst areas = await this.fetchAreas(cities[0].id);\r\n\t\t\t\t\tthis.multiArray[2] = areas.map(item => item.name);\r\n\t\t\t\t\tthis.multiIndex = [0, 0, 0];\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error('Failed to initialize picker:', error);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tasync fetchProvinces() {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst response = await api.citylist({\r\n\t\t\t\t\t\tlevel: 1,\r\n\t\t\t\t\t\tlimit: 100\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (response.code === 200) {\r\n\t\t\t\t\t\tthis.provinceList = response.data.listdata;\r\n\t\t\t\t\t\treturn this.provinceList;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthrow new Error('Failed to fetch provinces');\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error('Failed to fetch provinces:', error);\r\n\t\t\t\t\tthrow error;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tasync fetchCities(provinceId) {\r\n\t\t\t\t// console.log('Fetching cities for provinceId:', provinceId);\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst response = await api.citytree(provinceId);\r\n\t\t\t\t\t// console.log('Cities API response:', response);\r\n\t\t\t\t\tif (response.code === 200 && Array.isArray(response.data)) {\r\n\t\t\t\t\t\treturn response.data; // Assuming response.data is the array of cities\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconsole.error('No cities data found');\r\n\t\t\t\t\t\treturn [];\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error('Failed to fetch cities:', error);\r\n\t\t\t\t\treturn [];\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tasync fetchAreas(cityId) {\r\n\t\t\t\t// console.log('Fetching areas for cityId:', cityId);\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst response = await api.citytree(cityId);\r\n\t\t\t\t\t// console.log('Areas API response:', response);\r\n\t\t\t\t\tif (response.code === 200 && Array.isArray(response.data)) {\r\n\t\t\t\t\t\treturn response.data; // Assuming response.data is the array of areas\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconsole.error('No areas data found');\r\n\t\t\t\t\t\treturn [];\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error('Failed to fetch areas:', error);\r\n\t\t\t\t\treturn [];\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbindMultiPickerChange(e) {\r\n\t\t\t\tthis.multiIndex = e.detail.value;\r\n\t\t\t\tconst selectedProvince = this.multiArray[0][this.multiIndex[0]];\r\n\t\t\t\tconst selectedCity = this.multiArray[1][this.multiIndex[1]];\r\n\t\t\t\tconst selectedArea = this.multiArray[2][this.multiIndex[2]];\r\n\t\t\t\tconst selectedAreaId = this.districtList[this.multiIndex[2]].id;\r\n\t\t\t\tconsole.log('选择的省市区:', selectedProvince, selectedCity, selectedArea);\r\n\t\t\t\tthis.area_id = selectedAreaId;\r\n\t\t\t\tthis.fetchMarkets(selectedAreaId);\r\n\t\t\t},\r\n\t\t\tasync bindMultiPickerColumnChange(e) {\r\n\t\t\t\tconst column = e.detail.column;\r\n\t\t\t\tconst value = e.detail.value;\r\n\t\t\t\tthis.multiIndex[column] = value;\r\n\r\n\t\t\t\tif (column === 0) {\r\n\t\t\t\t\tconst provinceId = this.provinceList[value].id;\r\n\t\t\t\t\tconst cities = await this.fetchCities(provinceId);\r\n\t\t\t\t\tthis.cityList = cities;\r\n\t\t\t\t\tthis.multiArray[1] = cities.map(item => item.name);\r\n\t\t\t\t\tthis.multiArray[2] = cities ? cities[0].Children.map(item => item.name):[];\r\n\t\t\t\t\tthis.multiIndex[1] = 0;\r\n\t\t\t\t\tthis.multiIndex[2] = 0;\r\n\t\t\t\t} else if (column === 1) {\r\n\t\t\t\t\tconst cityId = this.cityList[value].id;\r\n\t\t\t\t\tconst areas = await this.fetchAreas(cityId);\r\n\t\t\t\t\tthis.districtList = areas;\r\n\t\t\t\t\tthis.multiArray[2] = areas.map(item => item.name);\r\n\t\t\t\t\tthis.multiIndex[2] = 0;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.multiIndex = [...this.multiIndex];\r\n\t\t\t},\r\n\r\n\t\t\tasync fetchMarkets(areaId) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst Limit = 100;\r\n\t\t\t\t\tconst response = await api.marketlist(areaId, Limit); // 传递实际的 areaId\r\n\t\t\t\t\t// console.log('Market API response:', response); // 打印响应数据\r\n\t\t\t\t\tif (response.code === 200) {\r\n\t\t\t\t\t\tthis.marketData = response.data.listdata;\r\n\t\t\t\t\t\tthis.marketList = response.data.listdata.map(item => item.marketname);\r\n\t\t\t\t\t\tthis.marketIdMap = this.marketData.reduce((map, item) => {\r\n\t\t\t\t\t\t\tmap[item.marketname] = item.id;\r\n\r\n\t\t\t\t\t\t\treturn map;\r\n\t\t\t\t\t\t}, {});\r\n\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconsole.error('Failed to fetch markets:', response.message);\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error('Failed to fetch markets:', error);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tbindMarketChange(e) {\r\n\t\t\t\tthis.selectedMarketIndex = e.detail.value;\r\n\t\t\t\tconst selectedMarketName = this.marketList[this.selectedMarketIndex];\r\n\t\t\t\tthis.market_id = this.marketIdMap[selectedMarketName] || null;\r\n\t\t\t},\r\n\r\n\t\t\tasync fetchCategories() {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst response = await api.cglist();\r\n\t\t\t\t\tif (response.code === 200) {\r\n\t\t\t\t\t\tconst categories = response.data.listdata;\r\n\t\t\t\t\t\tthis.categoryList = ['请选择分类', ...categories.map(item => item.title)];\r\n\t\t\t\t\t\tthis.categoryIdMap = categories.reduce((map, item) => {\r\n\t\t\t\t\t\t\tmap[item.title] = item.id;\r\n\t\t\t\t\t\t\treturn map;\r\n\t\t\t\t\t\t}, {});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthrow new Error('Failed to fetch categories');\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error('Failed to fetch categories:', error);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbindCategoryChange(e) {\r\n\t\t\t\tconst selectedIndex = e.detail.value;\r\n\t\t\t\tthis.selectedCategory = this.categoryList[selectedIndex];\r\n\t\t\t\tthis.category_id = this.categoryIdMap[this.selectedCategory];\r\n\t\t\t},\r\n\r\n\t\t\t// 摊位图片上传\r\n\t\t\tchooseImage() {\r\n\t\t\t\tuni.chooseImage({\r\n\t\t\t\t\tcount: 1,\r\n\t\t\t\t\tsizeType: ['compressed', 'original'],\r\n\t\t\t\t\tsourceType: ['album', 'camera'],\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tconst tempFilePaths = res.tempFilePaths;\r\n\t\t\t\t\t\tif (tempFilePaths.length > 0) {\r\n\t\t\t\t\t\t\tconst {\r\n\t\t\t\t\t\t\t\tupload,\r\n\t\t\t\t\t\t\t\trequest\r\n\t\t\t\t\t\t\t} = useUpload({\r\n\t\t\t\t\t\t\t\tuploadPath: '/group1/upload',\r\n\t\t\t\t\t\t\t\ttempFilePaths: tempFilePaths[0],\r\n\t\t\t\t\t\t\t\tfile: res.tempFiles[0]\r\n\t\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t\tupload().then((res) => {\r\n\t\t\t\t\t\t\t\tvar obj = JSON.parse(res);\r\n\t\t\t\t\t\t\t\t// console.log(obj.data);\r\n\t\t\t\t\t\t\t\tthis.logo = UPLOAD_URL + obj.data.path;\r\n\t\t\t\t\t\t\t\tthis.isImageSelected = true;\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\r\n\r\n\t\t\tasync submitForm() {\r\n\t\t\t\tif (this.isSubmitting) return; // 如果正在提交，直接返回\r\n\t\t\t\tif (!this.contactpeople || !this.contactphone || !this.title || !this.phone || !this\r\n\t\t\t\t\t.area_id || !this.market_id || !this.category_id || !this.logo) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '请填写完整的信息',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.isSubmitting = true; // 设置为正在提交状态\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst formData = {\r\n\t\t\t\t\t\tcontactpeople: this.contactpeople,\r\n\t\t\t\t\t\tcontactphone: this.contactphone,\r\n\t\t\t\t\t\ttitle: this.title,\r\n\t\t\t\t\t\tlogo: this.logo, // 取第一个上传的图片作为logo\r\n\t\t\t\t\t\tphone: this.phone,\r\n\t\t\t\t\t\tcontent: this.content,\r\n\t\t\t\t\t\tarea_id: this.area_id,\r\n\t\t\t\t\t\tmarket_id: this.market_id,\r\n\t\t\t\t\t\tcategory_id: this.category_id,\r\n\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tconst response = await api.addshop(formData);\r\n\r\n\t\t\t\t\tif (response.code === 200) {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '摊位申请成功',\r\n\t\t\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t// 清空表单或进行其他操作\r\n\t\t\t\t\t\t// 返回上一页\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tthis.customizeBack()\r\n\t\t\t\t\t\t}, 2000)\r\n\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: response.msg || '提交失败',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error('提交失败:', error);\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '提交失败',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t} finally {\r\n\t\t\t\t\tthis.isSubmitting = false; // 提交完成，重置状态\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n</script>\r\n\r\n\r\n<style lang=\"scss\" scoped>\r\n\t.compact-picker {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\tfont-size: 28rpx;\r\n\t\t\r\n\t}\r\n\r\n\t.me-container {\r\n\t\tpadding: 30rpx;\r\n\t\tbackground-color: #f8f8f8;\r\n\t\tmin-height: 100vh;\r\n\t}\r\n\r\n\t.form-card {\r\n\t\tbackground: white;\r\n\t\tborder-radius: 16rpx;\r\n\t\tpadding: 0 30rpx 30rpx;\r\n\t\tmargin-bottom: 30rpx;\r\n\t\tbox-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.04);\r\n\r\n\t\t.section-title {\r\n\t\t\tpadding: 30rpx 0;\r\n\t\t\tborder-bottom: 2rpx solid #eee;\r\n\t\t\tmargin-bottom: 20rpx;\r\n\r\n\t\t\t.title-icon {\r\n\t\t\t\tcolor: #409EFF;\r\n\t\t\t\tmargin-right: 12rpx;\r\n\t\t\t}\r\n\r\n\t\t\t.title-text {\r\n\t\t\t\tfont-size: 34rpx;\r\n\t\t\t\tfont-weight: 600;\r\n\t\t\t\tcolor: #333;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t.form-item {\r\n\t\tpadding: 25rpx 0;\r\n\t\tborder-bottom: 1rpx solid #f5f5f5;\r\n\r\n\t\t.item-label {\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t\tmargin-bottom: 20rpx;\r\n\t\t\tfont-size: 28rpx;\r\n\t\t\tcolor: #666;\r\n\r\n\t\t\tuni-icons {\r\n\t\t\t\tmargin-right: 12rpx;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.form-input {\r\n\t\t\theight: 80rpx;\r\n\t\t\tfont-size: 30rpx;\r\n\t\t\tcolor: #333;\r\n\t\t\tpadding: 0 20rpx;\r\n\t\t\tbackground: #f8f8f8;\r\n\t\t\tborder-radius: 8rpx;\r\n\t\t}\r\n\t}\r\n\r\n\t.picker-item {\r\n\t\t.picker-content {\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: space-between;\r\n\t\t\talign-items: center;\r\n\t\t\tpadding: 20rpx 0;\r\n\r\n\t\t\t.picker-text {\r\n\t\t\t\tfont-size: 30rpx;\r\n\t\t\t\tcolor: #333;\r\n\t\t\t\tflex: 1;\r\n\t\t\t\tmargin-right: 20rpx;\r\n\r\n\t\t\t\t&:empty::after {\r\n\t\t\t\t\tcontent: '请选择';\r\n\t\t\t\t\tcolor: #c0c4cc;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t.upload-btn {\r\n\t\tdisplay: inline-flex;\r\n\t\talign-items: center;\r\n\t\tpadding: 16rpx 32rpx;\r\n\t\tborder: 2rpx dashed #ddd;\r\n\t\tborder-radius: 8rpx;\r\n\t\ttransition: all 0.3s;\r\n\r\n\t\t&.uploaded {\r\n\t\t\tborder-color: #67C23A;\r\n\t\t\tbackground: #f0f9eb;\r\n\t\t}\r\n\r\n\t\tuni-icons {\r\n\t\t\tmargin-right: 12rpx;\r\n\t\t}\r\n\r\n\t\ttext {\r\n\t\t\tfont-size: 28rpx;\r\n\t\t\tcolor: #666;\r\n\t\t}\r\n\t}\r\n\r\n\t.submit-wrapper {\r\n\t\tmargin-top: 60rpx;\r\n\t\tpadding: 0 30rpx;\r\n\r\n\t\t.submit-btn {\r\n\t\t\tbackground: linear-gradient(45deg, #409EFF, #64b5f6);\r\n\t\t\tcolor: white;\r\n\t\t\theight: 88rpx;\r\n\t\t\tline-height: 88rpx;\r\n\t\t\tborder-radius: 44rpx;\r\n\t\t\tfont-size: 34rpx;\r\n\t\t\tletter-spacing: 2rpx;\r\n\t\t\ttransition: opacity 0.3s;\r\n\r\n\t\t\t&.disabled {\r\n\t\t\t\topacity: 0.7;\r\n\t\t\t\tbackground: #c0c4cc;\r\n\t\t\t}\r\n\r\n\t\t\t.loading-icon {\r\n\t\t\t\tdisplay: inline-block;\r\n\t\t\t\tmargin-left: 15rpx;\r\n\t\t\t\tanimation: rotate 1s linear infinite;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t@keyframes rotate {\r\n\t\tfrom {\r\n\t\t\ttransform: rotate(0deg);\r\n\t\t}\r\n\r\n\t\tto {\r\n\t\t\ttransform: rotate(360deg);\r\n\t\t}\r\n\t}\r\n</style>","import MiniProgramPage from 'E:/小程序转app/xcbapp/pages/Apply/Apply.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","api","useUpload","res","UPLOAD_URL"],"mappings":"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"}