{"version":3,"file":"merchantComplaints.js","sources":["pages/merchantComplaints/merchantComplaints.vue","D:/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbWVyY2hhbnRDb21wbGFpbnRzL21lcmNoYW50Q29tcGxhaW50cy52dWU"],"sourcesContent":["<template>\r\n\t<view class=\"complaint-container\">\r\n\t\t<!-- 头部 -->\r\n\t\t<view class=\"complaint-header\">\r\n\t\t\t<text class=\"title\">提交投诉</text>\r\n\t\t\t<text class=\"subtitle\">请补充投诉“{{query.title}}”的具体依据</text>\r\n\t\t</view>\r\n\r\n\t\t<!-- 表单主体 -->\r\n\t\t<view class=\"complaint-form\">\r\n\t\t\t<!-- 投诉类型 -->\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<text class=\"item-label\">投诉标题<text class=\"required\">*</text></text>\r\n\t\t\t\t<input v-model=\"formData.title\" placeholder=\"请简述一下您遇到的问题\"\r\n\t\t\t\t\tstyle=\"background-color: #F8F9FA; padding: 30rpx; font-size: 28rpx;\" />\r\n\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 投诉描述 -->\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<text class=\"item-label\">投诉描述<text class=\"required\">*</text></text>\r\n\t\t\t\t<textarea v-model=\"formData.content\" placeholder=\"请详细描述遇到的问题（建议包含时间、地点、具体经过）\" class=\"content-input\"\r\n\t\t\t\t\tmaxlength=\"500\" />\r\n\t\t\t\t<view class=\"word-counter\">\r\n\t\t\t\t\t{{ formData.content.length }}/500\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 上传凭证 -->\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<text class=\"item-label\">上传凭证</text>\r\n\t\t\t\t<view class=\"upload-area\">\r\n\t\t\t\t\t<view class=\"upload-card\" @click=\"selectImage\">\r\n\t\t\t\t\t\t<uni-icons type=\"plusempty\" size=\"36\" color=\"#7A9D7E\" />\r\n\t\t\t\t\t\t<text class=\"upload-tip\">请选择上传图片</text>\r\n\t\t\t\t\t\t<text class=\"upload-subtip\">最多6张图片</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<!-- \t\t\t\t\t<uni-file-picker v-model=\"formData.files\" fileMediatype=\"image\" limit=\"6\"\r\n\t\t\t\t\t\t@select=\"handleFileSelect\">\r\n\t\t\t\t\t</uni-file-picker> -->\r\n\r\n\t\t\t\t\t<view class=\"preview-grid\" v-if=\"fileList.length > 0\">\r\n\t\t\t\t\t\t<view v-for=\"(file, index) in fileList\" :key=\"index\" class=\"preview-item\">\r\n\t\t\t\t\t\t\t<image :src=\"file.data.url\" class=\"preview-image\" mode=\"aspectFill\" />\r\n\t\t\t\t\t\t\t<uni-icons type=\"close\" size=\"18\" class=\"delete-icon\" @click=\"removeFile(index)\" />\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 联系电话 -->\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<text class=\"item-label\">联系电话<text class=\"required\">*</text></text>\r\n\t\t\t\t<view class=\"phone-input\">\r\n\t\t\t\t\t<uni-icons type=\"phone\" size=\"20\" color=\"#7A9D7E\" />\r\n\t\t\t\t\t<input v-model=\"formData.phone\" type=\"number\" placeholder=\"请输入您的手机号码\" maxlength=\"11\" />\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 提交按钮 -->\r\n\t\t<view class=\"submit-area\">\r\n\t\t\t<button class=\"submit-btn\" @click=\"handleSubmit\">\r\n\t\t\t\t立即提交\r\n\t\t\t</button>\r\n\t\t\t<text class=\"agreement-tip\">提交之后工作人员将在两个小时之后联系您，请保持通话正常</text>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport {\r\n\t\tapi,\r\n\t\tUPLOAD_URL\r\n\t} from '../../api/index.js';\r\n\timport {\r\n\t\tuseUpload\r\n\t} from \"@/hooks/useUpload\"\r\n\timport {\r\n\t\tmyMixin\r\n\t} from '@/utils/public.js'\r\n\texport default {\r\n\t\tmixins:[myMixin],\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tformData: {\r\n\t\t\t\t\ttitle: '',\r\n\t\t\t\t\tcontent: '',\r\n\t\t\t\t\tphone: ''\r\n\t\t\t\t},\r\n\t\t\t\tfileList: [],\r\n\t\t\t\tquery: null, // 上个页面传来的数据\r\n\t\t\t}\r\n\r\n\t\t},\r\n\t\tcomputed: {\r\n\r\n\t\t},\r\n\t\tonLoad(query) {\r\n\t\t\tconsole.log(query)\r\n\t\t\tthis.query = query\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tsaveImage(path) {\r\n\t\t\t\treturn new Promise((res, rej) => {\r\n\t\t\t\t\tuni.uploadFile({\r\n\t\t\t\t\t\turl: 'https://image.xcbdsc.com/group1/upload',\r\n\t\t\t\t\t\tname: 'file',\r\n\t\t\t\t\t\tfilePath: path,\r\n\t\t\t\t\t\tformData: {\r\n\t\t\t\t\t\t\toutput: 'json2'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsuccess: (reponse) => {\r\n\t\t\t\t\t\t\tres(JSON.parse(reponse.data))\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\t\trej(err)\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: '上传失败',\r\n\t\t\t\t\t\t\t\ticon: 'error'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tasync selectImage() {\r\n\t\t\t\tuni.chooseMedia({\r\n\t\t\t\t\tcount: 6,\r\n\t\t\t\t\tmediaType: 'mix',\r\n\t\t\t\t\tsourceType: ['album', 'camera'],\r\n\t\t\t\t\tmaxDuration: 30,\r\n\t\t\t\t\tcamera: 'back',\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tconst imgUploadPromises = res.tempFiles.map(item => {\r\n\t\t\t\t\t\t\treturn this.saveImage(item.tempFilePath)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tPromise.all(imgUploadPromises)\r\n\t\t\t\t\t\t\t.then(urlList => {\r\n\t\t\t\t\t\t\t\tthis.fileList = [...this.fileList, ...urlList]\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\tremoveFile(index) {\r\n\t\t\t\tthis.fileList.splice(index, 1)\r\n\t\t\t},\r\n\t\t\tasync handleSubmit() {\r\n\t\t\t\tthis.formData.shop_id  = parseInt(this.query.id)\r\n\t\t\t\tlet ImgList = this.fileList.map(item=>{\r\n\t\t\t\t\treturn item.data.url\r\n\t\t\t\t})\r\n\t\t\t\tthis.formData.complaint_img = ImgList.join(',')\r\n\t\t\t\t// 构建数据包\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ticon:'loading',\r\n\t\t\t\t\ttitle:'正在提交'\r\n\t\t\t\t})\r\n\t\t\t\tapi.submitComplaint(this.formData).then((data)=>{\r\n\t\t\t\t\tif (data.code == 200){\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ticon:'success',\r\n\t\t\t\t\t\t\ttitle:'投诉成功'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ticon:'error',\r\n\t\t\t\t\t\t\ttitle:data.msg\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetTimeout(()=>{\r\n\t\t\t\t\t\tthis.customizeBack()\r\n\t\t\t\t\t},2000)\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t.complaint-container {\r\n\t\tbackground: linear-gradient(180deg, #2979ff 0%, #FFFFFF 100%);\r\n\t\tmin-height: 100vh; \r\n\t\tpadding: 40rpx 30rpx;\r\n\t}\r\n\r\n\t.complaint-header {\r\n\t\tmargin-bottom: 48rpx;\r\n\r\n\t\t.title {\r\n\t\t\tdisplay: block;\r\n\t\t\tfont-size: 44rpx;\r\n\t\t\tfont-weight: 600;\r\n\t\t\tcolor: white;\r\n\t\t\tmargin-bottom: 16rpx;\r\n\t\t}\r\n\r\n\t\t.subtitle {\r\n\t\t\tfont-size: 26rpx;\r\n\t\t\tcolor: white;\r\n\t\t}\r\n\t}\r\n\r\n\t.complaint-form {\r\n\t\tbackground: #FFFFFF;\r\n\t\tborder-radius: 24rpx;\r\n\t\tpadding: 32rpx;\r\n\t\tbox-shadow: 0 8rpx 24rpx rgba(122, 157, 126, 0.08);\r\n\t}\r\n\r\n\t.form-item {\r\n\t\tmargin-bottom: 48rpx;\r\n\r\n\t\t.item-label {\r\n\t\t\tdisplay: block;\r\n\t\t\tfont-size: 30rpx;\r\n\t\t\tcolor: #34495E;\r\n\t\t\tmargin-bottom: 24rpx;\r\n\r\n\t\t\t.required {\r\n\t\t\t\tcolor: #FF5A5F;\r\n\t\t\t\tmargin-left: 8rpx;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t.type-grid {\r\n\t\tdisplay: grid;\r\n\t\tgrid-template-columns: repeat(2, 1fr);\r\n\t\tgap: 24rpx;\r\n\r\n\t\t.type-item {\r\n\t\t\tbackground: #F8FFF9;\r\n\t\t\tborder: 2rpx solid #E8F5E9;\r\n\t\t\tborder-radius: 16rpx;\r\n\t\t\tpadding: 32rpx;\r\n\t\t\tdisplay: flex;\r\n\t\t\tflex-direction: column;\r\n\t\t\talign-items: center;\r\n\t\t\ttransition: all 0.3s;\r\n\r\n\t\t\t&.active {\r\n\t\t\t\tborder-color: #7A9D7E;\r\n\t\t\t\tbackground: rgba(122, 157, 126, 0.1);\r\n\r\n\t\t\t\tuni-icons {\r\n\t\t\t\t\tcolor: #7A9D7E;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tuni-icons {\r\n\t\t\t\tcolor: #95A5A6;\r\n\t\t\t\tmargin-bottom: 16rpx;\r\n\t\t\t}\r\n\r\n\t\t\ttext {\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\tcolor: #2C3E50;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t.content-input {\r\n\t\t// width: 100%;\r\n\t\theight: 240rpx;\r\n\t\tpadding: 24rpx;\r\n\t\tbackground: #F8F9FA;\r\n\t\tborder-radius: 16rpx;\r\n\t\tfont-size: 28rpx;\r\n\t\tline-height: 1.6;\r\n\t}\r\n\r\n\t.word-counter {\r\n\t\ttext-align: right;\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #95A5A6;\r\n\t\tmargin-top: 16rpx;\r\n\t}\r\n\r\n\t.upload-area {\r\n\t\t.upload-card {\r\n\t\t\tbackground: #F8FFF9;\r\n\t\t\tborder: 2rpx dashed #7A9D7E;\r\n\t\t\tborder-radius: 16rpx;\r\n\t\t\tpadding: 48rpx 0;\r\n\t\t\tdisplay: flex;\r\n\t\t\tflex-direction: column;\r\n\t\t\talign-items: center;\r\n\r\n\t\t\t.upload-tip {\r\n\t\t\t\tcolor: #7A9D7E;\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\tmargin-top: 16rpx;\r\n\t\t\t}\r\n\r\n\t\t\t.upload-subtip {\r\n\t\t\t\tcolor: #BDC3C7;\r\n\t\t\t\tfont-size: 24rpx;\r\n\t\t\t\tmargin-top: 8rpx;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t.preview-grid {\r\n\t\tdisplay: grid;\r\n\t\tgrid-template-columns: repeat(3, 1fr);\r\n\t\tgap: 20rpx;\r\n\t\tmargin-top: 24rpx;\r\n\r\n\t\t.preview-item {\r\n\t\t\tposition: relative;\r\n\t\t\tborder-radius: 12rpx;\r\n\t\t\toverflow: hidden;\r\n\r\n\t\t\t.preview-image {\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\theight: 200rpx;\r\n\t\t\t}\r\n\r\n\t\t\t.delete-icon {\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\tright: 8rpx;\r\n\t\t\t\ttop: 8rpx;\r\n\t\t\t\tbackground: white;\r\n\t\t\t\tcolor: black;\r\n\t\t\t\tborder-radius: 50%;\r\n\t\t\t\tpadding: 4rpx;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t.phone-input {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tbackground: #F8F9FA;\r\n\t\tborder-radius: 16rpx;\r\n\t\tpadding: 24rpx;\r\n\r\n\t\tuni-icons {\r\n\t\t\tmargin-right: 16rpx;\r\n\t\t}\r\n\r\n\t\tinput {\r\n\t\t\tflex: 1;\r\n\t\t\tfont-size: 28rpx;\r\n\t\t}\r\n\t}\r\n\r\n\t.submit-area {\r\n\t\tmargin-top: 64rpx;\r\n\r\n\t\t.submit-btn {\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: center;\r\n\t\t\talign-items: center;\r\n\t\t\tbackground: #007aff;;\r\n\t\t\tcolor: white;\r\n\t\t\theight: 96rpx;\r\n\t\t\tborder-radius: 64rpx;\r\n\t\t\tfont-size: 32rpx;\r\n\t\t\ttransition: opacity 0.3s;\r\n\r\n\r\n\t\t}\r\n\r\n\t\t.agreement-tip {\r\n\t\t\tdisplay: block;\r\n\t\t\ttext-align: center;\r\n\t\t\tcolor: #7A9D7E;\r\n\t\t\tfont-size: 24rpx;\r\n\t\t\tmargin-top: 24rpx;\r\n\t\t}\r\n\t}\r\n</style>","import MiniProgramPage from 'E:/小程序转app/xcbapp/pages/merchantComplaints/merchantComplaints.vue'\nwx.createPage(MiniProgramPage)"],"names":["myMixin","uni","api"],"mappings":";;;;AAiFC,MAAK,YAAU;AAAA,EACd,QAAO,CAACA,aAAAA,OAAO;AAAA,EACf,OAAO;AACN,WAAO;AAAA,MACN,UAAU;AAAA,QACT,OAAO;AAAA,QACP,SAAS;AAAA,QACT,OAAO;AAAA,MACP;AAAA,MACD,UAAU,CAAE;AAAA,MACZ,OAAO;AAAA;AAAA,IACR;AAAA,EAEA;AAAA,EACD,UAAU,CAET;AAAA,EACD,OAAO,OAAO;AACbC,kBAAAA,MAAY,MAAA,OAAA,0DAAA,KAAK;AACjB,SAAK,QAAQ;AAAA,EACb;AAAA,EACD,SAAS;AAAA,IACR,UAAU,MAAM;AACf,aAAO,IAAI,QAAQ,CAAC,KAAK,QAAQ;AAChCA,sBAAAA,MAAI,WAAW;AAAA,UACd,KAAK;AAAA,UACL,MAAM;AAAA,UACN,UAAU;AAAA,UACV,UAAU;AAAA,YACT,QAAQ;AAAA,UACR;AAAA,UACD,SAAS,CAAC,YAAY;AACrB,gBAAI,KAAK,MAAM,QAAQ,IAAI,CAAC;AAAA,UAC5B;AAAA,UACD,MAAM,CAAC,QAAQ;AACd,gBAAI,GAAG;AACPA,0BAAAA,MAAI,UAAU;AAAA,cACb,OAAO;AAAA,cACP,MAAM;AAAA,YACP,CAAC;AAAA,UACF;AAAA,SACA;AAAA,OACD;AAAA,IACD;AAAA,IACD,MAAM,cAAc;AACnBA,oBAAAA,MAAI,YAAY;AAAA,QACf,OAAO;AAAA,QACP,WAAW;AAAA,QACX,YAAY,CAAC,SAAS,QAAQ;AAAA,QAC9B,aAAa;AAAA,QACb,QAAQ;AAAA,QACR,SAAS,CAAC,QAAQ;AACjB,gBAAM,oBAAoB,IAAI,UAAU,IAAI,UAAQ;AACnD,mBAAO,KAAK,UAAU,KAAK,YAAY;AAAA,WACvC;AACD,kBAAQ,IAAI,iBAAiB,EAC3B,KAAK,aAAW;AAChB,iBAAK,WAAW,CAAC,GAAG,KAAK,UAAU,GAAG,OAAO;AAAA,WAC7C;AAAA,QACH;AAAA,OACA;AAAA,IACD;AAAA,IAED,WAAW,OAAO;AACjB,WAAK,SAAS,OAAO,OAAO,CAAC;AAAA,IAC7B;AAAA,IACD,MAAM,eAAe;AACpB,WAAK,SAAS,UAAW,SAAS,KAAK,MAAM,EAAE;AAC/C,UAAI,UAAU,KAAK,SAAS,IAAI,UAAM;AACrC,eAAO,KAAK,KAAK;AAAA,OACjB;AACD,WAAK,SAAS,gBAAgB,QAAQ,KAAK,GAAG;AAE9CA,oBAAAA,MAAI,UAAU;AAAA,QACb,MAAK;AAAA,QACL,OAAM;AAAA,OACN;AACDC,gBAAG,IAAC,gBAAgB,KAAK,QAAQ,EAAE,KAAK,CAAC,SAAO;AAC/C,YAAI,KAAK,QAAQ,KAAI;AACpBD,wBAAAA,MAAI,UAAU;AAAA,YACb,MAAK;AAAA,YACL,OAAM;AAAA,WACN;AAAA,eACG;AACJA,wBAAAA,MAAI,UAAU;AAAA,YACb,MAAK;AAAA,YACL,OAAM,KAAK;AAAA,WACX;AACD;AAAA,QACD;AACA,mBAAW,MAAI;AACd,eAAK,cAAc;AAAA,QACnB,GAAC,GAAI;AAAA,OACN;AAAA,IACF;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AChLD,GAAG,WAAW,eAAe;"}