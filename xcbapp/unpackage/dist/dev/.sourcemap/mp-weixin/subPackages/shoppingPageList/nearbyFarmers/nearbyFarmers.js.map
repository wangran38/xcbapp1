{"version":3,"file":"nearbyFarmers.js","sources":["subPackages/shoppingPageList/nearbyFarmers/nearbyFarmers.vue","D:/HBuilderX/plugins/uniapp-cli-vite/uniPage:/c3ViUGFja2FnZXNcc2hvcHBpbmdQYWdlTGlzdFxuZWFyYnlGYXJtZXJzXG5lYXJieUZhcm1lcnMudnVl"],"sourcesContent":["<template>\r\n\t<view class=\"container\">\r\n\t\t<!-- 搜索栏 -->\r\n\t\t<view class=\"search-bar\">\r\n\t\t\t<view style=\"display: flex;\">\r\n\t\t\t\t<view\r\n\t\t\t\t\tstyle=\"display: flex;  background-color: rgb(245, 245, 245); align-items: center; border-radius: 20rpx;\">\r\n\t\t\t\t\t<view style=\"padding: 20rpx;\"><uni-icons color=\"#999999\" size=\"20\" type=\"search\" /></view>\r\n\t\t\t\t\t<input type=\"text\" placeholder=\"搜索农户姓名或地址\" v-model=\"formdata.farmersname\" />\r\n\t\t\t\t</view>\r\n\t\t\t\t<view\r\n\t\t\t\t\tstyle=\"background-color: #007aff; color: white; width: 120rpx; height: 80rpx; line-height: 80rpx; text-align: center; border-radius: 10rpx; margin: 10rpx;\"\r\n\t\t\t\t\t@click=\"startSearch\">\r\n\t\t\t\t\t搜索</view>\r\n\t\t\t\t<view\r\n\t\t\t\t\tstyle=\"background-color: red; color: white;width: 120rpx; height: 80rpx; line-height: 80rpx; text-align: center; border-radius: 10rpx; margin: 10rpx;\"\r\n\t\t\t\t\t@click=\"stopSearch\">\r\n\t\t\t\t\t清空</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"filter-group\">\r\n\r\n\t\t\t\t<picker @change=\"categoryChange\" :range=\"categories\" range-key=\"label\">\r\n\t\t\t\t\t<view class=\"filter-btn\">\r\n\t\t\t\t\t\t<uni-icons type=\"tags\" size=\"16\" color=\"#3a7afe\" />\r\n\t\t\t\t\t\t<text class=\"btn-text\">{{ categories[selectedCategoryIndex].label }}</text>\r\n\t\t\t\t\t\t<uni-icons type=\"arrowdown\" size=\"14\" color=\"#3a7afe\" />\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</picker>\r\n\r\n\t\t\t\t<picker :range=\"distances\" range-key=\"label\">\r\n\t\t\t\t\t<view class=\"filter-btn\">\r\n\t\t\t\t\t\t<uni-icons type=\"tags\" size=\"16\" color=\"#3a7afe\" />\r\n\t\t\t\t\t\t<text class=\"btn-text\">{{ distances[selectedCategoryIndex].label }}</text>\r\n\t\t\t\t\t\t<uni-icons type=\"arrowdown\" size=\"14\" color=\"#3a7afe\" />\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</picker>\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t<view @click=\"goToRouter('/subPackages/shoppingPageList/statisticsMap/statisticsMap')\" style=\"position: absolute; right: 40rpx; background-color: #007aff; padding: 10rpx; color: white; border-radius: 10rpx;\">地图查看</view>\r\n\r\n\t\t\t</view>\r\n\r\n\t\t</view>\r\n\r\n\t\t<!-- 农户列表 -->\r\n\t\t<scroll-view class=\"list-container\" scroll-y :refresher-triggered=\"isRefreshing\">\r\n\t\t\t<view class=\"farmer-list\">\r\n\t\t\t\t<view v-for=\"(farmer, index) in farmers\" :key=\"farmer.id\" class=\"farmer-card\">\r\n\t\t\t\t\t<view class=\"card-header\">\r\n\r\n\t\t\t\t\t\t<view class=\"header-info\">\r\n\t\t\t\t\t\t\t<text class=\"name\">{{farmer.name}}</text>\r\n\t\t\t\t\t\t\t<view class=\"location\">\r\n\t\t\t\t\t\t\t\t<uni-icons type=\"location\" size=\"16\" color=\"#666\" />\r\n\t\t\t\t\t\t\t\t{{farmer.address}}\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t<view class=\"card-body\">\r\n\t\t\t\t\t\t<view>\r\n\t\t\t\t\t\t\t<view class=\"info-item\">\r\n\t\t\t\t\t\t\t\t<text class=\"label\">农户名称:</text>\r\n\t\t\t\t\t\t\t\t<text class=\"value\">{{farmer.farmersname}}</text>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<view class=\"info-item\">\r\n\t\t\t\t\t\t\t\t<text class=\"label\">所属地区：</text>\r\n\t\t\t\t\t\t\t\t<text class=\"value\">{{farmer.area_name}}</text>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<view class=\"info-item\">\r\n\t\t\t\t\t\t\t\t<text class=\"label\">加入时间：</text>\r\n\t\t\t\t\t\t\t\t<text class=\"value\">{{initDate(farmer.createtime)}}</text>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<view class=\"info-item\">\r\n\t\t\t\t\t\t\t\t<text class=\"label\">所售类目：</text>\r\n\t\t\t\t\t\t\t\t<text class=\"value\">{{farmer.category_name}}</text>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<view class=\"info-item\">\r\n\t\t\t\t\t\t\t\t<text class=\"label\">所售商品：</text>\r\n\t\t\t\t\t\t\t\t<text class=\"value\">{{'5个'}}</text>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<view class=\"info-item\">\r\n\t\t\t\t\t\t\t\t<text class=\"label\">距离您有：</text>\r\n\t\t\t\t\t\t\t\t<text class=\"value\">{{farmer.distance.toFixed(1) || '' }}km</text>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<image style=\"width: 150rpx; height: 150rpx;\"\r\n\t\t\t\t\t\t\t:src=\"farmer.logo ? farmer.logo : 'https://b0.bdstatic.com/0df6c8c7f109aa7b67e7cb15e6f8d025.jpg@h_1280'\">\r\n\t\t\t\t\t\t</image>\r\n\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t<view class=\"card-footer\">\r\n\t\t\t\t\t\t<!-- \t\t\t\t\t\t<button class=\"contact-btn\" @click=\"handleContact(farmer)\" style=\"background-color: #007aff;\">\r\n\t\t\t\t\t\t\t<uni-icons type=\"phone\" size=\"18\" color=\"#fff\" />\r\n\t\t\t\t\t\t\t联系农户\r\n\t\t\t\t\t\t</button> -->\r\n\t\t\t\t\t\t<button class=\"detail-btn\" @click=\"navigateToDetail(farmer)\"\r\n\t\t\t\t\t\t\tstyle=\"border-color: #007aff; color: #007aff;\">\r\n\t\t\t\t\t\t\t查看详情\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<view v-if=\"farmers.length === 0\" class=\"empty-container\">\r\n\t\t\t\t\t<!-- <image src=\"/static/empty-farmer.png\" class=\"empty-image\" /> -->\r\n\t\t\t\t\t<text class=\"empty-text\">暂无相关农户信息</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</scroll-view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport {\r\n\t\tapi\r\n\t} from '@/api/index.js';\r\n\timport {\r\n\t\tmyMixin\r\n\t} from '@/utils/public.js'\r\n\r\n\texport default {\r\n\t\tmixins: [myMixin],\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tdistances: [{\r\n\t\t\t\t\t\tlabel: '离我最近',\r\n\t\t\t\t\t\tvalue: ''\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlabel: '离我最远',\r\n\t\t\t\t\t\tvalue: ''\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t\tcategories: [{\r\n\t\t\t\t\t\tlabel: '菜品最多',\r\n\t\t\t\t\t\tvalue: ''\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlabel: '菜品最少',\r\n\t\t\t\t\t\tvalue: ''\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t\tselectedCategoryIndex: 0,\r\n\t\t\t\tsearchKey: '',\r\n\t\t\t\tisRefreshing: false,\r\n\t\t\t\tfarmers: [],\r\n\t\t\t\tformdata: {\r\n\t\t\t\t\tpage: 1,\r\n\t\t\t\t\tlimit: 100,\r\n\t\t\t\t\tfarmersname: null // 农户名称模糊查询\r\n\t\t\t\t},\r\n\t\t\t\tisSearch: false // 是否在搜索状态\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync onLoad() {\r\n\t\t\t// 格式化当前位置\r\n\t\t\tlet res = uni.getStorageSync('userlocation');\r\n\t\t\tif (res) {\r\n\t\t\t\tlet {\r\n\t\t\t\t\tlongitude,\r\n\t\t\t\t\tlatitude\r\n\t\t\t\t} = JSON.parse(res)\r\n\t\t\t\tthis.formdata.lat = latitude\r\n\t\t\t\t// this.formdata.lat = 19.2426 \r\n\t\t\t\tthis.formdata.lng = longitude\r\n\t\t\t\t// this.formdata.lng =  110.46907\r\n\t\t\t}\r\n\t\t\tthis.getData()\r\n\t\t},\r\n\t\tcomputed: {},\r\n\t\tmethods: {\r\n\t\t\tgoToRouter(url){\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl:url\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tintiQuery() {\r\n\t\t\t\tthis.formdata = {\r\n\t\t\t\t\tpage: 1,\r\n\t\t\t\t\tlimit: 100,\r\n\t\t\t\t\tfarmersname: null // 农户名称模糊查询\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 开始搜索\r\n\t\t\tstartSearch() {\r\n\t\t\t\tthis.farmers = [] // 清空原来的数据\r\n\t\t\t\tthis.getData()\r\n\t\t\t},\r\n\t\t\t// 结束搜索\r\n\t\t\tstopSearch() {\r\n\t\t\t\tthis.farmers = [] // 清空原来的数据\r\n\t\t\t\tthis.intiQuery()\r\n\t\t\t\tthis.getData()\r\n\t\t\t},\r\n\r\n\r\n\r\n\t\t\tasync getData() {\r\n\t\t\t\tlet data = await api.farmersList(this.formdata)\r\n\t\t\t\tif (data.code = 200) {\r\n\t\t\t\t\tthis.farmers = [...this.farmers, ...data.data.listdata]\r\n\t\t\t\t}\r\n\t\t\t\tconsole.log(this.farmers)\r\n\t\t\t},\r\n\r\n\r\n\t\t\thandleContact(farmer) {\r\n\t\t\t\tuni.makePhoneCall({\r\n\t\t\t\t\tphoneNumber: farmer.phone\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tnavigateToDetail(item) {\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: `/subPackages/shoppingPageList/merchantDetails/merchantDetails?query=${JSON.stringify(item)}`\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t.filter-group {\r\n\t\tmargin: 10rpx;\r\n\t\tdisplay: flex;\r\n\t\tgap: 30rpx;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.filter-btn {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tpadding: 12rpx 24rpx;\r\n\t\tborder-radius: 40rpx;\r\n\t\tbackground: #f5f7fa;\r\n\t\tborder: 1rpx solid #e4e7ed;\r\n\t}\r\n\r\n\t.container {\r\n\t\tbackground: #f8f8f8;\r\n\t\tmin-height: 100vh;\r\n\t}\r\n\r\n\t.search-bar {\r\n\t\tpadding: 20rpx 30rpx;\r\n\t\tbackground: #fff;\r\n\t}\r\n\r\n\t.farmer-list {\r\n\t\tpadding: 20rpx 30rpx;\r\n\t}\r\n\r\n\t.farmer-card {\r\n\t\tbackground: #fff;\r\n\t\tborder-radius: 16rpx;\r\n\t\tmargin-bottom: 24rpx;\r\n\t\tbox-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.06);\r\n\r\n\t\t.card-header {\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t\tpadding: 24rpx;\r\n\t\t\tborder-bottom: 1rpx solid #eee;\r\n\r\n\t\t\t.avatar {\r\n\t\t\t\twidth: 100rpx;\r\n\t\t\t\theight: 100rpx;\r\n\t\t\t\tborder-radius: 50%;\r\n\t\t\t\tmargin-right: 24rpx;\r\n\t\t\t}\r\n\r\n\t\t\t.header-info {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\r\n\t\t\t\t.name {\r\n\t\t\t\t\tfont-size: 32rpx;\r\n\t\t\t\t\tcolor: #333;\r\n\t\t\t\t\tfont-weight: 500;\r\n\t\t\t\t\tmargin-bottom: 8rpx;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.location {\r\n\t\t\t\t\tfont-size: 26rpx;\r\n\t\t\t\t\tcolor: #666;\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\talign-items: center;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.card-body {\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: space-between;\r\n\t\t\tpadding: 24rpx;\r\n\r\n\t\t\t.info-item {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tmargin-bottom: 16rpx;\r\n\t\t\t\tfont-size: 28rpx;\r\n\r\n\t\t\t\t.label {\r\n\t\t\t\t\tcolor: #666;\r\n\t\t\t\t\tmin-width: 140rpx;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.value {\r\n\t\t\t\t\tcolor: #333;\r\n\t\t\t\t\tflex: 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.card-footer {\r\n\t\t\tdisplay: flex;\r\n\t\t\tpadding: 24rpx;\r\n\t\t\tborder-top: 1rpx solid #eee;\r\n\r\n\t\t\tbutton {\r\n\t\t\t\tflex: 1;\r\n\t\t\t\tmargin: 0 12rpx;\r\n\t\t\t\theight: 72rpx;\r\n\t\t\t\tline-height: 72rpx;\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\tborder-radius: 40rpx;\r\n\r\n\t\t\t\t&::after {\r\n\t\t\t\t\tborder: none;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t&.contact-btn {\r\n\t\t\t\t\tbackground: #7A9D7E;\r\n\t\t\t\t\tcolor: #fff;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t&.detail-btn {\r\n\t\t\t\t\tbackground: #fff;\r\n\t\t\t\t\tcolor: #7A9D7E;\r\n\t\t\t\t\tborder: 1rpx solid #7A9D7E;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t.empty-container {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tpadding: 100rpx 0;\r\n\r\n\t\t.empty-image {\r\n\t\t\twidth: 300rpx;\r\n\t\t\theight: 300rpx;\r\n\t\t\tmargin-bottom: 40rpx;\r\n\t\t}\r\n\r\n\t\t.empty-text {\r\n\t\t\tcolor: #999;\r\n\t\t\tfont-size: 28rpx;\r\n\t\t}\r\n\t}\r\n</style>","import MiniProgramPage from 'E:/小程序转app/xcbapp/subPackages/shoppingPageList/nearbyFarmers/nearbyFarmers.vue'\nwx.createPage(MiniProgramPage)"],"names":["myMixin","uni","api"],"mappings":";;;;AAwHC,MAAK,YAAU;AAAA,EACd,QAAQ,CAACA,aAAAA,OAAO;AAAA,EAChB,OAAO;AACN,WAAO;AAAA,MACN,WAAW;AAAA,QAAC;AAAA,UACV,OAAO;AAAA,UACP,OAAO;AAAA,QACP;AAAA,QACD;AAAA,UACC,OAAO;AAAA,UACP,OAAO;AAAA,QACP;AAAA,MACD;AAAA,MACD,YAAY;AAAA,QAAC;AAAA,UACX,OAAO;AAAA,UACP,OAAO;AAAA,QACP;AAAA,QACD;AAAA,UACC,OAAO;AAAA,UACP,OAAO;AAAA,QACP;AAAA,MACD;AAAA,MACD,uBAAuB;AAAA,MACvB,WAAW;AAAA,MACX,cAAc;AAAA,MACd,SAAS,CAAE;AAAA,MACX,UAAU;AAAA,QACT,MAAM;AAAA,QACN,OAAO;AAAA,QACP,aAAa;AAAA;AAAA,MACb;AAAA,MACD,UAAU;AAAA;AAAA,IACX;AAAA,EACA;AAAA,EACD,MAAM,SAAS;AAEd,QAAI,MAAMC,cAAAA,MAAI,eAAe,cAAc;AAC3C,QAAI,KAAK;AACR,UAAI;AAAA,QACH;AAAA,QACA;AAAA,MACD,IAAI,KAAK,MAAM,GAAG;AAClB,WAAK,SAAS,MAAM;AAEpB,WAAK,SAAS,MAAM;AAAA,IAErB;AACA,SAAK,QAAQ;AAAA,EACb;AAAA,EACD,UAAU,CAAE;AAAA,EACZ,SAAS;AAAA,IACR,WAAW,KAAI;AACdA,oBAAAA,MAAI,WAAW;AAAA,QACd;AAAA,OACA;AAAA,IACD;AAAA,IACD,YAAY;AACX,WAAK,WAAW;AAAA,QACf,MAAM;AAAA,QACN,OAAO;AAAA,QACP,aAAa;AAAA;AAAA,MACd;AAAA,IACA;AAAA;AAAA,IAED,cAAc;AACb,WAAK,UAAU;AACf,WAAK,QAAQ;AAAA,IACb;AAAA;AAAA,IAED,aAAa;AACZ,WAAK,UAAU;AACf,WAAK,UAAU;AACf,WAAK,QAAQ;AAAA,IACb;AAAA,IAID,MAAM,UAAU;AACf,UAAI,OAAO,MAAMC,UAAAA,IAAI,YAAY,KAAK,QAAQ;AAC9C,UAAI,KAAK,OAAO,KAAK;AACpB,aAAK,UAAU,CAAC,GAAG,KAAK,SAAS,GAAG,KAAK,KAAK,QAAQ;AAAA,MACvD;AACAD,oBAAAA,MAAY,MAAA,OAAA,uEAAA,KAAK,OAAO;AAAA,IACxB;AAAA,IAGD,cAAc,QAAQ;AACrBA,oBAAAA,MAAI,cAAc;AAAA,QACjB,aAAa,OAAO;AAAA,OACpB;AAAA,IACD;AAAA,IACD,iBAAiB,MAAM;AACtBA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK,uEAAuE,KAAK,UAAU,IAAI,CAAC;AAAA,OAChG;AAAA,IACF;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACxND,GAAG,WAAW,eAAe;"}