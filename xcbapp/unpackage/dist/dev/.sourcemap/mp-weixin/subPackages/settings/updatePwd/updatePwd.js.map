{"version":3,"file":"updatePwd.js","sources":["subPackages/settings/updatePwd/updatePwd.vue","D:/HBuilderX/plugins/uniapp-cli-vite/uniPage:/c3ViUGFja2FnZXNcc2V0dGluZ3NcdXBkYXRlUHdkXHVwZGF0ZVB3ZC52dWU"],"sourcesContent":["<template>\r\n\t<view class=\"container\">\r\n\t\t<view class=\"header\">\r\n\t\t\t<text class=\"title\">重置密码</text>\r\n\t\t\t<text class=\"subtitle\">请验证手机号并设置新密码</text>\r\n\t\t</view>\r\n\r\n\t\t<view class=\"form\">\r\n\t\t\t<!-- 手机号输入 -->\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<text class=\"item-label\">手机号</text>\r\n\t\t\t\t<input v-model=\"formData.phone\" type=\"number\" placeholder=\"请输入手机号\" maxlength=\"11\"\r\n\t\t\t\t\t@input=\"validatePhone\" />\r\n\t\t\t\t<text v-if=\"phoneError\" class=\"error-tip\">{{ phoneError }}</text>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 验证码输入 -->\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<text class=\"item-label\">验证码</text>\r\n\t\t\t\t<view class=\"code-input\">\r\n\t\t\t\t\t<input v-model=\"formData.verificationCode\" type=\"number\" placeholder=\"请输入验证码\" maxlength=\"6\" />\r\n\t\t\t\t\t<button class=\"code-btn\" :class=\"{ disabled: !canSendCode }\" :disabled=\"!canSendCode\"\r\n\t\t\t\t\t\t@click=\"sendVerificationCode\">\r\n\t\t\t\t\t\t{{ codeBtnText }}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 新密码输入 -->\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<text class=\"item-label\">新密码</text>\r\n\t\t\t\t<view class=\"password-input\">\r\n\t\t\t\t\t<input v-model=\"formData.newPassword\" type=\"text\" placeholder=\"8-20位字母数字组合\" maxlength=\"20\"\r\n\t\t\t\t\t\t@input=\"validatePassword\" />\r\n\t\t\t\t\t<image class=\"eye-icon\" :src=\"showPassword ? '/static/eye-open.png' : '/static/eye-close.png'\"\r\n\t\t\t\t\t\t@click=\"togglePassword\" />\r\n\t\t\t\t</view>\r\n\t\t\t\t<text v-if=\"passwordError\" class=\"error-tip\">{{ passwordError }}</text>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 确认密码 -->\r\n\t\t\t<view class=\"form-item\">\r\n\t\t\t\t<text class=\"item-label\">确认密码</text>\r\n\t\t\t\t<input v-model=\"formData.confirmPassword\" type=\"'text'\" placeholder=\"请再次输入密码\"\r\n\t\t\t\t\t@input=\"validateConfirm\" />\r\n\t\t\t\t<text v-if=\"confirmError\" class=\"error-tip\">{{ confirmError }}</text>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 提交按钮 -->\r\n\t\t\t<button class=\"submit-btn\" :class=\"{ disabled: !formValid }\"  @click=\"handleSubmit\">\r\n\t\t\t\t确认重置\r\n\t\t\t</button>\r\n\t\t</view>\r\n\r\n\t\t<!-- 全局提示 -->\r\n\t\t<view v-if=\"message\" class=\"message-box\" :class=\"{ error: isError }\">\r\n\t\t\t{{ message }}\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport {\r\n\t\tapi\r\n\t} from '@/api/index.js'\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tformData: {\r\n\t\t\t\t\tphone: '',\r\n\t\t\t\t\tverificationCode: '',\r\n\t\t\t\t\tnewPassword: '',\r\n\t\t\t\t\tconfirmPassword: ''\r\n\t\t\t\t},\r\n\t\t\t\tshowPassword: false,\r\n\t\t\t\tcodeBtnText: '获取验证码',\r\n\t\t\t\tcanSendCode: true,\r\n\t\t\t\tcountdown: 0,\r\n\t\t\t\tphoneError: '',\r\n\t\t\t\tpasswordError: '',\r\n\t\t\t\tconfirmError: '',\r\n\t\t\t\tmessage: '',\r\n\t\t\t\tisError: false\r\n\t\t\t};\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\tformValid() {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t!this.phoneError &&\r\n\t\t\t\t\t!this.passwordError &&\r\n\t\t\t\t\t!this.confirmError &&\r\n\t\t\t\t\tthis.formData.phone &&\r\n\t\t\t\t\tthis.formData.verificationCode &&\r\n\t\t\t\t\tthis.formData.newPassword &&\r\n\t\t\t\t\tthis.formData.confirmPassword\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonLoad(va) {\r\n\t\t\t// 如果是从首页过来会携带参数过来\r\n\t\t\tif (va.phone) {\r\n\t\t\t\tthis.formData.phone = va.phone\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tvalidatePhone() {\r\n\t\t\t\tconst reg = /^1[3-9]\\d{9}$/;\r\n\t\t\t\tif (!this.formData.phone) {\r\n\t\t\t\t\tthis.phoneError = '手机号不能为空';\r\n\t\t\t\t} else if (!reg.test(this.formData.phone)) {\r\n\t\t\t\t\tthis.phoneError = '手机号格式不正确';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.phoneError = '';\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tvalidatePassword() {\r\n\t\t\t\tconst reg = /^(?=.*[a-zA-Z])(?=.*\\d).{8,20}$/;\r\n\t\t\t\tif (!this.formData.newPassword) {\r\n\t\t\t\t\tthis.passwordError = '密码不能为空';\r\n\t\t\t\t} else if (!reg.test(this.formData.newPassword)) {\r\n\t\t\t\t\tthis.passwordError = '需包含字母和数字，8-20位';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.passwordError = '';\r\n\t\t\t\t}\r\n\t\t\t\tif (this.formData.confirmPassword) {\r\n\t\t\t\t\tif (this.formData.confirmPassword !== this.formData.newPassword) {\r\n\t\t\t\t\t\tthis.passwordError = '两次输入密码不一致';\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.passwordError = '';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tvalidateConfirm() {\r\n\t\t\t\tif (this.formData.confirmPassword !== this.formData.newPassword) {\r\n\t\t\t\t\tthis.confirmError = '两次输入密码不一致';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.confirmError = '';\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\ttogglePassword() {\r\n\t\t\t\tthis.showPassword = !this.showPassword;\r\n\t\t\t},\r\n\r\n\t\t\tasync sendVerificationCode() {\r\n\t\t\t\tif (this.phoneError || !this.formData.phone) return;\r\n\r\n\t\t\t\tthis.startCountdown();\r\n\t\t\t\tlet res = await api.sendText({\r\n\t\t\t\t\t'phonenumber': this.formData.phone\r\n\t\t\t\t})\r\n\t\t\t\tif (res.code == 200) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\t\ttitle: '短信已发送至您的手机,请注意查收'\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ticon: 'error',\r\n\t\t\t\t\t\ttitle: res.msg\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tstartCountdown() {\r\n\t\t\t\tthis.canSendCode = false;\r\n\t\t\t\tthis.countdown = 60;\r\n\t\t\t\tthis.codeBtnText = `${this.countdown}秒后重发`;\r\n\r\n\t\t\t\tconst timer = setInterval(() => {\r\n\t\t\t\t\tif (this.countdown <= 0) {\r\n\t\t\t\t\t\tclearInterval(timer);\r\n\t\t\t\t\t\tthis.canSendCode = true;\r\n\t\t\t\t\t\tthis.codeBtnText = '获取验证码';\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.countdown--;\r\n\t\t\t\t\tthis.codeBtnText = `${this.countdown}秒后重发`;\r\n\t\t\t\t}, 1000);\r\n\t\t\t},\r\n\r\n\t\t\tasync handleSubmit() {\r\n\t\t\t\t// if (!this.formValid) return;\r\n\r\n\t\t\t\tlet res = await api.editPwd({\r\n\t\t\t\t\tphone: this.formData.phone,\r\n\t\t\t\t\tcodenum: this.formData.verificationCode,\r\n\t\t\t\t\tpsw: this.formData.newPassword\r\n\t\t\t\t})\r\n\t\t\t\tthis.showMessage('密码重置成功', false);\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tuni.navigateBack();\r\n\t\t\t\t}, 1500);\r\n\t\t\t},\r\n\r\n\t\t\tshowMessage(msg, isError = true) {\r\n\t\t\t\tthis.message = msg;\r\n\t\t\t\tthis.isError = isError;\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.message = '';\r\n\t\t\t\t}, 2000);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n</script>\r\n\r\n<style scoped>\r\n\t.container {\r\n\t\tpadding: 40rpx;\r\n\t\tmin-height: 100vh;\r\n\t\tbackground: #f5f6fa;\r\n\t}\r\n\r\n\t.header {\r\n\t\tmargin-bottom: 60rpx;\r\n\t}\r\n\r\n\t.title {\r\n\t\tdisplay: block;\r\n\t\tfont-size: 48rpx;\r\n\t\tfont-weight: 600;\r\n\t\tcolor: #2c3e50;\r\n\t\tmargin-bottom: 20rpx;\r\n\t}\r\n\r\n\t.subtitle {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #7f8c8d;\r\n\t}\r\n\r\n\t.form-item {\r\n\t\tmargin-bottom: 40rpx;\r\n\t\tbackground: #fff;\r\n\t\tborder-radius: 16rpx;\r\n\t\tpadding: 24rpx;\r\n\t\tbox-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.05);\r\n\t}\r\n\r\n\t.item-label {\r\n\t\tdisplay: block;\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #34495e;\r\n\t\tmargin-bottom: 20rpx;\r\n\t}\r\n\r\n\tinput {\r\n\t\theight: 80rpx;\r\n\t\tfont-size: 30rpx;\r\n\t\twidth: 100%;\r\n\t\tpadding: 0 10rpx;\r\n\t\tborder-bottom: 2rpx solid #eee;\r\n\t}\r\n\r\n\t.code-input {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: space-between;\r\n\t}\r\n\r\n\t.code-btn {\r\n\t\twidth: 200rpx;\r\n\t\theight: 60rpx;\r\n\t\tline-height: 60rpx;\r\n\t\tfont-size: 20rpx;\r\n\t\tbackground: #3498db;\r\n\t\tcolor: #fff;\r\n\t\tborder-radius: 30rpx;\r\n\t\tmargin-left: 20rpx;\r\n\r\n\t}\r\n\r\n\t.password-input {\r\n\t\tposition: relative;\r\n\t}\r\n\r\n\t.eye-icon {\r\n\t\tposition: absolute;\r\n\t\tright: 20rpx;\r\n\t\tbottom: 20rpx;\r\n\t\twidth: 40rpx;\r\n\t\theight: 40rpx;\r\n\t}\r\n\r\n\t.submit-btn {\r\n\t\tmargin-top: 60rpx;\r\n\t\theight: 96rpx;\r\n\t\tline-height: 96rpx;\r\n\t\tbackground: #2ecc71;\r\n\t\tcolor: #fff;\r\n\t\tfont-size: 32rpx;\r\n\t\tborder-radius: 48rpx;\r\n\t\ttransition: all 0.3s;\r\n\r\n\t}\r\n\r\n\t.error-tip {\r\n\t\tdisplay: block;\r\n\t\tcolor: #e74c3c;\r\n\t\tfont-size: 24rpx;\r\n\t\tmargin-top: 10rpx;\r\n\t}\r\n\r\n\t.message-box {\r\n\t\tposition: fixed;\r\n\t\tbottom: 100rpx;\r\n\t\tleft: 50%;\r\n\t\ttransform: translateX(-50%);\r\n\t\tpadding: 20rpx 40rpx;\r\n\t\tborder-radius: 48rpx;\r\n\t\tbackground: #2ecc71;\r\n\t\tcolor: #fff;\r\n\t\tfont-size: 28rpx;\r\n\r\n\t}\r\n</style>","import MiniProgramPage from 'E:/小程序转app/xcbapp/subPackages/settings/updatePwd/updatePwd.vue'\nwx.createPage(MiniProgramPage)"],"names":["api","uni"],"mappings":"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"}