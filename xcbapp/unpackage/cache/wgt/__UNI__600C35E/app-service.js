if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){const t=this.constructor;return this.then((a=>t.resolve(e()).then((()=>a))),(a=>t.resolve(e()).then((()=>{throw a}))))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const e=uni.requireGlobal();ArrayBuffer=e.ArrayBuffer,Int8Array=e.Int8Array,Uint8Array=e.Uint8Array,Uint8ClampedArray=e.Uint8ClampedArray,Int16Array=e.Int16Array,Uint16Array=e.Uint16Array,Int32Array=e.Int32Array,Uint32Array=e.Uint32Array,Float32Array=e.Float32Array,Float64Array=e.Float64Array,BigInt64Array=e.BigInt64Array,BigUint64Array=e.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(e){"use strict";function t(e,t,...a){uni.__log__?uni.__log__(e,t,...a):console[e].apply(console,[...a,t])}function a(e,t){return"string"==typeof e?t:e}const i="https://api.xcbdsc.com",o="https://image.xcbdsc.com",s=["/api/cglist","/api/citytree","/api/citylist","/api/marketlist","/group1/upload","/api/countrylist","/api/user/rs","/api/user/login","/api/market/commodity/list","/api/shop/lottery"],n=e=>{if(s.includes(e))return{"Content-Type":"application/json"};return{"Content-Type":"application/json",Authorization:uni.getStorageSync("token")}},r=(e,a,o={},s={})=>new Promise(((s,r)=>{uni.request({url:`${i}${e}`,method:a,data:o,header:n(e),success:e=>{const{code:t,msg:a}=e.data;200===e.statusCode||200===t?s(e.data):201===e.statusCode||201===t||"你没有登录！"===a?uni.showModal({title:"提示",content:"登录状态失效",confirmText:"前往登录",success:({confirm:e})=>{e&&uni.navigateTo({url:"/pages/login/login"})}}):s(e.data)},fail:e=>{r(e),t("log","at api/index.js:131","error",e)}})})),l={cglist:()=>r("/api/cglist","POST"),citylist:e=>r("/api/citylist","POST",e),citytree:e=>r("/api/citytree","POST",{pid:e}),marketlist:(e,t)=>r("/api/marketlist","POST",{area_id:e,limit:t}),register:(e,t,a,i)=>r("/api/user/rs","POST",{phone:e,psw:t,psw1:a,fromid:i}),login:(e,t)=>r("/api/user/login","POST",{phone:e,psw:t}),editUserProfile:e=>r("/api/user/myedit","POST",e),getUserProfile:()=>r("/api/user/my","POST"),addshop:({contactpeople:e,contactphone:t,area_id:a,title:i,logo:o,phone:s,market_id:n,category_id:l,content:c})=>r("/api/shop/addshop","POST",{area_id:a,title:i,market_id:n,category_id:l,contactpeople:e,contactphone:t,logo:o,phone:s,content:c}),marketShopList:e=>r("/api/shop/list","POST",e),getCommdityList:e=>r("/api/user/mygoods","POST",e),getMyShops:e=>r("/api/shop/myshop","POST",e),getmarketCommdityList:e=>r("/api/market/commodity/list","POST",e),addgoods:({category_id:e,goodsname:t,imglogo:a,price:i})=>r("/api/user/addgoods","POST",{category_id:e,goodsname:t,imglogo:a,price:i}),countrylist:(e,t,a)=>r("/api/countrylist","POST",{pid:e,limit:t,page:a}),shopDetail:e=>r("/api/shop/list","POST",{id:e}),getCommodityDetails:e=>r("/api/user/mygoods","POST",{id:e}),editGoods:({id:e,category_id:t,goodsname:a,imglogo:i})=>r("/api/user/editgoods","POST",{id:e,category_id:t,goodsname:a,imglogo:i}),addCommodityToShop:e=>r("/api/shop/addcommodity","POST",e),myShoplist:e=>r("/api/shop/mycommodity","POST",e),xiajiashop:e=>r("/api/shop/editcommodity","POST",e),editshop:e=>r("/api/shop/editshop","POST",e),mycoupon:e=>r("/api/user/mycoupon","POST",e),addorder:e=>r("/api/user/addorder","POST",e),sign:e=>r("/api/user/sign","POST",e),signlist:e=>r("/api/user/signlist","POST",e),lottery:e=>r("/api/shop/lottery","POST",e),scorelist:e=>r("/api/user/scorelist","POST",e),myorders:e=>r("/api/user/myorders","POST",e),shopoder:e=>r("/api/shop/order/list","POST",e),mysorce:e=>r("/api/shop/mysorce","POST",e),settlement:e=>r("/api/shop/settlement","POST",e),shopsorcelist:e=>r("/api/shop/shopsorcelist","POST",e),editshop:e=>r("/api/shop/editshop","POST",e),mybank:e=>r("/api/shop/mybank","POST",e),addbank:e=>r("/api/shop/addbank","POST",e),editshopbank:e=>r("/api/shop/editshopbank","POST",e),editgoods:e=>r("/api/user/editgoods","POST",e),bindingOpenid:e=>r("/api/wx/getopenid","GET",e),signTotal:e=>r("/api/sign/total","POST",e),addfarmers:e=>r("/api/farmers/addfarmers","POST",e),upFarmers:e=>r("/api/farmers/upFarmers","POST",e),myInfo:e=>r("/api/farmers/info","POST",e),payscore:e=>r("/api/user/payscore","POST",e),wechatpay:e=>r("/api/pay/orderpay","POST",e),getorderinfo:e=>r("/api/user/getorderinfo","POST",e),lookTraceability:e=>r("/api/goods/getinfo","POST",e),receiving:e=>r("/api/shop/receiving","POST",e),sendText:e=>r("/api/sendsms","POST",e),editPwd:e=>r("/api/user/editpsw","POST",e),mymoney:e=>r("/api/shop/mymoney","POST",e),amount:e=>r("/api/shop/amount","POST",e),addPreSale:e=>r("/api/farmers/addgoods","POST",e),goodslist:e=>r("/api/farmers/goodslist","POST",e),addinfos:e=>r("/api/farmers/goods/addinfos","POST",e),goodsinfoList:e=>r("/api/farmers/goodsinfo/list","POST",e),presaleList:e=>r("/api/farmers/market/goodslist","POST",e),delDishes:e=>r("/api/farmers/delgoods","POST",e),delMoments:e=>r("/api/farmers/goodsinfo/del","POST",e),farmersList:e=>r("/api/farmers/list","POST",e),dynamicsDataList:e=>r("/api/farmers/goodsinfo/showlist","POST",e),buyinfoAdd:e=>r("/api/user/buyinfo/add","POST",e),buyinfoList:e=>r("/api/buyinfo/list","POST",e),updateDish:e=>r("/api/farmers/upgoods","POST",e),submitComplaint:e=>r("/api/user/complaint/add","POST",e),mylist:e=>r("/api/user/complaint/mylist","POST",e),informationData:e=>r("/api/news/list","POST",e),classification:e=>r("/api/news/category/list","POST",e),foodOnSale:e=>r("/api/farmers/market/addgoods","POST",e),XiaShiCity:e=>r("/api/farmers/market/editgoods","POST",e),publishWholesale:e=>r("/api/user/sellinfo/add","POST",e),wholesaleList:e=>r("/api/sellinfo/list","POST",e),myProcurementData:e=>r("/api/user/buyinfo/mylist","POST",e),mySupplyData:e=>r("/api/user/sellinfo/mylist","POST",e),myaddressData:e=>r("/api/user/myaddress","POST",e),addMyAddress:e=>r("/api/user/addaddress","POST",e),editMyAddress:e=>r("/api/user/editaddress","POST",e),delMyAddress:e=>r("/api/user/deladdress","POST",e),shopmoneylist:e=>r("/api/shop/shopmoneylist","POST",e),searchResolution:e=>r("/api/get/lnglat","POST",e),prePurchaseOrder:e=>r("/api/user/addorderfarmer","POST",e),manyImages:e=>r("/api/shop/add/img","POST",e),getManyImages:e=>r("/api/shop/get/img/list","POST",e),delManyImages:e=>r("/api/shop/del/img","POST",e),addTraceability:e=>r("/api/goods/addinfo","POST",e),traceabilityInfo:e=>r("/api/goods/get/info","POST",e),getqrcode:e=>r("/wx/getqrcode","POST",e),fromuserlist:e=>r("/api/user/fromuserlist","POST",e),agentApply:e=>r("/api/agentuser/add","POST",e),viewAgentInfo:e=>r("/api/agentuser/info","POST",e),userRevenue:e=>r("/api/my/getusermoneylist","POST",e),merchantRevenue:e=>r("/api/my/getshopusermoneylist","POST",e),cityAgentRevenue:e=>r("/api/my/getcitymoneylist","POST",e)},c=o;function d(){return"undefined"!=typeof navigator&&"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}}const u="function"==typeof Proxy,m="devtools-plugin:setup";class h{constructor(e,t){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=e,this.hook=t;const a={};if(e.settings)for(const s in e.settings){const t=e.settings[s];a[s]=t.defaultValue}const i=`__vue-devtools-plugin-settings__${e.id}`;let o={...a};try{const e=localStorage.getItem(i),t=JSON.parse(e);Object.assign(o,t)}catch(ms){}this.fallbacks={getSettings:()=>o,setSettings(e){try{localStorage.setItem(i,JSON.stringify(e))}catch(ms){}o=e}},t.on("plugin:settings:set",((e,t)=>{e===this.plugin.id&&this.fallbacks.setSettings(t)})),this.proxiedOn=new Proxy({},{get:(e,t)=>this.target?this.target.on[t]:(...e)=>{this.onQueue.push({method:t,args:e})}}),this.proxiedTarget=new Proxy({},{get:(e,t)=>this.target?this.target[t]:"on"===t?this.proxiedOn:Object.keys(this.fallbacks).includes(t)?(...e)=>(this.targetQueue.push({method:t,args:e,resolve:()=>{}}),this.fallbacks[t](...e)):(...e)=>new Promise((a=>{this.targetQueue.push({method:t,args:e,resolve:a})}))})}async setRealTarget(e){this.target=e;for(const t of this.onQueue)this.target.on[t.method](...t.args);for(const t of this.targetQueue)t.resolve(await this.target[t.method](...t.args))}}function p(e,t){const a=d(),i=d().__VUE_DEVTOOLS_GLOBAL_HOOK__,o=u&&e.enableEarlyProxy;if(!i||!a.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__&&o){const s=o?new h(e,i):null;(a.__VUE_DEVTOOLS_PLUGINS__=a.__VUE_DEVTOOLS_PLUGINS__||[]).push({pluginDescriptor:e,setupFn:t,proxy:s}),s&&t(s.proxiedTarget)}else i.emit(m,e,t)}
/*!
   * vuex v4.1.0
   * (c) 2022 Evan You
   * @license MIT
   */function g(e,t){Object.keys(e).forEach((function(a){return t(e[a],a)}))}function f(e){return null!==e&&"object"==typeof e}function y(e,t,a){return t.indexOf(e)<0&&(a&&a.prepend?t.unshift(e):t.push(e)),function(){var a=t.indexOf(e);a>-1&&t.splice(a,1)}}function v(e,t){e._actions=Object.create(null),e._mutations=Object.create(null),e._wrappedGetters=Object.create(null),e._modulesNamespaceMap=Object.create(null);var a=e.state;k(e,a,[],e._modules.root,!0),w(e,a,t)}function w(t,a,i){var o=t._state,s=t._scope;t.getters={},t._makeLocalGettersCache=Object.create(null);var n=t._wrappedGetters,r={},l={},c=e.effectScope(!0);c.run((function(){g(n,(function(a,i){r[i]=function(e,t){return function(){return e(t)}}(a,t),l[i]=e.computed((function(){return r[i]()})),Object.defineProperty(t.getters,i,{get:function(){return l[i].value},enumerable:!0})}))})),t._state=e.reactive({data:a}),t._scope=c,t.strict&&function(t){e.watch((function(){return t._state.data}),(function(){}),{deep:!0,flush:"sync"})}(t),o&&i&&t._withCommit((function(){o.data=null})),s&&s.stop()}function k(e,t,a,i,o){var s=!a.length,n=e._modules.getNamespace(a);if(i.namespaced&&(e._modulesNamespaceMap[n],e._modulesNamespaceMap[n]=i),!s&&!o){var r=N(t,a.slice(0,-1)),l=a[a.length-1];e._withCommit((function(){r[l]=i.state}))}var c=i.context=function(e,t,a){var i=""===t,o={dispatch:i?e.dispatch:function(a,i,o){var s=b(a,i,o),n=s.payload,r=s.options,l=s.type;return r&&r.root||(l=t+l),e.dispatch(l,n)},commit:i?e.commit:function(a,i,o){var s=b(a,i,o),n=s.payload,r=s.options,l=s.type;r&&r.root||(l=t+l),e.commit(l,n,r)}};return Object.defineProperties(o,{getters:{get:i?function(){return e.getters}:function(){return E(e,t)}},state:{get:function(){return N(e.state,a)}}}),o}(e,n,a);i.forEachMutation((function(t,a){!function(e,t,a,i){var o=e._mutations[t]||(e._mutations[t]=[]);o.push((function(t){a.call(e,i.state,t)}))}(e,n+a,t,c)})),i.forEachAction((function(t,a){var i=t.root?a:n+a,o=t.handler||t;!function(e,t,a,i){var o=e._actions[t]||(e._actions[t]=[]);o.push((function(t){var o,s=a.call(e,{dispatch:i.dispatch,commit:i.commit,getters:i.getters,state:i.state,rootGetters:e.getters,rootState:e.state},t);return(o=s)&&"function"==typeof o.then||(s=Promise.resolve(s)),e._devtoolHook?s.catch((function(t){throw e._devtoolHook.emit("vuex:error",t),t})):s}))}(e,i,o,c)})),i.forEachGetter((function(t,a){!function(e,t,a,i){if(e._wrappedGetters[t])return;e._wrappedGetters[t]=function(e){return a(i.state,i.getters,e.state,e.getters)}}(e,n+a,t,c)})),i.forEachChild((function(i,s){k(e,t,a.concat(s),i,o)}))}function E(e,t){if(!e._makeLocalGettersCache[t]){var a={},i=t.length;Object.keys(e.getters).forEach((function(o){if(o.slice(0,i)===t){var s=o.slice(i);Object.defineProperty(a,s,{get:function(){return e.getters[o]},enumerable:!0})}})),e._makeLocalGettersCache[t]=a}return e._makeLocalGettersCache[t]}function N(e,t){return t.reduce((function(e,t){return e[t]}),e)}function b(e,t,a){return f(e)&&e.type&&(a=t,t=e,e=e.type),{type:e,payload:t,options:a}}var V="vuex:mutations",S="vuex:actions",x="vuex",C=0;function D(e,t){p({id:"org.vuejs.vuex",app:e,label:"Vuex",homepage:"https://next.vuex.vuejs.org/",logo:"https://vuejs.org/images/icons/favicon-96x96.png",packageName:"vuex",componentStateTypes:["vuex bindings"]},(function(a){a.addTimelineLayer({id:V,label:"Vuex Mutations",color:T}),a.addTimelineLayer({id:S,label:"Vuex Actions",color:T}),a.addInspector({id:x,label:"Vuex",icon:"storage",treeFilterPlaceholder:"Filter stores..."}),a.on.getInspectorTree((function(a){if(a.app===e&&a.inspectorId===x)if(a.filter){var i=[];B(i,t._modules.root,a.filter,""),a.rootNodes=i}else a.rootNodes=[I(t._modules.root,"")]})),a.on.getInspectorState((function(a){if(a.app===e&&a.inspectorId===x){var i=a.nodeId;E(t,i),a.state=function(e,t,a){t="root"===a?t:t[a];var i=Object.keys(t),o={state:Object.keys(e.state).map((function(t){return{key:t,editable:!0,value:e.state[t]}}))};if(i.length){var s=function(e){var t={};return Object.keys(e).forEach((function(a){var i=a.split("/");if(i.length>1){var o=t,s=i.pop();i.forEach((function(e){o[e]||(o[e]={_custom:{value:{},display:e,tooltip:"Module",abstract:!0}}),o=o[e]._custom.value})),o[s]=A((function(){return e[a]}))}else t[a]=A((function(){return e[a]}))})),t}(t);o.getters=Object.keys(s).map((function(e){return{key:e.endsWith("/")?P(e):e,editable:!1,value:A((function(){return s[e]}))}}))}return o}((o=t._modules,(n=(s=i).split("/").filter((function(e){return e}))).reduce((function(e,t,a){var i=e[t];if(!i)throw new Error('Missing module "'+t+'" for path "'+s+'".');return a===n.length-1?i:i._children}),"root"===s?o:o.root._children)),"root"===i?t.getters:t._makeLocalGettersCache,i)}var o,s,n})),a.on.editInspectorState((function(a){if(a.app===e&&a.inspectorId===x){var i=a.nodeId,o=a.path;"root"!==i&&(o=i.split("/").filter(Boolean).concat(o)),t._withCommit((function(){a.set(t._state.data,o,a.state.value)}))}})),t.subscribe((function(e,t){var i={};e.payload&&(i.payload=e.payload),i.state=t,a.notifyComponentUpdate(),a.sendInspectorTree(x),a.sendInspectorState(x),a.addTimelineEvent({layerId:V,event:{time:Date.now(),title:e.type,data:i}})})),t.subscribeAction({before:function(e,t){var i={};e.payload&&(i.payload=e.payload),e._id=C++,e._time=Date.now(),i.state=t,a.addTimelineEvent({layerId:S,event:{time:e._time,title:e.type,groupId:e._id,subtitle:"start",data:i}})},after:function(e,t){var i={},o=Date.now()-e._time;i.duration={_custom:{type:"duration",display:o+"ms",tooltip:"Action duration",value:o}},e.payload&&(i.payload=e.payload),i.state=t,a.addTimelineEvent({layerId:S,event:{time:Date.now(),title:e.type,groupId:e._id,subtitle:"end",data:i}})}})}))}var T=8702998,_={label:"namespaced",textColor:16777215,backgroundColor:6710886};function P(e){return e&&"root"!==e?e.split("/").slice(-2,-1)[0]:"Root"}function I(e,t){return{id:t||"root",label:P(t),tags:e.namespaced?[_]:[],children:Object.keys(e._children).map((function(a){return I(e._children[a],t+a+"/")}))}}function B(e,t,a,i){i.includes(a)&&e.push({id:i||"root",label:i.endsWith("/")?i.slice(0,i.length-1):i||"Root",tags:t.namespaced?[_]:[]}),Object.keys(t._children).forEach((function(o){B(e,t._children[o],a,i+o+"/")}))}function A(e){try{return e()}catch(ms){return ms}}var M=function(e,t){this.runtime=t,this._children=Object.create(null),this._rawModule=e;var a=e.state;this.state=("function"==typeof a?a():a)||{}},L={namespaced:{configurable:!0}};L.namespaced.get=function(){return!!this._rawModule.namespaced},M.prototype.addChild=function(e,t){this._children[e]=t},M.prototype.removeChild=function(e){delete this._children[e]},M.prototype.getChild=function(e){return this._children[e]},M.prototype.hasChild=function(e){return e in this._children},M.prototype.update=function(e){this._rawModule.namespaced=e.namespaced,e.actions&&(this._rawModule.actions=e.actions),e.mutations&&(this._rawModule.mutations=e.mutations),e.getters&&(this._rawModule.getters=e.getters)},M.prototype.forEachChild=function(e){g(this._children,e)},M.prototype.forEachGetter=function(e){this._rawModule.getters&&g(this._rawModule.getters,e)},M.prototype.forEachAction=function(e){this._rawModule.actions&&g(this._rawModule.actions,e)},M.prototype.forEachMutation=function(e){this._rawModule.mutations&&g(this._rawModule.mutations,e)},Object.defineProperties(M.prototype,L);var O=function(e){this.register([],e,!1)};function F(e,t,a){if(t.update(a),a.modules)for(var i in a.modules){if(!t.getChild(i))return;F(e.concat(i),t.getChild(i),a.modules[i])}}O.prototype.get=function(e){return e.reduce((function(e,t){return e.getChild(t)}),this.root)},O.prototype.getNamespace=function(e){var t=this.root;return e.reduce((function(e,a){return e+((t=t.getChild(a)).namespaced?a+"/":"")}),"")},O.prototype.update=function(e){F([],this.root,e)},O.prototype.register=function(e,t,a){var i=this;void 0===a&&(a=!0);var o=new M(t,a);0===e.length?this.root=o:this.get(e.slice(0,-1)).addChild(e[e.length-1],o);t.modules&&g(t.modules,(function(t,o){i.register(e.concat(o),t,a)}))},O.prototype.unregister=function(e){var t=this.get(e.slice(0,-1)),a=e[e.length-1],i=t.getChild(a);i&&i.runtime&&t.removeChild(a)},O.prototype.isRegistered=function(e){var t=this.get(e.slice(0,-1)),a=e[e.length-1];return!!t&&t.hasChild(a)};var R=function(e){var t=this;void 0===e&&(e={});var a=e.plugins;void 0===a&&(a=[]);var i=e.strict;void 0===i&&(i=!1);var o=e.devtools;this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new O(e),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._makeLocalGettersCache=Object.create(null),this._scope=null,this._devtools=o;var s=this,n=this.dispatch,r=this.commit;this.dispatch=function(e,t){return n.call(s,e,t)},this.commit=function(e,t,a){return r.call(s,e,t,a)},this.strict=i;var l=this._modules.root.state;k(this,l,[],this._modules.root),w(this,l),a.forEach((function(e){return e(t)}))},z={state:{configurable:!0}};R.prototype.install=function(e,t){e.provide(t||"store",this),e.config.globalProperties.$store=this,void 0!==this._devtools&&this._devtools&&D(e,this)},z.state.get=function(){return this._state.data},z.state.set=function(e){},R.prototype.commit=function(e,t,a){var i=this,o=b(e,t,a),s=o.type,n=o.payload,r={type:s,payload:n},l=this._mutations[s];l&&(this._withCommit((function(){l.forEach((function(e){e(n)}))})),this._subscribers.slice().forEach((function(e){return e(r,i.state)})))},R.prototype.dispatch=function(e,t){var a=this,i=b(e,t),o=i.type,s=i.payload,n={type:o,payload:s},r=this._actions[o];if(r){try{this._actionSubscribers.slice().filter((function(e){return e.before})).forEach((function(e){return e.before(n,a.state)}))}catch(ms){}var l=r.length>1?Promise.all(r.map((function(e){return e(s)}))):r[0](s);return new Promise((function(e,t){l.then((function(t){try{a._actionSubscribers.filter((function(e){return e.after})).forEach((function(e){return e.after(n,a.state)}))}catch(ms){}e(t)}),(function(e){try{a._actionSubscribers.filter((function(e){return e.error})).forEach((function(t){return t.error(n,a.state,e)}))}catch(ms){}t(e)}))}))}},R.prototype.subscribe=function(e,t){return y(e,this._subscribers,t)},R.prototype.subscribeAction=function(e,t){return y("function"==typeof e?{before:e}:e,this._actionSubscribers,t)},R.prototype.watch=function(t,a,i){var o=this;return e.watch((function(){return t(o.state,o.getters)}),a,Object.assign({},i))},R.prototype.replaceState=function(e){var t=this;this._withCommit((function(){t._state.data=e}))},R.prototype.registerModule=function(e,t,a){void 0===a&&(a={}),"string"==typeof e&&(e=[e]),this._modules.register(e,t),k(this,this.state,e,this._modules.get(e),a.preserveState),w(this,this.state)},R.prototype.unregisterModule=function(e){var t=this;"string"==typeof e&&(e=[e]),this._modules.unregister(e),this._withCommit((function(){delete N(t.state,e.slice(0,-1))[e[e.length-1]]})),v(this)},R.prototype.hasModule=function(e){return"string"==typeof e&&(e=[e]),this._modules.isRegistered(e)},R.prototype.hotUpdate=function(e){this._modules.update(e),v(this,!0)},R.prototype._withCommit=function(e){var t=this._committing;this._committing=!0,e(),this._committing=t},Object.defineProperties(R.prototype,z);var $=q((function(e,t){var a={};return U(t).forEach((function(t){var i=t.key,o=t.val;a[i]=function(){for(var t=[],a=arguments.length;a--;)t[a]=arguments[a];var i=this.$store.commit;if(e){var s=H(this.$store,"mapMutations",e);if(!s)return;i=s.context.commit}return"function"==typeof o?o.apply(this,[i].concat(t)):i.apply(this.$store,[o].concat(t))}})),a})),j=q((function(e,t){var a={};return U(t).forEach((function(t){var i=t.key,o=t.val;o=e+o,a[i]=function(){if(!e||H(this.$store,"mapGetters",e))return this.$store.getters[o]},a[i].vuex=!0})),a}));function U(e){return function(e){return Array.isArray(e)||f(e)}(e)?Array.isArray(e)?e.map((function(e){return{key:e,val:e}})):Object.keys(e).map((function(t){return{key:t,val:e[t]}})):[]}function q(e){return function(t,a){return"string"!=typeof t?(a=t,t=""):"/"!==t.charAt(t.length-1)&&(t+="/"),e(t,a)}}function H(e,t,a){return e._modulesNamespaceMap[a]}const W=(e,t)=>{const a=e.__vccOpts||e;for(const[i,o]of t)a[i]=o;return a},G={data:()=>({NoticeList:["赠送积分说明"],selectedCountry:"china",multiArray:[[],[],[]],multiIndex:[0,0,0],provinceList:[],cityList:[],districtList:[],marketList:[],marketIdMap:{},selectedMarketIndex:0,area_id:null,market_id:null,overseasCountries:[],overseasCities:[],overseasCountryId:null,overseasCityId:null,signTotalData:{}}),computed:{displayArray(){return"china"===this.selectedCountry?[this.multiArray[0],this.multiArray[1],this.multiArray[2]]:[this.multiArray[0],this.multiArray[1],[]]},displayMarketList(){return"china"===this.selectedCountry?this.marketList:["暂无数据"]}},watch:{selectedCountry(e){this.selectCountry(e)}},async mounted(){await this.initializePicker();let e=await l.signTotal();this.signTotalData=e.data},methods:{gotodemo(){uni.navigateTo({url:"/pages/demo/demo"})},goToJackpot(){uni.navigateTo({url:"/pages/jackpot/jackpot"})},...$("location",["setStatus"]),goTorules(e){switch(t("log","at pages/index1/index1.vue:123",e),e){case"赠送积分说明":uni.navigateTo({url:"/pages/rules/rules"});break;case"关于春节放假通知":uni.navigateTo({url:"/pages/arrangeNotification/arrangeNotification"})}},async initializePicker(){try{if("china"===this.selectedCountry){const e=await this.fetchProvinces();if(this.multiArray[0]=e.map((e=>e.name)),e.length>0){const t=await this.fetchCities(e[20].id);if(this.multiArray[1]=t.map((e=>e.name)),t.length>0){const e=await this.fetchAreas(2306);this.multiArray[2]=e.map((e=>e.name))}}this.multiIndex=[20,3,6]}else if("overseas"===this.selectedCountry){const e=await this.fetchOverseas();this.multiArray[0]=e.map((e=>e.shortname)),this.multiArray[1]=[],this.multiArray[2]=[],this.multiIndex=[0,0,0]}}catch(e){t("error","at pages/index1/index1.vue:171","Failed to initialize picker:",e)}this.fetchMarkets(2313),this.selectedMarketIndex=1},async fetchProvinces(){try{const e=await l.citylist({level:1,limit:100});if(200===e.code)return this.provinceList=e.data.listdata,this.provinceList;throw new Error("Failed to fetch provinces")}catch(e){throw t("error","at pages/index1/index1.vue:195","Failed to fetch provinces:",e),e}},async fetchCities(e){try{const a=await l.citytree(e);return 200===a.code&&Array.isArray(a.data)?(this.cityList=a.data,a.data):(t("error","at pages/index1/index1.vue:206","No cities data found"),[])}catch(a){return t("error","at pages/index1/index1.vue:210","Failed to fetch cities:",a),[]}},async fetchAreas(e){try{const a=await l.citytree(e);return 200===a.code&&Array.isArray(a.data)?(this.districtList=a.data,a.data):(t("error","at pages/index1/index1.vue:221","No areas data found"),[])}catch(a){return t("error","at pages/index1/index1.vue:225","Failed to fetch areas:",a),[]}},async fetchOverseas(){try{const e=await l.countrylist(0,200,1);if(200===e.code)return this.overseasCountries=e.data.listdata,this.multiArray[0]=this.overseasCountries.map((e=>e.shortname)),this.multiArray[1]=[],this.multiArray[2]=[],this.multiIndex=[0,0,0],this.overseasCountries;throw new Error("Failed to fetch overseas continents")}catch(e){throw t("error","at pages/index1/index1.vue:243","Failed to fetch overseas continents:",e),e}},async fetchOverseasCities(e){try{const t=await l.countrylist(e,100,1);if(200===t.code)return this.overseasCities=t.data.listdata,this.multiArray[1]=this.overseasCities.map((e=>e.shortname)),this.multiArray[2]=[],this.multiIndex[1]=0,this.multiIndex[2]=0,this.overseasCities;throw new Error("Failed to fetch overseas countries")}catch(a){throw t("error","at pages/index1/index1.vue:261","Failed to fetch overseas countries:",a),a}},async selectCountry(e){this.selectedCountry=e,this.multiArray=[[],[],[]],this.marketList=[],this.selectedMarketIndex=0,this.area_id=null,this.market_id=null,"china"===e?await this.initializePicker():"overseas"===e&&await this.fetchOverseas()},async bindMultiPickerColumnChange(e){const t=e.detail.column,a=e.detail.value;if("china"===this.selectedCountry){if(0===t){const e=this.provinceList[a];if(e&&void 0!==e.id){const t=await this.fetchCities(e.id);if(this.multiArray[1]=t.map((e=>e.name)),t.length>0){const e=await this.fetchAreas(t[0].id);this.multiArray[2]=e.map((e=>e.name))}else this.multiArray[2]=[]}this.multiIndex[1]=0,this.multiIndex[2]=0}else if(1===t){const e=this.cityList[a];if(e&&void 0!==e.id){const t=await this.fetchAreas(e.id);this.multiArray[2]=t.map((e=>e.name))}else this.multiArray[2]=[];this.multiIndex[2]=0}}else if("overseas"===this.selectedCountry)if(0===t){const e=this.overseasCountries[a];e&&void 0!==e.id&&await this.fetchOverseasCities(e.id),this.multiArray[2]=[],this.multiIndex[1]=0,this.multiIndex[2]=0}else 1===t&&(this.multiArray[2]=[],this.multiIndex[2]=0);this.multiIndex[t]=a,this.multiIndex=[...this.multiIndex]},async bindMultiPickerChange(e){var t,a,i,o;if(this.multiIndex=e.detail.value,"china"===this.selectedCountry){const e=this.multiIndex[1],i=(null==(t=this.cityList[e])?void 0:t.id)||null;i&&(await this.fetchAreas(i),this.area_id=(null==(a=this.districtList[this.multiIndex[2]])?void 0:a.id)||null,await this.fetchMarkets(this.area_id))}else if("overseas"===this.selectedCountry){const e=this.multiIndex[0];this.overseasCountryId=(null==(i=this.overseasCountries[e])?void 0:i.id)||null;const t=this.multiIndex[1];this.overseasCountryId&&(await this.fetchOverseasCities(this.overseasCountryId),this.overseasCityId=(null==(o=this.overseasCities[t])?void 0:o.id)||null)}},async fetchMarkets(e){try{const a=100,i=await l.marketlist(e,a);200===i.code&&Array.isArray(i.data.listdata)?(this.marketList=i.data.listdata.map((e=>e.marketname)),this.marketIdMap=i.data.listdata.reduce(((e,t)=>(e[t.marketname]=t.id,e)),{})):(t("error","at pages/index1/index1.vue:362","No market data found"),this.marketList=[],this.marketIdMap={})}catch(a){t("error","at pages/index1/index1.vue:367","Failed to fetch markets:",a),this.marketList=[],this.marketIdMap={}}},bindMarketChange(e){this.selectedMarketIndex=e.detail.value;const t=this.marketList[this.selectedMarketIndex];this.market_id=this.marketIdMap[t]||null},saveData(){const e={multiIndex:this.multiIndex,area_id:this.area_id,market_id:this.marketIdMap[this.displayMarketList[this.selectedMarketIndex]],selectedMarketIndex:this.selectedMarketIndex,marketName:this.displayMarketList[this.selectedMarketIndex]};this.setStatus(),uni.setStorageSync("userSelection",e),uni.showToast({title:"正在加载",icon:"success"}),uni.switchTab({url:"/pages/index/index"})},loadSavedData(){const e=uni.getStorageSync("userSelection");e?(this.multiIndex=e.multiIndex||[0,0,0],this.area_id=e.area_id||null,this.market_id=e.market_id||null,this.selectedMarketIndex=e.selectedMarketIndex||0,this.initializePicker().then((()=>{this.area_id&&"china"===this.selectedCountry&&this.fetchMarkets(this.area_id)}))):this.initializePicker()}}};const J=W(G,[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"me-container"},[e.createElementVNode("view",{class:"top"}," 农链天下 "),e.createElementVNode("view",{class:"region"},[e.createElementVNode("view",{class:"nation"},[e.createElementVNode("view",{class:e.normalizeClass(["china",{active:"china"===s.selectedCountry}]),onClick:a[0]||(a[0]=e=>n.selectCountry("china"))},"中国 ",2),e.createElementVNode("view",{class:e.normalizeClass(["overseas",{active:"overseas"===s.selectedCountry}]),onClick:a[1]||(a[1]=e=>n.selectCountry("overseas"))},"海外",2)]),e.createElementVNode("view",{class:"area"},[e.createElementVNode("text",null,"所在的地区"),e.createElementVNode("picker",{class:"picker",mode:"multiSelector",range:s.multiArray,value:s.multiIndex,onChange:a[2]||(a[2]=(...e)=>n.bindMultiPickerChange&&n.bindMultiPickerChange(...e)),onColumnchange:a[3]||(a[3]=(...e)=>n.bindMultiPickerColumnChange&&n.bindMultiPickerColumnChange(...e))},[e.createElementVNode("view",{class:"picker-text"},e.toDisplayString(s.multiArray[0][s.multiIndex[0]])+" - "+e.toDisplayString(s.multiArray[1][s.multiIndex[1]]?s.multiArray[1][s.multiIndex[1]]:"暂无数据")+" -"+e.toDisplayString("overseas"===s.selectedCountry?"":s.multiArray[2][s.multiIndex[2]]),1)],40,["range","value"])]),e.createElementVNode("view",{class:"Address"},[e.createElementVNode("text",null,"选择菜市场"),e.createElementVNode("picker",{class:"picker",mode:"selector",range:n.displayMarketList,value:s.selectedMarketIndex,onChange:a[4]||(a[4]=(...e)=>n.bindMarketChange&&n.bindMarketChange(...e))},[e.createElementVNode("view",{class:"picker-text"},e.toDisplayString(n.displayMarketList[s.selectedMarketIndex]),1)],40,["range","value"])]),e.createElementVNode("button",{class:"save",onClick:a[5]||(a[5]=(...e)=>n.saveData&&n.saveData(...e))},"立即逛")]),e.createElementVNode("button",{style:{margin:"50rpx"},onClick:a[6]||(a[6]=(...e)=>n.goToJackpot&&n.goToJackpot(...e))},"免费卖菜")])}]]),Y=[{font_class:"arrow-down",unicode:""},{font_class:"arrow-left",unicode:""},{font_class:"arrow-right",unicode:""},{font_class:"arrow-up",unicode:""},{font_class:"auth",unicode:""},{font_class:"auth-filled",unicode:""},{font_class:"back",unicode:""},{font_class:"bars",unicode:""},{font_class:"calendar",unicode:""},{font_class:"calendar-filled",unicode:""},{font_class:"camera",unicode:""},{font_class:"camera-filled",unicode:""},{font_class:"cart",unicode:""},{font_class:"cart-filled",unicode:""},{font_class:"chat",unicode:""},{font_class:"chat-filled",unicode:""},{font_class:"chatboxes",unicode:""},{font_class:"chatboxes-filled",unicode:""},{font_class:"chatbubble",unicode:""},{font_class:"chatbubble-filled",unicode:""},{font_class:"checkbox",unicode:""},{font_class:"checkbox-filled",unicode:""},{font_class:"checkmarkempty",unicode:""},{font_class:"circle",unicode:""},{font_class:"circle-filled",unicode:""},{font_class:"clear",unicode:""},{font_class:"close",unicode:""},{font_class:"closeempty",unicode:""},{font_class:"cloud-download",unicode:""},{font_class:"cloud-download-filled",unicode:""},{font_class:"cloud-upload",unicode:""},{font_class:"cloud-upload-filled",unicode:""},{font_class:"color",unicode:""},{font_class:"color-filled",unicode:""},{font_class:"compose",unicode:""},{font_class:"contact",unicode:""},{font_class:"contact-filled",unicode:""},{font_class:"down",unicode:""},{font_class:"bottom",unicode:""},{font_class:"download",unicode:""},{font_class:"download-filled",unicode:""},{font_class:"email",unicode:""},{font_class:"email-filled",unicode:""},{font_class:"eye",unicode:""},{font_class:"eye-filled",unicode:""},{font_class:"eye-slash",unicode:""},{font_class:"eye-slash-filled",unicode:""},{font_class:"fire",unicode:""},{font_class:"fire-filled",unicode:""},{font_class:"flag",unicode:""},{font_class:"flag-filled",unicode:""},{font_class:"folder-add",unicode:""},{font_class:"folder-add-filled",unicode:""},{font_class:"font",unicode:""},{font_class:"forward",unicode:""},{font_class:"gear",unicode:""},{font_class:"gear-filled",unicode:""},{font_class:"gift",unicode:""},{font_class:"gift-filled",unicode:""},{font_class:"hand-down",unicode:""},{font_class:"hand-down-filled",unicode:""},{font_class:"hand-up",unicode:""},{font_class:"hand-up-filled",unicode:""},{font_class:"headphones",unicode:""},{font_class:"heart",unicode:""},{font_class:"heart-filled",unicode:""},{font_class:"help",unicode:""},{font_class:"help-filled",unicode:""},{font_class:"home",unicode:""},{font_class:"home-filled",unicode:""},{font_class:"image",unicode:""},{font_class:"image-filled",unicode:""},{font_class:"images",unicode:""},{font_class:"images-filled",unicode:""},{font_class:"info",unicode:""},{font_class:"info-filled",unicode:""},{font_class:"left",unicode:""},{font_class:"link",unicode:""},{font_class:"list",unicode:""},{font_class:"location",unicode:""},{font_class:"location-filled",unicode:""},{font_class:"locked",unicode:""},{font_class:"locked-filled",unicode:""},{font_class:"loop",unicode:""},{font_class:"mail-open",unicode:""},{font_class:"mail-open-filled",unicode:""},{font_class:"map",unicode:""},{font_class:"map-filled",unicode:""},{font_class:"map-pin",unicode:""},{font_class:"map-pin-ellipse",unicode:""},{font_class:"medal",unicode:""},{font_class:"medal-filled",unicode:""},{font_class:"mic",unicode:""},{font_class:"mic-filled",unicode:""},{font_class:"micoff",unicode:""},{font_class:"micoff-filled",unicode:""},{font_class:"minus",unicode:""},{font_class:"minus-filled",unicode:""},{font_class:"more",unicode:""},{font_class:"more-filled",unicode:""},{font_class:"navigate",unicode:""},{font_class:"navigate-filled",unicode:""},{font_class:"notification",unicode:""},{font_class:"notification-filled",unicode:""},{font_class:"paperclip",unicode:""},{font_class:"paperplane",unicode:""},{font_class:"paperplane-filled",unicode:""},{font_class:"person",unicode:""},{font_class:"person-filled",unicode:""},{font_class:"personadd",unicode:""},{font_class:"personadd-filled",unicode:""},{font_class:"personadd-filled-copy",unicode:""},{font_class:"phone",unicode:""},{font_class:"phone-filled",unicode:""},{font_class:"plus",unicode:""},{font_class:"plus-filled",unicode:""},{font_class:"plusempty",unicode:""},{font_class:"pulldown",unicode:""},{font_class:"pyq",unicode:""},{font_class:"qq",unicode:""},{font_class:"redo",unicode:""},{font_class:"redo-filled",unicode:""},{font_class:"refresh",unicode:""},{font_class:"refresh-filled",unicode:""},{font_class:"refreshempty",unicode:""},{font_class:"reload",unicode:""},{font_class:"right",unicode:""},{font_class:"scan",unicode:""},{font_class:"search",unicode:""},{font_class:"settings",unicode:""},{font_class:"settings-filled",unicode:""},{font_class:"shop",unicode:""},{font_class:"shop-filled",unicode:""},{font_class:"smallcircle",unicode:""},{font_class:"smallcircle-filled",unicode:""},{font_class:"sound",unicode:""},{font_class:"sound-filled",unicode:""},{font_class:"spinner-cycle",unicode:""},{font_class:"staff",unicode:""},{font_class:"staff-filled",unicode:""},{font_class:"star",unicode:""},{font_class:"star-filled",unicode:""},{font_class:"starhalf",unicode:""},{font_class:"trash",unicode:""},{font_class:"trash-filled",unicode:""},{font_class:"tune",unicode:""},{font_class:"tune-filled",unicode:""},{font_class:"undo",unicode:""},{font_class:"undo-filled",unicode:""},{font_class:"up",unicode:""},{font_class:"top",unicode:""},{font_class:"upload",unicode:""},{font_class:"upload-filled",unicode:""},{font_class:"videocam",unicode:""},{font_class:"videocam-filled",unicode:""},{font_class:"vip",unicode:""},{font_class:"vip-filled",unicode:""},{font_class:"wallet",unicode:""},{font_class:"wallet-filled",unicode:""},{font_class:"weibo",unicode:""},{font_class:"weixin",unicode:""}];const K=W({name:"UniIcons",emits:["click"],props:{type:{type:String,default:""},color:{type:String,default:"#333333"},size:{type:[Number,String],default:16},customPrefix:{type:String,default:""},fontFamily:{type:String,default:""}},data:()=>({icons:Y}),computed:{unicode(){let e=this.icons.find((e=>e.font_class===this.type));return e?e.unicode:""},iconSize(){return"number"==typeof(e=this.size)||/^[0-9]*$/g.test(e)?e+"px":e;var e},styleObj(){return""!==this.fontFamily?`color: ${this.color}; font-size: ${this.iconSize}; font-family: ${this.fontFamily};`:`color: ${this.color}; font-size: ${this.iconSize};`}},methods:{_onClick(){this.$emit("click")}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("text",{style:e.normalizeStyle(n.styleObj),class:e.normalizeClass(["uni-icons",["uniui-"+i.type,i.customPrefix,i.customPrefix?i.type:""]]),onClick:a[0]||(a[0]=(...e)=>n._onClick&&n._onClick(...e))},[e.renderSlot(t.$slots,"default",{},void 0,!0)],6)}],["__scopeId","data-v-2a0026b0"]]),Z=["{","}"];const Q=/^(?:\d)+/,X=/^(?:\w)+/;const ee="zh-Hans",te="zh-Hant",ae="en",ie=Object.prototype.hasOwnProperty,oe=(e,t)=>ie.call(e,t),se=new class{constructor(){this._caches=Object.create(null)}interpolate(e,t,a=Z){if(!t)return[e];let i=this._caches[e];return i||(i=function(e,[t,a]){const i=[];let o=0,s="";for(;o<e.length;){let n=e[o++];if(n===t){s&&i.push({type:"text",value:s}),s="";let t="";for(n=e[o++];void 0!==n&&n!==a;)t+=n,n=e[o++];const r=n===a,l=Q.test(t)?"list":r&&X.test(t)?"named":"unknown";i.push({value:t,type:l})}else s+=n}return s&&i.push({type:"text",value:s}),i}(e,a),this._caches[e]=i),function(e,t){const a=[];let i=0;const o=Array.isArray(t)?"list":(s=t,null!==s&&"object"==typeof s?"named":"unknown");var s;if("unknown"===o)return a;for(;i<e.length;){const s=e[i];switch(s.type){case"text":a.push(s.value);break;case"list":a.push(t[parseInt(s.value,10)]);break;case"named":"named"===o&&a.push(t[s.value])}i++}return a}(i,t)}};function ne(e,t){if(!e)return;if(e=e.trim().replace(/_/g,"-"),t&&t[e])return e;if("chinese"===(e=e.toLowerCase()))return ee;if(0===e.indexOf("zh"))return e.indexOf("-hans")>-1?ee:e.indexOf("-hant")>-1?te:(a=e,["-tw","-hk","-mo","-cht"].find((e=>-1!==a.indexOf(e)))?te:ee);var a;let i=[ae,"fr","es"];t&&Object.keys(t).length>0&&(i=Object.keys(t));const o=function(e,t){return t.find((t=>0===e.indexOf(t)))}(e,i);return o||void 0}class re{constructor({locale:e,fallbackLocale:t,messages:a,watcher:i,formater:o}){this.locale=ae,this.fallbackLocale=ae,this.message={},this.messages={},this.watchers=[],t&&(this.fallbackLocale=t),this.formater=o||se,this.messages=a||{},this.setLocale(e||ae),i&&this.watchLocale(i)}setLocale(e){const t=this.locale;this.locale=ne(e,this.messages)||this.fallbackLocale,this.messages[this.locale]||(this.messages[this.locale]={}),this.message=this.messages[this.locale],t!==this.locale&&this.watchers.forEach((e=>{e(this.locale,t)}))}getLocale(){return this.locale}watchLocale(e){const t=this.watchers.push(e)-1;return()=>{this.watchers.splice(t,1)}}add(e,t,a=!0){const i=this.messages[e];i?a?Object.assign(i,t):Object.keys(t).forEach((e=>{oe(i,e)||(i[e]=t[e])})):this.messages[e]=t}f(e,t,a){return this.formater.interpolate(e,t,a).join("")}t(e,t,a){let i=this.message;return"string"==typeof t?(t=ne(t,this.messages))&&(i=this.messages[t]):a=t,oe(i,e)?this.formater.interpolate(i[e],a).join(""):(console.warn(`Cannot translate the value of keypath ${e}. Use the value of keypath as default.`),e)}}function le(e,t={},a,i){if("string"!=typeof e){const a=[t,e];e=a[0],t=a[1]}"string"!=typeof e&&(e="undefined"!=typeof uni&&uni.getLocale?uni.getLocale():"undefined"!=typeof global&&global.getLocale?global.getLocale():ae),"string"!=typeof a&&(a="undefined"!=typeof __uniConfig&&__uniConfig.fallbackLocale||ae);const o=new re({locale:e,fallbackLocale:a,messages:t,watcher:i});let s=(e,t)=>{if("function"!=typeof getApp)s=function(e,t){return o.t(e,t)};else{let e=!1;s=function(t,a){const i=getApp().$vm;return i&&(i.$locale,e||(e=!0,function(e,t){e.$watchLocale?e.$watchLocale((e=>{t.setLocale(e)})):e.$watch((()=>e.$locale),(e=>{t.setLocale(e)}))}(i,o))),o.t(t,a)}}return s(e,t)};return{i18n:o,f:(e,t,a)=>o.f(e,t,a),t:(e,t)=>s(e,t),add:(e,t,a=!0)=>o.add(e,t,a),watch:e=>o.watchLocale(e),getLocale:()=>o.getLocale(),setLocale:e=>o.setLocale(e)}}const ce={en:{"uni-load-more.contentdown":"Pull up to show more","uni-load-more.contentrefresh":"loading...","uni-load-more.contentnomore":"No more data"},"zh-Hans":{"uni-load-more.contentdown":"上拉显示更多","uni-load-more.contentrefresh":"正在加载...","uni-load-more.contentnomore":"没有更多数据了"},"zh-Hant":{"uni-load-more.contentdown":"上拉顯示更多","uni-load-more.contentrefresh":"正在加載...","uni-load-more.contentnomore":"沒有更多數據了"}};let de;setTimeout((()=>{de=uni.getSystemInfoSync().platform}),16);const{t:ue}=le(ce);const me=W({name:"UniLoadMore",emits:["clickLoadMore"],props:{status:{type:String,default:"more"},showIcon:{type:Boolean,default:!0},iconType:{type:String,default:"auto"},iconSize:{type:Number,default:24},color:{type:String,default:"#777777"},contentText:{type:Object,default:()=>({contentdown:"",contentrefresh:"",contentnomore:""})},showText:{type:Boolean,default:!0}},data:()=>({webviewHide:!1,platform:de,imgBase64:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QzlBMzU3OTlEOUM0MTFFOUI0NTZDNERBQURBQzI4RkUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QzlBMzU3OUFEOUM0MTFFOUI0NTZDNERBQURBQzI4RkUiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpDOUEzNTc5N0Q5QzQxMUU5QjQ1NkM0REFBREFDMjhGRSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpDOUEzNTc5OEQ5QzQxMUU5QjQ1NkM0REFBREFDMjhGRSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pt+ALSwAAA6CSURBVHja1FsLkFZVHb98LM+F5bHL8khA1iSeiyQBCRM+YGqKUnnJTDLGI0BGZlKDIU2MMglUiDApEZvSsZnQtBRJtKwQNKQMFYeRDR10WOLd8ljYXdh+v8v5fR3Od+797t1dnOnO/Ofce77z+J//+b/P+ZqtXbs2sJ9MJhNUV1cHJ06cCJo3bx7EPc2aNcvpy7pWrVoF+/fvDyoqKoI2bdoE9fX1F7TjN8a+EXBn/fkfvw942Tf+wYMHg9mzZwfjxo0LDhw4EPa1x2MbFw/fOGfPng1qa2tzcCkILsLDydq2bRsunpOTMM7TD/W/tZDZhPdeKD+yGxHhdu3aBV27dg3OnDlzMVANMheLAO3btw8KCwuDmpoaX5OxbgUIMEq7K8IcPnw4KCsrC/r37x8cP378/4cAXAB3vqSkJMuiDhTkw+XcuXNhOWbMmKBly5YhUT8xArhyFvP0BfwRsAuwxJZJsm/nzp2DTp06he/OU+cZ64K6o0ePBkOHDg2GDx8e6gEbJ5Q/NHNuAJQ1hgBeHUDlR7nVTkY8rQAvAi4z34vR/mPs1FoRsaCgIJThI0eOBC1atEiFGGV+5MiRoS45efJkqFjJFXV1dQuA012m2WcwTw98fy6CqBdsaiIO4CScrGPHjvk4odhavPquRtFWXEC25VgkREKOCh/qDSq+vn37htzD/mZTOmOc5U7zKzBPEedygWshcDyWvs30igAbU+6oyMgJBCFhwQE0fccxN60Ay9iebbjoDh06hMowjQxT4fXq1SskArmHZpkArvixp/kWzHdMeArExSJEaiXIjjRjRJ4DaAGWpibLzXN3Fm1vA5teBgh3j1Rv3bp1YgKwPdmf2p9zcyNYYgPKMfY0T5f5nNYdw158nJ8QawW4CLKwiOBSEgO/hok2eBydR+3dYH+PLxA5J8Vv0KBBwenTp0P2JWAx6+yFEBfs8lMY+y0SWMBNI9E4ThKi58VKTg3FQZS1RQF1cz27eC0QHMu+3E0SkUowjhVt5VdaWhp07949ZHv2Qd1EjDXM2cla1M0nl3GxAs3J9yREzyTdFVKVFOaE9qRA8GM0WebRuo9JGZKA7Mv2SeS/Z8+eoQ9BArMfFrLGo6jvxbhHbJZnKX2Rzz1O7QhJJ9Cs2ZMaWIyq/zhdeqPNfIoHd58clIQD+JSXl4dKlyIAuBdVXZwFVWKspSSoxE++h8x4k3uCnEhE4I5KwRiFWGOU0QWKiCYLbdoRMRKAu2kQ9vkfLU6dOhX06NEjlH+yMRZSinnuyWnYosVcji8CEA/6Cg2JF+IIUBqnGKUTCNwtwBN4f89RiK1R96DEgO2o0NDmtEdvVFdVVYV+P3UAPUEs6GFwV3PHmXkD4vh74iDFJysVI/MlaQhwKeBNTLYX5VuA8T4/gZxA4MRGFxDB6R7OmYPfyykGRJbyie+XnGYnQIC/coH9+vULiYrxrkL9ZA9+0ykaHIfEpM7ge8TiJ2CsHYwyMfafAF1yCGBHYIbCVDjDjKt7BeB51D+LgQa6OkG7IDYEEtvQ7lnXLKLtLdLuJBpE4gPUXcW2+PkZwOex+4cGDhwYDBkyRL7/HFcEwUGPo/8uWRUpYnfxGHco8HkewLHLyYmAawAPuIFZxhOpDfJQ8gbUv41yORAptMWBNr6oqMhWird5+u+iHmBb2nhjDV7HWBNQTgK8y11l5NetWzc5ULscAtSj7nbNI0skhWeUZCc0W4nyH/jO4Vz0u1IeYhbk4AiwM6tjxIWByHsoZ9qcIBPJd/y+DwPfBESOmCa/QF3WiZHucLlEDpNxcNhmheEOPgdQNx6/VZFQzFZ5TN08AHXQt2Ii3EdyFuUsPtTcGPhW5iMiCNELvz+Gdn9huG4HUJaW/w3g0wxV0XaG7arG2WeKiUWYM4Y7GO5ezshTARbbWGw/DvXkpp/ivVvE0JVoMxN4rpGzJMhE5Pl+xlATsDIqikP9F9D2z3h9nOksEUFhK+qO4rcPkoalMQ/HqJLIyb3F3JdjrCcw1yZ8joyJLR5gCo54etlag7qIoeNh1N1BRYj3DTFJ0elotxPlVzkGuYAmL0VSJVGAJA41c4Z6A3BzTLfn0HYwYKEI6CUAMzZEWvLsIcQOo1AmmyyM72nHJCfYsogflGV6jEk9vyQZXSuq6w4c16NsGcGZbwOPr+H1RkOk2LEzjNepxQkihHSCQ4ynAYNRx2zMKV92CQMWqj8J0BRE8EShxRFN6YrfCRhC0x3r/Zm4IbQCcmJoV0kMamllccR6FjHqUC5F2R/wS2dcymOlfAKOS4KmzQb5cpNC2MC7JhVn5wjXoJ44rYhLh8n0eXOCorJxa7POjbSlCGVczr34/RsAmrcvo9s+wGp3tzVhntxiXiJ4nvEYb4FJkf0O8HocAePmLvCxnL0AORraVekJk6TYjDabRVXfRE2lCN1h6ZQRN1+InUbsCpKwoBZHh0dODN9JBCUffItXxEavTQkUtnfTVAplCWL3JISz29h4NjotnuSsQKJCk8dF+kJR6RARjrqFVmfPnj3ZbK8cIJ0msd6jgHPGtfVTQ8VLmlvh4mct9sobRmPic0DyDQQnx/NlfYUgyz59+oScsH379pAwXABD32nTpoUHIToESeI5mnbE/UqDdyLcafEBf2MCqgC7NwxIbMREJQ0g4D4sfJwnD+AmRrII05cfMWJE+L1169bQr+fip06dGp4oJ83lmYd5wj/EmMa4TaHivo4EeCguYZBnkB5g2aWA69OIEnUHOaGysjIYMGBAMGnSpODYsWPZwCpFmm4lNq+4gSLQA7jcX8DwtjEyRC8wjabnXEx9kfWnTJkSJkAo90xpJVV+FmcVNeYAF5zWngS4C4O91MBxmAv8blLEpbjI5sz9MTdAhcgkCT1RO8mZkAjfiYpTEvStAS53Uw1vAiUGgZ3GpuQEYvoiBqlIan7kSDHnTwJQFNiPu0+5VxCVYhcZIjNrdXUDdp+Eq5AZ3Gkg8QAyVZRZIk4Tl4QAbF9cXJxNYZMAtAokgs4BrNxEpCtteXg7DDTMDKYNSuQdKsnJBek7HxewvxaosWxLYXtw+cJp18217wql4aKCfBNoEu0O5VU+PhctJ0YeXD4C6JQpyrlpSLTojpGGGN5YwNziChdIZLk4lvLcFJ9jMX3QdiImY9bmGQU+TRUL5CHITTRlgF8D9ouD1MfmLoEPl5xokIumZ2cfgMpHt47IW9N64Hsh7wQYYjyIugWuF5fCqYncXRd5vPMWyizzvhi/32+nvG0dZc9vR6fZOu0md5e+uC408FvKSIOZwXlGvxPv95izA2Vtvg1xKFWARI+vMX66HUhpQQb643uW1bSjuTWyw2SBvDrBvjFic1eGGlz5esq3ko9uSIlBRqPuFcCv8F4WIcN12nVaBd0SaYwI6PDDImR11JkqgHcPmQssjxIn6bUshygDFJUTxPMpHk+jfjPgupgdnYV2R/g7xSjtpah8RJBewhwf0gGK6XI92u4wXFEU40afJ4DN4h5LcAd+40HI3JgJecuT0c062W0i2hQJUTcxan3/CMW1PF2K6bbA+Daz4xRs1D3Br1Cm0OihKCqizW78/nXAF/G5TXrEcVzaNMH6CyMswqsAHqDyDLEyou8lwOXnKF8DjI6KjV3KzMBiXkDH8ij/H214J5A596ekrZ3F0zXlWeL7+P5eUrNo3/QwC15uxthuzidy7DzKRwEDaAViiDgKbTbz7CJnzo0bN7pIfIiid8SuPwn25o3QCmpnyjlZkyxPP8EomCJzrGb7GJMx7tNsq4MT2xMUYaiErZOluTzKsnz3gwCeCZyVRZJfYplNEokEjwrPtxlxjeYAk+F1F74VAzPxQRNYYdtpOUvWs8J1sGhBJMNsb7igN8plJs1eSmLIhLKE4rvaCX27gOhLpLOsIzJ7qn/i+wZzcvSOZ23/du8TZjwV8zHIXoP4R3ifBxiFz1dcVpa3aPntPE+c6TmIWE9EtcMmAcPdWAhYhAXxcLOQi9L1WhD1Sc8p1d2oL7XGiRKp8F4A2i8K/nfI+y/gsTDJ/YC/8+AD5Uh04KHiGl+cIFPnBDDrPMjwRGkLXyxO4VGbfQWnDH2v0bVWE3C9QOXlepbgjEfIJQI6XDG3z5ahD9cw2pS78ipB85wyScNTvsVzlzzhL8/jRrnmVjfFJK/m3m4nj9vbgQTguT8XZTjsm672R5uJKEaQmBI/c58gyus8ZDagLpEVSJBIyHp4jn++xqPV71OgQgJYEWOtZ/haxRtKmWOBu8xdBLftWltsY84zE6WIEy/eIOWL+BaayMx+KHtL7EAkqdNDLiEXmEMUHniedtJqg9HmZtfvt26vNi0BdG3Ft3g8ZOf7PAu59TxtzivLNIekyi+wD1i8CuUiD9FXAa8C+/xS3JPmZnomyc7H+fb4/Se0bk41Fel621r4cgVxbq91V4jVqwB7HTe2M7jgB+QWHavZkDRPmZcASoZEmBx6i75bGjPcMdL4/VKGFAGWZkGzPG0XAbdL9A81G5LOmUnC9hHKJeO7dcUMjblSl12867ElFTtaGl20xvvLGPdVz/8TVuU7y0x1PG7vtNg24oz9Uo/Z412++VFWI7Fcog9tu9Lm6gvRmIPv9x1xmQAu6RDkXtbOtlGEmpgD5Nvnyc0dcv0EE6cfdi1HmhMf9wDF3k3gtRvEedhxjpgfqPb9PU9iEJHnyOUA7bQUXh6kq/D7l2iTjWv7XOD530BDr8jIrus+srXjt4MzumJMHuTsBa63YKE1+RR5lBjEikCCnWKWiHdzOgKO+nRIBAF88za/IFmJ3eMZov4CYxGBabcpGL8EYx+SeMXJeRwHNsV/h+vdxeuhEpN3ZyNY78Gm2fknJxVGhyjixPiQvVkNzT1elD9Py/aTAL64Hb9vcYmC9zfdXdT/C1LeGbg4rnBaAihDFJH12W5ulfNCNe/xTsP3bp8ikzJs5BF+5PNfAQYAPaseTdsEcaYAAAAASUVORK5CYII="}),computed:{iconSnowWidth(){return 2*(Math.floor(this.iconSize/24)||1)},contentdownText(){return this.contentText.contentdown||ue("uni-load-more.contentdown")},contentrefreshText(){return this.contentText.contentrefresh||ue("uni-load-more.contentrefresh")},contentnomoreText(){return this.contentText.contentnomore||ue("uni-load-more.contentnomore")}},mounted(){var e=getCurrentPages(),t=e[e.length-1].$getAppWebview();t.addEventListener("hide",(()=>{this.webviewHide=!0})),t.addEventListener("show",(()=>{this.webviewHide=!1}))},methods:{onClick(){this.$emit("clickLoadMore",{detail:{status:this.status}})}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"uni-load-more",onClick:a[0]||(a[0]=(...e)=>n.onClick&&n.onClick(...e))},[!s.webviewHide&&("circle"===i.iconType||"auto"===i.iconType&&"android"===s.platform)&&"loading"===i.status&&i.showIcon?(e.openBlock(),e.createElementBlock("view",{key:0,style:e.normalizeStyle({width:i.iconSize+"px",height:i.iconSize+"px"}),class:"uni-load-more__img uni-load-more__img--android-MP"},[e.createElementVNode("view",{class:"uni-load-more__img-icon",style:e.normalizeStyle({borderTopColor:i.color,borderTopWidth:i.iconSize/12})},null,4),e.createElementVNode("view",{class:"uni-load-more__img-icon",style:e.normalizeStyle({borderTopColor:i.color,borderTopWidth:i.iconSize/12})},null,4),e.createElementVNode("view",{class:"uni-load-more__img-icon",style:e.normalizeStyle({borderTopColor:i.color,borderTopWidth:i.iconSize/12})},null,4)],4)):!s.webviewHide&&"loading"===i.status&&i.showIcon?(e.openBlock(),e.createElementBlock("view",{key:1,style:e.normalizeStyle({width:i.iconSize+"px",height:i.iconSize+"px"}),class:"uni-load-more__img uni-load-more__img--ios-H5"},[e.createElementVNode("image",{src:s.imgBase64,mode:"widthFix"},null,8,["src"])],4)):e.createCommentVNode("",!0),i.showText?(e.openBlock(),e.createElementBlock("text",{key:2,class:"uni-load-more__text",style:e.normalizeStyle({color:i.color})},e.toDisplayString("more"===i.status?n.contentdownText:"loading"===i.status?n.contentrefreshText:n.contentnomoreText),5)):e.createCommentVNode("",!0)])}],["__scopeId","data-v-a7e112cc"]]),he={props:{menuList:{type:Array,default:()=>[{path:"/pages/myComplaint/myComplaint",label:"我的投诉"},{path:"/pages/orders/orders",label:"我的订单"}]}},data:()=>({isShowItem:!1,position:{x:0,y:0},isExpanded:!1,systemInfo:{},startY:0,isDragging:!1}),computed:{containerStyle(){return{width:`${this.systemInfo.windowWidth}px`,height:`${this.systemInfo.windowHeight}px`}}},mounted(){this.initPosition()},methods:{initPosition(){this.systemInfo=uni.getSystemInfoSync();const e=uni.getStorageSync("floatPos")||{x:this.systemInfo.windowWidth-80,y:.7*this.systemInfo.windowHeight};this.position=e},handleTouchStart(e){this.startY=e.touches[0].clientY,this.isDragging=!1},handleTouchEnd(){this.isDragging&&(this.autoDock(),uni.setStorageSync("floatPos",this.position))},autoDock(){const{windowWidth:e}=this.systemInfo;this.position.x=this.position.x>e/2?e-60:20},toggleMenu(){this.isShowItem=!this.isShowItem,t("log","at components/float-ball/float-ball.vue:103",this.isShowItem),this.isDragging||(this.isExpanded=!this.isExpanded)},navigateTo(e){this.isExpanded=!1,this.isShowItem=!1,uni.navigateTo({url:e})},layoutParams(){const e=this.menuList.length;return{radius:60+8*Math.min(e,6),angleStep:Math.max(360/e,30),itemSize:80}},getSubStyle(e){if(!this.isExpanded)return{opacity:0};const{radius:t,angleStep:a,itemSize:i}=this.layoutParams,o=(a*e-90)*Math.PI/180,s=i/2;return{transform:`translate(\n\t\t\t          ${Math.cos(o)*t-s}px,\n\t\t\t          ${Math.sin(o)*t-s}px\n\t\t\t        )`,width:`${i}px`,height:`${i}px`,transitionDelay:30*e+"ms",opacity:1,zIndex:this.menuList.length-e}}}};const pe=W(he,[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("movable-area",{class:"float-container",style:e.normalizeStyle([n.containerStyle])},[e.createElementVNode("movable-view",{class:"main-ball",x:s.position.x,y:s.position.y,direction:"all",inertia:"","out-of-bounds":"false",onTouchstart:a[1]||(a[1]=(...e)=>n.handleTouchStart&&n.handleTouchStart(...e)),onTouchend:a[2]||(a[2]=(...e)=>n.handleTouchEnd&&n.handleTouchEnd(...e)),disabled:s.isExpanded},[e.createElementVNode("view",{class:e.normalizeClass(["ball-core",{expanded:s.isExpanded}]),onClick:a[0]||(a[0]=e.withModifiers(((...e)=>n.toggleMenu&&n.toggleMenu(...e)),["stop"]))},e.toDisplayString(s.isExpanded?"×":"+"),3),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.menuList,((t,a)=>e.withDirectives((e.openBlock(),e.createElementBlock("view",{key:t.path,class:"sub-item",style:e.normalizeStyle([n.getSubStyle(a)]),onClick:e.withModifiers((e=>n.navigateTo(t.path)),["stop"])},e.toDisplayString(t.label),13,["onClick"])),[[e.vShow,s.isShowItem]]))),128))],40,["x","y","disabled"])],4)}],["__scopeId","data-v-a9499a2a"]]),ge={data:()=>({page:1,limit:10,totalnum:0,pageData:[],pageLoading:!1,hasMore:!0,searchParams:{}}),computed:{queryParams(){const e=Object.fromEntries(Object.entries(this.searchParams).filter((([e,t])=>""!==t)));return{page:this.page,limit:this.limit,isshow:1,...e}}},methods:{async loadPageData(){if(this.hasMore&&!this.pageLoading){this.pageLoading=!0;try{const e=await this.fetchData(this.queryParams);this.querySuccess(e)}catch(e){this.handleFetchError(e)}finally{this.pageLoading=!1}}},async fetchData(e){},querySuccess(e){(null==e?void 0:e.listdata)&&(this.pageData=1===this.page?e.listdata:this.pageData.concat(e.listdata),this.totalnum=e.totalnum||0,this.hasMore=this.pageData.length<this.totalnum)},handleScrollToLower(){!this.pageLoading&&this.hasMore&&(this.page+=1,this.loadPageData())},handleFetchError(e){t("error","at hooks/usePage.js:63","Error loading data:",e)},resetPagination(){this.page=1,this.pageData=[],this.totalnum=0,this.hasMore=!0},reloadData(){this.resetPagination(),this.loadPageData()}}};const fe=W({components:{floatBall:pe},data:()=>({prompt:!0,showNotice:!1,menuItems:[],tabs:[{id:0,title:"附近农户",path:"/subPackages/shoppingPageList/nearbyFarmers/nearbyFarmers"},{id:1,title:"预卖菜品",path:"/subPackages/shoppingPageList/villageZone/villageZone"},{id:4,title:"种养来历",path:"/pages/dynamics/dynamics"},{id:6,title:"资讯信息",path:"/subPackages/shoppingPageList/realTimeInfo/realTimeInfo"},{id:7,title:"免费买菜",path:"/pages/jackpot/jackpot"}],selectedCategoryId:"",categories:[],pageData:[],currentMarketName:"",searchParams:{title:"",category_id:"",market_id:""},isloaded:!1,marketName:"",initReques:!1}),onLoad(){this.initPage(),uni.getLocation({altitude:!0,isHighAccuracy:!0,highAccuracy:!0,type:"gcj02",success:e=>{uni.setStorageSync("userlocation",JSON.stringify(e))}})},async onShow(){let e=uni.getStorageSync("userSelection");this.marketName!=e.marketName&&this.initPage(),uni.getStorageSync("prompt")||(this.showNotice=!0)},mixins:[ge],methods:{changePrompt(e){this.prompt=!this.prompt},handleClose(){this.showNotice=!1,uni.setStorageSync("prompt",this.prompt)},goToshoppingPageList(e){e.path?(t("log","at pages/index/index.vue:201",e.path),uni.navigateTo({url:e.path})):uni.showToast({icon:"error",title:`"${e.title}" 暂未开发`})},fetchData:async e=>(await l.marketShopList(e)).data,initPage(){this.isloaded=!0,this.selectedCategoryId=0,this.fetchMarketName(),this.fetchCategories(),this.setDefaultMarketId(),this.reloadData();let e=uni.getStorageSync("userSelection");this.marketName=e.marketName},setDefaultMarketId(){const{market_id:e}=uni.getStorageSync("userSelection");this.searchParams.market_id=e},async fetchCategories(){const e=await l.cglist();this.categories=[{id:0,title:"全选"},...e.data.listdata||[]]},async filterByCategory(e){this.searchParams.category_id=e,this.selectedCategoryId=e,this.reloadData()},async fetchMarketName(){try{const e=uni.getStorageSync("userSelection");if(!e)return void t("warn","at pages/index/index.vue:258","未找到 userSelection");const{market_id:a,area_id:i}=e;if(!a||!i)return void t("warn","at pages/index/index.vue:269","未找到市场 ID 或区域 ID");const o=(await l.marketlist(parseInt(i))).data.listdata.find((e=>e.id===parseInt(a)));o?this.currentMarketName=o.marketname||"未知市场":(t("warn","at pages/index/index.vue:280","未找到对应的市场"),this.currentMarketName="未知市场")}catch(e){t("error","at pages/index/index.vue:284","获取市场名称失败:",e)}},navigateToShopDetails(e){uni.navigateTo({url:`/pages/ShopDetails/ShopDetails?id=${e}`})},toindex1(){uni.switchTab({url:"/pages/index1/index1"})},scan(){uni.scanCode({onlyFromCamera:!1,success:async e=>{if(e.result){200==(await l.receiving({out_trade_no:e.result})).code?uni.showToast({icon:"success",title:"核销成功"}):uni.showToast({icon:"error",title:"核销失败"})}else t("log","at pages/index/index.vue:319",e.path),uni.navigateTo({url:"/"+e.path})},fail:function(e){t("error","at pages/index/index.vue:327","扫码失败:",e)}})}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K),c=a(e.resolveDynamicComponent("uni-load-more"),me),d=e.resolveComponent("floatBall");return e.openBlock(),e.createElementBlock("view",{class:"container"},[n.showNotice?(e.openBlock(),e.createElementBlock("view",{key:0,class:"notice-modal"},[e.createElementVNode("view",{class:"notice-modal__mask",onClick:i[0]||(i[0]=(...e)=>r.handleClose&&r.handleClose(...e))}),e.createElementVNode("view",{class:"notice-modal__box"},[e.createElementVNode("text",{class:"notice-modal__title"},"重要公告"),e.createElementVNode("scroll-view",{class:"notice-modal__content","scroll-y":""},[e.createElementVNode("text",{class:"notice-modal__content-text"}," 亲爱的用户：\\n 通知\\n 因“农链天下”系统升级建设，自2025年10月9日起暂停一周一次的免费赠送积分活动，恢复时间待定。在此之前的赠送积分不影响正常使用，特此通知！ ")]),e.createElementVNode("view",{style:{"margin-bottom":"10rpx","font-size":"25rpx"}},[e.createTextVNode("不再提示"),e.createElementVNode("radio",{checked:n.prompt,onClick:i[1]||(i[1]=(...e)=>r.changePrompt&&r.changePrompt(...e)),style:{"margin-left":"10rpx"}},null,8,["checked"])]),e.createElementVNode("button",{class:"notice-modal__confirm",onClick:i[2]||(i[2]=(...e)=>r.handleClose&&r.handleClose(...e)),"hover-class":"notice-modal__confirm--hover"}," 我知道了 ")])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"location-header"},[e.createElementVNode("view",{class:"location-info",onClick:i[3]||(i[3]=(...e)=>r.toindex1&&r.toindex1(...e))},[e.createVNode(l,{type:"location-filled",size:"22",color:"#4a90e2"}),e.createElementVNode("text",{class:"market-name"},e.toDisplayString(n.marketName||"暂未选中市场"),1),e.createVNode(l,{type:"arrowright",size:"16",color:"#999"})]),e.createVNode(l,{class:"scan-btn",type:"scan",size:"32",onClick:r.scan},null,8,["onClick"])]),e.createElementVNode("view",{class:"search-container"},[e.createElementVNode("view",{class:"search-bar"},[e.createVNode(l,{type:"search",size:"18",color:"#b2b2b2"}),e.withDirectives(e.createElementVNode("input",{class:"search-input",placeholder:"搜索摊位/商品","placeholder-class":"placeholder-style","onUpdate:modelValue":i[4]||(i[4]=e=>n.searchParams.title=e)},null,512),[[e.vModelText,n.searchParams.title]]),e.createElementVNode("button",{class:"search-btn",onClick:i[5]||(i[5]=(...e)=>t.reloadData&&t.reloadData(...e))},"搜索")])]),e.createElementVNode("scroll-view",{class:"category-nav","scroll-x":"","scroll-with-animation":!0},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.tabs,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.id,class:"nav-item",onClick:e=>r.goToshoppingPageList(t)},[e.createElementVNode("text",{class:"nav-text"},e.toDisplayString(t.title),1),n.selectedCategoryId===t.id?(e.openBlock(),e.createElementBlock("view",{key:0,class:"nav-indicator"})):e.createCommentVNode("",!0)],8,["onClick"])))),128))]),e.createElementVNode("scroll-view",{class:"category-filter","scroll-x":""},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.categories,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.id,class:e.normalizeClass(["filter-item",{active:t.id===n.selectedCategoryId}]),onClick:e=>r.filterByCategory(t.id)},[e.createElementVNode("text",{class:"filter-text"},e.toDisplayString(t.title),1)],10,["onClick"])))),128))]),e.createElementVNode("scroll-view",{class:"stall-list","scroll-y":"true","scroll-x":"false",onScrolltolower:i[6]||(i[6]=(...e)=>t.handleScrollToLower&&t.handleScrollToLower(...e))},[e.createElementVNode("view",{class:"stall-grid"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.pageData,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.id,class:"stall-card",onClick:e=>r.navigateToShopDetails(t.id)},[e.createElementVNode("image",{class:"stall-image",src:t.logo||"/static/default-logo.png",mode:"aspectFill","lazy-load":!0},null,8,["src"]),e.createElementVNode("view",{class:"stall-info"},[e.createElementVNode("text",{class:"stall-title"},e.toDisplayString(t.title),1),e.createElementVNode("view",{class:"meta-container"},[e.createElementVNode("text",{class:"meta-item"}," 地区:"+e.toDisplayString(t.area_name),1),e.createElementVNode("text",{class:"meta-item"}," 类型:"+e.toDisplayString(t.category_name||"未知类目"),1)])])],8,["onClick"])))),128))]),t.pageLoading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-more"},[e.createVNode(c,{status:"loading"})])):e.createCommentVNode("",!0),t.hasMore?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:1,class:"loading-more"},[e.createElementVNode("text",{class:"no-more"},"- 已经到底了 -")]))],32),e.createVNode(d)])}]]);const ye=W({data:()=>({form:{username:"",password:""},showPassword:!1,loading:!1}),computed:{formValid(){return/^1[3-9]\d{9}$/.test(this.form.username)&&this.form.password.length>=6}},methods:{togglePassword(){this.showPassword=!this.showPassword},async login(){try{const e=await l.login(this.form.username,this.form.password);if(200===e.code){const a=e.data.token;uni.setStorageSync("token",a);let i=uni.getStorageSync("registerID");if(i){t("log","at pages/login/login.vue:75","已覆盖设备id",await l.editUserProfile({registration_id:i}))}new Promise(((e,t)=>{"123456"==this.form.password?(uni.showToast({icon:"error",title:"密码过于简单,请用户自行修改以确保账号安全",duration:1e3}),setTimeout((()=>{e(200)}),2e3)):e(201)})).then((e=>{if(200!=e)return uni.showToast({icon:"loading",title:"正在登录.....",duration:1e3}),e;uni.showToast({icon:"loading",title:"正在登录.....",duration:2e3}),setTimeout((()=>e),1500)})).then((e=>{setTimeout((()=>{uni.switchTab({url:"/pages/index/index"})}),1e3)}))}else uni.showToast({title:e.msg||e.message,icon:"none"})}catch(e){t("log","at pages/login/login.vue:128",e),uni.showToast({title:"登录失败",icon:"error"})}},gotoRegster(){uni.navigateTo({url:"/pages/register/register"})},gotoUptdatePwd(){uni.navigateTo({url:"/subPackages/settings/updatePwd/updatePwd"})}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"login-container"},[e.createElementVNode("view",{class:"decorative-circle circle-1"}),e.createElementVNode("view",{class:"decorative-circle circle-2"}),e.createElementVNode("view",{class:"content-wrapper"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("text",{class:"title"},"农链天下"),e.createElementVNode("text",{class:"subtitle"},"请登录您的账号")]),e.createElementVNode("view",{class:"form-wrapper"},[e.createElementVNode("view",{class:"input-group"},[e.createVNode(l,{type:"phone",size:"24",color:"#409EFF"}),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"number","onUpdate:modelValue":i[0]||(i[0]=e=>n.form.username=e),placeholder:"手机号码",maxlength:"11"},null,512),[[e.vModelText,n.form.username]])]),e.createElementVNode("view",{class:"input-group"},[e.createVNode(l,{type:"locked",size:"24",color:"#409EFF"}),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"password",value:n.form.password,placeholder:"密码",maxlength:"11",onInput:i[1]||(i[1]=e=>n.form.password=e.detail.value)},null,40,["value"]),[[e.vShow,n.showPassword]]),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"text",value:n.form.password,placeholder:"密码",maxlength:"11",onInput:i[2]||(i[2]=e=>n.form.password=e.detail.value)},null,40,["value"]),[[e.vShow,!n.showPassword]]),e.createVNode(l,{type:n.showPassword?"eye":"eye-slash",size:"24",color:"#999",onClick:i[3]||(i[3]=e=>n.showPassword=!n.showPassword)},null,8,["type"])]),e.createElementVNode("button",{class:e.normalizeClass(["login-btn",{active:r.formValid}]),onClick:i[4]||(i[4]=(...e)=>r.login&&r.login(...e))},[n.loading?(e.openBlock(),e.createBlock(l,{key:1,type:"spinner-cycle",size:"24",color:"#fff",class:"loading-icon"})):(e.openBlock(),e.createElementBlock("text",{key:0},"登 录"))],2),e.createElementVNode("view",{class:"assist-links"},[e.createElementVNode("text",{class:"link-text",onClick:i[5]||(i[5]=(...e)=>r.gotoRegster&&r.gotoRegster(...e))},"注册账号"),e.createElementVNode("text",{class:"link-text",onClick:i[6]||(i[6]=(...e)=>r.gotoUptdatePwd&&r.gotoUptdatePwd(...e))},"忘记密码")])])])])}]]),ve={data:()=>({form:{username:"",password:"",confirm:"",fromid:""},phoneError:"",passwordError:"",confirmPasswordError:"",passwordValid:!1,confirmPasswordValid:!1,agreements:{service:!1,privacy:!1},showPassword:!0,showConfirmPassword:!0}),onLoad(e){try{let t=decodeURIComponent(e.scene);this.form.fromid=t||0}catch(ms){t("log","at pages/register/register.vue:112",ms)}},methods:{goTouserServiceAgreement(){uni.navigateTo({url:"/pages/userServiceAgreement/userServiceAgreement"})},goToprivacyAgreement(){uni.navigateTo({url:"/pages/privacyAgreement/privacyAgreement"})},async register(){if(/^1[3-9]\d{9}$/.test(this.form.username))if(""!==this.form.password)if(t("log","at pages/register/register.vue:150",this.form.password),this.form.password.length<6)uni.showToast({icon:"error",title:"密码必须为6位或者大于6位"});else if(this.form.password===this.form.confirm)if(this.agreements.service&&this.agreements.privacy)try{const e=await l.register(this.form.username,this.form.password,this.form.confirm,Number(this.form.fromid));if(200===e.code){const t=e.data;uni.setStorageSync("token",t),uni.showToast({title:"注册成功",icon:"success",duration:2e3}),setTimeout((()=>{uni.navigateTo({url:"/pages/login/login"})}),2e3)}else uni.showToast({icon:"none",title:e.msg||"注册失败，请重试"})}catch(e){uni.showToast({icon:"none",title:"网络错误，请稍后重试"}),t("error","at pages/register/register.vue:202","Registration Error:",e)}else uni.showToast({icon:"none",title:"请勾选服务协议和隐私协议"});else uni.showToast({icon:"none",title:"两次密码输入不一致"});else uni.showToast({title:"请输入密码",icon:"error"});else uni.showToast({title:"请输入正确的11位手机号",icon:"error"})},checkBox(e){switch(e){case 0:this.agreeServiceAgreement=!this.agreeServiceAgreement;break;case 1:this.agreePrivacyPolicy=!this.agreePrivacyPolicy}},navigateToLogin(){uni.navigateTo({url:"/pages/login/login"})}}};const we=W(ve,[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"register-container"},[e.createElementVNode("view",{class:"decorative-circle circle-1"}),e.createElementVNode("view",{class:"decorative-circle circle-2"}),e.createElementVNode("view",{class:"content-wrapper"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("text",{class:"title"},"农链天下"),e.createElementVNode("text",{class:"subtitle"},"开始注册您的账号")]),e.createElementVNode("view",{class:"form-wrapper"},[e.createElementVNode("view",{class:"input-group"},[e.createVNode(l,{type:"phone",size:"24",color:"#409EFF"}),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"number","onUpdate:modelValue":i[0]||(i[0]=e=>n.form.username=e),placeholder:"输入手机号",maxlength:"11"},null,512),[[e.vModelText,n.form.username]])]),e.createElementVNode("view",{class:"input-group"},[e.createVNode(l,{type:"locked",size:"24",color:"#409EFF"}),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"password","onUpdate:modelValue":i[1]||(i[1]=e=>n.form.password=e),placeholder:"输入至少六位密码",onInput:i[2]||(i[2]=e=>n.form.password=e.detail.value)},null,544),[[e.vShow,n.showPassword],[e.vModelText,n.form.password]]),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"text","onUpdate:modelValue":i[3]||(i[3]=e=>n.form.password=e),onInput:i[4]||(i[4]=e=>n.form.password=e.detail.value),placeholder:"请输入至少六位密码"},null,544),[[e.vShow,!n.showPassword],[e.vModelText,n.form.password]]),e.createVNode(l,{type:n.showPassword?"eye":"eye-slash",size:"24",color:"#999",onClick:i[5]||(i[5]=e=>n.showPassword=!n.showPassword)},null,8,["type"])]),e.createElementVNode("view",{class:"input-group"},[e.createVNode(l,{type:"locked",size:"24",color:"#409EFF"}),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"password",value:n.form.confirm,placeholder:"确认密码",maxlength:"11",onInput:i[6]||(i[6]=e=>n.form.confirm=e.detail.value)},null,40,["value"]),[[e.vShow,n.showConfirmPassword]]),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"text",value:n.form.confirm,placeholder:"确认密码",maxlength:"11",onInput:i[7]||(i[7]=e=>n.form.confirm=e.detail.value)},null,40,["value"]),[[e.vShow,!n.showConfirmPassword]]),e.createVNode(l,{type:n.showConfirmPassword?"eye":"eye-slash",size:"24",color:"#999",onClick:i[8]||(i[8]=e=>n.showConfirmPassword=!n.showConfirmPassword)},null,8,["type"])]),e.createElementVNode("view",{class:"input-group"},[e.createVNode(l,{type:"medal-filled",size:"24",color:"#409EFF"}),e.createElementVNode("input",{class:"form-input",type:"number",value:n.form.fromid,placeholder:"输入邀请码(选填)",maxlength:"11",onInput:i[9]||(i[9]=e=>n.form.fromid=e.detail.value)},null,40,["value"])]),e.createElementVNode("view",{class:"agreement-group"},[e.createElementVNode("view",{class:"checkbox-item"},[e.createVNode(l,{type:n.agreements.service?"checkbox-filled":"circle",size:"24",color:n.agreements.service?"#409EFF":"#999",onClick:i[10]||(i[10]=e=>n.agreements.service=!n.agreements.service)},null,8,["type","color"]),e.createElementVNode("text",{class:"agreement-text"},"我已阅读并同意"),e.createElementVNode("text",{class:"link",onClick:i[11]||(i[11]=(...e)=>r.goTouserServiceAgreement&&r.goTouserServiceAgreement(...e))},"《服务协议》")]),e.createElementVNode("view",{class:"checkbox-item"},[e.createVNode(l,{type:n.agreements.privacy?"checkbox-filled":"circle",size:"24",color:n.agreements.privacy?"#409EFF":"#999",onClick:i[12]||(i[12]=e=>n.agreements.privacy=!n.agreements.privacy)},null,8,["type","color"]),e.createElementVNode("text",{class:"agreement-text"},"我已阅读并同意"),e.createElementVNode("text",{class:"link",onClick:i[13]||(i[13]=(...e)=>r.goToprivacyAgreement&&r.goToprivacyAgreement(...e))},"《隐私政策》")])]),e.createElementVNode("button",{class:"register-btn",onClick:i[14]||(i[14]=(...e)=>r.register&&r.register(...e))},[e.createElementVNode("text",{class:"link"},"立即注册")]),e.createElementVNode("view",{class:"login-link"},[e.createElementVNode("text",null,"已有账号？"),e.createElementVNode("text",{class:"link",onClick:i[15]||(i[15]=(...e)=>r.navigateToLogin&&r.navigateToLogin(...e))},"立即登录")])])])])}]]);const ke=W({data:()=>({}),methods:{navigateToLogin(){wx.navigateTo({url:"/pages/login/login"})}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"select"},[e.createElementVNode("view",{class:"vip"},[e.createElementVNode("button",{class:"blue-button",onClick:a[0]||(a[0]=(...e)=>n.navigateToLogin&&n.navigateToLogin(...e))},"选择会员登录")]),e.createElementVNode("view",{class:"Owner"},[e.createElementVNode("button",{class:"blue-button",onClick:a[1]||(a[1]=(...e)=>n.navigateToLogin&&n.navigateToLogin(...e))},"选择摊主登录")])])}]]);const Ee=W({data:()=>({}),methods:{goToBoothOwner(){this.checkToken()?uni.showModal({showCancel:!1,content:"暂未登录,请前往登录"}).then((()=>{uni.navigateTo({url:"/pages/login/login"})})):uni.navigateTo({url:"/pages/boothOwner/boothOwner"})},goToAgent(){this.checkToken()?uni.showModal({showCancel:!1,content:"暂未登录,请前往登录"}).then((()=>{uni.navigateTo({url:"/pages/login/login"})})):uni.navigateTo({url:"/pages/agent/agent"})},goToAhouseholder(){this.checkToken()?uni.showModal({showCancel:!1,content:"暂未登录,请前往登录"}).then((()=>{uni.navigateTo({url:"/pages/login/login"})})):uni.navigateTo({url:"/pages/aHouseholder/aHouseholder"})},checkToken:()=>!uni.getStorageSync("token")}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"all"},[e.createElementVNode("view",{class:"tip"},[e.createElementVNode("view",{class:"heading"},"请选择您的身份"),e.createElementVNode("view",{class:"items"},[e.createElementVNode("view",{class:"mencheng booth-owner",onClick:i[0]||(i[0]=(...e)=>r.goToBoothOwner&&r.goToBoothOwner(...e)),"data-bg-color":"#90EE90"},[e.createVNode(l,{type:"staff-filled",size:"60rpx"}),e.createElementVNode("view",null,"我是摊主")]),e.createElementVNode("view",{class:"mencheng householder",onClick:i[1]||(i[1]=(...e)=>r.goToAhouseholder&&r.goToAhouseholder(...e)),"data-bg-color":"#ADD8E6"},[e.createVNode(l,{type:"person-filled",size:"60rpx"}),e.createElementVNode("view",null,"我是户主")]),e.createElementVNode("view",{class:"mencheng householder",onClick:i[2]||(i[2]=(...e)=>r.goToAgent&&r.goToAgent(...e)),"data-bg-color":"#ADD8E6"},[e.createVNode(l,{type:"auth",size:"60rpx"}),e.createElementVNode("view",null,"我是代理")])])]),e.createElementVNode("view",{class:"description"},[e.createElementVNode("text",null,"在这里，无论是摊主还是户主，都能享受到便捷的服务哦。摊主可以轻松管理自己的摊位商品，进行售卖等操作；")])])}]]);
/*!
   * Compressor.js v1.2.1
   * https://fengyuanchen.github.io/compressorjs
   *
   * Copyright 2018-present Chen Fengyuan
   * Released under the MIT license
   *
   * Date: 2023-02-28T14:09:41.732Z
   */var Ne,be,Ve,Se,xe,Ce,De,Te,_e={exports:{}};Ne=_e,"undefined"!=typeof window&&(be=window,Ve=be.HTMLCanvasElement&&be.HTMLCanvasElement.prototype,Se=be.Blob&&function(){try{return Boolean(new Blob)}catch(ms){return!1}}(),xe=Se&&be.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(ms){return!1}}(),Ce=be.BlobBuilder||be.WebKitBlobBuilder||be.MozBlobBuilder||be.MSBlobBuilder,De=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,Te=(Se||Ce)&&be.atob&&be.ArrayBuffer&&be.Uint8Array&&function(e){var t,a,i,o,s,n,r,l,c;if(!(t=e.match(De)))throw new Error("invalid data URI");for(a=t[2]?t[1]:"text/plain"+(t[3]||";charset=US-ASCII"),i=!!t[4],o=e.slice(t[0].length),s=i?atob(o):decodeURIComponent(o),n=new ArrayBuffer(s.length),r=new Uint8Array(n),l=0;l<s.length;l+=1)r[l]=s.charCodeAt(l);return Se?new Blob([xe?r:n],{type:a}):((c=new Ce).append(n),c.getBlob(a))},be.HTMLCanvasElement&&!Ve.toBlob&&(Ve.mozGetAsFile?Ve.toBlob=function(e,t,a){var i=this;setTimeout((function(){a&&Ve.toDataURL&&Te?e(Te(i.toDataURL(t,a))):e(i.mozGetAsFile("blob",t))}))}:Ve.toDataURL&&Te&&(Ve.msToBlob?Ve.toBlob=function(e,t,a){var i=this;setTimeout((function(){(t&&"image/png"!==t||a)&&Ve.toDataURL&&Te?e(Te(i.toDataURL(t,a))):e(i.msToBlob(t))}))}:Ve.toBlob=function(e,t,a){var i=this;setTimeout((function(){e(Te(i.toDataURL(t,a)))}))})),Ne.exports?Ne.exports=Te:be.dataURLtoBlob=Te);var Pe="undefined"!=typeof window&&void 0!==window.document?window:{};Array.prototype.slice;String.fromCharCode;Pe.btoa;Pe.ArrayBuffer,Pe.FileReader,Pe.URL||Pe.webkitURL,Pe.Compressor;const Ie={app:60,h5:.6,mpWeixin:30},Be={uploading:"上传中",success:"上传成功",fail:"上传失败",compressFail:"图片压缩失败",invalidFile:"无效的文件",unsupportedPlatform:"不支持的平台"};const Ae=e=>{const{uploadPath:a,file:i}=e;if(!a||!i)throw new Error("缺少必要的上传参数(uploadPath或file)");return{upload:async()=>{uni.showLoading({title:Be.uploading,mask:!0});try{const e=1;if(0===e)throw new Error(Be.unsupportedPlatform);const o=await(async e=>{if(!e)throw new Error(Be.invalidFile);const a=e.path||e;return new Promise(((e,i)=>{uni.compressImage({src:a,quality:Ie.app,success:t=>e(t.tempFilePath),fail:e=>{t("error","at hooks/useUpload.js:67","App图片压缩失败:",e),i(new Error(Be.compressFail))}})}))})(i),s=((e,t,a)=>{const i={url:`${c}${t}`,name:"file",formData:{output:"json2"}};return 2===e?{...i,file:a}:{...i,filePath:a}})(e,a,o);return new Promise(((a,i)=>{uni.uploadFile({...s,success:e=>{let i=e.data;try{i=e.data}catch(ms){t("warn","at hooks/useUpload.js:194","上传返回数据不是JSON格式:",e.data)}uni.showToast({title:Be.success}),a(i)},fail:a=>{t("error","at hooks/useUpload.js:203",`平台[${e}]上传失败:`,a),i(new Error(Be.fail))}})}))}catch(e){throw uni.showToast({title:e.message||Be.fail,icon:"error"}),e}finally{uni.hideLoading()}}}},Me={data:()=>({isLoggedIn:!1,userName:"",userAvatar:"",score:"",totalnum:0,signTotal:{},phone:null}),async onShow(){this.checkLoginStatus(),this.isLoggedIn&&this.fetchUserProfile(),this.signlist()},methods:{routerPush(e){try{uni.navigateTo({url:e})}catch{}},GotowholesaleNavigation(){uni.navigateTo({url:"/subPackages/Wholesale/wholesaleNavigation/wholesaleNavigation"})},GoTOsettings(){uni.navigateTo({url:"/pages/settings/settings"})},GoToComplaint(){uni.navigateTo({url:"/pages/myComplaint/myComplaint"})},goToprePurchaseOrder(){uni.navigateTo({url:"/subPackages/shoppingPageList/prePurchaseOrder/prePurchaseOrder"})},goToUpdatePwd(){uni.navigateTo({url:`/pages/updatePwd/updatePwd?phone=${this.phone}`})},checkLoginStatus(){const e=uni.getStorageSync("token");this.isLoggedIn=!!e},async fetchUserProfile(){try{const e=await l.getUserProfile();if(200===e.code){const{name:t,Headimgurl:a,score:i,phone:o}=e.data;this.userName=t,this.userAvatar=a,this.score=i,this.phone=o}else uni.showToast({title:"获取用户信息失败",icon:"none"})}catch(e){t("error","at pages/user/user.vue:233","Error fetching user profile:",e),uni.showToast({title:"获取用户信息失败",icon:"none"})}},async signlist(e){const t=uni.getStorageSync("token"),a=await l.signlist(t);this.totalnum=a.data.totalnum},login(){uni.navigateTo({url:"/pages/login/login"})},lottery(){uni.navigateTo({url:"/pages/clock-records/clock-records"})},toorders(e){uni.navigateTo({url:`/pages/orders/orders?orderStatus=${e}`})},mypoints(){uni.navigateTo({url:"/pages/MyPoints-records/MyPoints-records"})},logout(){try{uni.removeStorageSync("token"),uni.removeStorageSync("nickname"),t("log","at pages/user/user.vue:273","Token and nickname removed from storage")}catch(ms){t("error","at pages/user/user.vue:275","Failed to remove token or nickname from storage",ms)}this.isLoggedIn=!1,this.nickname="",this.userName="",uni.redirectTo({url:"/pages/login/login"})},async bindingWechat(){let e=await uni.getSystemInfo();e[1].host&&"WeChat"==e[1].host.env?uni.login({provider:"true",success:async e=>{t("log","at pages/user/user.vue:294",e.code,"这是用户唯一标识");let a=await l.bindingOpenid({code:e.code}),i=a.message;200==a.code?uni.showToast({title:i,icon:"success"}):uni.showToast({title:i,icon:"error"})},fail:()=>{},complete:()=>{}}):uni.showToast({title:"浏览器不支持调用api,请前往小程序端进行账号绑定",duration:3e3,icon:"error"})}}};const Le=W(Me,[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"me-container"},[e.createElementVNode("view",{class:"user"},[e.createElementVNode("view",{class:"user-info"},[e.createElementVNode("view",{class:"user-img"},[e.createElementVNode("image",{src:n.userAvatar||"http://h5.xcbdsc.com/static/morentouxiang.jpg",mode:"aspectFill"},null,8,["src"])]),e.createElementVNode("view",{class:"user-name"},[n.isLoggedIn?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("button",{key:0,onClick:i[0]||(i[0]=(...e)=>r.login&&r.login(...e)),class:"login-button"},"点击登录")),n.isLoggedIn?(e.openBlock(),e.createElementBlock("view",{key:1,class:"nickname-container"},[e.createElementVNode("view",{class:"nickname-input"},e.toDisplayString(n.userName||"请到我的信息中填写昵称"),1)])):e.createCommentVNode("",!0)]),e.createVNode(l,{"custom-prefix":"iconfont",type:"icon-shezhi",size:"20",class:"settings-icon",onClick:r.GoTOsettings},null,8,["onClick"])])]),e.createElementVNode("view",{class:"integral-grid"},[e.createElementVNode("view",{class:"integral-item"},[e.createElementVNode("text",{class:"label"},"现金消费累计"),e.createElementVNode("text",{class:"value"},"0元")]),e.createElementVNode("view",{class:"integral-item highlight"},[e.createElementVNode("text",{class:"label"},"可用积分"),e.createElementVNode("text",{class:"value"},e.toDisplayString(n.score)+"分",1)]),e.createElementVNode("view",{class:"integral-item"},[e.createElementVNode("text",{class:"label"},"冻结积分"),e.createElementVNode("text",{class:"value"},"0分")])]),e.createElementVNode("view",{class:"function-list"},[e.createElementVNode("view",{class:"function-item",onClick:i[1]||(i[1]=(...e)=>r.lottery&&r.lottery(...e))},[e.createElementVNode("view",{class:"item-left"},[e.createVNode(l,{type:"auth",size:"30",color:"#00C853"}),e.createElementVNode("text",{class:"title"},"我的打卡"),e.createElementVNode("text",{class:"subtitle"},"累计打卡"+e.toDisplayString(n.totalnum)+"次",1)]),e.createVNode(l,{type:"right",size:"18",color:"#999"})]),e.createElementVNode("view",{class:"function-item",onClick:i[2]||(i[2]=(...e)=>r.mypoints&&r.mypoints(...e))},[e.createElementVNode("view",{class:"item-left"},[e.createVNode(l,{type:"vip",size:"30",color:"#FFD600"}),e.createElementVNode("text",{class:"title"},"我的积分")]),e.createVNode(l,{type:"right",size:"18",color:"#999"})]),e.createElementVNode("view",{class:"function-item",onClick:i[3]||(i[3]=(...e)=>r.goToprePurchaseOrder&&r.goToprePurchaseOrder(...e))},[e.createElementVNode("view",{class:"item-left"},[e.createVNode(l,{type:"shop-filled",size:"30",color:"#2979FF"}),e.createElementVNode("text",{class:"title"},"我的预购")]),e.createVNode(l,{type:"right",size:"18",color:"#999"})]),e.createElementVNode("view",{class:"function-item",onClick:i[4]||(i[4]=(...e)=>r.toorders&&r.toorders(...e))},[e.createElementVNode("view",{class:"item-left"},[e.createVNode(l,{type:"cart",size:"30",color:"#2979FF"}),e.createElementVNode("text",{class:"title"},"我的订单")]),e.createVNode(l,{type:"right",size:"18",color:"#999"})]),e.createElementVNode("view",{class:"function-item",onClick:i[5]||(i[5]=(...e)=>r.GotowholesaleNavigation&&r.GotowholesaleNavigation(...e))},[e.createElementVNode("view",{class:"item-left"},[e.createVNode(l,{type:"list",size:"30",color:"#2979FF"}),e.createElementVNode("text",{class:"title"},"我的批发")]),e.createVNode(l,{type:"right",size:"18",color:"#999"})]),e.createElementVNode("view",{class:"function-item",onClick:i[6]||(i[6]=(...e)=>r.GoTOsettings&&r.GoTOsettings(...e))},[e.createElementVNode("view",{class:"item-left"},[e.createVNode(l,{type:"gear",size:"30",color:"#2979FF"}),e.createElementVNode("text",{class:"title"},"我的设置")]),e.createVNode(l,{type:"right",size:"18",color:"#999"})]),e.createElementVNode("view",{class:"function-item",onClick:i[7]||(i[7]=e=>r.routerPush("/pages/invitation/invitation"))},[e.createElementVNode("view",{class:"item-left"},[e.createVNode(l,{type:"medal-filled",size:"30",color:"#2979FF"}),e.createElementVNode("text",{class:"title"},"我的推广")]),e.createVNode(l,{type:"right",size:"18",color:"#999"})]),e.createElementVNode("view",{class:"function-item",onClick:i[8]||(i[8]=e=>r.routerPush("/pages/earningsRecord/earningsRecord"))},[e.createElementVNode("view",{class:"item-left"},[e.createVNode(l,{type:"medal-filled",size:"30",color:"#2979FF"}),e.createElementVNode("text",{class:"title"},"我的收益")]),e.createVNode(l,{type:"right",size:"18",color:"#999"})])]),e.createElementVNode("button",{type:"warn",onClick:i[9]||(i[9]=(...e)=>r.logout&&r.logout(...e)),style:{margin:"20rpx"}},"退出登录")])}]]);const Oe=W({name:"UniBadge",emits:["click"],props:{type:{type:String,default:"error"},inverted:{type:Boolean,default:!1},isDot:{type:Boolean,default:!1},maxNum:{type:Number,default:99},absolute:{type:String,default:""},offset:{type:Array,default:()=>[0,0]},text:{type:[String,Number],default:""},size:{type:String,default:"small"},customStyle:{type:Object,default:()=>({})}},data:()=>({}),computed:{width(){return 8*String(this.text).length+12},classNames(){const{inverted:e,type:t,size:a,absolute:i}=this;return[e?"uni-badge--"+t+"-inverted":"","uni-badge--"+t,"uni-badge--"+a,i?"uni-badge--absolute":""].join(" ")},positionStyle(){if(!this.absolute)return{};let e=this.width/2,t=10;this.isDot&&(e=5,t=5);const a=`${-e+this.offset[0]}px`,i=`${-t+this.offset[1]}px`,o={rightTop:{right:a,top:i},rightBottom:{right:a,bottom:i},leftBottom:{left:a,bottom:i},leftTop:{left:a,top:i}},s=o[this.absolute];return s||o.rightTop},dotStyle(){return this.isDot?{width:"10px",minWidth:"0",height:"10px",padding:"0",borderRadius:"10px"}:{}},displayValue(){const{isDot:e,text:t,maxNum:a}=this;return e?"":Number(t)>a?`${a}+`:t}},methods:{onClick(){this.$emit("click")}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"uni-badge--x"},[e.renderSlot(t.$slots,"default",{},void 0,!0),i.text?(e.openBlock(),e.createElementBlock("text",{key:0,class:e.normalizeClass([n.classNames,"uni-badge"]),style:e.normalizeStyle([n.positionStyle,i.customStyle,n.dotStyle]),onClick:a[0]||(a[0]=e=>n.onClick())},e.toDisplayString(n.displayValue),7)):e.createCommentVNode("",!0)])}],["__scopeId","data-v-bca7b097"]]),Fe={name:"UniListItem",emits:["click","switchChange"],props:{direction:{type:String,default:"row"},title:{type:String,default:""},note:{type:String,default:""},ellipsis:{type:[Number,String],default:0},disabled:{type:[Boolean,String],default:!1},clickable:{type:Boolean,default:!1},showArrow:{type:[Boolean,String],default:!1},link:{type:[Boolean,String],default:!1},to:{type:String,default:""},showBadge:{type:[Boolean,String],default:!1},showSwitch:{type:[Boolean,String],default:!1},switchChecked:{type:[Boolean,String],default:!1},badgeText:{type:String,default:""},badgeType:{type:String,default:"success"},badgeStyle:{type:Object,default:()=>({})},rightText:{type:String,default:""},thumb:{type:String,default:""},thumbSize:{type:String,default:"base"},showExtraIcon:{type:[Boolean,String],default:!1},extraIcon:{type:Object,default:()=>({type:"",color:"#000000",size:20,customPrefix:""})},border:{type:Boolean,default:!0},customStyle:{type:Object,default:()=>({padding:"",backgroundColor:"#FFFFFF"})},keepScrollPosition:{type:Boolean,default:!1}},watch:{"customStyle.padding":{handler(e){"number"==typeof e&&(e+="");let t=e.split(" ");if(1===t.length){const e=t[0];this.padding={top:e,right:e,bottom:e,left:e}}else if(2===t.length){const[e,a]=t;this.padding={top:e,right:a,bottom:e,left:a}}else if(4===t.length){const[e,a,i,o]=t;this.padding={top:e,right:a,bottom:i,left:o}}},immediate:!0}},data:()=>({isFirstChild:!1,padding:{top:"",right:"",bottom:"",left:""}}),mounted(){this.list=this.getForm(),this.list&&(this.list.firstChildAppend||(this.list.firstChildAppend=!0,this.isFirstChild=!0))},methods:{getForm(e="uniList"){let t=this.$parent,a=t.$options.name;for(;a!==e;){if(t=t.$parent,!t)return!1;a=t.$options.name}return t},onClick(){""===this.to?(this.clickable||this.link)&&this.$emit("click",{data:{}}):this.openPage()},onSwitchChange(e){this.$emit("switchChange",e.detail)},openPage(){-1!==["navigateTo","redirectTo","reLaunch","switchTab"].indexOf(this.link)?this.pageApi(this.link):this.pageApi("navigateTo")},pageApi(e){let t={url:this.to,success:e=>{this.$emit("click",{data:e})},fail:e=>{this.$emit("click",{data:e})}};switch(e){case"navigateTo":default:uni.navigateTo(t);break;case"redirectTo":uni.redirectTo(t);break;case"reLaunch":uni.reLaunch(t);break;case"switchTab":uni.switchTab(t)}}}};const Re=W(Fe,[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K),c=a(e.resolveDynamicComponent("uni-badge"),Oe);return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass([{"uni-list-item--disabled":o.disabled},"uni-list-item"]),style:e.normalizeStyle({"background-color":o.customStyle.backgroundColor}),"hover-class":!o.clickable&&!o.link||o.disabled||o.showSwitch?"":"uni-list-item--hover",onClick:i[1]||(i[1]=(...e)=>r.onClick&&r.onClick(...e))},[n.isFirstChild?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["border--left",{"uni-list--border":o.border}])},null,2)),e.createElementVNode("view",{class:e.normalizeClass(["uni-list-item__container",{"container--right":o.showArrow||o.link,"flex--direction":"column"===o.direction}]),style:e.normalizeStyle({paddingTop:n.padding.top,paddingLeft:n.padding.left,paddingRight:n.padding.right,paddingBottom:n.padding.bottom})},[e.renderSlot(t.$slots,"header",{},(()=>[e.createElementVNode("view",{class:"uni-list-item__header"},[o.thumb?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-list-item__icon"},[e.createElementVNode("image",{src:o.thumb,class:e.normalizeClass(["uni-list-item__icon-img",["uni-list--"+o.thumbSize]])},null,10,["src"])])):o.showExtraIcon?(e.openBlock(),e.createElementBlock("view",{key:1,class:"uni-list-item__icon"},[e.createVNode(l,{customPrefix:o.extraIcon.customPrefix,color:o.extraIcon.color,size:o.extraIcon.size,type:o.extraIcon.type},null,8,["customPrefix","color","size","type"])])):e.createCommentVNode("",!0)])]),!0),e.renderSlot(t.$slots,"body",{},(()=>[e.createElementVNode("view",{class:e.normalizeClass(["uni-list-item__content",{"uni-list-item__content--center":o.thumb||o.showExtraIcon||o.showBadge||o.showSwitch}])},[o.title?(e.openBlock(),e.createElementBlock("text",{key:0,class:e.normalizeClass(["uni-list-item__content-title",[0!==o.ellipsis&&o.ellipsis<=2?"uni-ellipsis-"+o.ellipsis:""]])},e.toDisplayString(o.title),3)):e.createCommentVNode("",!0),o.note?(e.openBlock(),e.createElementBlock("text",{key:1,class:"uni-list-item__content-note"},e.toDisplayString(o.note),1)):e.createCommentVNode("",!0)],2)]),!0),e.renderSlot(t.$slots,"footer",{},(()=>[o.rightText||o.showBadge||o.showSwitch?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["uni-list-item__extra",{"flex--justify":"column"===o.direction}])},[o.rightText?(e.openBlock(),e.createElementBlock("text",{key:0,class:"uni-list-item__extra-text"},e.toDisplayString(o.rightText),1)):e.createCommentVNode("",!0),o.showBadge?(e.openBlock(),e.createBlock(c,{key:1,type:o.badgeType,text:o.badgeText,"custom-style":o.badgeStyle},null,8,["type","text","custom-style"])):e.createCommentVNode("",!0),o.showSwitch?(e.openBlock(),e.createElementBlock("switch",{key:2,disabled:o.disabled,checked:o.switchChecked,onChange:i[0]||(i[0]=(...e)=>r.onSwitchChange&&r.onSwitchChange(...e))},null,40,["disabled","checked"])):e.createCommentVNode("",!0)],2)):e.createCommentVNode("",!0)]),!0)],6),o.showArrow||o.link?(e.openBlock(),e.createBlock(l,{key:1,size:16,class:"uni-icon-wrapper",color:"#bbb",type:"arrowright"})):e.createCommentVNode("",!0)],14,["hover-class"])}],["__scopeId","data-v-380d0f47"]]),ze={name:"uniList","mp-weixin":{options:{multipleSlots:!1}},props:{stackFromEnd:{type:Boolean,default:!1},enableBackToTop:{type:[Boolean,String],default:!1},scrollY:{type:[Boolean,String],default:!1},border:{type:Boolean,default:!0},renderReverse:{type:Boolean,default:!1}},created(){this.firstChildAppend=!1},methods:{loadMore(e){this.$emit("scrolltolower")},scroll(e){this.$emit("scroll",e)}}};const $e=W(ze,[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"uni-list uni-border-top-bottom"},[i.border?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-list--border-top"})):e.createCommentVNode("",!0),e.renderSlot(t.$slots,"default",{},void 0,!0),i.border?(e.openBlock(),e.createElementBlock("view",{key:1,class:"uni-list--border-bottom"})):e.createCommentVNode("",!0)])}],["__scopeId","data-v-c1d7c358"]]);const je=W({name:"uniCollapseItem",props:{title:{type:String,default:""},name:{type:[Number,String],default:""},disabled:{type:Boolean,default:!1},showAnimation:{type:Boolean,default:!1},open:{type:Boolean,default:!1},thumb:{type:String,default:""},titleBorder:{type:String,default:"auto"},border:{type:Boolean,default:!0},showArrow:{type:Boolean,default:!0}},data:()=>({isOpen:!1,isheight:null,height:0,elId:`Uni_${Math.ceil(1e6*Math.random()).toString(36)}`,nameSync:0}),watch:{open(e){this.isOpen=e,this.onClick(e,"init")}},updated(e){this.$nextTick((()=>{this.init(!0)}))},created(){this.collapse=this.getCollapse(),this.oldHeight=0,this.onClick(this.open,"init")},unmounted(){this.__isUnmounted=!0,this.uninstall()},mounted(){this.collapse&&(""!==this.name?this.nameSync=this.name:this.nameSync=this.collapse.childrens.length+"",-1===this.collapse.names.indexOf(this.nameSync)?this.collapse.names.push(this.nameSync):t("warn","at uni_modules/uni-collapse/components/uni-collapse-item/uni-collapse-item.vue:154",`name 值 ${this.nameSync} 重复`),-1===this.collapse.childrens.indexOf(this)&&this.collapse.childrens.push(this),this.init())},methods:{init(e){this.getCollapseHeight(e)},uninstall(){this.collapse&&(this.collapse.childrens.forEach(((e,t)=>{e===this&&this.collapse.childrens.splice(t,1)})),this.collapse.names.forEach(((e,t)=>{e===this.nameSync&&this.collapse.names.splice(t,1)})))},onClick(e,t){this.disabled||(this.isOpen=e,this.isOpen&&this.collapse&&this.collapse.setAccordion(this),"init"!==t&&this.collapse.onChange(e,this))},getCollapseHeight(e,t=0){uni.createSelectorQuery().in(this).select(`#${this.elId}`).fields({size:!0},(a=>{if(!(t>=10)){if(!a)return t++,void this.getCollapseHeight(!1,t);this.height=a.height,this.isheight=!0,e||this.onClick(this.isOpen,"init")}})).exec()},getNvueHwight(e){dom.getComponentRect(this.$refs["collapse--hook"],(t=>{if(t&&t.result&&t.size){if(this.height=t.size.height,this.isheight=!0,e)return;this.onClick(this.open,"init")}}))},getCollapse(e="uniCollapse"){let t=this.$parent,a=t.$options.name;for(;a!==e;){if(t=t.$parent,!t)return!1;a=t.$options.name}return t}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"uni-collapse-item"},[e.createElementVNode("view",{onClick:i[0]||(i[0]=e=>r.onClick(!n.isOpen)),class:e.normalizeClass(["uni-collapse-item__title",{"is-open":n.isOpen&&"auto"===o.titleBorder,"uni-collapse-item-border":"none"!==o.titleBorder}])},[e.createElementVNode("view",{class:"uni-collapse-item__title-wrap"},[e.renderSlot(t.$slots,"title",{},(()=>[e.createElementVNode("view",{class:e.normalizeClass(["uni-collapse-item__title-box",{"is-disabled":o.disabled}])},[o.thumb?(e.openBlock(),e.createElementBlock("image",{key:0,src:o.thumb,class:"uni-collapse-item__title-img"},null,8,["src"])):e.createCommentVNode("",!0),e.createElementVNode("text",{class:"uni-collapse-item__title-text"},e.toDisplayString(o.title),1)],2)]),!0)]),o.showArrow?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass([{"uni-collapse-item__title-arrow-active":n.isOpen,"uni-collapse-item--animation":!0===o.showAnimation},"uni-collapse-item__title-arrow"])},[e.createVNode(l,{color:o.disabled?"#ddd":"#bbb",size:"14",type:"bottom"},null,8,["color"])],2)):e.createCommentVNode("",!0)],2),e.createElementVNode("view",{class:e.normalizeClass(["uni-collapse-item__wrap",{"is--transition":o.showAnimation}]),style:e.normalizeStyle({height:(n.isOpen?n.height:0)+"px"})},[e.createElementVNode("view",{id:n.elId,ref:"collapse--hook",class:e.normalizeClass(["uni-collapse-item__wrap-content",{open:n.isheight,"uni-collapse-item--border":o.border&&n.isOpen}])},[e.renderSlot(t.$slots,"default",{},void 0,!0)],10,["id"])],6)])}],["__scopeId","data-v-b5be0bf0"]]);const Ue=W({name:"uniCollapse",emits:["change","activeItem","input","update:modelValue"],props:{value:{type:[String,Array],default:""},modelValue:{type:[String,Array],default:""},accordion:{type:[Boolean,String],default:!1}},data:()=>({}),computed:{dataValue(){let e="string"==typeof this.value&&""===this.value||Array.isArray(this.value)&&0===this.value.length;"string"==typeof this.modelValue&&""===this.modelValue||Array.isArray(this.modelValue)&&this.modelValue.length;return e?this.modelValue:this.value}},watch:{dataValue(e){this.setOpen(e)}},created(){this.childrens=[],this.names=[]},mounted(){this.$nextTick((()=>{this.setOpen(this.dataValue)}))},methods:{setOpen(e){let a="string"==typeof e,i=Array.isArray(e);this.childrens.forEach(((o,s)=>{if(a&&e===o.nameSync){if(!this.accordion)return void t("warn","at uni_modules/uni-collapse/components/uni-collapse/uni-collapse.vue:75","accordion 属性为 false ,v-model 类型应该为 array");o.isOpen=!0}i&&e.forEach((e=>{if(e===o.nameSync){if(this.accordion)return void t("warn","at uni_modules/uni-collapse/components/uni-collapse/uni-collapse.vue:85","accordion 属性为 true ,v-model 类型应该为 string");o.isOpen=!0}}))})),this.emit(e)},setAccordion(e){this.accordion&&this.childrens.forEach(((t,a)=>{e!==t&&(t.isOpen=!1)}))},resize(){this.childrens.forEach(((e,t)=>{e.getCollapseHeight()}))},onChange(e,t){let a=[];this.accordion?a=e?t.nameSync:"":this.childrens.forEach(((e,t)=>{e.isOpen&&a.push(e.nameSync)})),this.$emit("change",a),this.emit(a)},emit(e){this.$emit("input",e),this.$emit("update:modelValue",e)}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"uni-collapse"},[e.renderSlot(t.$slots,"default",{},void 0,!0)])}],["__scopeId","data-v-61e2e72f"]]);function qe(e){let t="";for(let a in e){t+=`${a}:${e[a]};`}return t}const He=W({name:"uni-easyinput",emits:["click","iconClick","update:modelValue","input","focus","blur","confirm","clear","eyes","change","keyboardheightchange"],model:{prop:"modelValue",event:"update:modelValue"},options:{virtualHost:!0},inject:{form:{from:"uniForm",default:null},formItem:{from:"uniFormItem",default:null}},props:{name:String,value:[Number,String],modelValue:[Number,String],type:{type:String,default:"text"},clearable:{type:Boolean,default:!0},autoHeight:{type:Boolean,default:!1},placeholder:{type:String,default:" "},placeholderStyle:String,focus:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},maxlength:{type:[Number,String],default:140},confirmType:{type:String,default:"done"},clearSize:{type:[Number,String],default:24},inputBorder:{type:Boolean,default:!0},prefixIcon:{type:String,default:""},suffixIcon:{type:String,default:""},trim:{type:[Boolean,String],default:!1},cursorSpacing:{type:Number,default:0},passwordIcon:{type:Boolean,default:!0},adjustPosition:{type:Boolean,default:!0},primaryColor:{type:String,default:"#2979ff"},styles:{type:Object,default:()=>({color:"#333",backgroundColor:"#fff",disableColor:"#F7F6F6",borderColor:"#e5e5e5"})},errorMessage:{type:[String,Boolean],default:""}},data:()=>({focused:!1,val:"",showMsg:"",border:!1,isFirstBorder:!1,showClearIcon:!1,showPassword:!1,focusShow:!1,localMsg:"",isEnter:!1}),computed:{isVal(){const e=this.val;return!(!e&&0!==e)},msg(){return this.localMsg||this.errorMessage},inputMaxlength(){return Number(this.maxlength)},boxStyle(){return`color:${this.inputBorder&&this.msg?"#e43d33":this.styles.color};`},inputContentClass(){return function(e){let t="";for(let a in e)e[a]&&(t+=`${a} `);return t}({"is-input-border":this.inputBorder,"is-input-error-border":this.inputBorder&&this.msg,"is-textarea":"textarea"===this.type,"is-disabled":this.disabled,"is-focused":this.focusShow})},inputContentStyle(){const e=this.focusShow?this.primaryColor:this.styles.borderColor;return qe({"border-color":(this.inputBorder&&this.msg?"#dd524d":e)||"#e5e5e5","background-color":this.disabled?this.styles.disableColor:this.styles.backgroundColor})},inputStyle(){return qe({"padding-right":"password"===this.type||this.clearable||this.prefixIcon?"":"10px","padding-left":this.prefixIcon?"":"10px"})}},watch:{value(e){this.val=e},modelValue(e){this.val=e},focus(e){this.$nextTick((()=>{this.focused=this.focus,this.focusShow=this.focus}))}},created(){this.init(),this.form&&this.formItem&&this.$watch("formItem.errMsg",(e=>{this.localMsg=e}))},mounted(){this.$nextTick((()=>{this.focused=this.focus,this.focusShow=this.focus}))},methods:{init(){this.value||0===this.value?this.val=this.value:this.modelValue||0===this.modelValue||""===this.modelValue?this.val=this.modelValue:this.val=null},onClickIcon(e){this.$emit("iconClick",e)},onEyes(){this.showPassword=!this.showPassword,this.$emit("eyes",this.showPassword)},onInput(e){let t=e.detail.value;this.trim&&("boolean"==typeof this.trim&&this.trim&&(t=this.trimStr(t)),"string"==typeof this.trim&&(t=this.trimStr(t,this.trim))),this.errMsg&&(this.errMsg=""),this.val=t,this.$emit("input",t),this.$emit("update:modelValue",t)},onFocus(){this.$nextTick((()=>{this.focused=!0})),this.$emit("focus",null)},_Focus(e){this.focusShow=!0,this.$emit("focus",e)},onBlur(){this.focused=!1,this.$emit("blur",null)},_Blur(e){if(e.detail.value,this.focusShow=!1,this.$emit("blur",e),!1===this.isEnter&&this.$emit("change",this.val),this.form&&this.formItem){const{validateTrigger:e}=this.form;"blur"===e&&this.formItem.onFieldChange()}},onConfirm(e){this.$emit("confirm",this.val),this.isEnter=!0,this.$emit("change",this.val),this.$nextTick((()=>{this.isEnter=!1}))},onClear(e){this.val="",this.$emit("input",""),this.$emit("update:modelValue",""),this.$emit("clear")},onkeyboardheightchange(e){this.$emit("keyboardheightchange",e)},trimStr:(e,t="both")=>"both"===t?e.trim():"left"===t?e.trimLeft():"right"===t?e.trimRight():"start"===t?e.trimStart():"end"===t?e.trimEnd():"all"===t?e.replace(/\s+/g,""):e}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["uni-easyinput",{"uni-easyinput-error":r.msg}]),style:e.normalizeStyle(r.boxStyle)},[e.createElementVNode("view",{class:e.normalizeClass(["uni-easyinput__content",r.inputContentClass]),style:e.normalizeStyle(r.inputContentStyle)},[o.prefixIcon?(e.openBlock(),e.createBlock(l,{key:0,class:"content-clear-icon",type:o.prefixIcon,color:"#c0c4cc",onClick:i[0]||(i[0]=e=>r.onClickIcon("prefix")),size:"22"},null,8,["type"])):e.createCommentVNode("",!0),e.renderSlot(t.$slots,"left",{},void 0,!0),"textarea"===o.type?(e.openBlock(),e.createElementBlock("textarea",{key:1,class:e.normalizeClass(["uni-easyinput__content-textarea",{"input-padding":o.inputBorder}]),name:o.name,value:n.val,placeholder:o.placeholder,placeholderStyle:o.placeholderStyle,disabled:o.disabled,"placeholder-class":"uni-easyinput__placeholder-class",maxlength:r.inputMaxlength,focus:n.focused,autoHeight:o.autoHeight,"cursor-spacing":o.cursorSpacing,"adjust-position":o.adjustPosition,onInput:i[1]||(i[1]=(...e)=>r.onInput&&r.onInput(...e)),onBlur:i[2]||(i[2]=(...e)=>r._Blur&&r._Blur(...e)),onFocus:i[3]||(i[3]=(...e)=>r._Focus&&r._Focus(...e)),onConfirm:i[4]||(i[4]=(...e)=>r.onConfirm&&r.onConfirm(...e)),onKeyboardheightchange:i[5]||(i[5]=(...e)=>r.onkeyboardheightchange&&r.onkeyboardheightchange(...e))},null,42,["name","value","placeholder","placeholderStyle","disabled","maxlength","focus","autoHeight","cursor-spacing","adjust-position"])):(e.openBlock(),e.createElementBlock("input",{key:2,type:"password"===o.type?"text":o.type,class:"uni-easyinput__content-input",style:e.normalizeStyle(r.inputStyle),name:o.name,value:n.val,password:!n.showPassword&&"password"===o.type,placeholder:o.placeholder,placeholderStyle:o.placeholderStyle,"placeholder-class":"uni-easyinput__placeholder-class",disabled:o.disabled,maxlength:r.inputMaxlength,focus:n.focused,confirmType:o.confirmType,"cursor-spacing":o.cursorSpacing,"adjust-position":o.adjustPosition,onFocus:i[6]||(i[6]=(...e)=>r._Focus&&r._Focus(...e)),onBlur:i[7]||(i[7]=(...e)=>r._Blur&&r._Blur(...e)),onInput:i[8]||(i[8]=(...e)=>r.onInput&&r.onInput(...e)),onConfirm:i[9]||(i[9]=(...e)=>r.onConfirm&&r.onConfirm(...e)),onKeyboardheightchange:i[10]||(i[10]=(...e)=>r.onkeyboardheightchange&&r.onkeyboardheightchange(...e))},null,44,["type","name","value","password","placeholder","placeholderStyle","disabled","maxlength","focus","confirmType","cursor-spacing","adjust-position"])),"password"===o.type&&o.passwordIcon?(e.openBlock(),e.createElementBlock(e.Fragment,{key:3},[r.isVal?(e.openBlock(),e.createBlock(l,{key:0,class:e.normalizeClass(["content-clear-icon",{"is-textarea-icon":"textarea"===o.type}]),type:n.showPassword?"eye-slash-filled":"eye-filled",size:22,color:n.focusShow?o.primaryColor:"#c0c4cc",onClick:r.onEyes},null,8,["class","type","color","onClick"])):e.createCommentVNode("",!0)],64)):e.createCommentVNode("",!0),o.suffixIcon?(e.openBlock(),e.createElementBlock(e.Fragment,{key:4},[o.suffixIcon?(e.openBlock(),e.createBlock(l,{key:0,class:"content-clear-icon",type:o.suffixIcon,color:"#c0c4cc",onClick:i[11]||(i[11]=e=>r.onClickIcon("suffix")),size:"22"},null,8,["type"])):e.createCommentVNode("",!0)],64)):(e.openBlock(),e.createElementBlock(e.Fragment,{key:5},[o.clearable&&r.isVal&&!o.disabled&&"textarea"!==o.type?(e.openBlock(),e.createBlock(l,{key:0,class:e.normalizeClass(["content-clear-icon",{"is-textarea-icon":"textarea"===o.type}]),type:"clear",size:o.clearSize,color:r.msg?"#dd524d":n.focusShow?o.primaryColor:"#c0c4cc",onClick:r.onClear},null,8,["class","size","color","onClick"])):e.createCommentVNode("",!0)],64)),e.renderSlot(t.$slots,"right",{},void 0,!0)],6)],6)}],["__scopeId","data-v-b341649b"]]);
/*!
   * pinia v2.1.7
   * (c) 2023 Eduardo San Martin Morote
   * @license MIT
   */
let We;const Ge=e=>We=e,Je=Symbol();function Ye(e){return e&&"object"==typeof e&&"[object Object]"===Object.prototype.toString.call(e)&&"function"!=typeof e.toJSON}var Ke,Ze;(Ze=Ke||(Ke={})).direct="direct",Ze.patchObject="patch object",Ze.patchFunction="patch function";const Qe=()=>{};function Xe(t,a,i,o=Qe){t.push(a);const s=()=>{const e=t.indexOf(a);e>-1&&(t.splice(e,1),o())};return!i&&e.getCurrentScope()&&e.onScopeDispose(s),s}function et(e,...t){e.slice().forEach((e=>{e(...t)}))}const tt=e=>e();function at(t,a){t instanceof Map&&a instanceof Map&&a.forEach(((e,a)=>t.set(a,e))),t instanceof Set&&a instanceof Set&&a.forEach(t.add,t);for(const i in a){if(!a.hasOwnProperty(i))continue;const o=a[i],s=t[i];Ye(s)&&Ye(o)&&t.hasOwnProperty(i)&&!e.isRef(o)&&!e.isReactive(o)?t[i]=at(s,o):t[i]=o}return t}const it=Symbol();const{assign:ot}=Object;function st(t,a,i={},o,s,n){let r;const l=ot({actions:{}},i),c={deep:!0};let d,u,m,h=[],p=[];const g=o.state.value[t];let f;function y(a){let i;d=u=!1,"function"==typeof a?(a(o.state.value[t]),i={type:Ke.patchFunction,storeId:t,events:m}):(at(o.state.value[t],a),i={type:Ke.patchObject,payload:a,storeId:t,events:m});const s=f=Symbol();e.nextTick().then((()=>{f===s&&(d=!0)})),u=!0,et(h,i,o.state.value[t])}n||g||(o.state.value[t]={}),e.ref({});const v=n?function(){const{state:e}=i,t=e?e():{};this.$patch((e=>{ot(e,t)}))}:Qe;function w(e,a){return function(){Ge(o);const i=Array.from(arguments),s=[],n=[];let r;et(p,{args:i,name:e,store:E,after:function(e){s.push(e)},onError:function(e){n.push(e)}});try{r=a.apply(this&&this.$id===t?this:E,i)}catch(l){throw et(n,l),l}return r instanceof Promise?r.then((e=>(et(s,e),e))).catch((e=>(et(n,e),Promise.reject(e)))):(et(s,r),r)}}const k={_p:o,$id:t,$onAction:Xe.bind(null,p),$patch:y,$reset:v,$subscribe(a,i={}){const s=Xe(h,a,i.detached,(()=>n())),n=r.run((()=>e.watch((()=>o.state.value[t]),(e=>{("sync"===i.flush?u:d)&&a({storeId:t,type:Ke.direct,events:m},e)}),ot({},c,i))));return s},$dispose:function(){r.stop(),h=[],p=[],o._s.delete(t)}},E=e.reactive(k);o._s.set(t,E);const N=(o._a&&o._a.runWithContext||tt)((()=>o._e.run((()=>(r=e.effectScope()).run(a)))));for(const S in N){const a=N[S];if(e.isRef(a)&&(V=a,!e.isRef(V)||!V.effect)||e.isReactive(a))n||(!g||Ye(b=a)&&b.hasOwnProperty(it)||(e.isRef(a)?a.value=g[S]:at(a,g[S])),o.state.value[t][S]=a);else if("function"==typeof a){const e=w(S,a);N[S]=e,l.actions[S]=a}}var b,V;return ot(E,N),ot(e.toRaw(E),N),Object.defineProperty(E,"$state",{get:()=>o.state.value[t],set:e=>{y((t=>{ot(t,e)}))}}),o._p.forEach((e=>{ot(E,r.run((()=>e({store:E,app:o._a,pinia:o,options:l}))))})),g&&n&&i.hydrate&&i.hydrate(E.$state,g),d=!0,u=!0,E}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function nt(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var rt={exports:{}};
/*!
   * decimal-js: Decimal Javascript Library v0.0.2
   * https://github.com/shinuza/decimal-js/
  */!function(e){!function(){for(var t=function(e){return this.constructor!=t?new t(e):e instanceof t?e:(this.internal=String(e),this.as_int=a(this.internal),this.add=function(e){var a=[this,new t(e)];a.sort((function(e,t){return e.as_int.exp-t.as_int.exp}));var i=a[0].as_int.exp,o=a[1].as_int.exp,n=Number(s(a[1].as_int.value,o-i)),r=Number(a[0].as_int.value),l=String(n+r);return t(s(l,i))},this.sub=function(e){return t(this.add(-1*e))},this.mul=function(e){e=new t(e);var a=String(this.as_int.value*e.as_int.value),i=this.as_int.exp+e.as_int.exp;return t(s(a,i))},this.div=function(e){e=new t(e);var a=Math.min(this.as_int.exp,e.as_int.exp),i=t.mul(Math.pow(10,Math.abs(a)),this),o=t.mul(Math.pow(10,Math.abs(a)),e);return t(i/o)},this.toString=function(){return this.internal},void(this.toNumber=function(){return Number(this.internal)}))},a=function(e){var t,a,i=(e=String(e)).split("."),o=i[0],s=i[1];if(s)t=parseInt(e.split(".").join(""),10),a=-1*s.length;else{var n=o.match(/0+$/);if(n){var r=n[0].length;t=o.substr(0,o.length-r),a=r}else t=o,a=0}return{value:t,exp:a}},i=function(e,t){var a=(t=Math.abs(t))-e.length,i=".";a>=0&&(e=n(a)+e,i="0.");var o=e.length;return e.substr(0,o-t)+i+e.substring(o-t,o)},o=function(e,t){var a=n(t);return String(e+a)},s=function(e,t){return e=String(e),(t>=0?o:i)(e,t)},n=function(e){return new Array(e+1).join("0")},r=["add","mul","sub","div"],l=0;l<r.length;l++)!function(e){t[e]=function(a,i){return new t(a)[e](i)}}(r[l]);e.exports?e.exports=t:this.Decimal=t}()}(rt);const lt=nt(rt.exports),ct=function(t,a,i){let o,s;const n="function"==typeof a;function r(t,i){const r=e.hasInjectionContext();(t=t||(r?e.inject(Je,null):null))&&Ge(t),(t=We)._s.has(o)||(n?st(o,a,s,t):function(t,a,i){const{state:o,actions:s,getters:n}=a,r=i.state.value[t];let l;l=st(t,(function(){r||(i.state.value[t]=o?o():{});const a=e.toRefs(i.state.value[t]);return ot(a,s,Object.keys(n||{}).reduce(((a,o)=>(a[o]=e.markRaw(e.computed((()=>{Ge(i);const e=i._s.get(t);return n[o].call(e,e)}))),a)),{}))}),a,i,0,!0)}(o,s,t));return t._s.get(o)}return"string"==typeof t?(o=t,s=n?i:a):(s=t,o=t.id),r.$id=o,r}("cart",{state:()=>({carts:[]}),getters:{cartTotalByShopId:e=>t=>{let a=0;return e.carts.filter((e=>{e.shop_id==t&&(a+=e.price*e.tempCount)})),a},getTempCount:e=>t=>{const a=e.carts.find((e=>e.id===t));return a?a.tempCount:0},cartsLengthByShopId:e=>t=>t?e.carts.filter((e=>e.shop_id==t)).length:e.carts.length||0,getCartsByShopId:e=>t=>t?e.carts.filter((e=>e.shop_id==t)):e.carts},actions:{addItem(e){const t=this.carts.findIndex((t=>t.id===e.id));if(-1!==t){const e=Number(this.carts[t].tempCount)||0;this.carts[t].tempCount=e+1}else this.carts.push({...e,tempCount:1})},subItem(e){const t=this.carts.findIndex((t=>t.id===e.id));if(-1!==t)if(this.carts[t].tempCount>1){const e=Number(this.carts[t].tempCount)||0;this.carts[t].tempCount=e-1}else this.carts.splice(t,1)},clearCart(){t("log","at store/cart.js:81","clearCart action triggered"),this.carts=[]},anyNumber(e){const t=this.carts.findIndex((t=>t.id===e.id));-1!==t?e.count<.1?this.carts.splice(t,1):this.carts[t].tempCount=e.count:e.count>=.1&&this.carts.push({...e,tempCount:e.count})}}});const dt=W({name:"shop-item",props:{shop_id:{type:[Number,String],default:""}},data:()=>({showCartLayer1:!1,cartStore:null}),created(){this.cartStore=ct()},computed:{carts(){return this.cartStore.carts},getCartsByShopId(){return this.carts.filter((e=>e.shop_id===this.shop_id))},cartTotalByShopId(){if(!Array.isArray(this.carts))return 0;const e=this.carts.reduce(((e,t)=>e+(Number(null==t?void 0:t.price)||0)*(Number(null==t?void 0:t.tempCount)||0)),0);return Number(e.toFixed(2))},cartsLengthByShopId(){return this.getCartsByShopId.reduce(((e,t)=>e+(t.tempCount||1)),0)},getTempCount(){return e=>{const t=this.carts.find((t=>t.id===e));return t?t.quantity||1:0}}},methods:{addItem(e){t("log","at components/shop-item/shop-item.vue:128",e),this.cartStore.addItem(this.item)},subItem(e){this.cartStore.subItem(e)},clearCart(){this.cartStore.carts=this.cartStore.carts.filter((e=>e.shop_id!==this.shop_id)),t("log","at components/shop-item/shop-item.vue:143","当前店铺购物车已清空")},clickCart(){t("log","at components/shop-item/shop-item.vue:147",this.showCartLayer1),this.showCartLayer1=!this.showCartLayer1},goToBuyPage(){uni.navigateTo({url:`/pages/Buy/Buy?id=${this.shop_id}`})}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"shoplist"},[n.showCartLayer1?(e.openBlock(),e.createElementBlock("view",{key:0,class:"overlay1"},[e.createElementVNode("scroll-view",{class:"Stallholder1","scroll-y":"",style:{height:"53vh"}},[e.createElementVNode("view",{ref:"cartLayer",onClick:i[1]||(i[1]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"Topmost1"},"农链天下"),e.createElementVNode("view",{class:"shopcontent1"},[e.createElementVNode("view",{class:"top1"},[e.createElementVNode("view",{class:"delete1",onClick:i[0]||(i[0]=(...e)=>r.clearCart&&r.clearCart(...e))},[e.createVNode(l,{type:"trash",size:"40rpx"}),e.createElementVNode("view",{class:"clear"},"清空购物车")])]),e.createElementVNode("view",{class:"content1"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.getCartsByShopId,(t=>(e.openBlock(),e.createElementBlock("view",{class:"item",key:t.id},[e.createElementVNode("view",{class:"biaoti1"},[e.createElementVNode("view",null,e.toDisplayString(t.shopTitle),1),e.createElementVNode("view",null,[e.createVNode(l,{type:"right",size:"14",color:"#ccc"})])]),e.createElementVNode("view",{class:"neirong1"},[e.createElementVNode("view",{class:"left"},[e.createElementVNode("image",{class:"shopimg1",src:t.imglogo,mode:"aspectFill"},null,8,["src"])]),e.createElementVNode("view",{class:"content1"},[e.createElementVNode("view",{class:"shoptitle1"},e.toDisplayString(t.commodity_name),1),e.createElementVNode("view",{class:"shopprice1"},"¥ "+e.toDisplayString(t.price.toFixed(2)),1)]),e.createElementVNode("view",{class:"right"},[e.createElementVNode("view",{class:"btn1",onClick:e=>r.subItem(t)},"-",8,["onClick"]),e.createElementVNode("view",{class:"count1"},e.toDisplayString(n.cartStore.getTempCount(t.id)),1),e.createElementVNode("view",{class:"btn2",onClick:e=>r.addItem(t)},"+",8,["onClick"])])])])))),128))])])],512)])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"fixed"},[e.createElementVNode("view",{class:"car",onClick:i[2]||(i[2]=e.withModifiers(((...e)=>r.clickCart&&r.clickCart(...e)),["stop"]))},[e.createElementVNode("view",{class:"cart-icon-wrapper"},[e.createVNode(l,{type:"cart",size:"40",color:"white"}),e.createElementVNode("view",{class:"badge"},e.toDisplayString(r.cartsLengthByShopId),1)]),e.createElementVNode("view",{class:"pri"},"¥ "+e.toDisplayString(r.cartTotalByShopId),1)]),e.createElementVNode("view",{class:"sett",onClick:i[3]||(i[3]=(...e)=>r.goToBuyPage&&r.goToBuyPage(...e))}," 去结算 ")])])}],["__scopeId","data-v-a276f8d4"]]),ut={name:"menuBarVue",props:["item"],data:()=>({show:!1,count:"",OpenImg:!1,selectImgUrl:null,cartStore:null}),created(){this.cartStore=ct()},computed:{getTempCount(){return e=>{const t=this.cartStore.carts.find((t=>t.id===e&&t.shop_id===this.item.shop_id));return t?t.tempCount:0}}},methods:{viewDetail(){uni.navigateTo({url:`/pages/commodityDetail/commodityDetail?query=${JSON.stringify(this.item)}`})},openBigImg(e){},changeTextarea(e){},add(){this.cartStore.addItem(this.item),this.count=""},reduce(){t("log","at components/menuBar.vue:86",this.item),this.cartStore.subItem({id:this.item.id,shop_id:this.item.shop_id}),this.count=""},isNumeric:e=>/^\d+(\.\d+)?$/.test(e),overInput(e){if(this.isNumeric(e.detail.value)){let t=Number(Number(e.detail.value).toFixed(1));this.cartStore.anyNumber({...this.item,quantity:t}),this.count=t}else uni.showToast({title:"数值有误",icon:"error"}),this.count="";this.show=!1},showInput(){this.$emit("showKeyboard",this.item)},goToSuyuan(e){uni.navigateTo({url:`/subPackages/aHouseholder/lookTraceability/lookTraceability?commodity_id=${e.id}`})}}};const mt=W(ut,[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"box",onClick:i[11]||(i[11]=e=>n.show=!1)},[e.createElementVNode("image",{src:o.item.imglogo,mode:"aspectFill",onClick:i[0]||(i[0]=e=>r.openBigImg(o.item.imglogo))},null,8,["src"]),e.createElementVNode("view",{class:"regard"},[e.createElementVNode("view",{class:"typetitle"},[e.createElementVNode("view",null,[e.createElementVNode("text",{class:"ellipsis"},e.toDisplayString(o.item.commodity_name),1),e.createVNode(l,{type:"right",size:"14",color:"#ccc"})]),e.createElementVNode("view",{onClick:i[1]||(i[1]=(...e)=>r.viewDetail&&r.viewDetail(...e)),style:{color:"white",display:"flex","align-items":"center","justify-content":"center","background-color":"#ffd100","font-size":"30rpx",padding:"30rpx","border-radius":"30rpx","font-weight":"400"}},"详情")]),e.createElementVNode("view",{class:"one",onClick:i[2]||(i[2]=e.withModifiers((e=>r.goToSuyuan(o.item)),["stop"]))},"溯源"),e.createElementVNode("view",{class:"price"},[e.createElementVNode("text",null,"¥ "+e.toDisplayString(o.item.price.toFixed(2))+" 元/"+e.toDisplayString(o.item.weight_name),1),e.createElementVNode("view",{class:"quantity"},[e.createElementVNode("view",{class:"btn1",onClick:i[3]||(i[3]=e.withModifiers(((...e)=>r.reduce&&r.reduce(...e)),["stop"]))},"-"),e.createElementVNode("view",{class:"count1",onClick:i[7]||(i[7]=e.withModifiers(((...e)=>r.showInput&&r.showInput(...e)),["stop"])),catchtouchmove:null},[n.show?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("text",{key:0},e.toDisplayString(r.getTempCount(o.item.id)),1)),n.show?e.withDirectives((e.openBlock(),e.createElementBlock("textarea",{key:1,"adjust-position":!1,"onUpdate:modelValue":i[4]||(i[4]=e=>n.count=e),onBlur:i[5]||(i[5]=(...e)=>r.overInput&&r.overInput(...e)),"auto-height":!1,fixed:"",class:"input",focus:n.show,onInput:i[6]||(i[6]=(...e)=>r.changeTextarea&&r.changeTextarea(...e))},null,40,["focus"])),[[e.vModelText,n.count]]):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"btn2",onClick:i[8]||(i[8]=e.withModifiers(((...e)=>r.add&&r.add(...e)),["stop"]))},"+")])])]),n.OpenImg?(e.openBlock(),e.createElementBlock("view",{key:0,class:"dialog-mask-img",onClick:i[10]||(i[10]=e=>n.OpenImg=!1)},[e.createElementVNode("view",{class:"showImg"},[e.createVNode(l,{mode:"scaleToFill",type:"closeempty",style:{position:"absolute",right:"5rpx",top:"10rpx"},size:"20px",onClick:i[9]||(i[9]=e=>n.OpenImg=!1)}),e.createElementVNode("image",{src:n.selectImgUrl,mode:"scaleToFill"},null,8,["src"])])])):e.createCommentVNode("",!0)])}],["__scopeId","data-v-016261d6"]]);const ht=W({name:"inputBox",props:{initialCartItem:{type:Object,required:!0,default:()=>({})}},data:()=>({show:!1,value:"",keys:["1","2","3","4","5","6","7","8","9","0",".","取消"],unit:"",funs:["删除","清空","确定"],lock:!0,animationData:{},cartItem:{}}),watch:{value(e,t){if(!e)return;if("."===e[0])return void(this.value="0"+e);if((e.match(/\./g)||[]).length>1)return void(this.value=t);if(e.length>1&&"0"===e[0]&&"."!==e[1])return void(this.value=t);const a=e.indexOf(".");if(a>-1&&e.length-a>2)this.value=t;else if(this.cartItem&&"object"==typeof this.cartItem){const e=Number(this.value)||0;this.cartItem.count=e,this.anyNumber(this.cartItem)}},show(e){e&&(this.cartItem={...this.initialCartItem},this.value=this.getTempCount(this.cartItem.id)+""||"")}},computed:{singleItemPrice(){if(!this.cartItem||!this.cartItem.price||!this.value)return 0;const e=new Decimal(Number(this.cartItem.price)||0),t=new Decimal(Number(this.value)||0);return e.mul(t).toNumber().toFixed(2)}},methods:{isNumeric:e=>/^\d+(\.\d+)?$/.test(e),close(){this.show=!1},inputNum(e){""!==this.value||"0"!==e?this.value+=e:this.value="0"},func(e){switch(e){case"删除":this.remove();break;case"取消":this.close();break;case"清空":this.clear();break;case"确定":this.sure()}},remove(){this.value&&(this.value=this.value.substring(0,this.value.length-1))},clear(){this.value="",this.cartItem&&(this.cartItem.count=0,this.anyNumber(this.cartItem))},sure(){if(!this.value||!this.isNumeric(this.value))return this.cartItem.count=0,this.anyNumber(this.cartItem),void(this.show=!1);const e=Number(this.value);this.cartItem.count=e,this.anyNumber(this.cartItem),this.show=!1},getTempCount(e){const t=(uni.getStorageSync("cartList")||[]).find((t=>t.id===e));return(null==t?void 0:t.count)||0},anyNumber(e){uni.setStorageSync("cartList",(uni.getStorageSync("cartList")||[]).map((t=>t.id===e.id?{...t,count:e.count}:t)))}}},[["render",function(t,a,i,o,s,n){return e.withDirectives((e.openBlock(),e.createElementBlock("view",{class:"bigBox",onClick:a[1]||(a[1]=(...e)=>n.close&&n.close(...e)),animation:s.animationData},[e.withDirectives(e.createElementVNode("view",{class:"body",onClick:a[0]||(a[0]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"value"},[e.createElementVNode("text",{style:{"font-size":"30rpx"}},e.toDisplayString(s.value),1),e.createElementVNode("text",{style:{position:"absolute",left:"20rpx",color:"gray"}},e.toDisplayString(s.cartItem.commodity_name)+"￥"+e.toDisplayString(s.cartItem.price)+"元/"+e.toDisplayString(s.cartItem.weight_name),1),e.createElementVNode("text",{style:{position:"absolute",right:"20rpx",color:"gray"}},e.toDisplayString(n.singleItemPrice)+"元",1)]),e.createElementVNode("view",{class:"function"},[e.createElementVNode("view",{class:"nums"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.keys,(t=>(e.openBlock(),e.createElementBlock("view",{class:"num",key:t,onClick:e.withModifiers((e=>"取消"!=t?n.inputNum(t):n.func(t)),["stop"])},e.toDisplayString(t),9,["onClick"])))),128))]),e.createElementVNode("view",{class:"funs"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.funs,(t=>(e.openBlock(),e.createElementBlock("view",{class:"fun",onClick:e.withModifiers((e=>n.func(t)),["stop"])},e.toDisplayString(t),9,["onClick"])))),256))])])],512),[[e.vShow,s.show]])],8,["animation"])),[[e.vShow,s.show]])}],["__scopeId","data-v-cf206b2c"]]),pt={methods:{async checkApplyStatus(){let e=await l.getqrcode(),t=await l.viewAgentInfo({userid:e.data.userid});return 200==t.code?t.data.listdata[0].status:0},hidePhone:e=>e.replace(/(\d{3})\d{4}(\d{4})/,"$1****$2"),getNowDate(){return this.initDate(Date.now())},getChineseTimeDiff(e,t){let a=Math.abs(e-t);return[{value:864e5,name:"天"},{value:36e5,name:"小时"}].map((e=>{const t=Math.floor(a/e.value);return a%=e.value,{val:t,name:e.name}})).filter((e=>e.val>0)).map((e=>`${e.val}${e.name}`)).join("")||"0秒"},async customizeBack(){let e=await getCurrentPages();e&&e.length>1?uni.navigateBack():history.back()},initTime(e){let t=new Date(e).getTime();var a=10===String(t).length?new Date(1e3*parseInt(t)):new Date(parseInt(t)),i=a.getFullYear(),o=a.getMonth()+1;o<10&&(o="0"+o);var s=a.getDate();s<10&&(s="0"+s);var n=a.getHours();n<10&&(n="0"+n);var r=a.getMinutes();r<10&&(r="0"+r);var l=a.getSeconds();return l<10&&(l="0"+l),i+"-"+o+"-"+s+" "+n+":"+r+":"+l},initDate(e){let t=new Date(e).getTime();var a=10===String(t).length?new Date(1e3*parseInt(t)):new Date(parseInt(t)),i=a.getFullYear(),o=a.getMonth()+1;o<10&&(o="0"+o);var s=a.getDate();return s<10&&(s="0"+s),a.getHours(),a.getMinutes(),a.getSeconds(),i+"-"+o+"-"+s}}},gt={data:()=>({showCartLayer:!1,pageData:[],shopDetails:{},shop_id:"",urls1:[],urls2:[],cart:!1,show:!1,isLogin:!0,showSearch:!1,commodity_name:"",showDetail:!1,detailHeidht:0,animationData:{}}),mixins:[ge,pt],components:{shopItem:dt,menuBarVue:mt,inputBoxVue:ht},setup:()=>({cartStore:ct()}),onShow(){uni.getStorageSync("token")||(this.isLogin=!1),this.loadPageData()},onLoad(e){this.shop_id=Number(e.id)},methods:{expandDetails(){if(this.showDetail=!this.showDetail,this.showDetail){var e=uni.createAnimation({duration:2e3,transformOrigin:"50% 50%",timingFunction:"ease"});this.animation=e,e.height(230).step(),this.animationData=e.export()}else{e=uni.createAnimation({duration:2e3,transformOrigin:"50% 50%",timingFunction:"ease"});this.animation=e,e.height(0).step(),this.animationData=e.export()}},async cancelSearch(){this.commodity_name=null,this.pageData=[],this.showSearch=!1;const e=await this.fetchData({page:1,limit:10,isshow:1});this.pageData=e.listdata,this.hasMore=!0},async searchCommodity(){this.pageData=[];let e=await this.fetchData({commodity_name:this.commodity_name,page:1,limit:100});this.pageData=e.listdata,this.hasMore=!1},complaint(){uni.navigateTo({url:`/pages/merchantComplaints/merchantComplaints?id=${this.shopDetails.id}&title=${this.shopDetails.title}`})},Keyboard(e){t("log","at pages/ShopDetails/ShopDetails.vue:203","调用自定义键盘"),this.$refs.inputBoxVueRef.show=!0,this.$refs.inputBoxVueRef.cartItem=e},closeTan(){this.$refs.shopitem.showCartLayer1&&(this.$refs.shopitem.showCartLayer1=!1)},openAvater1(){this.urls1[0]&&this.urls1[0].length>1?uni.previewImage({count:1,urls:this.urls1,sizeType:["original","compressed"],success:e=>{}}):uni.showToast({title:"暂无图片",icon:"error"})},openAvater2(){this.urls2[0]&&this.urls2[0].length>1?uni.previewImage({count:1,urls:this.urls2,sizeType:["original","compressed"],success:e=>{}}):uni.showToast({title:"暂无图片",icon:"error"})},async loadShopDetails(){try{const e=await l.shopDetail(this.shop_id);return this.shopDetails=e.data.listdata[0],this.shopDetails.facelogo&&this.urls1.push(this.shopDetails.facelogo),this.shopDetails.businesslogo&&this.urls2.push(this.shopDetails.businesslogo),e}catch(e){return t("error","at pages/ShopDetails/ShopDetails.vue:262","获取摊主详情失败",e),uni.showToast({title:"获取摊主详情失败",icon:"none"}),{data:{listdata:[{}]}}}},async fetchData(e){const t=await this.loadShopDetails(),{title:a}=t.data.listdata[0]||{};e={...e,shop_id:this.shop_id||null};const i=await l.getmarketCommdityList({...e});return i.data.listdata=i.data.listdata.map((e=>({...e,shopTitle:a}))),i.data},goTorules(){uni.navigateTo({url:"/pages/rules/rules"})}}};const ft=W(gt,[["render",function(t,i,o,s,n,r){const l=e.resolveComponent("inputBoxVue"),c=a(e.resolveDynamicComponent("uni-icons"),K),d=a(e.resolveDynamicComponent("uni-list-item"),Re),u=a(e.resolveDynamicComponent("uni-list"),$e),m=a(e.resolveDynamicComponent("uni-collapse-item"),je),h=a(e.resolveDynamicComponent("uni-collapse"),Ue),p=a(e.resolveDynamicComponent("uni-easyinput"),He),g=e.resolveComponent("menuBarVue"),f=e.resolveComponent("shopItem");return e.openBlock(),e.createElementBlock("scroll-view",{class:"Stallholder","scroll-y":"true",onScrolltolower:i[4]||(i[4]=(...e)=>t.handleScrollToLower&&t.handleScrollToLower(...e)),style:{height:"100vh"},onClick:i[5]||(i[5]=(...e)=>r.closeTan&&r.closeTan(...e))},[e.createVNode(l,{ref:"inputBoxVueRef"},null,512),e.createElementVNode("view",{class:"container"},[e.createElementVNode("view",{class:"StoreName",style:{position:"relative"}},[e.createElementVNode("text",null,e.toDisplayString(n.shopDetails.title),1),e.createElementVNode("image",{class:"logo",src:n.shopDetails.logo,mode:"aspectFill"},null,8,["src"]),e.createElementVNode("view",{class:"complaint-btn",onClick:i[0]||(i[0]=(...e)=>r.complaint&&r.complaint(...e))},[e.createVNode(c,{type:"compose",size:"18",color:"#fff"}),e.createElementVNode("text",null,"投诉建议")])]),e.createVNode(h,{class:"detail-collapse",border:"true"},{default:e.withCtx((()=>[e.createVNode(m,{title:"基本信息","title-style":{fontSize:"26rpx",color:"#333",fontWeight:600,padding:"10rpx 0"}},{default:e.withCtx((()=>[e.createVNode(u,null,{default:e.withCtx((()=>[e.createVNode(d,{title:"摊主名称","show-extra-icon":!0,"extra-icon":{color:"#007aff",size:"24",type:"person-filled"},style:{height:"70rpx",fontSize:"22rpx"},"right-text":n.shopDetails.contactpeople},null,8,["right-text"]),e.createVNode(d,{title:"电话","show-extra-icon":!0,"extra-icon":{color:"#007aff",size:"24",type:"phone-filled"},style:{height:"70rpx",fontSize:"22rpx"},"right-text":n.isLogin?n.shopDetails.contactphone:t.hidePhone(n.shopDetails.contactphone)},null,8,["right-text"]),e.createVNode(d,{title:"营业时间","show-extra-icon":!0,"extra-icon":{color:"#007aff",size:"24",type:"calendar-filled"},style:{height:"70rpx",fontSize:"22rpx"},"right-text":"6:00-21:00"}),e.createVNode(d,{title:"营业执照","show-extra-icon":!0,"extra-icon":{color:"#007aff",size:"24",type:"map-filled"},style:{height:"70rpx",fontSize:"22rpx"},onClick:r.openAvater2,"right-text":"点击查看摊位营业执照"},null,8,["onClick"]),e.createVNode(d,{title:"地址","show-extra-icon":!0,"extra-icon":{color:"#007aff",size:"24",type:"location-filled"},style:{height:"70rpx",fontSize:"22rpx"},"right-text":n.shopDetails.market_address?n.shopDetails.market_address:""},null,8,["right-text"])])),_:1})])),_:1})])),_:1}),e.createElementVNode("view",{class:"dishes"},[e.createElementVNode("view",{class:"search-bar"},[e.createVNode(p,{type:"text","adjust-position":!0,modelValue:n.commodity_name,"onUpdate:modelValue":i[1]||(i[1]=e=>n.commodity_name=e),placeholder:"请输入菜品名称",clearable:!1,"placeholder-style":"{ color: '#999', fontSize: '24rpx' }",class:"search-input"},null,8,["modelValue"]),e.createElementVNode("view",{class:"search-btn-group"},[e.createElementVNode("button",{class:"save search-btn",onClick:i[2]||(i[2]=(...e)=>r.searchCommodity&&r.searchCommodity(...e))},"搜索"),e.createElementVNode("button",{class:"save reset-btn",onClick:i[3]||(i[3]=(...e)=>r.cancelSearch&&r.cancelSearch(...e))},"清空")])]),e.createElementVNode("view",{class:"dish-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.pageData,(t=>(e.openBlock(),e.createElementBlock("view",{class:"dish-card",key:t.id},[e.createVNode(g,{item:t,class:"count",onShowKeyboard:r.Keyboard},null,8,["item","onShowKeyboard"])])))),128)),0===n.pageData.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createVNode(c,{type:"empty",size:"40",color:"#999"}),e.createElementVNode("text",null,"暂无菜品")])):e.createCommentVNode("",!0)])]),e.createVNode(f,{shop_id:n.shop_id,ref:"shopitem"},null,8,["shop_id"])])],32)}]]),yt={data:()=>({multiArray:[[],[],[]],multiIndex:[0,0,0],categoryList:["请选择分类"],categoryIdMap:{},selectedCategory:"请选择分类",provinceList:[],cityList:[],districtList:[],marketList:[],marketIdMap:{},selectedMarketIndex:0,contactpeople:"",contactphone:"",title:"",logo:"",phone:"",content:"",area_id:null,market_id:null,category_id:null,isSubmitting:!1,businessLicense:"",isImageSelected:!1}),mounted(){this.initializePicker(),this.fetchCategories(),this.fetchMarkets()},onShow(){this.checkToken()&&uni.navigateTo({url:"/pages/login/login"})},methods:{checkToken:()=>!uni.getStorageSync("token"),async customizeBack(){let e=await getCurrentPages();e&&e.length>1?uni.navigateBack():history.back()},async initializePicker(){try{const e=await this.fetchProvinces();this.multiArray[0]=e.map((e=>e.name));const t=await this.fetchCities(e[0].id);this.multiArray[1]=t.map((e=>e.name));const a=await this.fetchAreas(t[0].id);this.multiArray[2]=a.map((e=>e.name)),this.multiIndex=[0,0,0]}catch(e){t("error","at pages/Apply/Apply.vue:219","Failed to initialize picker:",e)}},async fetchProvinces(){try{const e=await l.citylist({level:1,limit:100});if(200===e.code)return this.provinceList=e.data.listdata,this.provinceList;throw new Error("Failed to fetch provinces")}catch(e){throw t("error","at pages/Apply/Apply.vue:235","Failed to fetch provinces:",e),e}},async fetchCities(e){try{const a=await l.citytree(e);return 200===a.code&&Array.isArray(a.data)?a.data:(t("error","at pages/Apply/Apply.vue:247","No cities data found"),[])}catch(a){return t("error","at pages/Apply/Apply.vue:251","Failed to fetch cities:",a),[]}},async fetchAreas(e){try{const a=await l.citytree(e);return 200===a.code&&Array.isArray(a.data)?a.data:(t("error","at pages/Apply/Apply.vue:263","No areas data found"),[])}catch(a){return t("error","at pages/Apply/Apply.vue:267","Failed to fetch areas:",a),[]}},bindMultiPickerChange(e){this.multiIndex=e.detail.value;const a=this.multiArray[0][this.multiIndex[0]],i=this.multiArray[1][this.multiIndex[1]],o=this.multiArray[2][this.multiIndex[2]],s=this.districtList[this.multiIndex[2]].id;t("log","at pages/Apply/Apply.vue:277","选择的省市区:",a,i,o),this.area_id=s,this.fetchMarkets(s)},async bindMultiPickerColumnChange(e){const t=e.detail.column,a=e.detail.value;if(this.multiIndex[t]=a,0===t){const e=this.provinceList[a].id,t=await this.fetchCities(e);this.cityList=t,this.multiArray[1]=t.map((e=>e.name)),this.multiArray[2]=t?t[0].Children.map((e=>e.name)):[],this.multiIndex[1]=0,this.multiIndex[2]=0}else if(1===t){const e=this.cityList[a].id,t=await this.fetchAreas(e);this.districtList=t,this.multiArray[2]=t.map((e=>e.name)),this.multiIndex[2]=0}this.multiIndex=[...this.multiIndex]},async fetchMarkets(e){try{const a=100,i=await l.marketlist(e,a);200===i.code?(this.marketData=i.data.listdata,this.marketList=i.data.listdata.map((e=>e.marketname)),this.marketIdMap=this.marketData.reduce(((e,t)=>(e[t.marketname]=t.id,e)),{})):t("error","at pages/Apply/Apply.vue:320","Failed to fetch markets:",i.message)}catch(a){t("error","at pages/Apply/Apply.vue:323","Failed to fetch markets:",a)}},bindMarketChange(e){this.selectedMarketIndex=e.detail.value;const t=this.marketList[this.selectedMarketIndex];this.market_id=this.marketIdMap[t]||null},async fetchCategories(){try{const e=await l.cglist();if(200!==e.code)throw new Error("Failed to fetch categories");{const t=e.data.listdata;this.categoryList=["请选择分类",...t.map((e=>e.title))],this.categoryIdMap=t.reduce(((e,t)=>(e[t.title]=t.id,e)),{})}}catch(e){t("error","at pages/Apply/Apply.vue:347","Failed to fetch categories:",e)}},bindCategoryChange(e){const t=e.detail.value;this.selectedCategory=this.categoryList[t],this.category_id=this.categoryIdMap[this.selectedCategory]},chooseImage(){uni.chooseImage({count:1,sizeType:["compressed","original"],sourceType:["album","camera"],success:e=>{const t=e.tempFilePaths;if(t.length>0){const{upload:a,request:i}=Ae({uploadPath:"/group1/upload",tempFilePaths:t[0],file:e.tempFiles[0]});a().then((e=>{var t=JSON.parse(e);this.logo=o+t.data.path,this.isImageSelected=!0}))}}})},async submitForm(){if(!this.isSubmitting)if(this.contactpeople&&this.contactphone&&this.title&&this.phone&&this.area_id&&this.market_id&&this.category_id&&this.logo){this.isSubmitting=!0;try{const e={contactpeople:this.contactpeople,contactphone:this.contactphone,title:this.title,logo:this.logo,phone:this.phone,content:this.content,area_id:this.area_id,market_id:this.market_id,category_id:this.category_id},t=await l.addshop(e);200===t.code?(uni.showToast({title:"摊位申请成功",icon:"success",duration:2e3}),setTimeout((()=>{this.customizeBack()}),2e3)):uni.showToast({title:t.msg||"提交失败",icon:"none"})}catch(e){t("error","at pages/Apply/Apply.vue:434","提交失败:",e),uni.showToast({title:"提交失败",icon:"none"})}finally{this.isSubmitting=!1}}else uni.showToast({title:"请填写完整的信息",icon:"none"})}}};const vt=W(yt,[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"me-container"},[e.createElementVNode("view",{class:"form-card"},[e.createElementVNode("view",{class:"section-title"},[e.createElementVNode("text",{class:"title-icon"},"｜"),e.createElementVNode("text",{class:"title-text"},"基本信息")]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"item-label"},[e.createVNode(l,{type:"person",size:"18",color:"#666"}),e.createElementVNode("text",null,"联系人")]),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":i[0]||(i[0]=e=>n.contactpeople=e),placeholder:"请输入联系人姓名","placeholder-style":"color: #c0c4cc"},null,512),[[e.vModelText,n.contactpeople]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"item-label"},[e.createVNode(l,{type:"phone",size:"18",color:"#666"}),e.createElementVNode("text",null,"联系电话")]),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":i[1]||(i[1]=e=>n.contactphone=e),type:"number",placeholder:"请输入联系人电话","placeholder-style":"color: #c0c4cc"},null,512),[[e.vModelText,n.contactphone]])])]),e.createElementVNode("view",{class:"form-card"},[e.createElementVNode("view",{class:"section-title"},[e.createElementVNode("text",{class:"title-icon"},"｜"),e.createElementVNode("text",{class:"title-text"},"所在地")]),e.createElementVNode("view",{class:"form-item picker-item compact"},[e.createElementVNode("view",{class:"item-label"},[e.createVNode(l,{type:"location",size:"18",color:"#666"}),e.createElementVNode("text",null,"所在地区")]),e.createElementVNode("picker",{mode:"multiSelector",range:n.multiArray,value:n.multiIndex,onChange:i[2]||(i[2]=(...e)=>r.bindMultiPickerChange&&r.bindMultiPickerChange(...e)),onColumnchange:i[3]||(i[3]=(...e)=>r.bindMultiPickerColumnChange&&r.bindMultiPickerColumnChange(...e))},[e.createElementVNode("view",{class:"compact-picker"},[e.createElementVNode("view",null,[e.createElementVNode("text",{class:"province"},e.toDisplayString(n.multiArray[0][n.multiIndex[0]]||"省"),1),e.createElementVNode("text",{class:"separator"},"/"),e.createElementVNode("text",{class:"city"},e.toDisplayString(n.multiArray[1][n.multiIndex[1]]||"市"),1),e.createElementVNode("text",{class:"separator"},"/"),e.createElementVNode("text",{class:"district"},e.toDisplayString(n.multiArray[2][n.multiIndex[2]]||"区"),1)]),e.createElementVNode("view",null,[e.createVNode(l,{type:"arrowright",size:"18",color:"#999"})])])],40,["range","value"])]),e.createElementVNode("view",{class:"form-item picker-item"},[e.createElementVNode("view",{class:"item-label"},[e.createVNode(l,{type:"flag",size:"18",color:"#666"}),e.createElementVNode("text",null,"选择菜市场")]),e.createElementVNode("picker",{mode:"selector",range:n.marketList,value:n.selectedMarketIndex,onChange:i[4]||(i[4]=(...e)=>r.bindMarketChange&&r.bindMarketChange(...e))},[e.createElementVNode("view",{class:"picker-content"},[e.createElementVNode("text",{class:"picker-text"},e.toDisplayString(n.marketList[n.selectedMarketIndex]||"请选择菜市场"),1),e.createVNode(l,{type:"arrowright",size:"18",color:"#999"})])],40,["range","value"])])]),e.createElementVNode("view",{class:"form-card"},[e.createElementVNode("view",{class:"section-title"},[e.createElementVNode("text",{class:"title-icon"},"｜"),e.createElementVNode("text",{class:"title-text"},"摊铺信息")]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"item-label"},[e.createVNode(l,{type:"shop",size:"18",color:"#666"}),e.createElementVNode("text",null,"摊铺名称")]),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":i[5]||(i[5]=e=>n.title=e),placeholder:"请输入摊铺名称","placeholder-style":"color: #c0c4cc"},null,512),[[e.vModelText,n.title]])]),e.createElementVNode("view",{class:"form-item picker-item"},[e.createElementVNode("view",{class:"item-label"},[e.createVNode(l,{type:"list",size:"18",color:"#666"}),e.createElementVNode("text",null,"所售类目")]),e.createElementVNode("picker",{mode:"selector",range:n.categoryList,onChange:i[6]||(i[6]=(...e)=>r.bindCategoryChange&&r.bindCategoryChange(...e))},[e.createElementVNode("view",{class:"picker-content"},[e.createElementVNode("text",{class:"picker-text"},e.toDisplayString(n.selectedCategory||"请选择经营类目"),1),e.createVNode(l,{type:"arrowright",size:"18",color:"#999"})])],40,["range"])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"item-label"},[e.createVNode(l,{type:"phone",size:"18",color:"#666"}),e.createElementVNode("text",null,"摊主电话")]),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":i[7]||(i[7]=e=>n.phone=e),type:"number",placeholder:"请输入摊主联系电话","placeholder-style":"color: #c0c4cc"},null,512),[[e.vModelText,n.phone]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"item-label"},[e.createVNode(l,{type:"image",size:"18",color:"#666"}),e.createElementVNode("text",null,"摊位图片")]),e.createElementVNode("view",{class:e.normalizeClass(["upload-btn",{uploaded:n.isImageSelected}]),onClick:i[8]||(i[8]=(...e)=>r.chooseImage&&r.chooseImage(...e))},[e.createVNode(l,{type:n.isImageSelected?"checkmarkempty":"plusempty",size:"24",color:n.isImageSelected?"#67C23A":"#999"},null,8,["type","color"]),e.createElementVNode("text",null,e.toDisplayString(n.isImageSelected?"已上传":"点击上传"),1)],2)])]),e.createElementVNode("view",{class:"submit-wrapper"},[e.createElementVNode("button",{class:e.normalizeClass(["submit-btn",{disabled:n.isSubmitting}]),onClick:i[9]||(i[9]=(...e)=>r.submitForm&&r.submitForm(...e))},[e.createTextVNode(e.toDisplayString(n.isSubmitting?"提交中...":"立即提交")+" ",1),n.isSubmitting?(e.openBlock(),e.createElementBlock("text",{key:0,class:"loading-icon"},"◌")):e.createCommentVNode("",!0)],2)])])}],["__scopeId","data-v-2291f268"]]);let wt=class{constructor({selected:e,startDate:t,endDate:a,range:i}={}){this.date=this.getDateObj(new Date),this.selected=e||[],this.startDate=t,this.endDate=a,this.range=i,this.cleanMultipleStatus(),this.weeks={},this.lastHover=!1}setDate(e){const t=this.getDateObj(e);this.getWeeks(t.fullDate)}cleanMultipleStatus(){this.multipleStatus={before:"",after:"",data:[]}}setStartDate(e){this.startDate=e}setEndDate(e){this.endDate=e}getPreMonthObj(e){e=Dt(e);const t=(e=new Date(e)).getMonth();e.setMonth(t-1);const a=e.getMonth();return 0!==t&&a-t==0&&e.setMonth(a-1),this.getDateObj(e)}getNextMonthObj(e){e=Dt(e);const t=(e=new Date(e)).getMonth();e.setMonth(t+1);const a=e.getMonth();return a-t>1&&e.setMonth(a-1),this.getDateObj(e)}getDateObj(e){return e=Dt(e),{fullDate:Et(e=new Date(e)),year:e.getFullYear(),month:bt(e.getMonth()+1),date:bt(e.getDate()),day:e.getDay()}}getPreMonthDays(e,t){const a=[];for(let i=e-1;i>=0;i--){const e=t.month-1;a.push({date:new Date(t.year,e,-i).getDate(),month:e,disable:!0})}return a}getCurrentMonthDays(e,t){const a=[],i=this.date.fullDate;for(let o=1;o<=e;o++){const e=`${t.year}-${t.month}-${bt(o)}`,s=i===e,n=this.selected&&this.selected.find((t=>{if(this.dateEqual(e,t.date))return t}));this.startDate&&St(this.startDate,e),this.endDate&&St(e,this.endDate);let r=this.multipleStatus.data,l=-1;this.range&&r&&(l=r.findIndex((t=>this.dateEqual(t,e))));const c=-1!==l;a.push({fullDate:e,year:t.year,date:o,multiple:!!this.range&&c,beforeMultiple:this.isLogicBefore(e,this.multipleStatus.before,this.multipleStatus.after),afterMultiple:this.isLogicAfter(e,this.multipleStatus.before,this.multipleStatus.after),month:t.month,disable:this.startDate&&!St(this.startDate,e)||this.endDate&&!St(e,this.endDate),isToday:s,userChecked:!1,extraInfo:n})}return a}_getNextMonthDays(e,t){const a=[],i=t.month+1;for(let o=1;o<=e;o++)a.push({date:o,month:i,disable:!0});return a}getInfo(e){return e||(e=new Date),this.calendar.find((t=>t.fullDate===this.getDateObj(e).fullDate))}dateEqual(e,t){return e=new Date(Dt(e)),t=new Date(Dt(t)),e.valueOf()===t.valueOf()}isLogicBefore(e,t,a){let i=t;return t&&a&&(i=St(t,a)?t:a),this.dateEqual(i,e)}isLogicAfter(e,t,a){let i=a;return t&&a&&(i=St(t,a)?a:t),this.dateEqual(i,e)}geDateAll(e,t){var a=[],i=e.split("-"),o=t.split("-"),s=new Date;s.setFullYear(i[0],i[1]-1,i[2]);var n=new Date;n.setFullYear(o[0],o[1]-1,o[2]);for(var r=s.getTime()-864e5,l=n.getTime()-864e5,c=r;c<=l;)c+=864e5,a.push(this.getDateObj(new Date(parseInt(c))).fullDate);return a}setMultiple(e){if(!this.range)return;let{before:t,after:a}=this.multipleStatus;if(t&&a){if(!this.lastHover)return void(this.lastHover=!0);this.multipleStatus.before=e,this.multipleStatus.after="",this.multipleStatus.data=[],this.multipleStatus.fulldate="",this.lastHover=!1}else t?(this.multipleStatus.after=e,St(this.multipleStatus.before,this.multipleStatus.after)?this.multipleStatus.data=this.geDateAll(this.multipleStatus.before,this.multipleStatus.after):this.multipleStatus.data=this.geDateAll(this.multipleStatus.after,this.multipleStatus.before),this.lastHover=!0):(this.multipleStatus.before=e,this.multipleStatus.after=void 0,this.lastHover=!1);this.getWeeks(e)}setHoverMultiple(e){if(!this.range||this.lastHover)return;const{before:t}=this.multipleStatus;t?(this.multipleStatus.after=e,St(this.multipleStatus.before,this.multipleStatus.after)?this.multipleStatus.data=this.geDateAll(this.multipleStatus.before,this.multipleStatus.after):this.multipleStatus.data=this.geDateAll(this.multipleStatus.after,this.multipleStatus.before)):this.multipleStatus.before=e,this.getWeeks(e)}setDefaultMultiple(e,t){this.multipleStatus.before=e,this.multipleStatus.after=t,e&&t&&(St(e,t)?(this.multipleStatus.data=this.geDateAll(e,t),this.getWeeks(t)):(this.multipleStatus.data=this.geDateAll(t,e),this.getWeeks(e)))}getWeeks(e){const{year:t,month:a}=this.getDateObj(e),i=new Date(t,a-1,1).getDay(),o=this.getPreMonthDays(i,this.getDateObj(e)),s=new Date(t,a,0).getDate(),n=42-i-s,r=[...o,...this.getCurrentMonthDays(s,this.getDateObj(e)),...this._getNextMonthDays(n,this.getDateObj(e))],l=new Array(6);for(let c=0;c<r.length;c++){const e=Math.floor(c/7);l[e]||(l[e]=new Array(7)),l[e][c%7]=r[c]}this.calendar=r,this.weeks=l}};function kt(e,t){return`${Et(e)} ${Nt(e,t)}`}function Et(e){e=Dt(e);const t=(e=new Date(e)).getFullYear(),a=e.getMonth()+1,i=e.getDate();return`${t}-${bt(a)}-${bt(i)}`}function Nt(e,t){e=Dt(e);const a=(e=new Date(e)).getHours(),i=e.getMinutes(),o=e.getSeconds();return t?`${bt(a)}:${bt(i)}`:`${bt(a)}:${bt(i)}:${bt(o)}`}function bt(e){return e<10&&(e=`0${e}`),e}function Vt(e){return e?"00:00":"00:00:00"}function St(e,t){return(e=new Date(Dt(e)))<=(t=new Date(Dt(t)))}function xt(e){return e.match(/((19|20)\d{2})(-|\/)\d{1,2}(-|\/)\d{1,2}/g)}const Ct=/^\d{4}-(0?[1-9]|1[012])-(0?[1-9]|[12][0-9]|3[01])( [0-5]?[0-9]:[0-5]?[0-9](:[0-5]?[0-9])?)?$/;function Dt(e){return"string"==typeof e&&Ct.test(e)&&(e=e.replace(/-/g,"/")),e}const Tt=W({props:{weeks:{type:Object,default:()=>({})},calendar:{type:Object,default:()=>({})},selected:{type:Array,default:()=>[]},checkHover:{type:Boolean,default:!1}},methods:{choiceDate(e){this.$emit("change",e)},handleMousemove(e){this.$emit("handleMouse",e)}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["uni-calendar-item__weeks-box",{"uni-calendar-item--disable":i.weeks.disable,"uni-calendar-item--before-checked-x":i.weeks.beforeMultiple,"uni-calendar-item--multiple":i.weeks.multiple,"uni-calendar-item--after-checked-x":i.weeks.afterMultiple}]),onClick:a[0]||(a[0]=e=>n.choiceDate(i.weeks)),onMouseenter:a[1]||(a[1]=e=>n.handleMousemove(i.weeks))},[e.createElementVNode("view",{class:e.normalizeClass(["uni-calendar-item__weeks-box-item",{"uni-calendar-item--checked":i.calendar.fullDate===i.weeks.fullDate&&(i.calendar.userChecked||!i.checkHover),"uni-calendar-item--checked-range-text":i.checkHover,"uni-calendar-item--before-checked":i.weeks.beforeMultiple,"uni-calendar-item--multiple":i.weeks.multiple,"uni-calendar-item--after-checked":i.weeks.afterMultiple,"uni-calendar-item--disable":i.weeks.disable}])},[i.selected&&i.weeks.extraInfo?(e.openBlock(),e.createElementBlock("text",{key:0,class:"uni-calendar-item__weeks-box-circle"})):e.createCommentVNode("",!0),e.createElementVNode("text",{class:"uni-calendar-item__weeks-box-text uni-calendar-item__weeks-box-text-disable uni-calendar-item--checked-text"},e.toDisplayString(i.weeks.date),1)],2),e.createElementVNode("view",{class:e.normalizeClass({"uni-calendar-item--today":i.weeks.isToday})},null,2)],34)}],["__scopeId","data-v-ee11a364"]]),_t={en:{"uni-datetime-picker.selectDate":"select date","uni-datetime-picker.selectTime":"select time","uni-datetime-picker.selectDateTime":"select date and time","uni-datetime-picker.startDate":"start date","uni-datetime-picker.endDate":"end date","uni-datetime-picker.startTime":"start time","uni-datetime-picker.endTime":"end time","uni-datetime-picker.ok":"ok","uni-datetime-picker.clear":"clear","uni-datetime-picker.cancel":"cancel","uni-datetime-picker.year":"-","uni-datetime-picker.month":"","uni-calender.MON":"MON","uni-calender.TUE":"TUE","uni-calender.WED":"WED","uni-calender.THU":"THU","uni-calender.FRI":"FRI","uni-calender.SAT":"SAT","uni-calender.SUN":"SUN","uni-calender.confirm":"confirm"},"zh-Hans":{"uni-datetime-picker.selectDate":"选择日期","uni-datetime-picker.selectTime":"选择时间","uni-datetime-picker.selectDateTime":"选择日期时间","uni-datetime-picker.startDate":"开始日期","uni-datetime-picker.endDate":"结束日期","uni-datetime-picker.startTime":"开始时间","uni-datetime-picker.endTime":"结束时间","uni-datetime-picker.ok":"确定","uni-datetime-picker.clear":"清除","uni-datetime-picker.cancel":"取消","uni-datetime-picker.year":"年","uni-datetime-picker.month":"月","uni-calender.SUN":"日","uni-calender.MON":"一","uni-calender.TUE":"二","uni-calender.WED":"三","uni-calender.THU":"四","uni-calender.FRI":"五","uni-calender.SAT":"六","uni-calender.confirm":"确认"},"zh-Hant":{"uni-datetime-picker.selectDate":"選擇日期","uni-datetime-picker.selectTime":"選擇時間","uni-datetime-picker.selectDateTime":"選擇日期時間","uni-datetime-picker.startDate":"開始日期","uni-datetime-picker.endDate":"結束日期","uni-datetime-picker.startTime":"開始时间","uni-datetime-picker.endTime":"結束时间","uni-datetime-picker.ok":"確定","uni-datetime-picker.clear":"清除","uni-datetime-picker.cancel":"取消","uni-datetime-picker.year":"年","uni-datetime-picker.month":"月","uni-calender.SUN":"日","uni-calender.MON":"一","uni-calender.TUE":"二","uni-calender.WED":"三","uni-calender.THU":"四","uni-calender.FRI":"五","uni-calender.SAT":"六","uni-calender.confirm":"確認"}},{t:Pt}=le(_t),It={name:"UniDatetimePicker",data:()=>({indicatorStyle:"height: 50px;",visible:!1,fixNvueBug:{},dateShow:!0,timeShow:!0,title:"日期和时间",time:"",year:1920,month:0,day:0,hour:0,minute:0,second:0,startYear:1920,startMonth:1,startDay:1,startHour:0,startMinute:0,startSecond:0,endYear:2120,endMonth:12,endDay:31,endHour:23,endMinute:59,endSecond:59}),options:{virtualHost:!0},props:{type:{type:String,default:"datetime"},value:{type:[String,Number],default:""},modelValue:{type:[String,Number],default:""},start:{type:[Number,String],default:""},end:{type:[Number,String],default:""},returnType:{type:String,default:"string"},disabled:{type:[Boolean,String],default:!1},border:{type:[Boolean,String],default:!0},hideSecond:{type:[Boolean,String],default:!1}},watch:{modelValue:{handler(e){e?(this.parseValue(Dt(e)),this.initTime(!1)):(this.time="",this.parseValue(Date.now()))},immediate:!0},type:{handler(e){"date"===e?(this.dateShow=!0,this.timeShow=!1,this.title="日期"):"time"===e?(this.dateShow=!1,this.timeShow=!0,this.title="时间"):(this.dateShow=!0,this.timeShow=!0,this.title="日期和时间")},immediate:!0},start:{handler(e){this.parseDatetimeRange(Dt(e),"start")},immediate:!0},end:{handler(e){this.parseDatetimeRange(Dt(e),"end")},immediate:!0},months(e){this.checkValue("month",this.month,e)},days(e){this.checkValue("day",this.day,e)},hours(e){this.checkValue("hour",this.hour,e)},minutes(e){this.checkValue("minute",this.minute,e)},seconds(e){this.checkValue("second",this.second,e)}},computed:{years(){return this.getCurrentRange("year")},months(){return this.getCurrentRange("month")},days(){return this.getCurrentRange("day")},hours(){return this.getCurrentRange("hour")},minutes(){return this.getCurrentRange("minute")},seconds(){return this.getCurrentRange("second")},ymd(){return[this.year-this.minYear,this.month-this.minMonth,this.day-this.minDay]},hms(){return[this.hour-this.minHour,this.minute-this.minMinute,this.second-this.minSecond]},currentDateIsStart(){return this.year===this.startYear&&this.month===this.startMonth&&this.day===this.startDay},currentDateIsEnd(){return this.year===this.endYear&&this.month===this.endMonth&&this.day===this.endDay},minYear(){return this.startYear},maxYear(){return this.endYear},minMonth(){return this.year===this.startYear?this.startMonth:1},maxMonth(){return this.year===this.endYear?this.endMonth:12},minDay(){return this.year===this.startYear&&this.month===this.startMonth?this.startDay:1},maxDay(){return this.year===this.endYear&&this.month===this.endMonth?this.endDay:this.daysInMonth(this.year,this.month)},minHour(){return"datetime"===this.type?this.currentDateIsStart?this.startHour:0:"time"===this.type?this.startHour:void 0},maxHour(){return"datetime"===this.type?this.currentDateIsEnd?this.endHour:23:"time"===this.type?this.endHour:void 0},minMinute(){return"datetime"===this.type?this.currentDateIsStart&&this.hour===this.startHour?this.startMinute:0:"time"===this.type?this.hour===this.startHour?this.startMinute:0:void 0},maxMinute(){return"datetime"===this.type?this.currentDateIsEnd&&this.hour===this.endHour?this.endMinute:59:"time"===this.type?this.hour===this.endHour?this.endMinute:59:void 0},minSecond(){return"datetime"===this.type?this.currentDateIsStart&&this.hour===this.startHour&&this.minute===this.startMinute?this.startSecond:0:"time"===this.type?this.hour===this.startHour&&this.minute===this.startMinute?this.startSecond:0:void 0},maxSecond(){return"datetime"===this.type?this.currentDateIsEnd&&this.hour===this.endHour&&this.minute===this.endMinute?this.endSecond:59:"time"===this.type?this.hour===this.endHour&&this.minute===this.endMinute?this.endSecond:59:void 0},selectTimeText:()=>Pt("uni-datetime-picker.selectTime"),okText:()=>Pt("uni-datetime-picker.ok"),clearText:()=>Pt("uni-datetime-picker.clear"),cancelText:()=>Pt("uni-datetime-picker.cancel")},mounted(){},methods:{lessThanTen:e=>e<10?"0"+e:e,parseTimeType(e){if(e){let t=e.split(":");this.hour=Number(t[0]),this.minute=Number(t[1]),this.second=Number(t[2])}},initPickerValue(e){let t=null;e?t=this.compareValueWithStartAndEnd(e,this.start,this.end):(t=Date.now(),t=this.compareValueWithStartAndEnd(t,this.start,this.end)),this.parseValue(t)},compareValueWithStartAndEnd(e,t,a){let i=null;return e=this.superTimeStamp(e),t=this.superTimeStamp(t),a=this.superTimeStamp(a),i=t&&a?e<t?new Date(t):e>a?new Date(a):new Date(e):t&&!a?t<=e?new Date(e):new Date(t):!t&&a?e<=a?new Date(e):new Date(a):new Date(e),i},superTimeStamp(e){let t="";if("time"===this.type&&e&&"string"==typeof e){const e=new Date;t=e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDate()+" "}return Number(e)&&(e=parseInt(e),t=0),this.createTimeStamp(t+e)},parseValue(e){if(e){if("time"===this.type&&"string"==typeof e)this.parseTimeType(e);else{let t=null;t=new Date(e),"time"!==this.type&&(this.year=t.getFullYear(),this.month=t.getMonth()+1,this.day=t.getDate()),"date"!==this.type&&(this.hour=t.getHours(),this.minute=t.getMinutes(),this.second=t.getSeconds())}this.hideSecond&&(this.second=0)}},parseDatetimeRange(e,t){if(!e)return"start"===t&&(this.startYear=1920,this.startMonth=1,this.startDay=1,this.startHour=0,this.startMinute=0,this.startSecond=0),void("end"===t&&(this.endYear=2120,this.endMonth=12,this.endDay=31,this.endHour=23,this.endMinute=59,this.endSecond=59));if("time"===this.type){const a=e.split(":");this[t+"Hour"]=Number(a[0]),this[t+"Minute"]=Number(a[1]),this[t+"Second"]=Number(a[2])}else{if(!e)return void("start"===t?this.startYear=this.year-60:this.endYear=this.year+60);Number(e)&&(e=parseInt(e));const a=/[0-9]:[0-9]/;"datetime"!==this.type||"end"!==t||"string"!=typeof e||a.test(e)||(e+=" 23:59:59");const i=new Date(e);this[t+"Year"]=i.getFullYear(),this[t+"Month"]=i.getMonth()+1,this[t+"Day"]=i.getDate(),"datetime"===this.type&&(this[t+"Hour"]=i.getHours(),this[t+"Minute"]=i.getMinutes(),this[t+"Second"]=i.getSeconds())}},getCurrentRange(e){const t=[];for(let a=this["min"+this.capitalize(e)];a<=this["max"+this.capitalize(e)];a++)t.push(a);return t},capitalize:e=>e.charAt(0).toUpperCase()+e.slice(1),checkValue(e,t,a){-1===a.indexOf(t)&&(this[e]=a[0])},daysInMonth:(e,t)=>new Date(e,t,0).getDate(),createTimeStamp(e){if(e)return"number"==typeof e?e:(e=e.replace(/-/g,"/"),"date"===this.type&&(e+=" 00:00:00"),Date.parse(e))},createDomSting(){const e=this.year+"-"+this.lessThanTen(this.month)+"-"+this.lessThanTen(this.day);let t=this.lessThanTen(this.hour)+":"+this.lessThanTen(this.minute);return this.hideSecond||(t=t+":"+this.lessThanTen(this.second)),"date"===this.type?e:"time"===this.type?t:e+" "+t},initTime(e=!0){this.time=this.createDomSting(),e&&("timestamp"===this.returnType&&"time"!==this.type?(this.$emit("change",this.createTimeStamp(this.time)),this.$emit("input",this.createTimeStamp(this.time)),this.$emit("update:modelValue",this.createTimeStamp(this.time))):(this.$emit("change",this.time),this.$emit("input",this.time),this.$emit("update:modelValue",this.time)))},bindDateChange(e){const t=e.detail.value;this.year=this.years[t[0]],this.month=this.months[t[1]],this.day=this.days[t[2]]},bindTimeChange(e){const t=e.detail.value;this.hour=this.hours[t[0]],this.minute=this.minutes[t[1]],this.second=this.seconds[t[2]]},initTimePicker(){if(this.disabled)return;const e=Dt(this.time);this.initPickerValue(e),this.visible=!this.visible},tiggerTimePicker(e){this.visible=!this.visible},clearTime(){this.time="",this.$emit("change",this.time),this.$emit("input",this.time),this.$emit("update:modelValue",this.time),this.tiggerTimePicker()},setTime(){this.initTime(),this.tiggerTimePicker()}}};const Bt=W(It,[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"uni-datetime-picker"},[e.createElementVNode("view",{onClick:a[0]||(a[0]=(...e)=>n.initTimePicker&&n.initTimePicker(...e))},[e.renderSlot(t.$slots,"default",{},(()=>[e.createElementVNode("view",{class:e.normalizeClass(["uni-datetime-picker-timebox-pointer",{"uni-datetime-picker-disabled":i.disabled,"uni-datetime-picker-timebox":i.border}])},[e.createElementVNode("text",{class:"uni-datetime-picker-text"},e.toDisplayString(s.time),1),s.time?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-datetime-picker-time"},[e.createElementVNode("text",{class:"uni-datetime-picker-text"},e.toDisplayString(n.selectTimeText),1)]))],2)]),!0)]),s.visible?(e.openBlock(),e.createElementBlock("view",{key:0,id:"mask",class:"uni-datetime-picker-mask",onClick:a[1]||(a[1]=(...e)=>n.tiggerTimePicker&&n.tiggerTimePicker(...e))})):e.createCommentVNode("",!0),s.visible?(e.openBlock(),e.createElementBlock("view",{key:1,class:e.normalizeClass(["uni-datetime-picker-popup",[s.dateShow&&s.timeShow?"":"fix-nvue-height"]]),style:e.normalizeStyle(s.fixNvueBug)},[e.createElementVNode("view",{class:"uni-title"},[e.createElementVNode("text",{class:"uni-datetime-picker-text"},e.toDisplayString(n.selectTimeText),1)]),s.dateShow?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-datetime-picker__container-box"},[e.createElementVNode("picker-view",{class:"uni-datetime-picker-view","indicator-style":s.indicatorStyle,value:n.ymd,onChange:a[2]||(a[2]=(...e)=>n.bindDateChange&&n.bindDateChange(...e))},[e.createElementVNode("picker-view-column",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.years,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-datetime-picker-item",key:a},[e.createElementVNode("text",{class:"uni-datetime-picker-item"},e.toDisplayString(n.lessThanTen(t)),1)])))),128))]),e.createElementVNode("picker-view-column",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.months,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-datetime-picker-item",key:a},[e.createElementVNode("text",{class:"uni-datetime-picker-item"},e.toDisplayString(n.lessThanTen(t)),1)])))),128))]),e.createElementVNode("picker-view-column",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.days,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-datetime-picker-item",key:a},[e.createElementVNode("text",{class:"uni-datetime-picker-item"},e.toDisplayString(n.lessThanTen(t)),1)])))),128))])],40,["indicator-style","value"]),e.createElementVNode("text",{class:"uni-datetime-picker-sign sign-left"},"-"),e.createElementVNode("text",{class:"uni-datetime-picker-sign sign-right"},"-")])):e.createCommentVNode("",!0),s.timeShow?(e.openBlock(),e.createElementBlock("view",{key:1,class:"uni-datetime-picker__container-box"},[e.createElementVNode("picker-view",{class:e.normalizeClass(["uni-datetime-picker-view",[i.hideSecond?"time-hide-second":""]]),"indicator-style":s.indicatorStyle,value:n.hms,onChange:a[3]||(a[3]=(...e)=>n.bindTimeChange&&n.bindTimeChange(...e))},[e.createElementVNode("picker-view-column",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.hours,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-datetime-picker-item",key:a},[e.createElementVNode("text",{class:"uni-datetime-picker-item"},e.toDisplayString(n.lessThanTen(t)),1)])))),128))]),e.createElementVNode("picker-view-column",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.minutes,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-datetime-picker-item",key:a},[e.createElementVNode("text",{class:"uni-datetime-picker-item"},e.toDisplayString(n.lessThanTen(t)),1)])))),128))]),i.hideSecond?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("picker-view-column",{key:0},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.seconds,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-datetime-picker-item",key:a},[e.createElementVNode("text",{class:"uni-datetime-picker-item"},e.toDisplayString(n.lessThanTen(t)),1)])))),128))]))],42,["indicator-style","value"]),e.createElementVNode("text",{class:e.normalizeClass(["uni-datetime-picker-sign",[i.hideSecond?"sign-center":"sign-left"]])},":",2),i.hideSecond?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("text",{key:0,class:"uni-datetime-picker-sign sign-right"},":"))])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"uni-datetime-picker-btn"},[e.createElementVNode("view",{onClick:a[4]||(a[4]=(...e)=>n.clearTime&&n.clearTime(...e))},[e.createElementVNode("text",{class:"uni-datetime-picker-btn-text"},e.toDisplayString(n.clearText),1)]),e.createElementVNode("view",{class:"uni-datetime-picker-btn-group"},[e.createElementVNode("view",{class:"uni-datetime-picker-cancel",onClick:a[5]||(a[5]=(...e)=>n.tiggerTimePicker&&n.tiggerTimePicker(...e))},[e.createElementVNode("text",{class:"uni-datetime-picker-btn-text"},e.toDisplayString(n.cancelText),1)]),e.createElementVNode("view",{onClick:a[6]||(a[6]=(...e)=>n.setTime&&n.setTime(...e))},[e.createElementVNode("text",{class:"uni-datetime-picker-btn-text"},e.toDisplayString(n.okText),1)])])])],6)):e.createCommentVNode("",!0)])}],["__scopeId","data-v-8a3925ff"]]),{t:At}=le(_t),Mt={components:{calendarItem:Tt,timePicker:Bt},options:{virtualHost:!0},props:{date:{type:String,default:""},defTime:{type:[String,Object],default:""},selectableTimes:{type:[Object],default:()=>({})},selected:{type:Array,default:()=>[]},startDate:{type:String,default:""},endDate:{type:String,default:""},startPlaceholder:{type:String,default:""},endPlaceholder:{type:String,default:""},range:{type:Boolean,default:!1},hasTime:{type:Boolean,default:!1},insert:{type:Boolean,default:!0},showMonth:{type:Boolean,default:!0},clearDate:{type:Boolean,default:!0},checkHover:{type:Boolean,default:!0},hideSecond:{type:[Boolean],default:!1},pleStatus:{type:Object,default:()=>({before:"",after:"",data:[],fulldate:""})},defaultValue:{type:[String,Object,Array],default:""}},data:()=>({show:!1,weeks:[],calendar:{},nowDate:{},aniMaskShow:!1,firstEnter:!0,time:"",timeRange:{startTime:"",endTime:""},tempSingleDate:"",tempRange:{before:"",after:""}}),watch:{date:{immediate:!0,handler(e){this.range||(this.tempSingleDate=e,setTimeout((()=>{this.init(e)}),100))}},defTime:{immediate:!0,handler(e){this.range?(this.timeRange.startTime=e.start,this.timeRange.endTime=e.end):this.time=e}},startDate(e){this.cale&&(this.cale.setStartDate(e),this.cale.setDate(this.nowDate.fullDate),this.weeks=this.cale.weeks)},endDate(e){this.cale&&(this.cale.setEndDate(e),this.cale.setDate(this.nowDate.fullDate),this.weeks=this.cale.weeks)},selected(e){this.cale&&(this.cale.setSelectInfo(this.nowDate.fullDate,e),this.weeks=this.cale.weeks)},pleStatus:{immediate:!0,handler(e){const{before:t,after:a,fulldate:i,which:o}=e;this.tempRange.before=t,this.tempRange.after=a,setTimeout((()=>{if(i)if(this.cale.setHoverMultiple(i),t&&a){if(this.cale.lastHover=!0,this.rangeWithinMonth(a,t))return;this.setDate(t)}else this.cale.setMultiple(i),this.setDate(this.nowDate.fullDate),this.calendar.fullDate="",this.cale.lastHover=!1;else{if(!this.cale)return;this.cale.setDefaultMultiple(t,a),"left"===o&&t?(this.setDate(t),this.weeks=this.cale.weeks):a&&(this.setDate(a),this.weeks=this.cale.weeks),this.cale.lastHover=!0}}),16)}}},computed:{timepickerStartTime(){return(this.range?this.tempRange.before:this.calendar.fullDate)===this.startDate?this.selectableTimes.start:""},timepickerEndTime(){return(this.range?this.tempRange.after:this.calendar.fullDate)===this.endDate?this.selectableTimes.end:""},selectDateText:()=>At("uni-datetime-picker.selectDate"),startDateText(){return this.startPlaceholder||At("uni-datetime-picker.startDate")},endDateText(){return this.endPlaceholder||At("uni-datetime-picker.endDate")},okText:()=>At("uni-datetime-picker.ok"),yearText:()=>At("uni-datetime-picker.year"),monthText:()=>At("uni-datetime-picker.month"),MONText:()=>At("uni-calender.MON"),TUEText:()=>At("uni-calender.TUE"),WEDText:()=>At("uni-calender.WED"),THUText:()=>At("uni-calender.THU"),FRIText:()=>At("uni-calender.FRI"),SATText:()=>At("uni-calender.SAT"),SUNText:()=>At("uni-calender.SUN"),confirmText:()=>At("uni-calender.confirm")},created(){this.cale=new wt({selected:this.selected,startDate:this.startDate,endDate:this.endDate,range:this.range}),this.init(this.date)},methods:{leaveCale(){this.firstEnter=!0},handleMouse(e){if(e.disable)return;if(this.cale.lastHover)return;let{before:t,after:a}=this.cale.multipleStatus;t&&(this.calendar=e,this.cale.setHoverMultiple(this.calendar.fullDate),this.weeks=this.cale.weeks,this.firstEnter&&(this.$emit("firstEnterCale",this.cale.multipleStatus),this.firstEnter=!1))},rangeWithinMonth(e,t){const[a,i]=e.split("-"),[o,s]=t.split("-");return a===o&&i===s},maskClick(){this.close(),this.$emit("maskClose")},clearCalender(){this.range?(this.timeRange.startTime="",this.timeRange.endTime="",this.tempRange.before="",this.tempRange.after="",this.cale.multipleStatus.before="",this.cale.multipleStatus.after="",this.cale.multipleStatus.data=[],this.cale.lastHover=!1):(this.time="",this.tempSingleDate=""),this.calendar.fullDate="",this.setDate(new Date)},bindDateChange(e){const t=e.detail.value+"-1";this.setDate(t)},init(e){if(this.cale&&(this.cale.setDate(e||new Date),this.weeks=this.cale.weeks,this.nowDate=this.cale.getInfo(e),this.calendar={...this.nowDate},!e&&(this.calendar.fullDate="",this.defaultValue&&!this.range))){const e=new Date(this.defaultValue),t=Et(e),a=e.getFullYear(),i=e.getMonth()+1,o=e.getDate(),s=e.getDay();this.calendar={fullDate:t,year:a,month:i,date:o,day:s},this.tempSingleDate=t,this.time=Nt(e,this.hideSecond)}},open(){this.clearDate&&!this.insert&&(this.cale.cleanMultipleStatus(),this.init(this.date)),this.show=!0,this.$nextTick((()=>{setTimeout((()=>{this.aniMaskShow=!0}),50)}))},close(){this.aniMaskShow=!1,this.$nextTick((()=>{setTimeout((()=>{this.show=!1,this.$emit("close")}),300)}))},confirm(){this.setEmit("confirm"),this.close()},change(e){(this.insert||e)&&this.setEmit("change")},monthSwitch(){let{year:e,month:t}=this.nowDate;this.$emit("monthSwitch",{year:e,month:Number(t)})},setEmit(e){this.range||(this.calendar.fullDate||(this.calendar=this.cale.getInfo(new Date),this.tempSingleDate=this.calendar.fullDate),this.hasTime&&!this.time&&(this.time=Nt(new Date,this.hideSecond)));let{year:t,month:a,date:i,fullDate:o,extraInfo:s}=this.calendar;this.$emit(e,{range:this.cale.multipleStatus,year:t,month:a,date:i,time:this.time,timeRange:this.timeRange,fulldate:o,extraInfo:s||{}})},choiceDate(e){if(e.disable)return;this.calendar=e,this.calendar.userChecked=!0,this.cale.setMultiple(this.calendar.fullDate,!0),this.weeks=this.cale.weeks,this.tempSingleDate=this.calendar.fullDate;const t=new Date(this.cale.multipleStatus.before).getTime(),a=new Date(this.cale.multipleStatus.after).getTime();t>a&&a?(this.tempRange.before=this.cale.multipleStatus.after,this.tempRange.after=this.cale.multipleStatus.before):(this.tempRange.before=this.cale.multipleStatus.before,this.tempRange.after=this.cale.multipleStatus.after),this.change(!0)},changeMonth(e){let t;"pre"===e?t=this.cale.getPreMonthObj(this.nowDate.fullDate).fullDate:"next"===e&&(t=this.cale.getNextMonthObj(this.nowDate.fullDate).fullDate),this.setDate(t),this.monthSwitch()},setDate(e){this.cale.setDate(e),this.weeks=this.cale.weeks,this.nowDate=this.cale.getInfo(e)}}};const Lt={name:"UniDatetimePicker",options:{virtualHost:!0},components:{Calendar:W(Mt,[["render",function(t,i,o,s,n,r){const l=e.resolveComponent("calendar-item"),c=e.resolveComponent("time-picker"),d=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"uni-calendar",onMouseleave:i[9]||(i[9]=(...e)=>r.leaveCale&&r.leaveCale(...e))},[!o.insert&&n.show?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["uni-calendar__mask",{"uni-calendar--mask-show":n.aniMaskShow}]),onClick:i[0]||(i[0]=(...e)=>r.maskClick&&r.maskClick(...e))},null,2)):e.createCommentVNode("",!0),o.insert||n.show?(e.openBlock(),e.createElementBlock("view",{key:1,class:e.normalizeClass(["uni-calendar__content",{"uni-calendar--fixed":!o.insert,"uni-calendar--ani-show":n.aniMaskShow,"uni-calendar__content-mobile":n.aniMaskShow}])},[e.createElementVNode("view",{class:e.normalizeClass(["uni-calendar__header",{"uni-calendar__header-mobile":!o.insert}])},[e.createElementVNode("view",{class:"uni-calendar__header-btn-box",onClick:i[1]||(i[1]=e.withModifiers((e=>r.changeMonth("pre")),["stop"]))},[e.createElementVNode("view",{class:"uni-calendar__header-btn uni-calendar--left"})]),e.createElementVNode("picker",{mode:"date",value:o.date,fields:"month",onChange:i[2]||(i[2]=(...e)=>r.bindDateChange&&r.bindDateChange(...e))},[e.createElementVNode("text",{class:"uni-calendar__header-text"},e.toDisplayString((n.nowDate.year||"")+r.yearText+(n.nowDate.month||"")+r.monthText),1)],40,["value"]),e.createElementVNode("view",{class:"uni-calendar__header-btn-box",onClick:i[3]||(i[3]=e.withModifiers((e=>r.changeMonth("next")),["stop"]))},[e.createElementVNode("view",{class:"uni-calendar__header-btn uni-calendar--right"})]),o.insert?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"dialog-close",onClick:i[4]||(i[4]=(...e)=>r.maskClick&&r.maskClick(...e))},[e.createElementVNode("view",{class:"dialog-close-plus","data-id":"close"}),e.createElementVNode("view",{class:"dialog-close-plus dialog-close-rotate","data-id":"close"})]))],2),e.createElementVNode("view",{class:"uni-calendar__box"},[o.showMonth?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-calendar__box-bg"},[e.createElementVNode("text",{class:"uni-calendar__box-bg-text"},e.toDisplayString(n.nowDate.month),1)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"uni-calendar__weeks",style:{"padding-bottom":"7px"}},[e.createElementVNode("view",{class:"uni-calendar__weeks-day"},[e.createElementVNode("text",{class:"uni-calendar__weeks-day-text"},e.toDisplayString(r.SUNText),1)]),e.createElementVNode("view",{class:"uni-calendar__weeks-day"},[e.createElementVNode("text",{class:"uni-calendar__weeks-day-text"},e.toDisplayString(r.MONText),1)]),e.createElementVNode("view",{class:"uni-calendar__weeks-day"},[e.createElementVNode("text",{class:"uni-calendar__weeks-day-text"},e.toDisplayString(r.TUEText),1)]),e.createElementVNode("view",{class:"uni-calendar__weeks-day"},[e.createElementVNode("text",{class:"uni-calendar__weeks-day-text"},e.toDisplayString(r.WEDText),1)]),e.createElementVNode("view",{class:"uni-calendar__weeks-day"},[e.createElementVNode("text",{class:"uni-calendar__weeks-day-text"},e.toDisplayString(r.THUText),1)]),e.createElementVNode("view",{class:"uni-calendar__weeks-day"},[e.createElementVNode("text",{class:"uni-calendar__weeks-day-text"},e.toDisplayString(r.FRIText),1)]),e.createElementVNode("view",{class:"uni-calendar__weeks-day"},[e.createElementVNode("text",{class:"uni-calendar__weeks-day-text"},e.toDisplayString(r.SATText),1)])]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.weeks,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-calendar__weeks",key:a},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-calendar__weeks-item",key:a},[e.createVNode(l,{class:"uni-calendar-item--hook",weeks:t,calendar:n.calendar,selected:o.selected,checkHover:o.range,onChange:r.choiceDate,onHandleMouse:r.handleMouse},null,8,["weeks","calendar","selected","checkHover","onChange","onHandleMouse"])])))),128))])))),128))]),o.insert||o.range||!o.hasTime?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-date-changed uni-calendar--fixed-top",style:{padding:"0 80px"}},[e.createElementVNode("view",{class:"uni-date-changed--time-date"},e.toDisplayString(n.tempSingleDate?n.tempSingleDate:r.selectDateText),1),e.createVNode(c,{type:"time",start:r.timepickerStartTime,end:r.timepickerEndTime,modelValue:n.time,"onUpdate:modelValue":i[5]||(i[5]=e=>n.time=e),disabled:!n.tempSingleDate,border:!1,"hide-second":o.hideSecond,class:"time-picker-style"},null,8,["start","end","modelValue","disabled","hide-second"])])),!o.insert&&o.range&&o.hasTime?(e.openBlock(),e.createElementBlock("view",{key:1,class:"uni-date-changed uni-calendar--fixed-top"},[e.createElementVNode("view",{class:"uni-date-changed--time-start"},[e.createElementVNode("view",{class:"uni-date-changed--time-date"},e.toDisplayString(n.tempRange.before?n.tempRange.before:r.startDateText),1),e.createVNode(c,{type:"time",start:r.timepickerStartTime,modelValue:n.timeRange.startTime,"onUpdate:modelValue":i[6]||(i[6]=e=>n.timeRange.startTime=e),border:!1,"hide-second":o.hideSecond,disabled:!n.tempRange.before,class:"time-picker-style"},null,8,["start","modelValue","hide-second","disabled"])]),e.createElementVNode("view",{style:{"line-height":"50px"}},[e.createVNode(d,{type:"arrowthinright",color:"#999"})]),e.createElementVNode("view",{class:"uni-date-changed--time-end"},[e.createElementVNode("view",{class:"uni-date-changed--time-date"},e.toDisplayString(n.tempRange.after?n.tempRange.after:r.endDateText),1),e.createVNode(c,{type:"time",end:r.timepickerEndTime,modelValue:n.timeRange.endTime,"onUpdate:modelValue":i[7]||(i[7]=e=>n.timeRange.endTime=e),border:!1,"hide-second":o.hideSecond,disabled:!n.tempRange.after,class:"time-picker-style"},null,8,["end","modelValue","hide-second","disabled"])])])):e.createCommentVNode("",!0),o.insert?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:2,class:"uni-date-changed uni-date-btn--ok"},[e.createElementVNode("view",{class:"uni-datetime-picker--btn",onClick:i[8]||(i[8]=(...e)=>r.confirm&&r.confirm(...e))},e.toDisplayString(r.confirmText),1)]))],2)):e.createCommentVNode("",!0)],32)}],["__scopeId","data-v-24c3b263"]]),TimePicker:Bt},data:()=>({isRange:!1,hasTime:!1,displayValue:"",inputDate:"",calendarDate:"",pickerTime:"",calendarRange:{startDate:"",startTime:"",endDate:"",endTime:""},displayRangeValue:{startDate:"",endDate:""},tempRange:{startDate:"",startTime:"",endDate:"",endTime:""},startMultipleStatus:{before:"",after:"",data:[],fulldate:""},endMultipleStatus:{before:"",after:"",data:[],fulldate:""},pickerVisible:!1,pickerPositionStyle:null,isEmitValue:!1,isPhone:!1,isFirstShow:!0,i18nT:()=>{}}),props:{type:{type:String,default:"datetime"},value:{type:[String,Number,Array,Date],default:""},modelValue:{type:[String,Number,Array,Date],default:""},start:{type:[Number,String],default:""},end:{type:[Number,String],default:""},returnType:{type:String,default:"string"},placeholder:{type:String,default:""},startPlaceholder:{type:String,default:""},endPlaceholder:{type:String,default:""},rangeSeparator:{type:String,default:"-"},border:{type:[Boolean],default:!0},disabled:{type:[Boolean],default:!1},clearIcon:{type:[Boolean],default:!0},hideSecond:{type:[Boolean],default:!1},defaultValue:{type:[String,Object,Array],default:""}},watch:{type:{immediate:!0,handler(e){this.hasTime=-1!==e.indexOf("time"),this.isRange=-1!==e.indexOf("range")}},modelValue:{immediate:!0,handler(e){this.isEmitValue?this.isEmitValue=!1:this.initPicker(e)}},start:{immediate:!0,handler(e){e&&(this.calendarRange.startDate=Et(e),this.hasTime&&(this.calendarRange.startTime=Nt(e)))}},end:{immediate:!0,handler(e){e&&(this.calendarRange.endDate=Et(e),this.hasTime&&(this.calendarRange.endTime=Nt(e,this.hideSecond)))}}},computed:{timepickerStartTime(){return(this.isRange?this.tempRange.startDate:this.inputDate)===this.calendarRange.startDate?this.calendarRange.startTime:""},timepickerEndTime(){return(this.isRange?this.tempRange.endDate:this.inputDate)===this.calendarRange.endDate?this.calendarRange.endTime:""},mobileCalendarTime(){const e={start:this.tempRange.startTime,end:this.tempRange.endTime};return this.isRange?e:this.pickerTime},mobSelectableTime(){return{start:this.calendarRange.startTime,end:this.calendarRange.endTime}},datePopupWidth(){return this.isRange?653:301},singlePlaceholderText(){return this.placeholder||("date"===this.type?this.selectDateText:this.selectDateTimeText)},startPlaceholderText(){return this.startPlaceholder||this.startDateText},endPlaceholderText(){return this.endPlaceholder||this.endDateText},selectDateText(){return this.i18nT("uni-datetime-picker.selectDate")},selectDateTimeText(){return this.i18nT("uni-datetime-picker.selectDateTime")},selectTimeText(){return this.i18nT("uni-datetime-picker.selectTime")},startDateText(){return this.startPlaceholder||this.i18nT("uni-datetime-picker.startDate")},startTimeText(){return this.i18nT("uni-datetime-picker.startTime")},endDateText(){return this.endPlaceholder||this.i18nT("uni-datetime-picker.endDate")},endTimeText(){return this.i18nT("uni-datetime-picker.endTime")},okText(){return this.i18nT("uni-datetime-picker.ok")},clearText(){return this.i18nT("uni-datetime-picker.clear")},showClearIcon(){return this.clearIcon&&!this.disabled&&(this.displayValue||this.displayRangeValue.startDate&&this.displayRangeValue.endDate)}},created(){this.initI18nT(),this.platform()},methods:{initI18nT(){const e=le(_t);this.i18nT=e.t},initPicker(e){if(!e&&!this.defaultValue||Array.isArray(e)&&!e.length)this.$nextTick((()=>{this.clear(!1)}));else if(Array.isArray(e)||this.isRange){const[t,a]=e;if(!t&&!a)return;const i=Et(t),o=Nt(t,this.hideSecond),s=Et(a),n=Nt(a,this.hideSecond),r=i,l=s;this.displayRangeValue.startDate=this.tempRange.startDate=r,this.displayRangeValue.endDate=this.tempRange.endDate=l,this.hasTime&&(this.displayRangeValue.startDate=`${i} ${o}`,this.displayRangeValue.endDate=`${s} ${n}`,this.tempRange.startTime=o,this.tempRange.endTime=n);const c={before:i,after:s};this.startMultipleStatus=Object.assign({},this.startMultipleStatus,c,{which:"right"}),this.endMultipleStatus=Object.assign({},this.endMultipleStatus,c,{which:"left"})}else e?(this.displayValue=this.inputDate=this.calendarDate=Et(e),this.hasTime&&(this.pickerTime=Nt(e,this.hideSecond),this.displayValue=`${this.displayValue} ${this.pickerTime}`)):this.defaultValue&&(this.inputDate=this.calendarDate=Et(this.defaultValue),this.hasTime&&(this.pickerTime=Nt(this.defaultValue,this.hideSecond)))},updateLeftCale(e){const t=this.$refs.left;t.cale.setHoverMultiple(e.after),t.setDate(this.$refs.left.nowDate.fullDate)},updateRightCale(e){const t=this.$refs.right;t.cale.setHoverMultiple(e.after),t.setDate(this.$refs.right.nowDate.fullDate)},platform(){if("undefined"!=typeof navigator)return void(this.isPhone=-1!==navigator.userAgent.toLowerCase().indexOf("mobile"));const{windowWidth:e}=uni.getSystemInfoSync();this.isPhone=e<=500,this.windowWidth=e},show(){if(this.$emit("show"),this.disabled)return;if(this.platform(),this.isPhone)return void setTimeout((()=>{this.$refs.mobile.open()}),0);this.pickerPositionStyle={top:"10px"};uni.createSelectorQuery().in(this).select(".uni-date-editor").boundingClientRect((e=>{this.windowWidth-e.left<this.datePopupWidth&&(this.pickerPositionStyle.right=0)})).exec(),setTimeout((()=>{if(this.pickerVisible=!this.pickerVisible,!this.isPhone&&this.isRange&&this.isFirstShow){this.isFirstShow=!1;const{startDate:e,endDate:t}=this.calendarRange;e&&t?this.diffDate(e,t)<30&&this.$refs.right.changeMonth("pre"):this.isPhone&&(this.$refs.right.cale.lastHover=!1)}}),50)},close(){setTimeout((()=>{this.pickerVisible=!1,this.$emit("maskClick",this.value),this.$refs.mobile&&this.$refs.mobile.close()}),20)},setEmit(e){"timestamp"!==this.returnType&&"date"!==this.returnType||(Array.isArray(e)?(this.hasTime||(e[0]=e[0]+" 00:00:00",e[1]=e[1]+" 00:00:00"),e[0]=this.createTimestamp(e[0]),e[1]=this.createTimestamp(e[1]),"date"===this.returnType&&(e[0]=new Date(e[0]),e[1]=new Date(e[1]))):(this.hasTime||(e+=" 00:00:00"),e=this.createTimestamp(e),"date"===this.returnType&&(e=new Date(e)))),this.$emit("update:modelValue",e),this.$emit("input",e),this.$emit("change",e),this.isEmitValue=!0},createTimestamp:e=>(e=Dt(e),Date.parse(new Date(e))),singleChange(e){this.calendarDate=this.inputDate=e.fulldate,this.hasTime||this.confirmSingleChange()},confirmSingleChange(){if(!xt(this.inputDate)){const e=new Date;this.calendarDate=this.inputDate=Et(e),this.pickerTime=Nt(e,this.hideSecond)}let e,t,a=!1;if(this.start){let i=this.start;"number"==typeof this.start&&(i=kt(this.start,this.hideSecond)),[e,t]=i.split(" "),this.start&&!St(e,this.inputDate)&&(a=!0,this.inputDate=e)}let i,o,s=!1;if(this.end){let e=this.end;"number"==typeof this.end&&(e=kt(this.end,this.hideSecond)),[i,o]=e.split(" "),this.end&&!St(this.inputDate,i)&&(s=!0,this.inputDate=i)}this.hasTime?(a&&(this.pickerTime=t||Vt(this.hideSecond)),s&&(this.pickerTime=o||Vt(this.hideSecond)),this.pickerTime||(this.pickerTime=Nt(Date.now(),this.hideSecond)),this.displayValue=`${this.inputDate} ${this.pickerTime}`):this.displayValue=this.inputDate,this.setEmit(this.displayValue),this.pickerVisible=!1},leftChange(e){const{before:t,after:a}=e.range;this.rangeChange(t,a);const i={before:e.range.before,after:e.range.after,data:e.range.data,fulldate:e.fulldate};this.startMultipleStatus=Object.assign({},this.startMultipleStatus,i),this.$emit("calendarClick",e)},rightChange(e){const{before:t,after:a}=e.range;this.rangeChange(t,a);const i={before:e.range.before,after:e.range.after,data:e.range.data,fulldate:e.fulldate};this.endMultipleStatus=Object.assign({},this.endMultipleStatus,i),this.$emit("calendarClick",e)},mobileChange(e){if(this.isRange){const{before:t,after:a}=e.range;if(!t)return;if(this.handleStartAndEnd(t,a,!0),this.hasTime){const{startTime:t,endTime:a}=e.timeRange;this.tempRange.startTime=t,this.tempRange.endTime=a}this.confirmRangeChange()}else this.hasTime?this.displayValue=e.fulldate+" "+e.time:this.displayValue=e.fulldate,this.setEmit(this.displayValue);this.$refs.mobile.close()},rangeChange(e,t){e&&t&&(this.handleStartAndEnd(e,t,!0),this.hasTime||this.confirmRangeChange())},confirmRangeChange(){if(!this.tempRange.startDate||!this.tempRange.endDate)return void(this.pickerVisible=!1);let e,t;xt(this.tempRange.startDate)||(this.tempRange.startDate=Et(Date.now())),xt(this.tempRange.endDate)||(this.tempRange.endDate=Et(Date.now()));let a,i,o=!1,s=!1;if(this.start){let e=this.start;"number"==typeof this.start&&(e=kt(this.start,this.hideSecond)),[a,i]=e.split(" "),this.start&&!St(this.start,this.tempRange.startDate)&&(o=!0,this.tempRange.startDate=a),this.start&&!St(this.start,this.tempRange.endDate)&&(s=!0,this.tempRange.endDate=a)}let n,r,l=!1,c=!1;if(this.end){let e=this.end;"number"==typeof this.end&&(e=kt(this.end,this.hideSecond)),[n,r]=e.split(" "),this.end&&!St(this.tempRange.startDate,this.end)&&(l=!0,this.tempRange.startDate=n),this.end&&!St(this.tempRange.endDate,this.end)&&(c=!0,this.tempRange.endDate=n)}this.hasTime?(o?this.tempRange.startTime=i||Vt(this.hideSecond):l&&(this.tempRange.startTime=r||Vt(this.hideSecond)),this.tempRange.startTime||(this.tempRange.startTime=Nt(Date.now(),this.hideSecond)),s?this.tempRange.endTime=i||Vt(this.hideSecond):c&&(this.tempRange.endTime=r||Vt(this.hideSecond)),this.tempRange.endTime||(this.tempRange.endTime=Nt(Date.now(),this.hideSecond)),e=this.displayRangeValue.startDate=`${this.tempRange.startDate} ${this.tempRange.startTime}`,t=this.displayRangeValue.endDate=`${this.tempRange.endDate} ${this.tempRange.endTime}`):(e=this.displayRangeValue.startDate=this.tempRange.startDate,t=this.displayRangeValue.endDate=this.tempRange.endDate),St(e,t)||([e,t]=[t,e]),this.displayRangeValue.startDate=e,this.displayRangeValue.endDate=t;const d=[e,t];this.setEmit(d),this.pickerVisible=!1},handleStartAndEnd(e,t,a=!1){if(!e)return;t||(t=e);const i=a?"tempRange":"range",o=St(e,t);this[i].startDate=o?e:t,this[i].endDate=o?t:e},dateCompare:(e,t)=>(e=new Date(e.replace("-","/").replace("-","/")))<=(t=new Date(t.replace("-","/").replace("-","/"))),diffDate(e,t){e=new Date(e.replace("-","/").replace("-","/"));const a=((t=new Date(t.replace("-","/").replace("-","/")))-e)/864e5;return Math.abs(a)},clear(e=!0){this.isRange?(this.displayRangeValue.startDate="",this.displayRangeValue.endDate="",this.tempRange.startDate="",this.tempRange.startTime="",this.tempRange.endDate="",this.tempRange.endTime="",this.isPhone?this.$refs.mobile&&this.$refs.mobile.clearCalender():(this.$refs.left&&this.$refs.left.clearCalender(),this.$refs.right&&this.$refs.right.clearCalender(),this.$refs.right&&this.$refs.right.changeMonth("next")),e&&(this.$emit("change",[]),this.$emit("input",[]),this.$emit("update:modelValue",[]))):(this.displayValue="",this.inputDate="",this.pickerTime="",this.isPhone?this.$refs.mobile&&this.$refs.mobile.clearCalender():this.$refs.pcSingle&&this.$refs.pcSingle.clearCalender(),e&&(this.$emit("change",""),this.$emit("input",""),this.$emit("update:modelValue","")))},calendarClick(e){this.$emit("calendarClick",e)}}};const Ot=W(Lt,[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K),c=e.resolveComponent("time-picker"),d=e.resolveComponent("Calendar");return e.openBlock(),e.createElementBlock("view",{class:"uni-date"},[e.createElementVNode("view",{class:"uni-date-editor",onClick:i[1]||(i[1]=(...e)=>r.show&&r.show(...e))},[e.renderSlot(t.$slots,"default",{},(()=>[e.createElementVNode("view",{class:e.normalizeClass(["uni-date-editor--x",{"uni-date-editor--x__disabled":o.disabled,"uni-date-x--border":o.border}])},[n.isRange?(e.openBlock(),e.createElementBlock("view",{key:1,class:"uni-date-x uni-date-range"},[e.createVNode(l,{class:"icon-calendar",type:"calendar",color:"#c0c4cc",size:"22"}),e.createElementVNode("view",{class:"uni-date__x-input text-center"},e.toDisplayString(n.displayRangeValue.startDate||r.startPlaceholderText),1),e.createElementVNode("view",{class:"range-separator"},e.toDisplayString(o.rangeSeparator),1),e.createElementVNode("view",{class:"uni-date__x-input text-center"},e.toDisplayString(n.displayRangeValue.endDate||r.endPlaceholderText),1)])):(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-date-x uni-date-single"},[e.createVNode(l,{class:"icon-calendar",type:"calendar",color:"#c0c4cc",size:"22"}),e.createElementVNode("view",{class:"uni-date__x-input"},e.toDisplayString(n.displayValue||r.singlePlaceholderText),1)])),r.showClearIcon?(e.openBlock(),e.createElementBlock("view",{key:2,class:"uni-date__icon-clear",onClick:i[0]||(i[0]=e.withModifiers(((...e)=>r.clear&&r.clear(...e)),["stop"]))},[e.createVNode(l,{type:"clear",color:"#c0c4cc",size:"22"})])):e.createCommentVNode("",!0)],2)]),!0)]),e.withDirectives(e.createElementVNode("view",{class:"uni-date-mask--pc",onClick:i[2]||(i[2]=(...e)=>r.close&&r.close(...e))},null,512),[[e.vShow,n.pickerVisible]]),n.isPhone?e.createCommentVNode("",!0):e.withDirectives((e.openBlock(),e.createElementBlock("view",{key:0,ref:"datePicker",class:"uni-date-picker__container"},[n.isRange?(e.openBlock(),e.createElementBlock("view",{key:1,class:"uni-date-range--x",style:e.normalizeStyle(n.pickerPositionStyle)},[e.createElementVNode("view",{class:"uni-popper__arrow"}),n.hasTime?(e.openBlock(),e.createElementBlock("view",{key:0,class:"popup-x-header uni-date-changed"},[e.createElementVNode("view",{class:"popup-x-header--datetime"},[e.withDirectives(e.createElementVNode("input",{class:"uni-date__input uni-date-range__input",type:"text","onUpdate:modelValue":i[7]||(i[7]=e=>n.tempRange.startDate=e),placeholder:r.startDateText},null,8,["placeholder"]),[[e.vModelText,n.tempRange.startDate]]),e.createVNode(c,{type:"time",modelValue:n.tempRange.startTime,"onUpdate:modelValue":i[9]||(i[9]=e=>n.tempRange.startTime=e),start:r.timepickerStartTime,border:!1,disabled:!n.tempRange.startDate,hideSecond:o.hideSecond},{default:e.withCtx((()=>[e.withDirectives(e.createElementVNode("input",{class:"uni-date__input uni-date-range__input",type:"text","onUpdate:modelValue":i[8]||(i[8]=e=>n.tempRange.startTime=e),placeholder:r.startTimeText,disabled:!n.tempRange.startDate},null,8,["placeholder","disabled"]),[[e.vModelText,n.tempRange.startTime]])])),_:1},8,["modelValue","start","disabled","hideSecond"])]),e.createVNode(l,{type:"arrowthinright",color:"#999",style:{"line-height":"40px"}}),e.createElementVNode("view",{class:"popup-x-header--datetime"},[e.withDirectives(e.createElementVNode("input",{class:"uni-date__input uni-date-range__input",type:"text","onUpdate:modelValue":i[10]||(i[10]=e=>n.tempRange.endDate=e),placeholder:r.endDateText},null,8,["placeholder"]),[[e.vModelText,n.tempRange.endDate]]),e.createVNode(c,{type:"time",modelValue:n.tempRange.endTime,"onUpdate:modelValue":i[12]||(i[12]=e=>n.tempRange.endTime=e),end:r.timepickerEndTime,border:!1,disabled:!n.tempRange.endDate,hideSecond:o.hideSecond},{default:e.withCtx((()=>[e.withDirectives(e.createElementVNode("input",{class:"uni-date__input uni-date-range__input",type:"text","onUpdate:modelValue":i[11]||(i[11]=e=>n.tempRange.endTime=e),placeholder:r.endTimeText,disabled:!n.tempRange.endDate},null,8,["placeholder","disabled"]),[[e.vModelText,n.tempRange.endTime]])])),_:1},8,["modelValue","end","disabled","hideSecond"])])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"popup-x-body"},[e.createVNode(d,{ref:"left",showMonth:!1,"start-date":n.calendarRange.startDate,"end-date":n.calendarRange.endDate,range:!0,pleStatus:n.endMultipleStatus,onChange:r.leftChange,onFirstEnterCale:r.updateRightCale,style:{padding:"0 8px"}},null,8,["start-date","end-date","pleStatus","onChange","onFirstEnterCale"]),e.createVNode(d,{ref:"right",showMonth:!1,"start-date":n.calendarRange.startDate,"end-date":n.calendarRange.endDate,range:!0,onChange:r.rightChange,pleStatus:n.startMultipleStatus,onFirstEnterCale:r.updateLeftCale,style:{padding:"0 8px","border-left":"1px solid #F1F1F1"}},null,8,["start-date","end-date","onChange","pleStatus","onFirstEnterCale"])]),n.hasTime?(e.openBlock(),e.createElementBlock("view",{key:1,class:"popup-x-footer"},[e.createElementVNode("text",{onClick:i[13]||(i[13]=(...e)=>r.clear&&r.clear(...e))},e.toDisplayString(r.clearText),1),e.createElementVNode("text",{class:"confirm-text",onClick:i[14]||(i[14]=(...e)=>r.confirmRangeChange&&r.confirmRangeChange(...e))},e.toDisplayString(r.okText),1)])):e.createCommentVNode("",!0)],4)):(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-date-single--x",style:e.normalizeStyle(n.pickerPositionStyle)},[e.createElementVNode("view",{class:"uni-popper__arrow"}),n.hasTime?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-date-changed popup-x-header"},[e.withDirectives(e.createElementVNode("input",{class:"uni-date__input text-center",type:"text","onUpdate:modelValue":i[3]||(i[3]=e=>n.inputDate=e),placeholder:r.selectDateText},null,8,["placeholder"]),[[e.vModelText,n.inputDate]]),e.createVNode(c,{type:"time",modelValue:n.pickerTime,"onUpdate:modelValue":i[5]||(i[5]=e=>n.pickerTime=e),border:!1,disabled:!n.inputDate,start:r.timepickerStartTime,end:r.timepickerEndTime,hideSecond:o.hideSecond,style:{width:"100%"}},{default:e.withCtx((()=>[e.withDirectives(e.createElementVNode("input",{class:"uni-date__input text-center",type:"text","onUpdate:modelValue":i[4]||(i[4]=e=>n.pickerTime=e),placeholder:r.selectTimeText,disabled:!n.inputDate},null,8,["placeholder","disabled"]),[[e.vModelText,n.pickerTime]])])),_:1},8,["modelValue","disabled","start","end","hideSecond"])])):e.createCommentVNode("",!0),e.createVNode(d,{ref:"pcSingle",showMonth:!1,"start-date":n.calendarRange.startDate,"end-date":n.calendarRange.endDate,date:n.calendarDate,onChange:r.singleChange,"default-value":o.defaultValue,style:{padding:"0 8px"}},null,8,["start-date","end-date","date","onChange","default-value"]),n.hasTime?(e.openBlock(),e.createElementBlock("view",{key:1,class:"popup-x-footer"},[e.createElementVNode("text",{class:"confirm-text",onClick:i[6]||(i[6]=(...e)=>r.confirmSingleChange&&r.confirmSingleChange(...e))},e.toDisplayString(r.okText),1)])):e.createCommentVNode("",!0)],4))],512)),[[e.vShow,n.pickerVisible]]),n.isPhone?(e.openBlock(),e.createBlock(d,{key:1,ref:"mobile",clearDate:!1,date:n.calendarDate,defTime:r.mobileCalendarTime,"start-date":n.calendarRange.startDate,"end-date":n.calendarRange.endDate,selectableTimes:r.mobSelectableTime,startPlaceholder:o.startPlaceholder,endPlaceholder:o.endPlaceholder,"default-value":o.defaultValue,pleStatus:n.endMultipleStatus,showMonth:!1,range:n.isRange,hasTime:n.hasTime,insert:!1,hideSecond:o.hideSecond,onConfirm:r.mobileChange,onMaskClose:r.close,onChange:r.calendarClick},null,8,["date","defTime","start-date","end-date","selectableTimes","startPlaceholder","endPlaceholder","default-value","pleStatus","range","hasTime","hideSecond","onConfirm","onMaskClose","onChange"])):e.createCommentVNode("",!0)])}],["__scopeId","data-v-c6a4853b"]]),Ft={data:()=>({totalCount:0,cartList:[],pageData:[],shopDetails:{},cartItems:[],couponName:"选择优惠卷",couponPrice:"0.00",cartItemCount:0,totalPrice:"0.00",paymentMethod:"请选择",score:"",inputScore:"",isEditingScore:!1,shop_id:"",single:0,payway:0,cartStore:null}),computed:{usableScoreAmount(){return parseFloat(this.inputScore/10)||0},finalAmount(){var e;const t=(null==(e=this.cartStore)?void 0:e.cartTotalByShopId(Number(this.shop_id)))||0,a=parseFloat(this.couponPrice)||0,i=this.usableScoreAmount;return Math.max(t-a-i,0)},displayPaymentMethod(){if(this.isEditingScore)return`使用积分 ${this.inputScore||0}`;const e=this.paymentMethod;return e.startsWith("积分支付")&&this.score?e.includes("积分余额")?e:`${e} (积分余额: ${this.score})`:e}},created(){this.cartStore=ct()},onLoad(e){this.shop_id=Number(e.id)||0,this.totalCount=this.cartStore.cartTotalByShopId(this.shop_id),this.cartList=this.cartStore.getCartsByShopId(this.shop_id)},methods:{subItem(e){if(!e)return;const t=this.cartStore.getTempCount(e.id)||1;t<=1||this.cartStore.changeGoodsNum(e.id,t-1)},addItem(e){if(!e)return;const t=this.cartStore.getTempCount(e.id)||0;this.cartStore.changeGoodsNum(e.id,t+1)},selectMethod(){const e=["线上支付","到付"];uni.showActionSheet({itemList:e,success:t=>{this.paymentMethod=e[t.tapIndex]},fail:e=>{t("log","at pages/Buy/Buy.vue:148","选择支付方式失败:",e)}})},clearCart(){this.cartStore.clearCart()},loadCouponData(e){const a=uni.getStorageSync("coupon");if(!a)return this.couponPrice="0.00",void(this.couponName="选择优惠卷");let i=a;if("string"==typeof i)try{i=JSON.parse(i)}catch(o){return void t("error","at pages/Buy/Buy.vue:171","解析优惠券失败:",o)}if("object"===(null==i?void 0:i.type)&&Array.isArray(i.data)&&(i=i.data),Array.isArray(i)){const t=i.find((t=>t.id===parseInt(e)));t&&(this.couponName=t.coupon_name,this.couponPrice=t.price.toFixed(2))}},async fetchUserProfile(){try{const e=await l.getUserProfile();200===e.code&&(this.score=e.data.score||0)}catch(e){t("error","at pages/Buy/Buy.vue:197","获取用户积分失败:",e),uni.showToast({title:"获取积分失败",icon:"none"})}},handleTimeConfirm(e){this.single=e.value},async addorder(){const e=this.cartStore.getCartsByShopId(Number(this.shop_id)).map((e=>({goods_id:e.id,goodsname:e.commodity_name,price:e.price,goodsnum:e.tempCount||0})));if(e.length)if(this.single&&0!==this.single)try{const t=Number(this.shop_id),a=Number(this.cartStore.cartTotalByShopId(t)),i=this.cartStore.cartsLengthByShopId(t),o={pay_time:this.single,shop_id:t,goods_num:i,price:a,payprice:this.finalAmount,payway:this.payway,goods_arr:e},s=await l.addorder(o);200===s.code?uni.showToast({title:"订单提交成功",icon:"success",duration:1500,complete:()=>{setTimeout((()=>{this.clearCart(),uni.redirectTo({url:`/subPackages/PaymentModule/collectOnDelivery/collectOnDelivery?out_trade_no=${s.data.out_trade_no}`})}),1500)}}):201===s.code?uni.showToast({title:s.msg||"积分余额不足",icon:"none"}):uni.showToast({title:"订单提交失败: "+(s.msg||"未知错误"),icon:"none"})}catch(a){t("error","at pages/Buy/Buy.vue:282","创建订单失败:",a),uni.showToast({title:"订单创建失败",icon:"none"})}else uni.showToast({title:"请选择取货时间",icon:"error"});else uni.showToast({title:"您还未选购商品,无法提交订单!!!!",icon:"error",duration:5e3})},updatePaymentMethodOnBlur(){this.inputScore?(this.paymentMethod=`使用积分: ${this.inputScore}`,Vue.set(this,"payway",1)):(this.paymentMethod="积分支付",Vue.set(this,"payway",1)),this.isEditingScore=!1},handlePaymentMethodClick(){this.showActionSheet()},showActionSheet(){const e=["积分支付"];uni.showActionSheet({itemList:e,success:async t=>{const a=e[t.tapIndex];this.paymentMethod=a,"积分支付"===a&&(await this.fetchUserProfile(),Vue.set(this,"payway",1),this.paymentMethod=`${a} (积分余额: ${this.score})`)},fail:e=>{t("log","at pages/Buy/Buy.vue:321","选择支付方式失败:",e)}})},gotousecou(){uni.redirectTo({url:"/pages/usecoupons/usecoupons"})}}};const Rt=W(Ft,[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K),c=a(e.resolveDynamicComponent("uni-datetime-picker"),Ot);return e.openBlock(),e.createElementBlock("view",{class:"me-container"},[e.createElementVNode("scroll-view",{class:"Stallholder","scroll-y":"true",style:{height:"100vh"}},[e.createElementVNode("view",{class:"product-details"},[e.createElementVNode("view",{class:"commodity"},[e.createElementVNode("view",{class:"content"},[n.cartList.length?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-tip"},"暂无选购商品")),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.cartList,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"item",key:a},[e.createElementVNode("view",{class:"biaoti"},[e.createElementVNode("view",null,e.toDisplayString(t.shopTitle),1)]),e.createElementVNode("view",{class:"neirong"},[e.createElementVNode("view",{class:"left"},[e.createElementVNode("image",{class:"shopimg",src:t.imglogo,mode:"aspectFill"},null,8,["src"])]),e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"shoptitle"},e.toDisplayString(t.commodity_name),1),e.createElementVNode("view",{class:"shopprice"},"¥ "+e.toDisplayString(t.price),1)]),e.createElementVNode("view",{class:"right"},[e.createElementVNode("view",{class:"btn1",onClick:e=>r.subItem(t)},"-",8,["onClick"]),e.createElementVNode("view",{class:"count"},e.toDisplayString(t.tempCount),1),e.createElementVNode("view",{class:"btn2",onClick:e=>r.addItem(t)},"+",8,["onClick"])])])])))),128))])]),e.createElementVNode("view",{class:"Payment"},[e.createElementVNode("text",null,"取菜方式"),e.createElementVNode("view",{style:{color:"#ccc"}},[e.createTextVNode("摊位自取"),e.createVNode(l,{type:"right",size:"14",color:"#ccc"})])]),e.createElementVNode("view",{class:"Payment"},[e.createTextVNode(" 取货时间 "),e.createVNode(c,{type:"datetime","clear-icon":!1,modelValue:n.single,"onUpdate:modelValue":i[0]||(i[0]=e=>n.single=e),"return-type":"timestamp",onConfirm:r.handleTimeConfirm},null,8,["modelValue","onConfirm"])])]),e.createElementVNode("view",{class:"total"},[e.createElementVNode("view",{class:"numberpieces"},[e.createElementVNode("view",null,"合计 ¥ "+e.toDisplayString(r.finalAmount),1),e.createElementVNode("view",null,"共 "+e.toDisplayString(n.cartList.length)+" 件",1)]),e.createElementVNode("view",{class:"submit-order",onClick:i[1]||(i[1]=(...e)=>r.addorder&&r.addorder(...e))},"提交订单")])])])}],["__scopeId","data-v-4d507e84"]]),zt={data:()=>({pageData:[],showEditPopup:!1,currentItem:{},categories:[],pickerRange:[],selectedCategoryIndex:0,imageUploaded:!1,showEditPopup1:!1,showEditPopup2:!1,pickerRange1:[],selectedCategoryIndex1:0,itemDescription:"",itemPrice:"",marketList:[],candidates:["斤","瓶","桶","个"],candidate2:["元"],unit:"",unit2:"",tijiaoPrice:"",isloaded:!1,iconStatus:!0,isShowItems:!1,tempItem:null}),mixins:[ge],onLoad(){this.isloaded=!0},onShow(){this.reloadData()},methods:{operation(e){this.showEditPopup2=!0,this.tempItem=e},routerPush(){uni.navigateTo({url:`/subPackages/aHouseholder/Traceability/Traceability?id=${this.tempItem.id}&goodsname=${this.tempItem.goodsname}`})},async removeItem(){let e={id:this.tempItem.id,isshow:2};200==(await l.editgoods(e)).code?(uni.showToast({title:"删除成功",icon:"success"}),this.reloadData(),this.closePopup()):uni.showToast({title:"删除失败",icon:"error"})},clicKexampleBody(){this.iconStatus=!this.iconStatus,this.isShowItems=!this.isShowItems},selectItem(e){this.unit=e,this.iconStatus=!this.iconStatus,this.isShowItems=!this.isShowItems},fetchCategories(){l.cglist().then((e=>{if(200===e.code){const t=e.data.listdata.map((e=>({id:e.id,content:e.content})));this.categories=t,this.pickerRange=[...t.map((e=>e.content))]}}))},async fetchMarketList(){try{uni.getStorageSync("token");const e={limit:100,page:1},a=await l.getMyShops({token:this.token,...e});if(200===a.code){const e=a.data.listdata.map((e=>({id:e.id,title:e.title})));this.marketList=e,this.pickerRange1=[...e.map((e=>e.title))]}else t("error","at pages/publish/publish.vue:252","Failed to fetch market list:",a.msg)}catch(e){t("error","at pages/publish/publish.vue:255","Error fetching market list:",e)}},onCategoryChange(e){this.selectedCategoryIndex=e.detail.value,this.currentItem.category_id=this.categories[this.selectedCategoryIndex].id},onMarketChange(e){this.selectedCategoryIndex1=e.detail.value,this.currentItem.market_id=this.marketList[this.selectedCategoryIndex1].id},fetchData:async e=>(await l.getCommdityList(e)).data,goTorelePage(){uni.navigateTo({url:"/pages/release/release"})},edit(){this.currentItem={...this.tempItem},this.fetchCategories(),this.showEditPopup=!0,this.fetchCommodityDetails(this.tempItem.id)},fetchCommodityDetails(e){l.getCommodityDetails(e).then((e=>{if(200===e.code){const t=e.data.listdata[0];this.currentItem.goodsname=t.goodsname,this.currentItem.imglogo=t.imglogo;const a=this.categories.findIndex((e=>e.id===t.category_id));-1!==a&&(this.selectedCategoryIndex=a)}}))},uploadcuisine(){uni.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:e=>{const a=e.tempFilePaths;if(a.length>0){t("log","at pages/publish/publish.vue:313",66676,e.tempFiles[0]);const{upload:i,request:o}=Ae({uploadPath:"/group1/upload",tempFilePaths:a[0],file:e.tempFiles[0]});i().then((e=>{e=JSON.parse(e),this.currentItem.imglogo=e.data.url}))}}})},shelves(){this.currentItem={...this.tempItem},t("log","at pages/publish/publish.vue:349",this.currentItem),this.showEditPopup1=!0,this.fetchMarketList()},closePopup(){this.showEditPopup=!1,this.showEditPopup1=!1,this.showEditPopup2=!1,this.itemPrice=""},confirmEdit(){if(!this.currentItem.id)return void uni.showToast({title:"商品 ID 不正确",icon:"none"});if(!this.imageUploaded&&!this.currentItem.imglogo)return void uni.showToast({title:"请上传图片",icon:"none"});const{id:e,category_id:t,goodsname:a,imglogo:i}=this.currentItem;l.editGoods({id:e,category_id:t,goodsname:a,imglogo:i}).then((e=>{200===e.code?(uni.showToast({title:"商品修改成功",icon:"success"}),this.reloadData(),this.closePopup()):uni.showToast({title:e.msg||"商品修改失败",icon:"none"})}))},confirmShelves(){t("log","at pages/publish/publish.vue:411","Goods ID:",this.currentItem.id),this.itemPrice?this.unit?l.addCommodityToShop({goods_id:this.currentItem.id,shop_id:this.marketList[this.selectedCategoryIndex1].id,content:this.itemDescription,price:parseFloat(this.itemPrice),weight_name:this.unit}).then((e=>{200===e.code?(uni.showToast({title:"上架成功"}),this.closePopup(),this.reloadData()):uni.showToast({title:"上架失败",icon:"none"})})):uni.showToast({title:"请选择单位",icon:"none"}):uni.showToast({title:"请填写价格",icon:"none"})}}};const $t=W(zt,[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"me-container"},[e.createElementVNode("scroll-view",{class:"Stallholder","scroll-y":"true",onScrolltolower:i[0]||(i[0]=(...e)=>t.handleScrollToLower&&t.handleScrollToLower(...e)),style:{height:"100vh"},"lower-threshold":"10"},[e.createElementVNode("view",{class:"disheslist"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.pageData,(t=>(e.openBlock(),e.createElementBlock("view",{class:"type",key:t.id},[n.isloaded?(e.openBlock(),e.createElementBlock("image",{key:0,class:"type-image","lazy-load":"",src:t.imglogo,mode:"scaleToFill"},null,8,["src"])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"regard"},[e.createElementVNode("view",{class:"typetitle"},e.toDisplayString(t.goodsname),1)]),e.createElementVNode("view",{class:"function"},[e.createElementVNode("view",{class:"rigicon",onClick:e=>r.operation(t)},"操作",8,["onClick"])])])))),128)),t.pageLoading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading"},"加载中...")):e.createCommentVNode("",!0),t.hasMore?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:1,class:"loading"},"没有更多了"))])],32),e.createElementVNode("view",{class:"butt",onClick:i[1]||(i[1]=(...e)=>r.goTorelePage&&r.goTorelePage(...e))}," 点击新增菜品 "),n.showEditPopup2?(e.openBlock(),e.createElementBlock("view",{key:0,class:"popup-overlay",onClick:i[8]||(i[8]=(...e)=>r.closePopup&&r.closePopup(...e))},[e.createElementVNode("view",{style:{"background-color":"white",width:"300rpx",height:"600rpx","border-radius":"5%",position:"relative"},onClick:i[7]||(i[7]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{style:{position:"absolute",right:"15rpx",top:"10rpx","background-color":"red",color:"white",padding:"5rpx"},onClick:i[2]||(i[2]=(...e)=>r.closePopup&&r.closePopup(...e))},"关闭"),e.createElementVNode("view",{class:"btns",style:{display:"flex","align-items":"center",height:"100%","justify-content":"center","flex-wrap":"wrap"}},[e.createElementVNode("view",{class:"rigicon",style:{"margin-top":"50rpx",color:"white"},onClick:i[3]||(i[3]=(...e)=>r.edit&&r.edit(...e))},"修改"),e.createElementVNode("view",{class:"rigicon",style:{"background-color":"#67c23a",color:"white"},onClick:i[4]||(i[4]=(...e)=>r.shelves&&r.shelves(...e))},"上架 "),e.createElementVNode("view",{class:"rigicon",style:{"background-color":"#f56c6c",color:"white"},onClick:i[5]||(i[5]=(...e)=>r.removeItem&&r.removeItem(...e))},"删除 "),e.createElementVNode("view",{class:"rigicon",style:{"background-color":"#5daaa8",color:"white"},onClick:i[6]||(i[6]=(...e)=>r.routerPush&&r.routerPush(...e))},"补充溯源 ")])])])):e.createCommentVNode("",!0),n.showEditPopup?(e.openBlock(),e.createElementBlock("view",{key:1,class:"popup-overlay",onClick:i[16]||(i[16]=(...e)=>r.closePopup&&r.closePopup(...e))},[e.createElementVNode("view",{class:"popup",onClick:i[15]||(i[15]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"close-button",onClick:i[9]||(i[9]=(...e)=>r.closePopup&&r.closePopup(...e))},"×"),e.createElementVNode("view",{class:"popup-content"},[e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"cuisine"},[e.createElementVNode("view",{class:"title"},"菜名"),e.createElementVNode("view",{class:"shuru"},[e.withDirectives(e.createElementVNode("input",{class:"shurucon",type:"text","onUpdate:modelValue":i[10]||(i[10]=e=>n.currentItem.goodsname=e)},null,512),[[e.vModelText,n.currentItem.goodsname]])])]),e.createElementVNode("view",{class:"class"},[e.createElementVNode("view",{class:"title"},"分类"),e.createElementVNode("picker",{class:"picker",range:n.pickerRange,value:n.selectedCategoryIndex,onChange:i[11]||(i[11]=(...e)=>r.onCategoryChange&&r.onCategoryChange(...e))},[e.createElementVNode("view",{class:"picker-text"},e.toDisplayString(n.pickerRange[n.selectedCategoryIndex]),1)],40,["range","value"])]),e.createElementVNode("view",{class:"editimg"},[e.createElementVNode("view",{class:"title"},"图片"),e.createElementVNode("image",{class:"cimg",src:n.currentItem.imglogo,mode:"aspectFit",onClick:i[12]||(i[12]=(...e)=>r.uploadcuisine&&r.uploadcuisine(...e))},null,8,["src"])])])]),e.createElementVNode("view",{class:"popup-footer"},[e.createElementVNode("button",{onClick:i[13]||(i[13]=(...e)=>r.closePopup&&r.closePopup(...e))},"取消"),e.createElementVNode("button",{onClick:i[14]||(i[14]=(...e)=>r.confirmEdit&&r.confirmEdit(...e)),style:{"background-color":"#007aff",color:"white"}},"确认")])])])):e.createCommentVNode("",!0),n.showEditPopup1?(e.openBlock(),e.createElementBlock("view",{key:2,class:"popup-overlay",onClick:i[24]||(i[24]=(...e)=>r.closePopup&&r.closePopup(...e))},[e.createElementVNode("view",{class:"popup",onClick:i[23]||(i[23]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"close-button",onClick:i[17]||(i[17]=(...e)=>r.closePopup&&r.closePopup(...e))},"×"),e.createElementVNode("view",{class:"popup-header"},e.toDisplayString(n.currentItem.goodsname),1),e.createElementVNode("view",{class:"popup-content"},[e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"cuisine"},[e.createElementVNode("view",{class:"title"},"选择摊位"),e.createElementVNode("picker",{class:"picker1",range:n.pickerRange1,value:n.selectedCategoryIndex1,onChange:i[18]||(i[18]=(...e)=>r.onMarketChange&&r.onMarketChange(...e))},[e.createElementVNode("view",{class:"picker-text"},e.toDisplayString(n.pickerRange1[n.selectedCategoryIndex1]),1)],40,["range","value"])]),e.createElementVNode("view",{class:"editimg"},[e.createElementVNode("view",{class:"title"},"菜品价格"),e.createElementVNode("view",{class:"shuru"},[e.withDirectives(e.createElementVNode("input",{class:"shurucon",type:"text",placeholder:"请输入价格","onUpdate:modelValue":i[19]||(i[19]=e=>n.itemPrice=e)},null,512),[[e.vModelText,n.itemPrice]])]),e.createElementVNode("view",{class:"unit"},"元/"),e.createElementVNode("view",{class:"example-body",onClick:i[20]||(i[20]=(...e)=>r.clicKexampleBody&&r.clicKexampleBody(...e))},[e.createElementVNode("view",{class:"unit"},e.toDisplayString(n.unit?n.unit:"单位"),1),e.createElementVNode("view",{class:"icon"},[e.createVNode(l,{type:n.iconStatus?"up":"down",size:"20"},null,8,["type"])])]),e.withDirectives(e.createElementVNode("view",{class:"items"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.candidates,(t=>(e.openBlock(),e.createElementBlock("view",{class:"item",onClick:e=>r.selectItem(t)},e.toDisplayString(t),9,["onClick"])))),256))],512),[[e.vShow,n.isShowItems]])])])]),e.createElementVNode("view",{class:"popup-footer"},[e.createElementVNode("button",{onClick:i[21]||(i[21]=(...e)=>r.closePopup&&r.closePopup(...e))},"取消"),e.createElementVNode("button",{onClick:i[22]||(i[22]=(...e)=>r.confirmShelves&&r.confirmShelves(...e)),style:{"background-color":"#007aff",color:"white"}},"确认")])])])):e.createCommentVNode("",!0)])}]]),jt={data:()=>({Image:"",goodsname:"",category_id:"",imageUploaded:!1,imglogo:"",categories:[],pickerRange:[],selectedCategoryIndex:0}),onLoad(){this.fetchCategories()},methods:{async customizeBack(){let e=await getCurrentPages();e&&e.length>1?uni.navigateBack():history.back()},fetchCategories(){l.cglist().then((e=>{if(200===e.code){const t=e.data.listdata.map((e=>({id:e.id,content:e.content})));this.categories=t,this.pickerRange=["请选择分类",...t.map((e=>e.content))],t.length>0&&(this.category_id=t[0].id)}else uni.showToast({title:e.message||"获取分类失败",icon:"none"})})).catch((e=>{t("error","at pages/release/release.vue:110",e),uni.showToast({title:"获取分类失败",icon:"none"})}))},uploadcuisine(){uni.chooseImage({count:1,sizeType:["compressed","original"],sourceType:["album","camera"],success:async e=>{const a=e.tempFilePaths;if(t("log","at pages/release/release.vue:126",e),a.length>0){const{upload:t,request:i}=Ae({uploadPath:"/group1/upload",file:e.tempFiles[0],tempFilePaths:a[0]});t().then((e=>{var t=JSON.parse(e);this.imglogo=o+t.data.path,this.isImageSelected=!0,this.imageUploaded=!0}))}}})},onCategoryChange(e){const t=e.detail.value;this.selectedCategoryIndex=t,this.category_id=t>0?this.categories[t-1].id:""},submit(){t("log","at pages/release/release.vue:174",this.goodsname,this.category_id),this.goodsname&&this.category_id&&this.imglogo?l.addgoods({category_id:this.category_id,goodsname:this.goodsname,imglogo:this.imglogo}).then((e=>{200===e.code?(uni.showToast({title:"菜品添加成功",icon:"success",duration:1e3}).then((()=>{setTimeout((()=>{uni.showModal({title:"是否继续添加菜品",cancelText:"否",confirmText:"是",success:e=>{e.confirm?t("log","at pages/release/release.vue:203","继续添加"):this.customizeBack()}})}),1e3)})),this.goodsname="",this.imglogo="",this.imageUploaded=!1):uni.showToast({title:e.msg||"添加失败",icon:"none"})})).catch((e=>{t("error","at pages/release/release.vue:223",e),uni.showToast({title:"添加失败",icon:"none"})})):uni.showToast({title:"请填写完整信息",icon:"none"})}}};const Ut=W(jt,[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"me-container"},[e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"name"},[e.createElementVNode("text",{class:"title"},"菜名"),e.createElementVNode("view",{class:"item"},[e.createElementVNode("view",{class:"picture"},[e.withDirectives(e.createElementVNode("input",{class:"input-text",type:"text",placeholder:"请输入菜名","onUpdate:modelValue":i[0]||(i[0]=e=>n.goodsname=e)},null,512),[[e.vModelText,n.goodsname]])]),e.createVNode(l,{class:"rigicon",type:"right",size:"14",color:"rgb(229, 229, 229)"})])]),e.createElementVNode("view",{class:"price"},[e.createElementVNode("text",{class:"title"},"分类"),e.createElementVNode("view",{class:"item"},[e.createElementVNode("picker",{class:"picker",range:n.pickerRange,value:n.selectedCategoryIndex,onChange:i[1]||(i[1]=(...e)=>r.onCategoryChange&&r.onCategoryChange(...e))},[e.createElementVNode("view",{class:"picker-text"},e.toDisplayString(n.pickerRange[n.selectedCategoryIndex]),1)],40,["range","value"]),e.createVNode(l,{class:"rigicon",type:"right",size:"14",color:"rgb(229, 229, 229)"})])]),e.createElementVNode("view",{class:"img",onClick:i[2]||(i[2]=(...e)=>r.uploadcuisine&&r.uploadcuisine(...e))},[e.createElementVNode("text",{class:"title"},"图片"),e.createElementVNode("view",{class:"item"},[e.createElementVNode("view",{class:"picture"},[n.imglogo?(e.openBlock(),e.createElementBlock("image",{key:1,src:n.imglogo,class:"uploaded-image",mode:"aspectFit"},null,8,["src"])):(e.openBlock(),e.createElementBlock("view",{key:0},"请上传图片"))]),e.createVNode(l,{class:"rigicon",type:"right",size:"14",color:"rgb(229, 229, 229)"})])]),e.createElementVNode("view",{class:"submit",onClick:i[3]||(i[3]=(...e)=>r.submit&&r.submit(...e))}," 提交 ")]),e.createElementVNode("text",{style:{color:"red","margin-top":"30rpx","font-size":"30rpx"}},"注意：添加菜品后要在菜品列表里面选择上架")])}]]);const qt=W({data:()=>({pageData:[],shopList:[],imageUploaded:!1,showEditPopup:!1,currentShopTitle:"",currentShopLogo:"",isloaded:!1}),mixins:[ge],onLoad(){this.isloaded=!0},created(){this.reloadData()},methods:{async deleteShop(e){200==(await l.editshop({id:e.id,isshow:2})).code&&(uni.showToast({title:"删除成功",icon:"success"}),this.reloadData())},async fetchData(e){try{return(await l.getMyShops({...e})).data}catch(a){t("error","at pages/stalllist/stalllist.vue:110","获取摊位列表失败",a),uni.showToast({title:"获取摊位列表失败",icon:"none"})}},editShop(e){this.currentShopId=e.id,this.currentShopTitle=e.title,this.currentShopLogo=e.logo,this.showEditPopup=!0},closePopup(){this.showEditPopup=!1},async confirmEdit(e){if(this.currentShopTitle)if(this.imageUploaded||this.currentShopLogo)try{t("log","at pages/stalllist/stalllist.vue:152","Calling editshop API");const e=await l.editshop({id:this.currentShopId,title:this.currentShopTitle,logo:this.currentShopLogo});200===e.code?(uni.showToast({title:"摊位信息修改成功",icon:"success"}),this.reloadData(),this.closePopup()):uni.showToast({title:e.msg||"摊位信息修改失败",icon:"none"})}catch(a){uni.showToast({title:"修改失败，请稍后重试",icon:"none"})}else uni.showToast({title:"请上传图片",icon:"none"});else uni.showToast({title:"请输入摊位名称",icon:"none"})},uploadcuisine(){uni.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:e=>{const a=e.tempFilePaths;if(a.length>0){const{upload:i,request:o}=Ae({uploadPath:"/group1/upload",file:e.tempFiles[0],tempFilePaths:a[0]});i().then((e=>{e=JSON.parse(e),this.currentShopLogo=e.data.url,t("log","at pages/stalllist/stalllist.vue:203","更新后的图片路径:",this.currentShopLogo),this.isImageSelected=!0,this.imageUploaded=!0}))}}})},gotostaldis(e){uni.navigateTo({url:`/pages/Stalls-dishes/Stalls-dishes?id=${e}`})}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"me-container"},[e.createElementVNode("scroll-view",{class:"Stallholder","scroll-y":"true",onScrolltolower:a[0]||(a[0]=(...e)=>t.handleScrollToLower&&t.handleScrollToLower(...e)),style:{height:"100vh"}},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.pageData,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.id,class:"item-list"},[e.createElementVNode("view",{class:"logo",onClick:e=>n.gotostaldis(t.id)},[s.isloaded?(e.openBlock(),e.createElementBlock("image",{key:0,class:"logos","lazy-load":"",src:t.logo,mode:"aspectFill"},null,8,["src"])):e.createCommentVNode("",!0)],8,["onClick"]),e.createElementVNode("view",{class:"info",onClick:e=>n.gotostaldis(t.id)},[e.createElementVNode("view",{class:"message"},"菜市场名称："+e.toDisplayString(t.market_name),1),e.createElementVNode("view",{class:"message"},"摊位名称："+e.toDisplayString(t.title),1),e.createElementVNode("view",{class:"message"},"摊位编号："+e.toDisplayString(t.id),1)],8,["onClick"]),e.createElementVNode("view",{class:"interface"},[e.createElementVNode("view",{class:"edit",onClick:e=>n.editShop(t)},"编辑",8,["onClick"]),e.createElementVNode("view",{class:"delete",onClick:e=>n.deleteShop(t)},"删除",8,["onClick"])])])))),128)),t.pageLoading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading"},"加载中...")):e.createCommentVNode("",!0),t.hasMore?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:1,class:"loading"},"没有更多了"))],32),s.showEditPopup?(e.openBlock(),e.createElementBlock("view",{key:0,class:"popup-overlay",onClick:a[7]||(a[7]=(...e)=>n.closePopup&&n.closePopup(...e))},[e.createElementVNode("view",{class:"popup",onClick:a[6]||(a[6]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"close-button",onClick:a[1]||(a[1]=(...e)=>n.closePopup&&n.closePopup(...e))},"×"),e.createElementVNode("view",{class:"popup-content"},[e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"cuisine"},[e.createElementVNode("view",{class:"title"},"摊位名称"),e.createElementVNode("view",{class:"shuru"},[e.withDirectives(e.createElementVNode("input",{class:"shurucon",type:"text","onUpdate:modelValue":a[2]||(a[2]=e=>s.currentShopTitle=e)},null,512),[[e.vModelText,s.currentShopTitle]])])]),e.createElementVNode("view",{class:"editimg"},[e.createElementVNode("view",{class:"title"},"摊位图片"),e.createElementVNode("image",{class:"cimg",src:s.currentShopLogo,mode:"aspectFit",onClick:a[3]||(a[3]=(...e)=>n.uploadcuisine&&n.uploadcuisine(...e))},null,8,["src"])])])]),e.createElementVNode("view",{class:"popup-footer"},[e.createElementVNode("button",{onClick:a[4]||(a[4]=(...e)=>n.closePopup&&n.closePopup(...e))},"取消"),e.createElementVNode("button",{onClick:a[5]||(a[5]=(...e)=>n.confirmEdit&&n.confirmEdit(...e)),style:{"background-color":"#007aff",color:"white"}},"确认")])])])):e.createCommentVNode("",!0)])}]]);const Ht=W({data:()=>({pageData:[]}),onShow(){this.reloadData()},mixins:[ge],methods:{fetchData:async e=>(await l.mycoupon(e)).data,click(e){uni.showToast({title:"请在购买时使用优惠券",icon:"none"}),e.isUse=!0}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"me-container"},[e.createElementVNode("view",{class:"content"},[e.createElementVNode("scroll-view",{class:"Stallholder","scroll-y":"true",onScrolltolower:a[0]||(a[0]=(...e)=>t.handleScrollToLower&&t.handleScrollToLower(...e)),style:{height:"100vh"}},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.pageData,(t=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["yhq",t.isUse?"use":""]),key:t.id,onClick:e=>n.click(t)},[e.createElementVNode("view",{class:"left"}," ￥"+e.toDisplayString(t.price),1),e.createElementVNode("view",{class:"right"},[e.createElementVNode("view",{class:"tit"},e.toDisplayString(t.coupon_name),1),e.createElementVNode("view",{class:"desc"},[e.createElementVNode("view",{class:"p"}," 有效期至: 2025年10月1日 ")])])],10,["onClick"])))),128)),t.pageLoading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading"},"加载中...")):e.createCommentVNode("",!0),t.hasMore?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:1,class:"loading"},"没有更多了"))],32)])])}]]);const Wt=W({data:()=>({}),methods:{rules(){uni.navigateTo({url:"/pages/rules/rules"})},jackpot(e){uni.navigateTo({url:`/pages/jackpot/jackpot?title=${e.title}&image=${e.image}&price=${e.price}&type=${e.type}`})}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"me-container"},[e.createElementVNode("view",{class:"first"},[e.createElementVNode("image",{class:"img",src:"http://h5.xcbdsc.com/static/one.jpg",mode:""}),e.createElementVNode("view",{class:"item"},[e.createElementVNode("view",{class:"info"},[e.createElementVNode("view",{class:"title"},"一等奖 "),e.createElementVNode("view",{class:"cost"},[e.createTextVNode(" 价值 "),e.createElementVNode("text",{class:"price"}," 3000 积分")]),e.createElementVNode("view",{class:"time"}," 开奖时间：2024/08/04 12：00 ")]),e.createElementVNode("view",{class:"draw",onClick:a[0]||(a[0]=e=>n.jackpot({title:"一等奖 ",image:"http://h5.xcbdsc.com/static/one.jpg",price:"3000 积分",type:1}))}," 免费抽 ")])]),e.createElementVNode("view",{class:"accessit"},[e.createElementVNode("image",{class:"img",src:"http://h5.xcbdsc.com/static/two.jpg",mode:""}),e.createElementVNode("view",{class:"item"},[e.createElementVNode("view",{class:"info"},[e.createElementVNode("view",{class:"title"},"二等奖 "),e.createElementVNode("view",{class:"cost"},[e.createTextVNode(" 价值 "),e.createElementVNode("text",{class:"price"}," 1000 积分")]),e.createElementVNode("view",{class:"time"}," 开奖时间：2024/08/04 12：00 ")]),e.createElementVNode("view",{class:"draw",onClick:a[1]||(a[1]=e=>n.jackpot({title:"二等奖 ",image:"http://h5.xcbdsc.com/static/two.jpg",price:"1000 积分",type:2}))}," 免费抽 ")])]),e.createElementVNode("view",{class:"third"},[e.createElementVNode("image",{class:"img",src:"http://h5.xcbdsc.com/static/three.jpg",mode:""}),e.createElementVNode("view",{class:"item"},[e.createElementVNode("view",{class:"info"},[e.createElementVNode("view",{class:"title"},"三等奖 "),e.createElementVNode("view",{class:"cost"},[e.createTextVNode(" 价值 "),e.createElementVNode("text",{class:"price"}," 500 积分")]),e.createElementVNode("view",{class:"time"}," 开奖时间：2024/08/04 12：00 ")]),e.createElementVNode("view",{class:"draw",onClick:a[2]||(a[2]=e=>n.jackpot({title:"三等奖 ",image:"http://h5.xcbdsc.com/static/three.jpg",price:"500 积分",type:3}))}," 免费抽 ")])]),e.createElementVNode("view",{class:"rules-box",onClick:a[3]||(a[3]=(...e)=>n.rules&&n.rules(...e))},[e.createElementVNode("text",{class:"rules-text"},"规则")])])}]]);const Gt=W({data:()=>({}),methods:{scan(){uni.scanCode({onlyFromCamera:!0,success:function(e){t("log","at pages/rules/rules.vue:56",1),t("log","at pages/rules/rules.vue:57","条码类型："+e.scanType),t("log","at pages/rules/rules.vue:58","条码内容："+e.result);const a=e.result;if(a.startsWith("http")){t("log","at pages/rules/rules.vue:63","这是一个有效的 URL");const e=decodeURIComponent(a);t("log","at pages/rules/rules.vue:66","解码后的 URL:",e);const i=e.indexOf("#");if(-1!==i){const a=e.substring(i+1);t("log","at pages/rules/rules.vue:71","提取到的页面路径:",a),uni.navigateTo({url:a})}else t("warn","at pages/rules/rules.vue:77","未能解析到有效的页面路径")}else t("warn","at pages/rules/rules.vue:81","扫码结果不是有效的链接:",a)},fail:function(e){t("error","at pages/rules/rules.vue:85","扫码失败:",e)}})}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"me-container"},[e.createElementVNode("view",{class:"title"}," 喜讯 "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"one"},"为了营造一个轻松,愉悦,有趣味的购物消费场景,我们塔岭农贸市场管理处从2024年11月1日开始,开展购物消费，系统随机摇号产生幸运者,获赠消费积分活动.具体规定如下:"),e.createElementVNode("view",{class:"one"},"一、凡是到塔岭农贸市场购物消费的市民,都可以扫打卡二维码,同一个电话号码一天可以扫码打卡两次：上午一次.时间:6:00-12:00,下午一次.时间:12:00-21:00。"),e.createElementVNode("view",{class:"one"}," 二、每周日晚上23.00,根据市民上一周每一次的打卡记录信息,自动随机摇号抽选出一、二、三档共十二名幸运者。打卡次数越多,选中的几率越大。 一档：1名,获赠1000个积分。 二档：3名,分别获赠500个积分。 三档：8名,分别获赠300个分。 "),e.createElementVNode("view",{class:"one"},"三、1个积分等同于0.1元现金价值.积分不能兑换现金.也不能转赠,获赠积分的凭被抽选中的手机号,在塔岭农贸市场购物消费使用(由于系统还在建设升级的原因，仅限在“农链天下”小程序加盟商户进行消费使用)。"),e.createElementVNode("view",{class:"one"},"四、积分可以单独使用,也可以和现金同时使用。"),e.createElementVNode("view",{class:"one"},"五、积分有效期为180个日历天数,从获赠积分即时算起，超时不使用，剩余的积分全部清零。"),e.createElementVNode("view",{class:"one"}," 六、每次抽选结果及个人积分信息，在“农链天下”小程序中都可以查询。 "),e.createElementVNode("view",{class:"one"}," 七、参与积分活动的行为都属于个人自愿行为，无任何强迫因素在内。 "),e.createElementVNode("view",{class:"one"}," 八.本活动的解释权由塔岭农贸市场管理处负责。 ")]),e.createElementVNode("view",{class:"luokuan"},[e.createElementVNode("view",{class:"bomen"}," 塔岭农贸市场办公室 "),e.createElementVNode("view",{class:"dateTime"},"2024.11.01 ")]),e.createElementVNode("view",{class:"fixd",onClick:a[0]||(a[0]=(...e)=>n.scan&&n.scan(...e))},[e.createElementVNode("view",null,"立即签到")])])}]]);const Jt=W({data:()=>({pagedData:[],totalnum:0,totalPages:0,yideng:[],erdeng:[],sandeng:[],Created:"",signTotalData:{}}),mixins:[pt],async onLoad(){this.fetchData();let e=await l.signTotal();this.signTotalData=e.data},methods:{goTofreeGroceryShopping(){uni.navigateTo({url:"/subPackages/shoppingPageList/freeGroceryShopping/freeGroceryShopping"})},async fetchData(e){this.totalPages=Math.ceil(this.totalnum/6),this.pagedData=[];[{page:1,limit:1,type:1},{page:1,limit:3,type:2},{page:1,limit:8,type:3}].forEach((async e=>{let{data:t}=await l.lottery(e),a=t.listdata[0].type;switch(this.Created=t.listdata[0].Created,a){case 1:this.yideng=t.listdata;break;case 2:this.erdeng=t.listdata;break;case 3:this.sandeng=t.listdata}}))},formatPhoneNumber:e=>e?e.replace(/(\d{3})\d{4}(\d{4})/,"$1****$2"):""}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"me-container"},[e.createElementVNode("view",{class:"item"},[e.createElementVNode("view",{class:"top"},[e.createElementVNode("view",{class:"consequence"},"摇号结果")]),e.createElementVNode("view",{class:"nci"},[e.createElementVNode("view",{class:"draw-time"},"摇号时间："+e.toDisplayString(t.initTime(s.Created)),1),e.createElementVNode("view",{class:"Position"},[e.createElementVNode("view",{class:"grades"},[e.createElementVNode("view",{class:"grade"}),e.createElementVNode("view",{class:"middle"},[e.createElementVNode("view",{class:"title one"},[e.createElementVNode("view",{class:"dengji"},"一档幸运号码"),e.createElementVNode("view",{class:"pailie"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.yideng,(t=>(e.openBlock(),e.createElementBlock("view",null,e.toDisplayString(n.formatPhoneNumber(t.phone)),1)))),256))])]),e.createElementVNode("view",{class:"title two"},[e.createElementVNode("view",{class:"dengji"},"二档幸运号码"),e.createElementVNode("view",{class:"pailie grid"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.erdeng,(t=>(e.openBlock(),e.createElementBlock("view",null,e.toDisplayString(n.formatPhoneNumber(t.phone)),1)))),256))])]),e.createElementVNode("view",{class:"title three"},[e.createElementVNode("view",{class:"dengji"},"三档幸运号码"),e.createElementVNode("view",{class:"pailie"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.sandeng,(t=>(e.openBlock(),e.createElementBlock("view",null,e.toDisplayString(n.formatPhoneNumber(t.phone)),1)))),256))])])])])])])]),e.createElementVNode("button",{onClick:a[0]||(a[0]=(...e)=>n.goTofreeGroceryShopping&&n.goTofreeGroceryShopping(...e))},"参与活动说明")])}]]);const Yt=W({name:"UniSection",emits:["click"],props:{type:{type:String,default:""},title:{type:String,required:!0,default:""},titleFontSize:{type:String,default:"14px"},titleColor:{type:String,default:"#333"},subTitle:{type:String,default:""},subTitleFontSize:{type:String,default:"12px"},subTitleColor:{type:String,default:"#999"},padding:{type:[Boolean,String],default:!1}},computed:{_padding(){return"string"==typeof this.padding?this.padding:this.padding?"10px":""}},watch:{title(e){uni.report&&""!==e&&uni.report("title",e)}},methods:{onClick(){this.$emit("click")}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"uni-section"},[e.createElementVNode("view",{class:"uni-section-header",onClick:a[0]||(a[0]=(...e)=>n.onClick&&n.onClick(...e))},[i.type?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["uni-section-header__decoration",i.type])},null,2)):e.renderSlot(t.$slots,"decoration",{key:1},void 0,!0),e.createElementVNode("view",{class:"uni-section-header__content"},[e.createElementVNode("text",{style:e.normalizeStyle({"font-size":i.titleFontSize,color:i.titleColor}),class:e.normalizeClass(["uni-section__content-title",{distraction:!i.subTitle}])},e.toDisplayString(i.title),7),i.subTitle?(e.openBlock(),e.createElementBlock("text",{key:0,style:e.normalizeStyle({"font-size":i.subTitleFontSize,color:i.subTitleColor}),class:"uni-section-header__content-sub"},e.toDisplayString(i.subTitle),5)):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"uni-section-header__slot-right"},[e.renderSlot(t.$slots,"right",{},void 0,!0)])]),e.createElementVNode("view",{class:"uni-section-content",style:e.normalizeStyle({padding:n._padding})},[e.renderSlot(t.$slots,"default",{},void 0,!0)],4)])}],["__scopeId","data-v-0a8818d5"]]),Kt={props:{value:{type:[String,Number]},options:{type:Object,default:()=>({})},size:{type:[String,Number],default:200},fileType:{type:String,default:"png"},start:{type:Boolean,default:!0},auto:{type:Boolean,default:!0},hide:{type:Boolean,default:!1},type:{type:String,default:()=>"normal"},queue:{type:Boolean,default:!1},isQueueLoadImage:{type:Boolean,default:!1},loading:{type:Boolean,default:void 0},h5SaveIsDownload:{type:Boolean,default:!1},h5DownloadName:{type:String,default:"uvQRCode"},h5SaveTip:{type:Boolean,default:!0}}};function Zt(e){return/^[\+-]?(\d+\.?\d*|\.\d+|\d\.\d+e\+\d+)$/.test(e)}function Qt(e){switch(typeof e){case"undefined":return!0;case"string":if(0==e.replace(/(^[ \t\n\r]*)|([ \t\n\r]*$)/g,"").length)return!0;break;case"boolean":if(!e)return!0;break;case"number":if(0===e||isNaN(e))return!0;break;case"object":if(null===e||0===e.length)return!0;for(const t in e)return!1;return!0}return!1}function Xt(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)}function ea(e){return"[object Object]"===Object.prototype.toString.call(e)}function ta(e){return"function"==typeof e}const aa=Object.freeze(Object.defineProperty({__proto__:null,amount:function(e){return/^[1-9]\d*(,\d{3})*(\.\d{1,2})?$|^0\.\d{1,2}$/.test(e)},array:Xt,carNo:function(e){const t=/^[京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领A-Z]{1}[A-Z]{1}(([0-9]{5}[DF]$)|([DF][A-HJ-NP-Z0-9][0-9]{4}$))/,a=/^[京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领A-Z]{1}[A-Z]{1}[A-HJ-NP-Z0-9]{4}[A-HJ-NP-Z0-9挂学警港澳]{1}$/;return 7===e.length?a.test(e):8===e.length&&t.test(e)},chinese:function(e){return/^[\u4e00-\u9fa5]+$/gi.test(e)},code:function(e,t=6){return new RegExp(`^\\d{${t}}$`).test(e)},contains:function(e,t){return e.indexOf(t)>=0},date:function(e){return!!e&&(Zt(e)&&(e=+e),!/Invalid|NaN/.test(new Date(e).toString()))},dateISO:function(e){return/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/.test(e)},digits:function(e){return/^\d+$/.test(e)},email:function(e){return/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/.test(e)},empty:Qt,enOrNum:function(e){return/^[0-9a-zA-Z]*$/g.test(e)},func:ta,idCard:function(e){return/^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}([0-9]|X)$/.test(e)},image:function(e){const t=e.split("?")[0];return/\.(jpeg|jpg|gif|png|svg|webp|jfif|bmp|dpg)/i.test(t)},jsonString:function(e){if("string"==typeof e)try{const t=JSON.parse(e);return!("object"!=typeof t||!t)}catch(ms){return!1}return!1},landline:function(e){return/^\d{3,4}-\d{7,8}(-\d{3,4})?$/.test(e)},letter:function(e){return/^[a-zA-Z]*$/.test(e)},mobile:function(e){return/^1([3589]\d|4[5-9]|6[1-2,4-7]|7[0-8])\d{8}$/.test(e)},number:Zt,object:ea,promise:function(e){return ea(e)&&ta(e.then)&&ta(e.catch)},range:function(e,t){return e>=t[0]&&e<=t[1]},rangeLength:function(e,t){return e.length>=t[0]&&e.length<=t[1]},regExp:function(e){return e&&"[object RegExp]"===Object.prototype.toString.call(e)},string:function(e){return"string"==typeof e},url:function(e){return/^((https|http|ftp|rtsp|mms):\/\/)(([0-9a-zA-Z_!~*'().&=+$%-]+: )?[0-9a-zA-Z_!~*'().&=+$%-]+@)?(([0-9]{1,3}.){3}[0-9]{1,3}|([0-9a-zA-Z_!~*'()-]+.)*([0-9a-zA-Z][0-9a-zA-Z-]{0,61})?[0-9a-zA-Z].[a-zA-Z]{2,6})(:[0-9]{1,4})?((\/?)|(\/[0-9a-zA-Z_!~*'().;?:@&=+$,%#-]+)+\/?)$/.test(e)},video:function(e){return/\.(mp4|mpg|mpeg|dat|asf|avi|rm|rmvb|mov|wmv|flv|mkv|m3u8)/i.test(e)}},Symbol.toStringTag,{value:"Module"}));function ia(e,t=15){return+parseFloat(Number(e).toPrecision(t))}function oa(e){const t=e.toString().split(/[eE]/),a=(t[0].split(".")[1]||"").length-+(t[1]||0);return a>0?a:0}function sa(e){if(-1===e.toString().indexOf("e"))return Number(e.toString().replace(".",""));const t=oa(e);return t>0?ia(Number(e)*Math.pow(10,t)):Number(e)}function na(e){(e>Number.MAX_SAFE_INTEGER||e<Number.MIN_SAFE_INTEGER)&&t("warn","at uni_modules/uv-ui-tools/libs/function/digit.js:45",`${e} 超出了精度限制，结果可能不正确`)}function ra(e,t){const[a,i,...o]=e;let s=t(a,i);return o.forEach((e=>{s=t(s,e)})),s}function la(...e){if(e.length>2)return ra(e,la);const[t,a]=e,i=sa(t),o=sa(a),s=oa(t)+oa(a),n=i*o;return na(n),n/Math.pow(10,s)}function ca(...e){if(e.length>2)return ra(e,ca);const[t,a]=e,i=sa(t),o=sa(a);return na(i),na(o),la(i/o,ia(Math.pow(10,oa(a)-oa(t))))}function da(e=void 0){let t=this.$parent;for(;t;){if(!t.$options||t.$options.name===e)return t;t=t.$parent}return!1}function ua(e,t=new WeakMap){if(null===e||"object"!=typeof e)return e;if(t.has(e))return t.get(e);let a;if(e instanceof Date)a=new Date(e.getTime());else if(e instanceof RegExp)a=new RegExp(e);else if(e instanceof Map)a=new Map(Array.from(e,(([e,a])=>[e,ua(a,t)])));else if(e instanceof Set)a=new Set(Array.from(e,(e=>ua(e,t))));else if(Array.isArray(e))a=e.map((e=>ua(e,t)));else if("[object Object]"===Object.prototype.toString.call(e)){a=Object.create(Object.getPrototypeOf(e)),t.set(e,a);for(const[i,o]of Object.entries(e))a[i]=ua(o,t)}else a=Object.assign({},e);return t.set(e,a),a}function ma(e={},t={}){if("object"!=typeof(e=ua(e))||null===e||"object"!=typeof t||null===t)return e;const a=Array.isArray(e)?e.slice():Object.assign({},e);for(const i in t){if(!t.hasOwnProperty(i))continue;const e=t[i],o=a[i];e instanceof Date?a[i]=new Date(e):e instanceof RegExp?a[i]=new RegExp(e):e instanceof Map?a[i]=new Map(e):e instanceof Set?a[i]=new Set(e):a[i]="object"==typeof e&&null!==e?ma(o,e):e}return a}function ha(e=null,t="yyyy-mm-dd"){let a;a=e?/^\d{10}$/.test(null==e?void 0:e.toString().trim())?new Date(1e3*e):"string"==typeof e&&/^\d+$/.test(e.trim())?new Date(Number(e)):"string"==typeof e&&e.includes("-")&&!e.includes("T")?new Date(e.replace(/-/g,"/")):new Date(e):new Date;const i={y:a.getFullYear().toString(),m:(a.getMonth()+1).toString().padStart(2,"0"),d:a.getDate().toString().padStart(2,"0"),h:a.getHours().toString().padStart(2,"0"),M:a.getMinutes().toString().padStart(2,"0"),s:a.getSeconds().toString().padStart(2,"0")};for(const o in i){const[e]=new RegExp(`${o}+`).exec(t)||[];if(e){const a="y"===o&&2===e.length?2:0;t=t.replace(e,i[o].slice(a))}}return t}function pa(e,t="both"){return e=String(e),"both"==t?e.replace(/^\s+|\s+$/g,""):"left"==t?e.replace(/^\s*/,""):"right"==t?e.replace(/(\s*$)/g,""):"all"==t?e.replace(/\s+/g,""):e}function ga(e={},t=!0,a="brackets"){const i=t?"?":"",o=[];-1==["indices","brackets","repeat","comma"].indexOf(a)&&(a="brackets");for(const s in e){const t=e[s];if(!(["",void 0,null].indexOf(t)>=0))if(t.constructor===Array)switch(a){case"indices":for(let a=0;a<t.length;a++)o.push(`${s}[${a}]=${t[a]}`);break;case"brackets":default:t.forEach((e=>{o.push(`${s}[]=${e}`)}));break;case"repeat":t.forEach((e=>{o.push(`${s}=${e}`)}));break;case"comma":let e="";t.forEach((t=>{e+=(e?",":"")+t})),o.push(`${s}=${e}`)}else o.push(`${s}=${t}`)}return o.length?i+o.join("&"):""}function fa(){var e;const t=getCurrentPages(),a=null==(e=t[t.length-1])?void 0:e.route;return`/${a||""}`}String.prototype.padStart||(String.prototype.padStart=function(e,t=" "){if("[object String]"!==Object.prototype.toString.call(t))throw new TypeError("fillString must be String");const a=this;if(a.length>=e)return String(a);const i=e-a.length;let o=Math.ceil(i/t.length);for(;o>>=1;)t+=t,1===o&&(t+=t);return t.slice(0,i)+a});const ya=Object.freeze(Object.defineProperty({__proto__:null,$parent:da,addStyle:function(e,t="object"){if(Qt(e)||"object"==typeof e&&"object"===t||"string"===t&&"string"==typeof e)return e;if("object"===t){const t=(e=pa(e)).split(";"),a={};for(let e=0;e<t.length;e++)if(t[e]){const i=t[e].split(":");a[pa(i[0])]=pa(i[1])}return a}let a="";for(const i in e){a+=`${i.replace(/([A-Z])/g,"-$1").toLowerCase()}:${e[i]};`}return pa(a)},addUnit:function(e="auto",t=((e=>{return null==(e=null==(t=null==uni?void 0:uni.$uv)?void 0:t.config)?void 0:e.unit;var t})()?(e=>{return null==(e=null==(t=null==uni?void 0:uni.$uv)?void 0:t.config)?void 0:e.unit;var t})():"px")){return Zt(e=String(e))?`${e}${t}`:e},deepClone:ua,deepMerge:ma,error:function(e){},formValidate:function(e,t){const a=da.call(e,"uv-form-item"),i=da.call(e,"uv-form");a&&i&&i.validateField(a.prop,(()=>{}),t)},getDuration:function(e,t=!0){const a=parseInt(e);return t?/s$/.test(e)?e:e>30?`${e}ms`:`${e}s`:/ms$/.test(e)?a:/s$/.test(e)?a>30?a:1e3*a:a},getHistoryPage:function(e=0){const t=getCurrentPages();return t[t.length-1+e]},getProperty:function(e,t){if(e){if("string"!=typeof t||""===t)return"";if(-1!==t.indexOf(".")){const a=t.split(".");let i=e[a[0]]||{};for(let e=1;e<a.length;e++)i&&(i=i[a[e]]);return i}return e[t]}},getPx:function(e,t=!1){return Zt(e)?t?`${e}px`:Number(e):/(rpx|upx)$/.test(e)?t?`${uni.upx2px(parseInt(e))}px`:Number(uni.upx2px(parseInt(e))):t?`${parseInt(e)}px`:parseInt(e)},guid:function(e=32,t=!0,a=null){const i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),o=[];if(a=a||i.length,e)for(let s=0;s<e;s++)o[s]=i[0|Math.random()*a];else{let e;o[8]=o[13]=o[18]=o[23]="-",o[14]="4";for(let t=0;t<36;t++)o[t]||(e=0|16*Math.random(),o[t]=i[19==t?3&e|8:e])}return t?(o.shift(),`u${o.join("")}`):o.join("")},os:function(){return uni.getSystemInfoSync().platform.toLowerCase()},padZero:function(e){return`00${e}`.slice(-2)},page:fa,pages:function(){return getCurrentPages()},priceFormat:function(e,t=0,a=".",i=","){e=`${e}`.replace(/[^0-9+-Ee.]/g,"");const o=isFinite(+e)?+e:0,s=isFinite(+t)?Math.abs(t):0,n=void 0===i?",":i,r=void 0===a?".":a;let l="";l=(s?function(e,t){const a=Math.pow(10,t);let i=ca(Math.round(Math.abs(la(e,a))),a);return e<0&&0!==i&&(i=la(i,-1)),i}(o,s)+"":`${Math.round(o)}`).split(".");const c=/(-?\d+)(\d{3})/;for(;c.test(l[0]);)l[0]=l[0].replace(c,`$1${n}$2`);return(l[1]||"").length<s&&(l[1]=l[1]||"",l[1]+=new Array(s-l[1].length+1).join("0")),l.join(r)},queryParams:ga,random:function(e,t){if(e>=0&&t>0&&t>=e){const a=t-e+1;return Math.floor(Math.random()*a+e)}return 0},randomArray:function(e=[]){return e.sort((()=>Math.random()-.5))},range:function(e=0,t=0,a=0){return Math.max(e,Math.min(t,Number(a)))},setConfig:function({props:e={},config:t={},color:a={},zIndex:i={}}){const{deepMerge:o}=uni.$uv;uni.$uv.config=o(uni.$uv.config,t),uni.$uv.props=o(uni.$uv.props,e),uni.$uv.color=o(uni.$uv.color,a),uni.$uv.zIndex=o(uni.$uv.zIndex,i)},setProperty:function(e,t,a){if(!e)return;const i=function(e,t,a){if(1!==t.length)for(;t.length>1;){const o=t[0];e[o]&&"object"==typeof e[o]||(e[o]={}),t.shift(),i(e[o],t,a)}else e[t[0]]=a};if("string"!=typeof t||""===t);else if(-1!==t.indexOf(".")){const o=t.split(".");i(e,o,a)}else e[t]=a},sleep:function(e=30){return new Promise((t=>{setTimeout((()=>{t()}),e)}))},sys:function(){return uni.getSystemInfoSync()},timeFormat:ha,timeFrom:function(e=null,t="yyyy-mm-dd"){null==e&&(e=Number(new Date)),10==(e=parseInt(e)).toString().length&&(e*=1e3);let a=(new Date).getTime()-e;a=parseInt(a/1e3);let i="";switch(!0){case a<300:i="刚刚";break;case a>=300&&a<3600:i=`${parseInt(a/60)}分钟前`;break;case a>=3600&&a<86400:i=`${parseInt(a/3600)}小时前`;break;case a>=86400&&a<2592e3:i=`${parseInt(a/86400)}天前`;break;default:i=!1===t?a>=2592e3&&a<31536e3?`${parseInt(a/2592e3)}个月前`:`${parseInt(a/31536e3)}年前`:ha(e,t)}return i},toast:function(e,t=2e3){uni.showToast({title:String(e),icon:"none",duration:t})},trim:pa,type2icon:function(e="success",t=!1){-1==["primary","info","error","warning","success"].indexOf(e)&&(e="success");let a="";switch(e){case"primary":case"info":a="info-circle";break;case"error":a="close-circle";break;case"warning":a="error-circle";break;default:a="checkmark-circle"}return t&&(a+="-fill"),a}},Symbol.toStringTag,{value:"Module"}));const va=(new class{constructor(){this.config={type:"navigateTo",url:"",delta:1,params:{},animationType:"pop-in",animationDuration:300,intercept:!1,events:{}},this.route=this.route.bind(this)}addRootPath(e){return"/"===e[0]?e:`/${e}`}mixinParam(e,t){e=e&&this.addRootPath(e);let a="";return/.*\/.*\?.*=.*/.test(e)?(a=ga(t,!1),e+`&${a}`):(a=ga(t),e+a)}async route(e={},t={}){let a={};if("string"==typeof e?(a.url=this.mixinParam(e,t),a.type="navigateTo"):(a=ma(this.config,e),a.url=this.mixinParam(e.url,e.params)),a.url!==fa())if(t.intercept&&(a.intercept=t.intercept),a.params=t,a=ma(this.config,a),"function"==typeof a.intercept){await new Promise(((e,t)=>{a.intercept(a,e)}))&&this.openPage(a)}else this.openPage(a)}openPage(e){const{url:t,type:a,delta:i,animationType:o,animationDuration:s,events:n}=e;"navigateTo"!=e.type&&"to"!=e.type||uni.navigateTo({url:t,animationType:o,animationDuration:s,events:n}),"redirectTo"!=e.type&&"redirect"!=e.type||uni.redirectTo({url:t}),"switchTab"!=e.type&&"tab"!=e.type||uni.switchTab({url:t}),"reLaunch"!=e.type&&"launch"!=e.type||uni.reLaunch({url:t}),"navigateBack"!=e.type&&"back"!=e.type||uni.navigateBack({delta:i})}}).route;let wa,ka=null;function Ea(e,t=500,a=!1){if(null!==ka&&clearTimeout(ka),a){const a=!ka;ka=setTimeout((()=>{ka=null}),t),a&&"function"==typeof e&&e()}else ka=setTimeout((()=>{"function"==typeof e&&e()}),t)}function Na(e,t=500,a=!0){a?wa||(wa=!0,"function"==typeof e&&e(),setTimeout((()=>{wa=!1}),t)):wa||(wa=!0,setTimeout((()=>{wa=!1,"function"==typeof e&&e()}),t))}const ba={props:{customStyle:{type:[Object,String],default:()=>({})},customClass:{type:String,default:""},url:{type:String,default:""},linkType:{type:String,default:"navigateTo"}},data:()=>({}),onLoad(){this.$uv.getRect=this.$uvGetRect},created(){this.$uv.getRect=this.$uvGetRect},computed:{$uv(){var e,t;return{...ya,test:aa,route:va,debounce:Ea,throttle:Na,unit:null==(t=null==(e=null==uni?void 0:uni.$uv)?void 0:e.config)?void 0:t.unit}},bem:()=>function(e,t,a){const i=`uv-${e}--`,o={};return t&&t.map((e=>{o[i+this[e]]=!0})),a&&a.map((e=>{this[e]?o[i+e]=this[e]:delete o[i+e]})),Object.keys(o)}},methods:{openPage(e="url"){const t=this[e];t&&uni[this.linkType]({url:t})},$uvGetRect(e,t){return new Promise((a=>{uni.createSelectorQuery().in(this)[t?"selectAll":"select"](e).boundingClientRect((e=>{t&&Array.isArray(e)&&e.length&&a(e),!t&&e&&a(e)})).exec()}))},getParentData(e=""){this.parent||(this.parent={}),this.parent=this.$uv.$parent.call(this,e),this.parent.children&&-1===this.parent.children.indexOf(this)&&this.parent.children.push(this),this.parent&&this.parentData&&Object.keys(this.parentData).map((e=>{this.parentData[e]=this.parent[e]}))},preventEvent(e){e&&"function"==typeof e.stopPropagation&&e.stopPropagation()},noop(e){this.preventEvent(e)}},onReachBottom(){uni.$emit("uvOnReachBottom")},beforeDestroy(){if(this.parent&&Xt(this.parent.children)){const e=this.parent.children;e.map(((t,a)=>{t===this&&e.splice(a,1)}))}},unmounted(){if(this.parent&&Xt(this.parent.children)){const e=this.parent.children;e.map(((t,a)=>{t===this&&e.splice(a,1)}))}}};function Va(e){this.mode=xa.MODE_8BIT_BYTE,this.data=e}function Sa(e,t){this.typeNumber=e,this.errorCorrectLevel=t,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=new Array}Va.prototype={getLength:function(e){return this.data.length},write:function(e){for(var t=0;t<this.data.length;t++)e.put(this.data.charCodeAt(t),8)}},Sa.prototype={addData:function(e){var t=new Va(e);this.dataList.push(t),this.dataCache=null},isDark:function(e,t){if(e<0||this.moduleCount<=e||t<0||this.moduleCount<=t)throw new Error(e+","+t);return this.modules[e][t]},getModuleCount:function(){return this.moduleCount},make:function(){if(this.typeNumber<1){var e=1;for(e=1;e<40;e++){for(var t=Ia.getRSBlocks(e,this.errorCorrectLevel),a=new Ba,i=0,o=0;o<t.length;o++)i+=t[o].dataCount;for(o=0;o<this.dataList.length;o++){var s=this.dataList[o];a.put(s.mode,4),a.put(s.getLength(),Da.getLengthInBits(s.mode,e)),s.write(a)}if(a.getLengthInBits()<=8*i)break}this.typeNumber=e}this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(e,t){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var a=0;a<this.moduleCount;a++){this.modules[a]=new Array(this.moduleCount);for(var i=0;i<this.moduleCount;i++)this.modules[a][i]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(e,t),this.typeNumber>=7&&this.setupTypeNumber(e),null==this.dataCache&&(this.dataCache=Sa.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,t)},setupPositionProbePattern:function(e,t){for(var a=-1;a<=7;a++)if(!(e+a<=-1||this.moduleCount<=e+a))for(var i=-1;i<=7;i++)t+i<=-1||this.moduleCount<=t+i||(this.modules[e+a][t+i]=0<=a&&a<=6&&(0==i||6==i)||0<=i&&i<=6&&(0==a||6==a)||2<=a&&a<=4&&2<=i&&i<=4)},getBestMaskPattern:function(){for(var e=0,t=0,a=0;a<8;a++){this.makeImpl(!0,a);var i=Da.getLostPoint(this);(0==a||e>i)&&(e=i,t=a)}return t},createMovieClip:function(e,t,a){var i=e.createEmptyMovieClip(t,a);this.make();for(var o=0;o<this.modules.length;o++)for(var s=1*o,n=0;n<this.modules[o].length;n++){var r=1*n;this.modules[o][n]&&(i.beginFill(0,100),i.moveTo(r,s),i.lineTo(r+1,s),i.lineTo(r+1,s+1),i.lineTo(r,s+1),i.endFill())}return i},setupTimingPattern:function(){for(var e=8;e<this.moduleCount-8;e++)null==this.modules[e][6]&&(this.modules[e][6]=e%2==0);for(var t=8;t<this.moduleCount-8;t++)null==this.modules[6][t]&&(this.modules[6][t]=t%2==0)},setupPositionAdjustPattern:function(){for(var e=Da.getPatternPosition(this.typeNumber),t=0;t<e.length;t++)for(var a=0;a<e.length;a++){var i=e[t],o=e[a];if(null==this.modules[i][o])for(var s=-2;s<=2;s++)for(var n=-2;n<=2;n++)this.modules[i+s][o+n]=-2==s||2==s||-2==n||2==n||0==s&&0==n}},setupTypeNumber:function(e){for(var t=Da.getBCHTypeNumber(this.typeNumber),a=0;a<18;a++){var i=!e&&1==(t>>a&1);this.modules[Math.floor(a/3)][a%3+this.moduleCount-8-3]=i}for(a=0;a<18;a++)i=!e&&1==(t>>a&1),this.modules[a%3+this.moduleCount-8-3][Math.floor(a/3)]=i},setupTypeInfo:function(e,t){for(var a=this.errorCorrectLevel<<3|t,i=Da.getBCHTypeInfo(a),o=0;o<15;o++){var s=!e&&1==(i>>o&1);o<6?this.modules[o][8]=s:o<8?this.modules[o+1][8]=s:this.modules[this.moduleCount-15+o][8]=s}for(o=0;o<15;o++)s=!e&&1==(i>>o&1),o<8?this.modules[8][this.moduleCount-o-1]=s:o<9?this.modules[8][15-o-1+1]=s:this.modules[8][15-o-1]=s;this.modules[this.moduleCount-8][8]=!e},mapData:function(e,t){for(var a=-1,i=this.moduleCount-1,o=7,s=0,n=this.moduleCount-1;n>0;n-=2)for(6==n&&n--;;){for(var r=0;r<2;r++)if(null==this.modules[i][n-r]){var l=!1;s<e.length&&(l=1==(e[s]>>>o&1)),Da.getMask(t,i,n-r)&&(l=!l),this.modules[i][n-r]=l,-1==--o&&(s++,o=7)}if((i+=a)<0||this.moduleCount<=i){i-=a,a=-a;break}}}},Sa.PAD0=236,Sa.PAD1=17,Sa.createData=function(e,t,a){for(var i=Ia.getRSBlocks(e,t),o=new Ba,s=0;s<a.length;s++){var n=a[s];o.put(n.mode,4),o.put(n.getLength(),Da.getLengthInBits(n.mode,e)),n.write(o)}var r=0;for(s=0;s<i.length;s++)r+=i[s].dataCount;if(o.getLengthInBits()>8*r)throw new Error("code length overflow. ("+o.getLengthInBits()+">"+8*r+")");for(o.getLengthInBits()+4<=8*r&&o.put(0,4);o.getLengthInBits()%8!=0;)o.putBit(!1);for(;!(o.getLengthInBits()>=8*r||(o.put(Sa.PAD0,8),o.getLengthInBits()>=8*r));)o.put(Sa.PAD1,8);return Sa.createBytes(o,i)},Sa.createBytes=function(e,t){for(var a=0,i=0,o=0,s=new Array(t.length),n=new Array(t.length),r=0;r<t.length;r++){var l=t[r].dataCount,c=t[r].totalCount-l;i=Math.max(i,l),o=Math.max(o,c),s[r]=new Array(l);for(var d=0;d<s[r].length;d++)s[r][d]=255&e.buffer[d+a];a+=l;var u=Da.getErrorCorrectPolynomial(c),m=new Pa(s[r],u.getLength()-1).mod(u);for(n[r]=new Array(u.getLength()-1),d=0;d<n[r].length;d++){var h=d+m.getLength()-n[r].length;n[r][d]=h>=0?m.get(h):0}}var p=0;for(d=0;d<t.length;d++)p+=t[d].totalCount;var g=new Array(p),f=0;for(d=0;d<i;d++)for(r=0;r<t.length;r++)d<s[r].length&&(g[f++]=s[r][d]);for(d=0;d<o;d++)for(r=0;r<t.length;r++)d<n[r].length&&(g[f++]=n[r][d]);return g};for(var xa={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},Ca={L:1,M:0,Q:3,H:2},Da={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(e){for(var t=e<<10;Da.getBCHDigit(t)-Da.getBCHDigit(Da.G15)>=0;)t^=Da.G15<<Da.getBCHDigit(t)-Da.getBCHDigit(Da.G15);return(e<<10|t)^Da.G15_MASK},getBCHTypeNumber:function(e){for(var t=e<<12;Da.getBCHDigit(t)-Da.getBCHDigit(Da.G18)>=0;)t^=Da.G18<<Da.getBCHDigit(t)-Da.getBCHDigit(Da.G18);return e<<12|t},getBCHDigit:function(e){for(var t=0;0!=e;)t++,e>>>=1;return t},getPatternPosition:function(e){return Da.PATTERN_POSITION_TABLE[e-1]},getMask:function(e,t,a){switch(e){case 0:return(t+a)%2==0;case 1:return t%2==0;case 2:return a%3==0;case 3:return(t+a)%3==0;case 4:return(Math.floor(t/2)+Math.floor(a/3))%2==0;case 5:return t*a%2+t*a%3==0;case 6:return(t*a%2+t*a%3)%2==0;case 7:return(t*a%3+(t+a)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}},getErrorCorrectPolynomial:function(e){for(var t=new Pa([1],0),a=0;a<e;a++)t=t.multiply(new Pa([1,Ta.gexp(a)],0));return t},getLengthInBits:function(e,t){if(1<=t&&t<10)switch(e){case xa.MODE_NUMBER:return 10;case xa.MODE_ALPHA_NUM:return 9;case xa.MODE_8BIT_BYTE:case xa.MODE_KANJI:return 8;default:throw new Error("mode:"+e)}else if(t<27)switch(e){case xa.MODE_NUMBER:return 12;case xa.MODE_ALPHA_NUM:return 11;case xa.MODE_8BIT_BYTE:return 16;case xa.MODE_KANJI:return 10;default:throw new Error("mode:"+e)}else{if(!(t<41))throw new Error("type:"+t);switch(e){case xa.MODE_NUMBER:return 14;case xa.MODE_ALPHA_NUM:return 13;case xa.MODE_8BIT_BYTE:return 16;case xa.MODE_KANJI:return 12;default:throw new Error("mode:"+e)}}},getLostPoint:function(e){for(var t=e.getModuleCount(),a=0,i=0;i<t;i++)for(var o=0;o<t;o++){for(var s=0,n=e.isDark(i,o),r=-1;r<=1;r++)if(!(i+r<0||t<=i+r))for(var l=-1;l<=1;l++)o+l<0||t<=o+l||0==r&&0==l||n==e.isDark(i+r,o+l)&&s++;s>5&&(a+=3+s-5)}for(i=0;i<t-1;i++)for(o=0;o<t-1;o++){var c=0;e.isDark(i,o)&&c++,e.isDark(i+1,o)&&c++,e.isDark(i,o+1)&&c++,e.isDark(i+1,o+1)&&c++,0!=c&&4!=c||(a+=3)}for(i=0;i<t;i++)for(o=0;o<t-6;o++)e.isDark(i,o)&&!e.isDark(i,o+1)&&e.isDark(i,o+2)&&e.isDark(i,o+3)&&e.isDark(i,o+4)&&!e.isDark(i,o+5)&&e.isDark(i,o+6)&&(a+=40);for(o=0;o<t;o++)for(i=0;i<t-6;i++)e.isDark(i,o)&&!e.isDark(i+1,o)&&e.isDark(i+2,o)&&e.isDark(i+3,o)&&e.isDark(i+4,o)&&!e.isDark(i+5,o)&&e.isDark(i+6,o)&&(a+=40);var d=0;for(o=0;o<t;o++)for(i=0;i<t;i++)e.isDark(i,o)&&d++;return a+Math.abs(100*d/t/t-50)/5*10}},Ta={glog:function(e){if(e<1)throw new Error("glog("+e+")");return Ta.LOG_TABLE[e]},gexp:function(e){for(;e<0;)e+=255;for(;e>=256;)e-=255;return Ta.EXP_TABLE[e]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},_a=0;_a<8;_a++)Ta.EXP_TABLE[_a]=1<<_a;for(_a=8;_a<256;_a++)Ta.EXP_TABLE[_a]=Ta.EXP_TABLE[_a-4]^Ta.EXP_TABLE[_a-5]^Ta.EXP_TABLE[_a-6]^Ta.EXP_TABLE[_a-8];for(_a=0;_a<255;_a++)Ta.LOG_TABLE[Ta.EXP_TABLE[_a]]=_a;function Pa(e,t){if(null==e.length)throw new Error(e.length+"/"+t);for(var a=0;a<e.length&&0==e[a];)a++;this.num=new Array(e.length-a+t);for(var i=0;i<e.length-a;i++)this.num[i]=e[i+a]}function Ia(e,t){this.totalCount=e,this.dataCount=t}function Ba(){this.buffer=new Array,this.length=0}function Aa(e){return e.setFillStyle=e.setFillStyle||function(t){e.fillStyle=t},e.setFontSize=e.setFontSize||function(t){e.font=`${t}px`},e.setTextAlign=e.setTextAlign||function(t){e.textAlign=t},e.setTextBaseline=e.setTextBaseline||function(t){e.textBaseline=t},e.setGlobalAlpha=e.setGlobalAlpha||function(t){e.globalAlpha=t},e.setStrokeStyle=e.setStrokeStyle||function(t){e.strokeStyle=t},e.setShadow=e.setShadow||function(t,a,i,o){e.shadowOffsetX=t,e.shadowOffsetY=a,e.shadowBlur=i,e.shadowColor=o},e.draw=e.draw||function(e,t){t&&t()},e.clearRect=e.clearRect||function(t,a,i,o){e.draw(!1)},e}function Ma(e,a){var i=this.data="",o=this.size=200;this.useDynamicSize=!1,this.dynamicSize=o;var s=this.typeNumber=-1;this.errorCorrectLevel=Ma.errorCorrectLevel.H;var n=this.margin=0;this.areaColor="#FFFFFF",this.backgroundColor="rgba(255,255,255,0)",this.backgroundImageSrc=void 0;var r=this.backgroundImageWidth=void 0,l=this.backgroundImageHeight=void 0,c=this.backgroundImageX=void 0,d=this.backgroundImageY=void 0;this.backgroundImageAlpha=1,this.backgroundImageBorderRadius=0;var u=this.backgroundPadding=0;this.foregroundColor="#000000",this.foregroundImageSrc=void 0;var m=this.foregroundImageWidth=void 0,h=this.foregroundImageHeight=void 0,p=this.foregroundImageX=void 0,g=this.foregroundImageY=void 0,f=this.foregroundImagePadding=0;this.foregroundImageBackgroundColor="#FFFFFF";var y=this.foregroundImageBorderRadius=0,v=this.foregroundImageShadowOffsetX=0,w=this.foregroundImageShadowOffsetY=0,k=this.foregroundImageShadowBlur=0;this.foregroundImageShadowColor="#808080";var E=this.foregroundPadding=0,N=this.positionProbeBackgroundColor=void 0,b=this.positionProbeForegroundColor=void 0,V=this.separatorColor=void 0,S=this.positionAdjustBackgroundColor=void 0,x=this.positionAdjustForegroundColor=void 0,C=this.timingBackgroundColor=void 0,D=this.timingForegroundColor=void 0,T=this.typeNumberBackgroundColor=void 0,_=this.typeNumberForegroundColor=void 0,P=this.darkBlockColor=void 0;this.base=void 0,this.modules=[],this.moduleCount=0,this.drawModules=[];var I=this.canvasContext=void 0;this.loadImage,this.drawReserve=!1,this.isMaked=!1,Object.defineProperties(this,{data:{get(){if(""===i||void 0===i)throw t("error","at uni_modules/uv-qrcode/components/uv-qrcode/qrcode.js:34","[uQRCode]: data must be set!"),new Ma.Error("data must be set!");return i},set(e){i=String(e)}},size:{get:()=>o,set(e){o=Number(e)}},typeNumber:{get:()=>s,set(e){s=Number(e)}},margin:{get:()=>n,set(e){n=Number(e)}},backgroundImageWidth:{get(){return void 0===r?this.dynamicSize:this.useDynamicSize?this.dynamicSize/this.size*r:r},set(e){r=Number(e)}},backgroundImageHeight:{get(){return void 0===l?this.dynamicSize:this.useDynamicSize?this.dynamicSize/this.size*l:l},set(e){l=Number(e)}},backgroundImageX:{get(){return void 0===c?0:this.useDynamicSize?this.dynamicSize/this.size*c:c},set(e){c=Number(e)}},backgroundImageY:{get(){return void 0===d?0:this.useDynamicSize?this.dynamicSize/this.size*d:d},set(e){d=Number(e)}},backgroundPadding:{get:()=>u,set(e){u=e>1?1:e<0?0:e}},foregroundImageWidth:{get(){return void 0===m?(this.dynamicSize-2*this.margin)/4:this.useDynamicSize?this.dynamicSize/this.size*m:m},set(e){m=Number(e)}},foregroundImageHeight:{get(){return void 0===h?(this.dynamicSize-2*this.margin)/4:this.useDynamicSize?this.dynamicSize/this.size*h:h},set(e){h=Number(e)}},foregroundImageX:{get(){return void 0===p?this.dynamicSize/2-this.foregroundImageWidth/2:this.useDynamicSize?this.dynamicSize/this.size*p:p},set(e){p=Number(e)}},foregroundImageY:{get(){return void 0===g?this.dynamicSize/2-this.foregroundImageHeight/2:this.useDynamicSize?this.dynamicSize/this.size*g:g},set(e){g=Number(e)}},foregroundImagePadding:{get(){return this.useDynamicSize?this.dynamicSize/this.size*f:f},set(e){f=Number(e)}},foregroundImageBorderRadius:{get(){return this.useDynamicSize?this.dynamicSize/this.size*y:y},set(e){y=Number(e)}},foregroundImageShadowOffsetX:{get(){return this.useDynamicSize?this.dynamicSize/this.size*v:v},set(e){v=Number(e)}},foregroundImageShadowOffsetY:{get(){return this.useDynamicSize?this.dynamicSize/this.size*w:w},set(e){w=Number(e)}},foregroundImageShadowBlur:{get(){return this.useDynamicSize?this.dynamicSize/this.size*k:k},set(e){k=Number(e)}},foregroundPadding:{get:()=>E,set(e){E=e>1?1:e<0?0:e}},positionProbeBackgroundColor:{get(){return N||this.backgroundColor},set(e){N=e}},positionProbeForegroundColor:{get(){return b||this.foregroundColor},set(e){b=e}},separatorColor:{get(){return V||this.backgroundColor},set(e){V=e}},positionAdjustBackgroundColor:{get(){return S||this.backgroundColor},set(e){S=e}},positionAdjustForegroundColor:{get(){return x||this.foregroundColor},set(e){x=e}},timingBackgroundColor:{get(){return C||this.backgroundColor},set(e){C=e}},timingForegroundColor:{get(){return D||this.foregroundColor},set(e){D=e}},typeNumberBackgroundColor:{get(){return T||this.backgroundColor},set(e){T=e}},typeNumberForegroundColor:{get(){return _||this.foregroundColor},set(e){_=e}},darkBlockColor:{get(){return P||this.foregroundColor},set(e){P=e}},canvasContext:{get(){if(void 0===I)throw t("error","at uni_modules/uv-qrcode/components/uv-qrcode/qrcode.js:34","[uQRCode]: use drawCanvas, you need to set the canvasContext!"),new Ma.Error("use drawCanvas, you need to set the canvasContext!");return I},set(e){I=Aa(e)}}}),Ma.plugins.forEach((e=>e(Ma,this,!1))),e&&this.setOptions(e),a&&(this.canvasContext=Aa(a))}function La(){let e=this.waitingQueue=[],t=this.isRunning=!1;function a(i,o,s){i().then((e=>{o(e)})).catch((e=>{s(e)})).finally((()=>{if(e.length){const t=e.shift();a(t.task,t.resolve,t.reject)}else t=!1}))}this.exec=function(i){return new Promise(((o,s)=>{t?e.push({task:i,resolve:o,reject:s}):(t=!0,a(i,o,s))}))}}Pa.prototype={get:function(e){return this.num[e]},getLength:function(){return this.num.length},multiply:function(e){for(var t=new Array(this.getLength()+e.getLength()-1),a=0;a<this.getLength();a++)for(var i=0;i<e.getLength();i++)t[a+i]^=Ta.gexp(Ta.glog(this.get(a))+Ta.glog(e.get(i)));return new Pa(t,0)},mod:function(e){if(this.getLength()-e.getLength()<0)return this;for(var t=Ta.glog(this.get(0))-Ta.glog(e.get(0)),a=new Array(this.getLength()),i=0;i<this.getLength();i++)a[i]=this.get(i);for(i=0;i<e.getLength();i++)a[i]^=Ta.gexp(Ta.glog(e.get(i))+t);return new Pa(a,0).mod(e)}},Ia.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],Ia.getRSBlocks=function(e,t){var a=Ia.getRsBlockTable(e,t);if(null==a)throw new Error("bad rs block @ typeNumber:"+e+"/errorCorrectLevel:"+t);for(var i=a.length/3,o=new Array,s=0;s<i;s++)for(var n=a[3*s+0],r=a[3*s+1],l=a[3*s+2],c=0;c<n;c++)o.push(new Ia(r,l));return o},Ia.getRsBlockTable=function(e,t){switch(t){case Ca.L:return Ia.RS_BLOCK_TABLE[4*(e-1)+0];case Ca.M:return Ia.RS_BLOCK_TABLE[4*(e-1)+1];case Ca.Q:return Ia.RS_BLOCK_TABLE[4*(e-1)+2];case Ca.H:return Ia.RS_BLOCK_TABLE[4*(e-1)+3];default:return}},Ba.prototype={get:function(e){var t=Math.floor(e/8);return 1==(this.buffer[t]>>>7-e%8&1)},put:function(e,t){for(var a=0;a<t;a++)this.putBit(1==(e>>>t-a-1&1))},getLengthInBits:function(){return this.length},putBit:function(e){var t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}},Sa.errorCorrectLevel=Ca,Ma.errorCorrectLevel=Sa.errorCorrectLevel,Ma.Error=function(e){this.errMsg="[uQRCode]: "+e},Ma.plugins=[],Ma.use=function(e){"function"==typeof e&&Ma.plugins.push(e)},Ma.prototype.loadImage=function(e){return Promise.resolve(e)},Ma.prototype.setOptions=function(e){var t,a,i,o,s,n,r,l,c,d,u,m,h,p,g,f,y,v,w,k,E,N,b,V,S,x,C,D,T,_,P,I,B,A,M,L,O,F,R,z,$,j,U,q,H,W,G,J,Y,K,Z,Q,X,ee,te,ae;e&&(Object.keys(e).forEach((t=>{this[t]=e[t]})),function(e={},t={},a=!1){let i;i=a?e:{...e};for(let s in t){var o=t[s];null!=o&&(o.constructor==Object?i[s]=this.deepReplace(i[s],o):o.constructor!=String||o?i[s]=o:i[s]=i[s])}}(this,{data:e.data||e.text,size:e.size,useDynamicSize:e.useDynamicSize,typeNumber:e.typeNumber,errorCorrectLevel:e.errorCorrectLevel,margin:e.margin,areaColor:e.areaColor,backgroundColor:e.backgroundColor||(null===(t=e.background)||void 0===t?void 0:t.color),backgroundImageSrc:e.backgroundImageSrc||(null===(a=e.background)||void 0===a||null===(i=a.image)||void 0===i?void 0:i.src),backgroundImageWidth:e.backgroundImageWidth||(null===(o=e.background)||void 0===o||null===(s=o.image)||void 0===s?void 0:s.width),backgroundImageHeight:e.backgroundImageHeight||(null===(n=e.background)||void 0===n||null===(r=n.image)||void 0===r?void 0:r.height),backgroundImageX:e.backgroundImageX||(null===(l=e.background)||void 0===l||null===(c=l.image)||void 0===c?void 0:c.x),backgroundImageY:e.backgroundImageY||(null===(d=e.background)||void 0===d||null===(u=d.image)||void 0===u?void 0:u.y),backgroundImageAlpha:e.backgroundImageAlpha||(null===(m=e.background)||void 0===m||null===(h=m.image)||void 0===h?void 0:h.alpha),backgroundImageBorderRadius:e.backgroundImageBorderRadius||(null===(p=e.background)||void 0===p||null===(g=p.image)||void 0===g?void 0:g.borderRadius),backgroundPadding:e.backgroundPadding,foregroundColor:e.foregroundColor||(null===(f=e.foreground)||void 0===f?void 0:f.color),foregroundImageSrc:e.foregroundImageSrc||(null===(y=e.foreground)||void 0===y||null===(v=y.image)||void 0===v?void 0:v.src),foregroundImageWidth:e.foregroundImageWidth||(null===(w=e.foreground)||void 0===w||null===(k=w.image)||void 0===k?void 0:k.width),foregroundImageHeight:e.foregroundImageHeight||(null===(E=e.foreground)||void 0===E||null===(N=E.image)||void 0===N?void 0:N.height),foregroundImageX:e.foregroundImageX||(null===(b=e.foreground)||void 0===b||null===(V=b.image)||void 0===V?void 0:V.x),foregroundImageY:e.foregroundImageY||(null===(S=e.foreground)||void 0===S||null===(x=S.image)||void 0===x?void 0:x.y),foregroundImagePadding:e.foregroundImagePadding||(null===(C=e.foreground)||void 0===C||null===(D=C.image)||void 0===D?void 0:D.padding),foregroundImageBackgroundColor:e.foregroundImageBackgroundColor||(null===(T=e.foreground)||void 0===T||null===(_=T.image)||void 0===_?void 0:_.backgroundColor),foregroundImageBorderRadius:e.foregroundImageBorderRadius||(null===(P=e.foreground)||void 0===P||null===(I=P.image)||void 0===I?void 0:I.borderRadius),foregroundImageShadowOffsetX:e.foregroundImageShadowOffsetX||(null===(B=e.foreground)||void 0===B||null===(A=B.image)||void 0===A?void 0:A.shadowOffsetX),foregroundImageShadowOffsetY:e.foregroundImageShadowOffsetY||(null===(M=e.foreground)||void 0===M||null===(L=M.image)||void 0===L?void 0:L.shadowOffsetY),foregroundImageShadowBlur:e.foregroundImageShadowBlur||(null===(O=e.foreground)||void 0===O||null===(F=O.image)||void 0===F?void 0:F.shadowBlur),foregroundImageShadowColor:e.foregroundImageShadowColor||(null===(R=e.foreground)||void 0===R||null===(z=R.image)||void 0===z?void 0:z.shadowColor),foregroundPadding:e.foregroundPadding,positionProbeBackgroundColor:e.positionProbeBackgroundColor||(null===($=e.positionProbe)||void 0===$?void 0:$.backgroundColor)||(null===(j=e.positionDetection)||void 0===j?void 0:j.backgroundColor),positionProbeForegroundColor:e.positionProbeForegroundColor||(null===(U=e.positionProbe)||void 0===U?void 0:U.foregroundColor)||(null===(q=e.positionDetection)||void 0===q?void 0:q.foregroundColor),separatorColor:e.separatorColor||(null===(H=e.separator)||void 0===H?void 0:H.color),positionAdjustBackgroundColor:e.positionAdjustBackgroundColor||(null===(W=e.positionAdjust)||void 0===W?void 0:W.backgroundColor)||(null===(G=e.alignment)||void 0===G?void 0:G.backgroundColor),positionAdjustForegroundColor:e.positionAdjustForegroundColor||(null===(J=e.positionAdjust)||void 0===J?void 0:J.foregroundColor)||(null===(Y=e.alignment)||void 0===Y?void 0:Y.foregroundColor),timingBackgroundColor:e.timingBackgroundColor||(null===(K=e.timing)||void 0===K?void 0:K.backgroundColor),timingForegroundColor:e.timingForegroundColor||(null===(Z=e.timing)||void 0===Z?void 0:Z.foregroundColor),typeNumberBackgroundColor:e.typeNumberBackgroundColor||(null===(Q=e.typeNumber)||void 0===Q?void 0:Q.backgroundColor)||(null===(X=e.versionInformation)||void 0===X?void 0:X.backgroundColor),typeNumberForegroundColor:e.typeNumberForegroundColor||(null===(ee=e.typeNumber)||void 0===ee?void 0:ee.foregroundColor)||(null===(te=e.versionInformation)||void 0===te?void 0:te.foregroundColor),darkBlockColor:e.darkBlockColor||(null===(ae=e.darkBlock)||void 0===ae?void 0:ae.color)},!0))},Ma.prototype.make=function(){let{foregroundColor:e,backgroundColor:a,typeNumber:i,errorCorrectLevel:o,data:s,size:n,margin:r,useDynamicSize:l}=this;if(e===a)throw t("error","at uni_modules/uv-qrcode/components/uv-qrcode/qrcode.js:34","[uQRCode]: foregroundColor and backgroundColor cannot be the same!"),new Ma.Error("foregroundColor and backgroundColor cannot be the same!");var c=new Sa(i,o);c.addData(function(e){e=e.toString();for(var t,a="",i=0;i<e.length;i++)(t=e.charCodeAt(i))>=1&&t<=127?a+=e.charAt(i):t>2047?(a+=String.fromCharCode(224|t>>12&15),a+=String.fromCharCode(128|t>>6&63),a+=String.fromCharCode(128|63&t)):(a+=String.fromCharCode(192|t>>6&31),a+=String.fromCharCode(128|63&t));return a}(s)),c.make(),this.base=c,this.typeNumber=c.typeNumber,this.modules=c.modules,this.moduleCount=c.moduleCount,this.dynamicSize=l?Math.ceil((n-2*r)/c.moduleCount)*c.moduleCount+2*r:n,function(e){let{dynamicSize:t,margin:a,backgroundColor:i,backgroundPadding:o,foregroundColor:s,foregroundPadding:n,modules:r,moduleCount:l}=e,c=(t-2*a)/l,d=c,u=0;o>0&&(u=d*o/2,d-=2*u);let m=c,h=0;n>0&&(h=m*n/2,m-=2*h);for(var p=0;p<l;p++)for(var g=0;g<l;g++){var f=g*c+a,y=p*c+a;if(r[p][g]){var v=h,w=f+h,k=y+h,E=m,N=m;r[p][g]={type:["foreground"],color:s,isBlack:!0,isDrawn:!1,destX:f,destY:y,destWidth:c,destHeight:c,x:w,y:k,width:E,height:N,paddingTop:v,paddingRight:v,paddingBottom:v,paddingLeft:v}}else v=u,w=f+u,k=y+u,E=d,N=d,r[p][g]={type:["background"],color:i,isBlack:!1,isDrawn:!1,destX:f,destY:y,destWidth:c,destHeight:c,x:w,y:k,width:E,height:N,paddingTop:v,paddingRight:v,paddingBottom:v,paddingLeft:v}}}(this),function(e){let{modules:t,moduleCount:a,positionProbeBackgroundColor:i,positionProbeForegroundColor:o}=e,s=a-7;[[0,0,1],[1,0,1],[2,0,1],[3,0,1],[4,0,1],[5,0,1],[6,0,1],[0,1,1],[1,1,0],[2,1,0],[3,1,0],[4,1,0],[5,1,0],[6,1,1],[0,2,1],[1,2,0],[2,2,1],[3,2,1],[4,2,1],[5,2,0],[6,2,1],[0,3,1],[1,3,0],[2,3,1],[3,3,1],[4,3,1],[5,3,0],[6,3,1],[0,4,1],[1,4,0],[2,4,1],[3,4,1],[4,4,1],[5,4,0],[6,4,1],[0,5,1],[1,5,0],[2,5,0],[3,5,0],[4,5,0],[5,5,0],[6,5,1],[0,6,1],[1,6,1],[2,6,1],[3,6,1],[4,6,1],[5,6,1],[6,6,1]].forEach((e=>{var a=t[e[0]][e[1]],n=t[e[0]+s][e[1]],r=t[e[0]][e[1]+s];r.type.push("positionProbe"),n.type.push("positionProbe"),a.type.push("positionProbe"),a.color=1==e[2]?o:i,n.color=1==e[2]?o:i,r.color=1==e[2]?o:i}))}(this),function(e){let{modules:t,moduleCount:a,separatorColor:i}=e;[[7,0],[7,1],[7,2],[7,3],[7,4],[7,5],[7,6],[7,7],[0,7],[1,7],[2,7],[3,7],[4,7],[5,7],[6,7]].forEach((e=>{var o=t[e[0]][e[1]],s=t[a-e[0]-1][e[1]],n=t[e[0]][a-e[1]-1];n.type.push("separator"),s.type.push("separator"),o.type.push("separator"),o.color=i,s.color=i,n.color=i}))}(this),function(e){let{typeNumber:t,modules:a,moduleCount:i,foregroundColor:o,backgroundColor:s,positionAdjustForegroundColor:n,positionAdjustBackgroundColor:r,timingForegroundColor:l,timingBackgroundColor:c}=e;const d=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]][t-1];if(d){const e=[[-2,-2,1],[-1,-2,1],[0,-2,1],[1,-2,1],[2,-2,1],[-2,-1,1],[-1,-1,0],[0,-1,0],[1,-1,0],[2,-1,1],[-2,0,1],[-1,0,0],[0,0,1],[1,0,0],[2,0,1],[-2,1,1],[-1,1,0],[0,1,0],[1,1,0],[2,1,1],[-2,2,1],[-1,2,1],[0,2,1],[1,2,1],[2,2,1]],t=d.length;for(let u=0;u<t;u++)for(let m=0;m<t;m++){let{x:t,y:h}={x:d[u],y:d[m]};t<9&&h<9||t>i-9-1&&h<9||h>i-9-1&&t<9||e.forEach((e=>{var i=a[t+e[0]][h+e[1]];i.type.push("positionAdjust"),i.type.includes("timing")?1==e[2]?i.color=n==o?l:n:i.color=n==o&&r==s?c:r:i.color=1==e[2]?n:r}))}}}(this),function(e){let{modules:t,moduleCount:a,timingForegroundColor:i,timingBackgroundColor:o}=e,s=a-16;for(let l=0;l<s;l++){var n=t[6][8+l],r=t[8+l][6];n.type.push("timing"),r.type.push("timing"),n.color=1&l^1?i:o,r.color=1&l^1?i:o}}(this),function(e){let{modules:t,moduleCount:a,darkBlockColor:i}=e;var o=t[a-7-1][8];o.type.push("darkBlock"),o.color=i}(this),function(e){let{typeNumber:t,modules:a,moduleCount:i,typeNumberBackgroundColor:o,typeNumberForegroundColor:s}=e;if(t<7)return a;const n=[0,0,0,0,0,0,0,"000111110010010100","001000010110111100","001001101010011001","001010010011010011","001011101111110110","001100011101100010","001101100001000111","001110011000001101","001111100100101000","010000101101111000","010001010001011101","010010101000010111","010011010100110010","010100100110100110","010101011010000011","010110100011001001","010111011111101100","011000111011000100","011001000111100001","011010111110101011","011011000010001110","011100110000011010","011101001100111111","011110110101110101","011111001001010000","100000100111010101","100001011011110000","100010100010111010","100011011110011111","100100101100001011","100101010000101110","100110101001100100","100111010101000001","101000110001101001"];let r=n[t]+n[t],l=[i-11,i-10,i-9];[[5,l[2]],[5,l[1]],[5,l[0]],[4,l[2]],[4,l[1]],[4,l[0]],[3,l[2]],[3,l[1]],[3,l[0]],[2,l[2]],[2,l[1]],[2,l[0]],[1,l[2]],[1,l[1]],[1,l[0]],[0,l[2]],[0,l[1]],[0,l[0]],[l[2],5],[l[1],5],[l[0],5],[l[2],4],[l[1],4],[l[0],4],[l[2],3],[l[1],3],[l[0],3],[l[2],2],[l[1],2],[l[0],2],[l[2],1],[l[1],1],[l[0],1],[l[2],0],[l[1],0],[l[0],0]].forEach(((e,t)=>{var i=a[e[0]][e[1]];i.type.push("typeNumber"),i.color="1"==r[t]?s:o}))}(this),this.isMaked=!0,this.drawModules=[]},Ma.prototype.getDrawModules=function(){if(this.drawModules&&this.drawModules.length>0)return this.drawModules;let e=this.drawModules=[],{modules:t,moduleCount:a,dynamicSize:i,areaColor:o,backgroundImageSrc:s,backgroundImageX:n,backgroundImageY:r,backgroundImageWidth:l,backgroundImageHeight:c,backgroundImageAlpha:d,backgroundImageBorderRadius:u,foregroundImageSrc:m,foregroundImageX:h,foregroundImageY:p,foregroundImageWidth:g,foregroundImageHeight:f,foregroundImagePadding:y,foregroundImageBackgroundColor:v,foregroundImageBorderRadius:w,foregroundImageShadowOffsetX:k,foregroundImageShadowOffsetY:E,foregroundImageShadowBlur:N,foregroundImageShadowColor:b}=this;o&&e.push({name:"area",type:"area",color:o,x:0,y:0,width:i,height:i}),s&&e.push({name:"backgroundImage",type:"image",imageSrc:s,mappingName:"backgroundImageSrc",x:n,y:r,width:l,height:c,alpha:d,borderRadius:u});for(var V=0;V<a;V++)for(var S=0;S<a;S++){var x=t[V][S];x.isDrawn||(x.type.includes("foreground")?e.push({name:"foreground",type:"tile",color:x.color,destX:x.destX,destY:x.destY,destWidth:x.destWidth,destHeight:x.destHeight,x:x.x,y:x.y,width:x.width,height:x.height,paddingTop:x.paddingTop,paddingRight:x.paddingRight,paddingBottom:x.paddingBottom,paddingLeft:x.paddingLeft,rowIndex:V,colIndex:S}):e.push({name:"background",type:"tile",color:x.color,destX:x.destX,destY:x.destY,destWidth:x.destWidth,destHeight:x.destHeight,x:x.x,y:x.y,width:x.width,height:x.height,paddingTop:x.paddingTop,paddingRight:x.paddingRight,paddingBottom:x.paddingBottom,paddingLeft:x.paddingLeft,rowIndex:V,colIndex:S}),x.isDrawn=!0)}return m&&e.push({name:"foregroundImage",type:"image",imageSrc:m,mappingName:"foregroundImageSrc",x:h,y:p,width:g,height:f,padding:y,backgroundColor:v,borderRadius:w,shadowOffsetX:k,shadowOffsetY:E,shadowBlur:N,shadowColor:b}),e},Ma.prototype.isBlack=function(e,t){var a=this.moduleCount;return!(0>e||0>t||e>=a||t>=a)&&this.modules[e][t].isBlack},Ma.prototype.drawCanvas=function(){let{isMaked:e,canvasContext:a,useDynamicSize:i,dynamicSize:o,foregroundColor:s,foregroundPadding:n,backgroundColor:r,backgroundPadding:l,drawReserve:c,margin:d}=this;if(!e)return t("error","at uni_modules/uv-qrcode/components/uv-qrcode/qrcode.js:34","[uQRCode]: please execute the make method first!"),Promise.reject(new Ma.Error("please execute the make method first!"));let u=this.getDrawModules(),m=async(e,i)=>{try{a.clearRect(0,0,o,o),a.draw(!1);for(var s=0;s<u.length;s++){var n=u[s];switch(a.save(),n.type){case"area":a.setFillStyle(n.color),a.fillRect(n.x,n.y,n.width,n.height);break;case"tile":var r=n.x,l=n.y,d=n.width,m=n.height;a.setFillStyle(n.color),a.fillRect(r,l,d,m);break;case"image":if("backgroundImage"===n.name){r=Math.round(n.x),l=Math.round(n.y),d=Math.round(n.width),m=Math.round(n.height),d<2*(p=Math.round(n.borderRadius))&&(p=d/2),m<2*p&&(p=m/2),a.setGlobalAlpha(n.alpha),p>0&&(a.beginPath(),a.moveTo(r+p,l),a.arcTo(r+d,l,r+d,l+m,p),a.arcTo(r+d,l+m,r,l+m,p),a.arcTo(r,l+m,r,l,p),a.arcTo(r,l,r+d,l,p),a.closePath(),a.setStrokeStyle("rgba(0,0,0,0)"),a.stroke(),a.clip());try{var h=await this.loadImage(n.imageSrc);a.drawImage(h,r,l,d,m)}catch(E){throw t("error","at uni_modules/uv-qrcode/components/uv-qrcode/qrcode.js:34",`[uQRCode]: ${n.mappingName} invalid!`),new Ma.Error(`${n.mappingName} invalid!`)}}else if("foregroundImage"===n.name){r=Math.round(n.x),l=Math.round(n.y),d=Math.round(n.width),m=Math.round(n.height);var p,g=Math.round(n.padding);d<2*(p=Math.round(n.borderRadius))&&(p=d/2),m<2*p&&(p=m/2);var f=r-g,y=l-g,v=d+2*g,w=m+2*g,k=Math.round(v/d*p);v<2*k&&(k=v/2),w<2*k&&(k=w/2),a.save(),a.setShadow(n.shadowOffsetX,n.shadowOffsetY,n.shadowBlur,n.shadowColor),k>0?(a.beginPath(),a.moveTo(f+k,y),a.arcTo(f+v,y,f+v,y+w,k),a.arcTo(f+v,y+w,f,y+w,k),a.arcTo(f,y+w,f,y,k),a.arcTo(f,y,f+v,y,k),a.closePath(),a.setFillStyle(n.backgroundColor),a.fill()):(a.setFillStyle(n.backgroundColor),a.fillRect(f,y,v,w)),a.restore(),a.save(),k>0?(a.beginPath(),a.moveTo(f+k,y),a.arcTo(f+v,y,f+v,y+w,k),a.arcTo(f+v,y+w,f,y+w,k),a.arcTo(f,y+w,f,y,k),a.arcTo(f,y,f+v,y,k),a.closePath(),a.setFillStyle(g>0?n.backgroundColor:"rgba(0,0,0,0)"),a.fill()):(a.setFillStyle(g>0?n.backgroundColor:"rgba(0,0,0,0)"),a.fillRect(f,y,v,w)),a.restore(),p>0&&(a.beginPath(),a.moveTo(r+p,l),a.arcTo(r+d,l,r+d,l+m,p),a.arcTo(r+d,l+m,r,l+m,p),a.arcTo(r,l+m,r,l,p),a.arcTo(r,l,r+d,l,p),a.closePath(),a.setStrokeStyle("rgba(0,0,0,0)"),a.stroke(),a.clip());try{h=await this.loadImage(n.imageSrc),a.drawImage(h,r,l,d,m)}catch(E){throw t("error","at uni_modules/uv-qrcode/components/uv-qrcode/qrcode.js:34",`[uQRCode]: ${n.mappingName} invalid!`),new Ma.Error(`${n.mappingName} invalid!`)}}}c&&a.draw(!0),a.restore()}a.draw(!0),setTimeout(e,150)}catch(E){if(!(E instanceof Ma.Error))throw E;i(E)}};return new Promise(((e,t)=>{m(e,t)}))},Ma.prototype.draw=function(){return this.drawCanvas()},Ma.prototype.register=function(e){e&&e(Ma,this,!0)};const Oa=new La,Fa=new La,Ra=[];let za=null;const $a={name:"uv-qrcode",mixins:[{},ba,Kt],emits:["click","change","complete"],data:()=>({canvasId:"",canvas:void 0,canvasType:void 0,canvasContext:void 0,makeDelegate:void 0,drawDelegate:void 0,toTempFilePathDelegate:void 0,makeExecuted:!1,makeing:!1,drawing:!1,isError:!1,error:void 0,isH5Save:!1,tempFilePath:"",templateOptions:{size:0,width:0,height:0,canvasWidth:0,canvasHeight:0,canvasTransform:"",canvasDisplay:!1},uqrcodeOptions:{data:""},plugins:[],makeingPattern:[[[!0,!0,!0,!1,!1,!1,!1,!0,!0,!0],[!0,!0,!0,!1,!1,!1,!1,!0,!0,!0],[!0,!0,!0,!1,!1,!1,!1,!0,!0,!0],[!0,!0,!0,!1,!1,!1,!1,!0,!0,!0],[!0,!0,!0,!1,!1,!1,!1,!0,!0,!0],[!0,!0,!0,!1,!1,!1,!1,!0,!0,!0],[!0,!0,!0,!1,!1,!1,!1,!0,!0,!0],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0]],[[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0],[!0,!0,!0,!1,!1,!1,!1,!0,!0,!0],[!0,!0,!0,!1,!1,!1,!1,!0,!0,!0],[!0,!0,!0,!1,!1,!1,!1,!0,!0,!0],[!0,!0,!0,!1,!1,!1,!1,!1,!1,!1],[!0,!0,!0,!0,!0,!0,!1,!0,!0,!0],[!0,!0,!0,!0,!0,!0,!1,!0,!0,!0],[!0,!0,!0,!0,!0,!0,!1,!0,!0,!0]],[[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0],[!0,!0,!0,!1,!1,!1,!1,!0,!0,!0],[!0,!0,!0,!1,!1,!1,!1,!0,!0,!0],[!0,!0,!0,!0,!0,!0,!0,!1,!1,!1],[!0,!0,!0,!0,!0,!0,!0,!1,!1,!1],[!0,!0,!0,!0,!0,!0,!0,!1,!1,!1],[!0,!0,!0,!1,!1,!1,!1,!0,!0,!0],[!0,!0,!0,!1,!1,!1,!1,!0,!0,!0]],[[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0],[!0,!0,!0,!1,!1,!1,!1,!1,!1,!1],[!0,!0,!0,!1,!1,!1,!1,!1,!1,!1],[!0,!0,!0,!1,!1,!1,!1,!1,!1,!1],[!0,!0,!0,!1,!1,!1,!1,!1,!1,!1],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0]]]}),watch:{type:{handler(e){["2d"].includes(e)?this.canvasType=e:this.canvasType=void 0},immediate:!0},value:{handler(){this.auto&&this.remake()}},size:{handler(){this.auto&&this.remake()}},options:{handler(){this.auto&&this.remake()},deep:!0},makeing:{handler(e){e||"function"==typeof this.toTempFilePathDelegate&&this.toTempFilePathDelegate()}}},created(){this.canvasId=this.$uv.guid()},mounted(){this.templateOptions.size=this.$uv.getPx(this.size),this.templateOptions.width=this.templateOptions.size,this.templateOptions.height=this.templateOptions.size,this.templateOptions.canvasWidth=this.templateOptions.size,this.templateOptions.canvasHeight=this.templateOptions.size,this.canvasType,this.templateOptions.canvasTransform=`scale(${this.templateOptions.size/this.templateOptions.canvasWidth}, ${this.templateOptions.size/this.templateOptions.canvasHeight})`,this.start&&this.$nextTick((()=>{this.make()}))},methods:{getTemplateOptions(){var e=this.$uv.getPx(this.size);return ja(this.templateOptions,{size:e,width:e,height:e})},getUqrcodeOptions(){return ja(this.options,{data:String(this.value),size:Number(this.templateOptions.size)})},resetCanvas(e){this.templateOptions.canvasDisplay=!1,this.$nextTick((()=>{this.templateOptions.canvasDisplay=!0,this.$nextTick((()=>{e&&e()}))}))},async draw(e={},a=!1){if("function"!=typeof e.success&&(e.success=()=>{}),"function"!=typeof e.fail&&(e.fail=()=>{}),"function"!=typeof e.complete&&(e.complete=()=>{}),this.drawing){if(!a)return void(this.drawDelegate=()=>{this.draw(e,!0)})}else this.drawing=!0;if(!this.canvasId)return t("error","at uni_modules/uv-qrcode/components/uv-qrcode/uv-qrcode.vue:325","[uQRCode]: canvasId must be set!"),this.isError=!0,this.drawing=!1,e.fail({errMsg:"[uQRCode]: canvasId must be set!"}),void e.complete({errMsg:"[uQRCode]: canvasId must be set!"});if(!this.value)return t("error","at uni_modules/uv-qrcode/components/uv-qrcode/uv-qrcode.vue:337","[uQRCode]: value must be set!"),this.isError=!0,this.drawing=!1,e.fail({errMsg:"[uQRCode]: value must be set!"}),void e.complete({errMsg:"[uQRCode]: value must be set!"});this.templateOptions=this.getTemplateOptions(),this.uqrcodeOptions=this.getUqrcodeOptions(),"string"==typeof this.uqrcodeOptions.errorCorrectLevel&&(this.uqrcodeOptions.errorCorrectLevel=Ma.errorCorrectLevel[this.uqrcodeOptions.errorCorrectLevel]),void 0===this.options.useDynamicSize&&(this.uqrcodeOptions.useDynamicSize=!0);const i=za=new Ma;this.plugins.forEach((e=>i.register(e.plugin))),i.setOptions(this.uqrcodeOptions),i.make();let o=null;"2d"===this.canvasType?(o=this.canvasContext=uni.createCanvasContext(this.canvasId,this),this.templateOptions.canvasWidth=i.dynamicSize,this.templateOptions.canvasHeight=i.dynamicSize,this.templateOptions.canvasTransform=`scale(${this.templateOptions.size/this.templateOptions.canvasWidth}, ${this.templateOptions.size/this.templateOptions.canvasHeight})`,i.loadImage=this.getLoadImage((function(e){return new Promise(((a,i)=>{if(e.startsWith("http"))uni.getImageInfo({src:e,success:e=>{a(e.path)},fail:e=>{i(e)}});else{if(e.startsWith("."))throw t("error","at uni_modules/uv-qrcode/components/uv-qrcode/uv-qrcode.vue:448","[uQRCode]: 本地图片路径仅支持绝对路径！"),new Error("[uQRCode]: local image path only supports absolute path!");a(e)}}))}))):(o=this.canvasContext=uni.createCanvasContext(this.canvasId,this),this.templateOptions.canvasWidth=i.dynamicSize,this.templateOptions.canvasHeight=i.dynamicSize,this.templateOptions.canvasTransform=`scale(${this.templateOptions.size/this.templateOptions.canvasWidth}, ${this.templateOptions.size/this.templateOptions.canvasHeight})`,i.loadImage=this.getLoadImage((function(e){return new Promise(((a,i)=>{if(e.startsWith("http"))uni.getImageInfo({src:e,success:e=>{a(e.path)},fail:e=>{i(e)}});else{if(e.startsWith("."))throw t("error","at uni_modules/uv-qrcode/components/uv-qrcode/uv-qrcode.vue:481","[uQRCode]: 本地图片路径仅支持绝对路径！"),new Error("[uQRCode]: local image path only supports absolute path!");a(e)}}))}))),i.canvasContext=o,setTimeout((()=>{var a=this.plugins.find((e=>e.name==i.style)),o=a?a.drawCanvas:"drawCanvas";(this.queue?()=>Oa.exec((()=>i[o]())):()=>i[o]())().then((()=>{if(this.drawDelegate){let e=this.drawDelegate;this.drawDelegate=void 0,e()}else this.drawing=!1,e.success()})).catch((a=>{if(t("log","at uni_modules/uv-qrcode/components/uv-qrcode/uv-qrcode.vue:553",a),this.drawDelegate){let e=this.drawDelegate;this.drawDelegate=void 0,e()}else this.drawing=!1,this.isError=!0,e.fail(a)})).finally((()=>{e.complete()}))}),300)},make(e={}){this.makeExecuted=!0,this.makeing=!0,this.isError=!1,"function"!=typeof e.success&&(e.success=()=>{}),"function"!=typeof e.fail&&(e.fail=()=>{}),"function"!=typeof e.complete&&(e.complete=()=>{}),this.resetCanvas((()=>{clearTimeout(this.makeDelegate),this.makeDelegate=setTimeout((()=>{this.draw({success:()=>{setTimeout((()=>{e.success(),this.complete(!0)}),300)},fail:t=>{e.fail(t),this.error=t,this.complete(!1,t.errMsg)},complete:()=>{e.complete(),this.makeing=!1}})}),300)}))},remake(e){this.$emit("change"),this.make(e)},complete(e=!0,t=""){e?this.$emit("complete",{success:e}):this.$emit("complete",{success:e,errMsg:t})},toTempFilePath(e={}){if("function"!=typeof e.success&&(e.success=()=>{}),"function"!=typeof e.fail&&(e.fail=()=>{}),"function"!=typeof e.complete&&(e.complete=()=>{}),!this.makeExecuted){t("error","at uni_modules/uv-qrcode/components/uv-qrcode/uv-qrcode.vue:648","[uQRCode]: make() 方法从未调用！请先成功调用 make() 后再进行操作。");var a={errMsg:"[uQRCode]: make() method has never been executed! please execute make() successfully before operating."};return e.fail(a),void e.complete(a)}if(this.isError)return e.fail(this.error),void e.complete(this.error);this.makeing?this.toTempFilePathDelegate=()=>{this.toTempFilePath(e)}:(this.toTempFilePathDelegate=null,"2d"===this.canvasType||uni.canvasToTempFilePath({canvasId:this.canvasId,fileType:this.fileType,width:Number(this.templateOptions.canvasWidth),height:Number(this.templateOptions.canvasHeight),destWidth:Number(this.templateOptions.size),destHeight:Number(this.templateOptions.size),success:t=>{e.success(t)},fail:t=>{e.fail(t)},complete:()=>{e.complete()}},this))},save(e={}){"function"!=typeof e.success&&(e.success=()=>{}),"function"!=typeof e.fail&&(e.fail=()=>{}),"function"!=typeof e.complete&&(e.complete=()=>{}),this.toTempFilePath({success:t=>{"2d"===this.canvasType||uni.saveImageToPhotosAlbum({filePath:t.tempFilePath,success:t=>{e.success(t)},fail:t=>{e.fail(t)},complete:()=>{e.complete()}})},fail:t=>{e.fail(t),e.complete(t)}})},onClick(e){this.$emit("click",e)},getInstance:()=>za,registerStyle(e){if("style"!=e.Type)return t("warn","at uni_modules/uv-qrcode/components/uv-qrcode/uv-qrcode.vue:850","[uQRCode]: registerStyle 仅支持注册 style 类型的扩展！"),{errMsg:"registerStyle 仅支持注册 style 类型的扩展！"};"function"==typeof e&&this.plugins.push({plugin:e,name:e.Name,drawCanvas:e.DrawCanvas})},getLoadImage(e){var t=this;return"function"==typeof e?function(a){return t.isQueueLoadImage?Fa.exec((()=>new Promise(((t,i)=>{setTimeout((()=>{const o=Ra.find((e=>e.src==a));o?t(o.img):e(a).then((e=>{Ra.push({src:a,img:e}),t(e)})).catch((e=>{i(e)}))}),10)})))):e(a)}:function(e){return Promise.resolve(e)}}}};function ja(e={},t={},a=!1){let i;i=a?e:{...e};for(let s in t){var o=t[s];null!=o&&(o.constructor==Object?i[s]=this.deepReplace(i[s],o):o.constructor!=String||o?i[s]=o:i[s]=i[s])}return i}const Ua=W($a,[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["uqrcode",{"uqrcode-hide":t.hide}]),style:e.normalizeStyle({width:`${s.templateOptions.width}px`,height:`${s.templateOptions.height}px`})},[e.createElementVNode("view",{class:"uqrcode-canvas-wrapper"},[s.templateOptions.canvasDisplay?(e.openBlock(),e.createElementBlock("canvas",{key:0,class:"uqrcode-canvas",id:s.canvasId,"canvas-id":s.canvasId,type:s.canvasType,style:e.normalizeStyle({width:`${s.templateOptions.canvasWidth}px`,height:`${s.templateOptions.canvasHeight}px`,transform:s.templateOptions.canvasTransform}),onClick:a[0]||(a[0]=(...e)=>n.onClick&&n.onClick(...e))},null,12,["id","canvas-id","type"])):e.createCommentVNode("",!0)]),(void 0!==t.loading&&t.loading?t.loading:s.makeing)?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uqrcode-makeing"},[e.renderSlot(t.$slots,"loading",{},(()=>[e.createElementVNode("image",{class:"uqrcode-makeing-image",style:e.normalizeStyle({width:s.templateOptions.size/4+"px",height:s.templateOptions.size/4+"px"}),src:"data:image/gif;base64,R0lGODlhAAEAAfIEAOHh4SSsWuDg4N3d3f///wAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDYuMC1jMDAyIDc5LjE2NDQ4OCwgMjAyMC8wNy8xMC0yMjowNjo1MyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDIyLjAgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjAyODhGMzM4RDEwMTExRUM4MDhCRkVBQkE2QUZDQzkwIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjAyODhGMzM5RDEwMTExRUM4MDhCRkVBQkE2QUZDQzkwIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MDI4OEYzMzZEMTAxMTFFQzgwOEJGRUFCQTZBRkNDOTAiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MDI4OEYzMzdEMTAxMTFFQzgwOEJGRUFCQTZBRkNDOTAiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4B//79/Pv6+fj39vX08/Lx8O/u7ezr6uno5+bl5OPi4eDf3t3c29rZ2NfW1dTT0tHQz87NzMvKycjHxsXEw8LBwL++vby7urm4t7a1tLOysbCvrq2sq6qpqKempaSjoqGgn56dnJuamZiXlpWUk5KRkI+OjYyLiomIh4aFhIOCgYB/fn18e3p5eHd2dXRzcnFwb25tbGtqaWhnZmVkY2JhYF9eXVxbWllYV1ZVVFNSUVBPTk1MS0pJSEdGRURDQkFAPz49PDs6OTg3NjU0MzIxMC8uLSwrKikoJyYlJCMiISAfHh0cGxoZGBcWFRQTEhEQDw4NDAsKCQgHBgUEAwIBAAAh+QQFFAAEACwAAAAAAAEAAQAD/0i63P4wykmrvTjrzbv/YCiOZGmeaKqubOu+cCzPdG3feK7vfO//wKBwSCwaj8ikcslsOp/QqHRKrVqv2Kx2y+16v+CweEwum8/otHrNbrvf8Lh8Tq/b7/i8fs/v+/+AgYKDhIWGh4iJiouMjY6PkJGSk5SVlpeYmZqbnJ2en6ChoqOkpaanigCqq6ytrieusbISAbW2t7i5uru8vb66bLLCrLDDw7S/ycrLzLXBxsLF0LHIzdbXzc/Trybb1BHY4eK92t6r0uaq1ePs4+Xp6PDg7fTh7+bx+PP1/Mz33vkA7utH0Ne/bQERDizIMNfBaQkhLmxIMcBDaBExTqzI8P+isYwfN3Ik6PFYt3TnRI7kVzLaSZQA1q0s2HLWS5QyZ/ar+a0ETHUqdbLjyc3nz5xC6RFtBdIkhKQ01/yMeVPeU6g7pR6tqu8q1npLiXEV6PVru7ApjcJEquyEPa1rxyosm83EWzVTm7qk688uNrRA1eIMatDvNcBUBVt9cJdEYzR55Urku8ztX7iDFXdlfLnE4zORNZPlfNiwNcR6bVJua7ou3q2i55I+3brv67ixJ8927bhzmtAkgDv4HIJ4GeEikDMw/oH5GOUgoCtw3oF6GOkesFvfsP0L9g7afY/o7uU7h/ClPYsHDTt4++Hri8c//j55/eXzm+d/fj96/+n/+1UX4HX/ZVcgeRggyIV5G6BHmycMauAgb5xEmMGEtnViIQYYVvbJhhd0yBqEBYJ34ICUgGiBiMmAomIFLP7iYonnnZiehjQ2aOODOE7l449MERbVai1iBuSRO67EVpG3IenkYvDptKSMRj5pZUhENjRlYU1e6aVqu420JTlVfmlmYGFyNCYviJ2ZWZoVrblLm25uFuVMcgJTZp1X5gmWkGzuyeeTfioF6JyCDopkoWcdqmeXilrJ6FCOOpRopD9O6k6luNCJ6V5wUqSpRZd+mqSYnN7iqalFhaplqrasyqpYWXYEqzOlzmpnA0mNKquuiblqa61kQgrsqWreSqqx/8e+eaeSyqIi7bTUVmvttdhmq+223Hbr7bejCCDuuOSWa+656Kar7rrnSjDAu/DGK++89NZr77340vsru/z2224E+QYs8MAEw7uvvwj3627BDDfM8MEJR5zuwg5XbHG9EEusMbkUX+zxxRlvvHHHH5f8cK4ip+wvySa3HHDIKifMsss0Y4xyzDijO3PNPBt8c85Aj7tzzzzDHPS6QxNNs9FHTwyw0lAPwHTT/0IQNdRTU11u0ld/nLXWQj/dddE/g50y12Nb/LXZaKft8Npgt+32ycyafbTccxMMt9Z45y3w3lT37Xe+qEnGruDxzihxalU/ULHiETNuLuI+k7i44f9Ii013j5Fjri7l70Ius+dOW/32hxpLvrXmBYuOsOocs6436pfndrjsA7u+Muk64/437Z3bnrnpDeuuMO+NO/A48KML/7nvLzP/OvKTQ0+49Ls7X7rjp1sevHu1c1889sdr3zvxm1eYOvWro986+fzCHrb7s3vfPPjfK9895/ePMLL1+DKe3c6Hv/fZb4DPM5++4IfA9hWwfvxrIAH9tz/1STCBD8wdAy8oNfYlboMXlF/oQChBEXbwgByMnQLnJcAUmrCFHDTh4FhYNrZ5cIY2q5sLb4hDGuowhjzs4Qd/GMIgCnGERCyhEY8IOAxS8IgVZE8Kk2cfKI4viQ2UIRPAaxi3JQqxiXcDoBXtVbgVOlB/YzTgb9ZnRhWKL40axCIVQ/A/+sExgFwU1wvFeMchrjF8T8xfA/oYxz8Kko5sfCMh71XGDJZPkYvMoSH7V8VDLiCS15Nj9do4P0hiUl6NDCQlGfBJRoLrlKhMpSpXycpWuvKVsIylLGdJy1ra8pa4zKUud8nLXvryl8AMpjCHScxiGvOYyEymMpfJzGY685nQjKY0p0nNalrzmtjMpja3yc1uevOb4AynOMdJhwQAACH5BAUUAAQALDIAMgCcAJwAAAP/KLrcTjDKSWt0OFsIuv9gKI5kaZ6Ztq1s6iorKs90/apsTt1pbP/AIA+mK16Gj41wyWwan8ikpUmtRp/GaMNn7Xq3WJ2Wwf2arWHxmDg9u6np3JpdeduX8da8fO8j83xXSn6EQ4CDa4GFi2CHO3uIjJJkjo+JkZOTlZZjipmFmxNzAp6ffqESo6Wmd6hHl22sjK4ckLGyoLSqmLh9tAS7t72+urZ1QL+LycacNcuEz528M9HErsHHP9WtxbDZNtt24YbTMuNu5zerJulm7S7rJe9e8zjfzt2n+VrxJPVo+wQJo/GvSsFG9wgGFLeQ3EBqDdFFVFcOxUEnE1/0G3GR/0lHOs0UXss10ltIiCX1peRX8cRHIS83iniJLVRNUcgyfonZkp1Oej/tnTT3K87NSkdfgSuaJukhp8ByMsUCNQ/UIFPDVDXKDKe2rFC6IhWrFB/YIlubkq319awak5uuSnWrB+5Yu2VF0pUpBZXctnt7jhqMl63KhMMIU3z4hm9ixY4xMn6sGENkj4IpVyaVuctlzdImn/kMWiDixp1L/z08VPVm0lhTuw59WqLo2YNhz22NO7dsOL9789ANmLfwwlGhBT8Obzke58wtQ499O/qf6bu9WvddHWj37RqxF9cOHrky8ZvTs/wOkH2IwPDjy59Pv779+/jz69/Pv7////8ABijggAQWaOCBCCao4FQDNOjggxBGKOGEFFZooYQrBKDhhhx26OGHIIYo4ogfXmjiiSim6GCGJLbo4oswaqjijDTSyGKMOOYYY4089ljhjToGKWSJPhZpJJBDJimkkUz2iKSSUO7Y5JQqPhnllSRSqeWJVmLpJZFbhjlhl1+WKaOYaEJIpplfpulmg2uyieWbbsYpZ5R0pmnnnUrmieaefA7pp5iABhrkoGEWamiOiG6p6KJSNjrlo5C+KCmVlFba4qWTbqCpl5w2memnIvLIkwVB6mdqUBh6qqOqNZ5aQar5rbpSiqMGAKuNrEaY664zykoBrfjZ6lesruYIbJX/vaqZLI7L4trsg7/WiuytKFZb7LXH8orqq9Z6222wz8YYbbbTrlgujOdymS6c677YronCTkDsfcbaxO2w4G4rrr7/2tsvvvvGVbAE99qXr8EBIzywwgc7srDDyoZLLrbufluxv6EOUFTC9XWsLi0g0ycyvCQ/HPLJH6tsMsu/lDzfyR7H7PLMMKe8McEit7wzxD3b/PPKQesMrcWh+kxqnzm7sjSeTaPyNJQ0Kz31oVGHcnWSVQu9tY5dG/01jmE7PTbYWW9yNtpFm712pDQ3HMHbZEf8lN0E0A03sxjTG6/eIU4sMd6AW4q3VYQXvunhXMkNgeKLOw6I4I9DPiLlGZMnbnngjKsl+ealdq6V5qB7iDnin5f+YQIAIfkEBRQABAAsMgAyAJwAnAAAA/84utxOMMpJa3Q4Wyi6/2AojmRpnpm2rWzqKisqz3T9qmxO3Wls/8AgD6YrXoaPjXDJbBqfyKSlSa1Gn8Zow2fterdYnZbB/ZqtYfGYOD27qencml1525fx1rx87yPzfFdKfoRDgINrgYWLYIc7e4iMkmSOj4mRk5OVlmOKmYWbE3MDnp9+oRKjpaZ3qEeXbayMrhyQsbKgtKqYuH20BLu3vb66tnVAv4vJxpw1y4TPnbwz0cSuwcc/1a3FsNk223bhhtMy427nN6sm6WbtLusl717zON/O3af5WvEk9Wj7BAmj8a9KwUb3CAYUt5DcQGoN0UVUVw7FQScTX/QbcZH/SUc6zRReyzXSW0iIJfWl5FfxxEchLzeKeIktVE1RyDJ+idmSnU56P+2dNPcrzs1KR1+BK5om6SGnwHIyxQI1D9QgU8NUNcoMp7asULoiFasUH9giW5uSrfX1rBqTm65KdasH7li7ZUXSlSkFldy2e3uOGoyXrcqEwwhTfPiGb2LFjjEyfqwYQ2SPgilXJpW5y2XN0iaf+QxaIOLGnUv/PTxU9WbSWFO7Dn1aoujZg2HPbY07t2w4v3vz0A2Yt/DCUaEFPw5vOR7nzC1Dj307+p/pu71a910daPftGrEX1w4euTLxm9Oz/A6QfYjA8OPLn0+/vv37+PPr38+/v////wAGKOCABBZo4IEIJqjgVAE06OCDEEYo4YQUVmihhMQBoOGGHHbo4YcghsjhhSSWaOKJDmYo4oostqghijDGGKOKLtZo44sy5qgjhTTe6OOKOwYpZAA9/mikh0MmKWORRzYJgJJQnsikk0ZGaeWFU1Lp45VcTpilljZ2KeaDX4Lp4pholmkmi2iOqeaaIrYp5ptwgihnl3TWieSdV+ap54h8WunnnzgGCuWghBoaJaJ/KnooeoTW6KiSjOo5aZKV1pnjL5tCp1+nroBaG4ufLkmLqMaJWOqMp5rqXoerwsipq6OuGCuKs7L6Koe3StmqrrWqmh+qmxCbipG9mpirrP+eDktrKMbmVWOyJS6La7P4RXuItsn5SC2J1vq664bfYvkrs+NqWK6F4SqL7X3c5sHtketW2G6179oXbxzzIusssNA+S56N9fJ47rXpAlCwlweLG2yIC7fJU7aXkhnUhxGnebGHGbu5Maz/Vkzkx7yGXPHE8IrcIMr6qjzySgSbfCnL9bn8sl/+UqwyTZHeaDPPPUvqMtBBt/gzyUVvOTTSSYe5NMxNr3k01FGDOTXOVWv6NNZZS721TV3DaXO/YZu5bxpkl63l2WGkrbaTbGPh9ttHxv3E3HT/aLcReOfts8CV9O230AAXC7i0gxOOLiqCJ87m4dtC3q3jThceuOQElP+YAAAh+QQFFAAEACwyADIAnACcAAAD/xi63E4wyklrdDhbOLr/YCiOZGmKWcpsbEuoMHvOdG17sOruVJ7Kt6Aw6NPwjq/iYzNsOkvKJXIXbQCfWGx1NaVuFdesWPgFd13lQHjMpqXP6PK6TSe94ay7pc6HyvEbehV9hCGCgBOHE4WMHYqIEI8RjYySiJYElIWYeJiahJxwnp98oWejpHSmXaipbKtTra5isEiys1p/kIm6g7hjtUe3v03BPMM0uxTFvcpJX3M1zhLM0NORzYtD1xxDxl7We9vc1Vvcz+ZM49flVefIM+ftUe/Z1OvT80r14b5C8t7sQYJ3AiAZgZcQZsLnTF8RfunE/SMXsJ8zgiYMElHYSf9hE403vsWxqG0iu4oRp2EsAdKGyBYrSbSs8TKPR4bKHPqA6E6dyXwoe16LOWKmG46ibv5sGJQeN6IijM6oGUhpkHMdSe6CGgJrUq0Drd7wegppWbDdlpIFl/KiWBtrY5ll9VZaXGFz5aJdqPZu1b1Z25a86petUJV1kxUeKXhr4niLYaaZTFmKP03RjlbePDkzIc8nOIt+3Ae0idGonUrE7HNj6tc6WlMy7Qe2bcvLSNG2c7v3gt1tgKPw7Vv4GOMgiBeX3Qj5B+W9nWOR7gi6bepOsFu/zpyR9u2vsX/srhn8aPE47x00f578Z/eh2bdfPRv+afmi0fed1BQ/VzH/3/lXmX6E0eeSgAPaV0eACP6XBXaRRSjhhBRWaOGFGGao4YYcdujhhyCGKOKIJJZo4okopqjiimQB4OKLMMYo44w01mjjjTMSKMCOPPbo449ABinkkDgWaeSROOpI5JJMNonkk1BGqaSTVFYZ5ZVY3jillVx2meWXSG7p5Zhkgmmmi2KWqeaZbBqZ5ppwtilnjG/GaeecbNZ55554Yqknn4D2eeSfgRYqaI2EGqrooS8muiijkDr6KKSCSjoppXNaeimmeSq46aec2qgpqKH66SmpqJYKwKipqjroqa3yKVWSsP64oaknSVmrj7deOauWu/bYq665QgmhhrgCRexl/1UOayxFy+bGpbNP/ipqsDxSGya0zxropLavFlsttjuC6ya343rbpLlFWosouQKwS6u426rLpLzA0hsus1Tie62+59q7pL/vAtwuvATT6K7CCCPrK7r18vutw9Hm9LDARCacI8T7SmulxjIuvDHGQ4JMJ8cBS7wuxa6GjPK9LLcMo8i2xiwzmi8PbPPNNPO6s8w9C/tzy0FnO7SrRZd7tKpJx7t0qU2bzGjUT4fadKxYn2xw1lwfvHXXYDP8ddhkN5pz2WhfjTbQZ68dttpuM9123De7PDbddZvJatZUk4x3xbsk6/Hfa/atMuGCWww4f4gXPrfYhzferbKTDy554hmBXxz55R0rXvlgnGvO1OJphS665+luTncCADs="},null,4)]),!0)])):e.createCommentVNode("",!0),s.isError?(e.openBlock(),e.createElementBlock("view",{key:1,class:"uqrcode-error",onClick:a[1]||(a[1]=(...e)=>n.onClick&&n.onClick(...e))},[e.renderSlot(t.$slots,"error",{error:s.error},(()=>[e.createElementVNode("text",{class:"uqrcode-error-message"},e.toDisplayString(s.error.errMsg),1)]),!0)])):e.createCommentVNode("",!0)],6)}],["__scopeId","data-v-6d3c00fe"]]);class qa{constructor(e,t){this.options=e,this.animation=uni.createAnimation({...e}),this.currentStepAnimates={},this.next=0,this.$=t}_nvuePushAnimates(e,t){let a=this.currentStepAnimates[this.next],i={};if(i=a||{styles:{},config:{}},Ha.includes(e)){i.styles.transform||(i.styles.transform="");let a="";"rotate"===e&&(a="deg"),i.styles.transform+=`${e}(${t+a}) `}else i.styles[e]=`${t}`;this.currentStepAnimates[this.next]=i}_animateRun(e={},t={}){let a=this.$.$refs.ani.ref;if(a)return new Promise(((i,o)=>{nvueAnimation.transition(a,{styles:e,...t},(e=>{i()}))}))}_nvueNextAnimate(e,t=0,a){let i=e[t];if(i){let{styles:o,config:s}=i;this._animateRun(o,s).then((()=>{t+=1,this._nvueNextAnimate(e,t,a)}))}else this.currentStepAnimates={},"function"==typeof a&&a(),this.isEnd=!0}step(e={}){return this.animation.step(e),this}run(e){this.$.animationData=this.animation.export(),this.$.timer=setTimeout((()=>{"function"==typeof e&&e()}),this.$.durationTime)}}const Ha=["matrix","matrix3d","rotate","rotate3d","rotateX","rotateY","rotateZ","scale","scale3d","scaleX","scaleY","scaleZ","skew","skewX","skewY","translate","translate3d","translateX","translateY","translateZ"];function Wa(e,t){if(t)return clearTimeout(t.timer),new qa(e,t)}Ha.concat(["opacity","backgroundColor"],["width","height","left","right","top","bottom"]).forEach((e=>{qa.prototype[e]=function(...t){return this.animation[e](...t),this}}));const Ga=W({name:"uniTransition",emits:["click","change"],props:{show:{type:Boolean,default:!1},modeClass:{type:[Array,String],default:()=>"fade"},duration:{type:Number,default:300},styles:{type:Object,default:()=>({})},customClass:{type:String,default:""},onceRender:{type:Boolean,default:!1}},data:()=>({isShow:!1,transform:"",opacity:1,animationData:{},durationTime:300,config:{}}),watch:{show:{handler(e){e?this.open():this.isShow&&this.close()},immediate:!0}},computed:{stylesObject(){let e={...this.styles,"transition-duration":this.duration/1e3+"s"},t="";for(let a in e){t+=this.toLine(a)+":"+e[a]+";"}return t},transformStyles(){return"transform:"+this.transform+";opacity:"+this.opacity+";"+this.stylesObject}},created(){this.config={duration:this.duration,timingFunction:"ease",transformOrigin:"50% 50%",delay:0},this.durationTime=this.duration},methods:{init(e={}){e.duration&&(this.durationTime=e.duration),this.animation=Wa(Object.assign(this.config,e),this)},onClick(){this.$emit("click",{detail:this.isShow})},step(e,a={}){if(this.animation){for(let a in e)try{"object"==typeof e[a]?this.animation[a](...e[a]):this.animation[a](e[a])}catch(ms){t("error","at uni_modules/uni-transition/components/uni-transition/uni-transition.vue:148",`方法 ${a} 不存在`)}return this.animation.step(a),this}},run(e){this.animation&&this.animation.run(e)},open(){clearTimeout(this.timer),this.transform="",this.isShow=!0;let{opacity:e,transform:t}=this.styleInit(!1);void 0!==e&&(this.opacity=e),this.transform=t,this.$nextTick((()=>{this.timer=setTimeout((()=>{this.animation=Wa(this.config,this),this.tranfromInit(!1).step(),this.animation.run(),this.$emit("change",{detail:this.isShow})}),20)}))},close(e){this.animation&&this.tranfromInit(!0).step().run((()=>{this.isShow=!1,this.animationData=null,this.animation=null;let{opacity:e,transform:t}=this.styleInit(!1);this.opacity=e||1,this.transform=t,this.$emit("change",{detail:this.isShow})}))},styleInit(e){let t={transform:""},a=(e,a)=>{"fade"===a?t.opacity=this.animationType(e)[a]:t.transform+=this.animationType(e)[a]+" "};return"string"==typeof this.modeClass?a(e,this.modeClass):this.modeClass.forEach((t=>{a(e,t)})),t},tranfromInit(e){let t=(e,t)=>{let a=null;"fade"===t?a=e?0:1:(a=e?"-100%":"0","zoom-in"===t&&(a=e?.8:1),"zoom-out"===t&&(a=e?1.2:1),"slide-right"===t&&(a=e?"100%":"0"),"slide-bottom"===t&&(a=e?"100%":"0")),this.animation[this.animationMode()[t]](a)};return"string"==typeof this.modeClass?t(e,this.modeClass):this.modeClass.forEach((a=>{t(e,a)})),this.animation},animationType:e=>({fade:e?0:1,"slide-top":`translateY(${e?"0":"-100%"})`,"slide-right":`translateX(${e?"0":"100%"})`,"slide-bottom":`translateY(${e?"0":"100%"})`,"slide-left":`translateX(${e?"0":"-100%"})`,"zoom-in":`scaleX(${e?1:.8}) scaleY(${e?1:.8})`,"zoom-out":`scaleX(${e?1:1.2}) scaleY(${e?1:1.2})`}),animationMode:()=>({fade:"opacity","slide-top":"translateY","slide-right":"translateX","slide-bottom":"translateY","slide-left":"translateX","zoom-in":"scale","zoom-out":"scale"}),toLine:e=>e.replace(/([A-Z])/g,"-$1").toLowerCase()}},[["render",function(t,a,i,o,s,n){return e.withDirectives((e.openBlock(),e.createElementBlock("view",{ref:"ani",animation:s.animationData,class:e.normalizeClass(i.customClass),style:e.normalizeStyle(n.transformStyles),onClick:a[0]||(a[0]=(...e)=>n.onClick&&n.onClick(...e))},[e.renderSlot(t.$slots,"default")],14,["animation"])),[[e.vShow,s.isShow]])}]]),Ja={name:"uniPopup",components:{},emits:["change","maskClick"],props:{animation:{type:Boolean,default:!0},type:{type:String,default:"center"},isMaskClick:{type:Boolean,default:null},maskClick:{type:Boolean,default:null},backgroundColor:{type:String,default:"none"},safeArea:{type:Boolean,default:!0},maskBackgroundColor:{type:String,default:"rgba(0, 0, 0, 0.4)"},borderRadius:{type:String}},watch:{type:{handler:function(e){this.config[e]&&this[this.config[e]](!0)},immediate:!0},isDesktop:{handler:function(e){this.config[e]&&this[this.config[this.type]](!0)},immediate:!0},maskClick:{handler:function(e){this.mkclick=e},immediate:!0},isMaskClick:{handler:function(e){this.mkclick=e},immediate:!0},showPopup(e){}},data(){return{duration:300,ani:[],showPopup:!1,showTrans:!1,popupWidth:0,popupHeight:0,config:{top:"top",bottom:"bottom",center:"center",left:"left",right:"right",message:"top",dialog:"center",share:"bottom"},maskClass:{position:"fixed",bottom:0,top:0,left:0,right:0,backgroundColor:"rgba(0, 0, 0, 0.4)"},transClass:{backgroundColor:"transparent",borderRadius:this.borderRadius||"0",position:"fixed",left:0,right:0},maskShow:!0,mkclick:!0,popupstyle:"top"}},computed:{getStyles(){let e={backgroundColor:this.bg};return this.borderRadius,e=Object.assign(e,{borderRadius:this.borderRadius}),e},isDesktop(){return this.popupWidth>=500&&this.popupHeight>=500},bg(){return""===this.backgroundColor||"none"===this.backgroundColor?"transparent":this.backgroundColor}},mounted(){(()=>{const{windowWidth:e,windowHeight:t,windowTop:a,safeArea:i,screenHeight:o,safeAreaInsets:s}=uni.getSystemInfoSync();this.popupWidth=e,this.popupHeight=t+(a||0),i&&this.safeArea?this.safeAreaInsets=s.bottom:this.safeAreaInsets=0})()},unmounted(){this.setH5Visible()},activated(){this.setH5Visible(!this.showPopup)},deactivated(){this.setH5Visible(!0)},created(){null===this.isMaskClick&&null===this.maskClick?this.mkclick=!0:this.mkclick=null!==this.isMaskClick?this.isMaskClick:this.maskClick,this.animation?this.duration=300:this.duration=0,this.messageChild=null,this.clearPropagation=!1,this.maskClass.backgroundColor=this.maskBackgroundColor},methods:{setH5Visible(e=!0){},closeMask(){this.maskShow=!1},disableMask(){this.mkclick=!1},clear(e){e.stopPropagation(),this.clearPropagation=!0},open(e){if(this.showPopup)return;e&&-1!==["top","center","bottom","left","right","message","dialog","share"].indexOf(e)||(e=this.type),this.config[e]?(this[this.config[e]](),this.$emit("change",{show:!0,type:e})):t("error","at uni_modules/uni-popup/components/uni-popup/uni-popup.vue:298","缺少类型：",e)},close(e){this.showTrans=!1,this.$emit("change",{show:!1,type:this.type}),clearTimeout(this.timer),this.timer=setTimeout((()=>{this.showPopup=!1}),300)},touchstart(){this.clearPropagation=!1},onTap(){this.clearPropagation?this.clearPropagation=!1:(this.$emit("maskClick"),this.mkclick&&this.close())},top(e){this.popupstyle=this.isDesktop?"fixforpc-top":"top",this.ani=["slide-top"],this.transClass={position:"fixed",left:0,right:0,backgroundColor:this.bg,borderRadius:this.borderRadius||"0"},e||(this.showPopup=!0,this.showTrans=!0,this.$nextTick((()=>{this.messageChild&&"message"===this.type&&this.messageChild.timerClose()})))},bottom(e){this.popupstyle="bottom",this.ani=["slide-bottom"],this.transClass={position:"fixed",left:0,right:0,bottom:0,paddingBottom:"0px",backgroundColor:this.bg,borderRadius:this.borderRadius||"0"},e||(this.showPopup=!0,this.showTrans=!0)},center(e){this.popupstyle="center",this.ani=["zoom-out","fade"],this.transClass={position:"fixed",display:"flex",flexDirection:"column",bottom:0,left:0,right:0,top:0,justifyContent:"center",alignItems:"center",borderRadius:this.borderRadius||"0"},e||(this.showPopup=!0,this.showTrans=!0)},left(e){this.popupstyle="left",this.ani=["slide-left"],this.transClass={position:"fixed",left:0,bottom:0,top:0,backgroundColor:this.bg,borderRadius:this.borderRadius||"0",display:"flex",flexDirection:"column"},e||(this.showPopup=!0,this.showTrans=!0)},right(e){this.popupstyle="right",this.ani=["slide-right"],this.transClass={position:"fixed",bottom:0,right:0,top:0,backgroundColor:this.bg,borderRadius:this.borderRadius||"0",display:"flex",flexDirection:"column"},e||(this.showPopup=!0,this.showTrans=!0)}}};const Ya=W(Ja,[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-transition"),Ga);return n.showPopup?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["uni-popup",[n.popupstyle,r.isDesktop?"fixforpc-z-index":""]])},[e.createElementVNode("view",{onTouchstart:i[1]||(i[1]=(...e)=>r.touchstart&&r.touchstart(...e))},[n.maskShow?(e.openBlock(),e.createBlock(l,{key:"1",name:"mask","mode-class":"fade",styles:n.maskClass,duration:n.duration,show:n.showTrans,onClick:r.onTap},null,8,["styles","duration","show","onClick"])):e.createCommentVNode("",!0),e.createVNode(l,{key:"2","mode-class":n.ani,name:"content",styles:n.transClass,duration:n.duration,show:n.showTrans,onClick:r.onTap},{default:e.withCtx((()=>[e.createElementVNode("view",{class:e.normalizeClass(["uni-popup__wrapper",[n.popupstyle]]),style:e.normalizeStyle(r.getStyles),onClick:i[0]||(i[0]=(...e)=>r.clear&&r.clear(...e))},[e.renderSlot(t.$slots,"default",{},void 0,!0)],6)])),_:3},8,["mode-class","styles","duration","show","onClick"])],32)],2)):e.createCommentVNode("",!0)}],["__scopeId","data-v-59a5a597"]]);const Ka=W({data:()=>({tabs1:["全部","待支付","待收货","已完成"],stastatus:[0,1,3,4],tabs1Current:0,pageData:[],searData:[],out_trade_no:"",searchOrderNumber:null}),mixins:[ge],onLoad(e){if(this.orderStatus=e.orderStatus,this.orderStatus){const e=this.stastatus.indexOf(Number(this.orderStatus));-1!==e&&(this.tabs1Current=e)}this.reloadData()},computed:{buyButtonText(){let e="";switch(this.tabs1Current){case 0:e="再买一单";break;case 1:e="去支付";break;case 2:e="确认收货";break;case 3:e="已完成"}return e}},methods:{clearSearch(){this.searData=[],this.searchOrderNumber=null,this.reloadData()},async sendSearch(){let e={isshow:1,limit:100,page:1,status:1,out_trade_no:this.searchOrderNumber};const{data:a}=await l.myorders(e);t("log","at pages/orders/orders.vue:171","开始搜索",a.listdata),this.searData=a.listdata},goPay(e){switch(this.out_trade_no=e.out_trade_no,e.status){case 1:if("再买一单"==this.buyButtonText)return"";uni.navigateTo({url:`/subPackages/PaymentModule/collectOnDelivery/collectOnDelivery?out_trade_no=${e.out_trade_no}`});break;case 2:case 3:this.$refs.popup.open("center")}},initTime(e){let t=new Date(e).getTime();var a=10===String(t).length?new Date(1e3*parseInt(t)):new Date(parseInt(t)),i=a.getFullYear(),o=a.getMonth()+1;o<10&&(o="0"+o);var s=a.getDate();s<10&&(s="0"+s);var n=a.getHours();n<10&&(n="0"+n);var r=a.getMinutes();r<10&&(r="0"+r);var l=a.getSeconds();return l<10&&(l="0"+l),i+"-"+o+"-"+s+" "+n+":"+r+":"+l},handleTabChange(e){this.tabs1Current=e,this.reloadData()},async fetchData(e){const t={...e};0!==this.tabs1Current&&(t.status=this.stastatus[this.tabs1Current]);return(await l.myorders(t)).data}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-easyinput"),He),c=a(e.resolveDynamicComponent("uni-section"),Yt),d=a(e.resolveDynamicComponent("uni-icons"),K),u=a(e.resolveDynamicComponent("uv-qrcode"),Ua),m=a(e.resolveDynamicComponent("uni-popup"),Ya);return e.openBlock(),e.createElementBlock("view",{class:"me-container"},[e.createElementVNode("view",{class:"b-tabs"},[e.createElementVNode("scroll-view",{"scroll-x":""},[e.createElementVNode("view",{class:"b-tabs-container"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.tabs1,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["b-tabs-item",{"b-tabs-active":n.tabs1Current==a}]),key:a,onClick:e=>r.handleTabChange(a)},e.toDisplayString(t),11,["onClick"])))),128))])])]),e.createVNode(c,{title:"查询",type:"line",padding:""},{default:e.withCtx((()=>[e.createVNode(l,{prefixIcon:"search",modelValue:n.searchOrderNumber,"onUpdate:modelValue":i[0]||(i[0]=e=>n.searchOrderNumber=e),placeholder:"请输入订单号",onIconClick:t.iconClick,onChange:r.sendSearch,onClear:r.clearSearch},null,8,["modelValue","onIconClick","onChange","onClear"])])),_:1}),e.createElementVNode("scroll-view",{class:"Stallholder","scroll-y":"true",onScrolltolower:i[1]||(i[1]=(...e)=>t.handleScrollToLower&&t.handleScrollToLower(...e)),style:{height:"100vh"}},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.pageData,(t=>e.withDirectives((e.openBlock(),e.createElementBlock("view",{class:"list",key:t.id},[e.createElementVNode("view",{class:"Order-number"},[e.createElementVNode("text",{class:"orderstitle"},"订单号 "),e.createTextVNode(" "+e.toDisplayString(t.out_trade_no),1)]),e.createElementVNode("view",{class:"title"},[e.createElementVNode("view",null,e.toDisplayString(t.shop_name),1),e.createVNode(d,{type:"right",size:"20"})]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.list_arr,(t=>(e.openBlock(),e.createElementBlock("view",{class:"content",key:t.id},[e.createElementVNode("image",{class:"logo",src:t.imglogo,mode:"aspectFill"},null,8,["src"]),e.createElementVNode("view",{class:"info"},[e.createElementVNode("view",{class:"cgname"},e.toDisplayString(t.goodsname),1),e.createElementVNode("view",{class:"detail"},e.toDisplayString(t.content),1)]),e.createElementVNode("view",{class:"amount"},[e.createElementVNode("view",null,"¥ "+e.toDisplayString(t.price),1),e.createElementVNode("view",null,"× "+e.toDisplayString(t.goodsnum),1)])])))),128)),e.createElementVNode("view",{class:"orderTime"},"下单时间:"+e.toDisplayString(r.initTime(t.createtime)),1),e.createElementVNode("view",{class:"pay"},[e.createElementVNode("view",{class:"paydetail"},[1===t.payway?(e.openBlock(),e.createElementBlock("view",{key:0},"积分支付 ")):(e.openBlock(),e.createElementBlock("view",{key:1},"其他支付方式")),e.createElementVNode("view",{class:"Payprice"},e.toDisplayString(10*t.payprice),1)])]),e.createElementVNode("view",{class:"butt"},[e.createElementVNode("view",{class:"buy",onClick:e=>r.goPay(t)},e.toDisplayString(r.buyButtonText),9,["onClick"])])])),[[e.vShow,0==n.searData.length]]))),128)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.searData,(t=>e.withDirectives((e.openBlock(),e.createElementBlock("view",{class:"list"},[e.createElementVNode("view",{class:"Order-number"},[e.createElementVNode("text",{class:"orderstitle"},"订单号 "),e.createTextVNode(" "+e.toDisplayString(t.out_trade_no),1)]),e.createElementVNode("view",{class:"title"},[e.createElementVNode("view",null,e.toDisplayString(t.shop_name),1),e.createVNode(d,{type:"right",size:"20"})]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.list_arr,(t=>(e.openBlock(),e.createElementBlock("view",{class:"content",key:t.id},[e.createElementVNode("image",{class:"logo",src:t.imglogo,mode:"aspectFill"},null,8,["src"]),e.createElementVNode("view",{class:"info"},[e.createElementVNode("view",{class:"cgname"},e.toDisplayString(t.goodsname),1),e.createElementVNode("view",{class:"detail"},e.toDisplayString(t.content),1)]),e.createElementVNode("view",{class:"amount"},[e.createElementVNode("view",null,"¥ "+e.toDisplayString(t.price),1),e.createElementVNode("view",null,"× "+e.toDisplayString(t.goodsnum),1)])])))),128)),e.createElementVNode("view",{class:"orderTime"},"下单时间:"+e.toDisplayString(r.initTime(t.createtime)),1),e.createElementVNode("view",{class:"pay"},[e.createElementVNode("view",{class:"paydetail"},[1===t.payway?(e.openBlock(),e.createElementBlock("view",{key:0},"积分支付 ")):(e.openBlock(),e.createElementBlock("view",{key:1},"其他支付方式")),e.createElementVNode("view",{class:"Payprice"},e.toDisplayString(10*t.payprice),1)])]),e.createElementVNode("view",{class:"butt"},[e.createElementVNode("view",{class:"buy",onClick:e=>r.goPay(t)},e.toDisplayString(r.buyButtonText),9,["onClick"])])],512)),[[e.vShow,0!=n.searData.length]]))),256))],32),e.createVNode(m,{ref:"popup"},{default:e.withCtx((()=>[e.createElementVNode("view",{style:{"background-color":"white",border:"1rpx","border-radius":"5%",padding:"50rpx"}},[e.createElementVNode("view",{style:{"text-align":"center","font-size":"30rpx",padding:"5rpx"}},"取货核销码"),e.createElementVNode("view",{class:"card",style:{"background-color":"white",border:"1rpx","border-radius":"5%"}},[e.createVNode(u,{value:n.out_trade_no},null,8,["value"])])])])),_:1},512)])}]]);const Za=W({data:()=>({pageData:[],shopId:0}),onLoad(e){this.token=uni.getStorageSync("token"),this.shopId=e.id,this.reloadData()},mixins:[ge],methods:{async fetchData(e){return(await l.myShoplist({...e,shop_id:Number(this.shopId),isshow:1})).data},async off(e){try{const t=await l.xiajiashop({id:e,isshow:2});if(200===t.code){uni.showToast({title:"下架成功",icon:"success"});const t=this.pageData.findIndex((t=>t.id===e));-1!==t&&(this.pageData[t].isshow=0),this.reloadData()}else uni.showToast({title:t.msg||"操作失败",icon:"none"})}catch(a){uni.showToast({title:"请求失败",icon:"none"}),t("error","at pages/Stalls-dishes/Stalls-dishes.vue:91","下架失败",a)}}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"me-container"},[e.createElementVNode("scroll-view",{class:"Stallholder","scroll-y":"true",onScrolltolower:a[0]||(a[0]=(...e)=>t.handleScrollToLower&&t.handleScrollToLower(...e)),style:{height:"100vh"}},[e.createElementVNode("view",{class:"disheslist"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.pageData,(t=>(e.openBlock(),e.createElementBlock("view",{class:"type",key:t.id},[e.createElementVNode("image",{class:"type-image",src:t.imglogo,mode:"scaleToFill"},null,8,["src"]),e.createElementVNode("view",{class:"regard"},[e.createElementVNode("view",{class:"typetitle"},e.toDisplayString(t.commodity_name),1),e.createElementVNode("view",{class:"typetitle"},e.toDisplayString(t.price.toFixed(2))+" 元/斤 ",1)]),e.createElementVNode("view",{class:"function"},[e.createElementVNode("view",{class:e.normalizeClass({rigicon:!0,disabled:0===t.isshow}),onClick:e=>1===t.isshow&&n.off(t.id)},e.toDisplayString(1===t.isshow?"下架":"已下架"),11,["onClick"])])])))),128)),t.pageLoading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading"},"加载中...")):e.createCommentVNode("",!0),t.hasMore?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:1,class:"loading"},"没有更多了"))])],32)])}]]);const Qa=W({data:()=>({pageData:[],isloaded:!1}),onLoad(){this.isloaded=!0},onShow(){this.token=uni.getStorageSync("token"),this.reloadData()},mixins:[ge],methods:{fetchData:async e=>(await l.myShoplist({...e,isshow:1})).data,goToRoute(e){uni.navigateTo({url:e})},async off(e){try{const t=await l.xiajiashop({id:e,isshow:2});if(200===t.code){uni.showToast({title:"下架成功",icon:"success"});const t=this.pageData.findIndex((t=>t.id===e));-1!==t&&(this.pageData[t].isshow=0),this.reloadData()}else uni.showToast({title:t.msg||"操作失败",icon:"none"})}catch(a){uni.showToast({title:"请求失败",icon:"none"}),t("error","at pages/Listed-Dishes/Listed-Dishes.vue:104","下架失败",a)}}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"me-container"},[e.createElementVNode("scroll-view",{class:"Stallholder","scroll-y":"true",onScrolltolower:a[0]||(a[0]=(...e)=>t.handleScrollToLower&&t.handleScrollToLower(...e)),style:{height:"100vh"}},[e.createElementVNode("view",{class:"disheslist"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.pageData,(t=>(e.openBlock(),e.createElementBlock("view",{class:"type",key:t.id},[s.isloaded?(e.openBlock(),e.createElementBlock("image",{key:0,class:"type-image","lazy-load":"",src:t.imglogo},null,8,["src"])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"regard"},[e.createElementVNode("view",{class:"typetitle"},e.toDisplayString(t.commodity_name),1),e.createElementVNode("view",{class:"typetitle"},e.toDisplayString(t.price.toFixed(2))+" 元/"+e.toDisplayString(t.weight_name),1)]),e.createElementVNode("view",{class:"function"},[e.createElementVNode("view",{class:e.normalizeClass({rigicon:!0,disabled:0===t.isshow}),onClick:e=>1===t.isshow&&n.off(t.id)},e.toDisplayString(1===t.isshow?"下架":"已下架"),11,["onClick"])])])))),128)),t.pageLoading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading"},"加载中...")):e.createCommentVNode("",!0),t.hasMore?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:1,class:"loading"},"没有更多了"))])],32)])}]]);const Xa=W({data:()=>({pageData:[],selectedCoupon:null}),onShow(){this.reloadData()},mixins:[ge],methods:{fetchData:async e=>(await l.mycoupon(e)).data,toggleSelection(e){this.selectedCoupon===e.id?(this.selectedCoupon=null,uni.removeStorageSync("coupon")):(this.selectedCoupon=e.id,uni.setStorageSync("coupon",[e]))},gotobuy(){null!==this.selectedCoupon?uni.redirectTo({url:`/pages/Buy/Buy?id=${this.selectedCoupon}`}):uni.showToast({title:"请选择优惠券",icon:"none"})}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"me-container"},[e.createElementVNode("view",{class:"content"},[e.createElementVNode("scroll-view",{class:"Stallholder","scroll-y":"true",onScrolltolower:a[0]||(a[0]=(...e)=>t.handleScrollToLower&&t.handleScrollToLower(...e)),style:{height:"100vh"}},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.pageData,(t=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["yhq",t.isUse?"use":""]),key:t.id,onClick:e=>n.toggleSelection(t)},[e.createElementVNode("view",{class:"left"}," ￥"+e.toDisplayString(t.price),1),e.createElementVNode("view",{class:"right"},[e.createElementVNode("view",{class:"tit"},e.toDisplayString(t.coupon_name),1),e.createElementVNode("view",{class:"desc"},[e.createElementVNode("view",{class:"p"}," 有效期至: 2025年10月1日 ")])]),e.createElementVNode("checkbox",{checked:s.selectedCoupon===t.id,onChange:e=>n.toggleSelection(t)},null,40,["checked","onChange"])],10,["onClick"])))),128)),t.pageLoading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading"},"加载中...")):e.createCommentVNode("",!0),t.hasMore?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:1,class:"loading"},"没有更多了"))],32)]),e.createElementVNode("view",{class:"ent",onClick:a[1]||(a[1]=(...e)=>n.gotobuy&&n.gotobuy(...e))}," 确认 ")])}]]);const ei=W({data:()=>({isSignedIn:!1,timestamp:"",time:""}),onLoad(e){e.time&&(this.time=e.time),this.signIn()},methods:{async signIn(e){}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"me-container"},[e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"state"},e.toDisplayString(s.isSignedIn?"已打卡":"此次未打卡"),1)])])}]]);const ti=W({data:()=>({pageData:[]}),onShow(){this.reloadData()},mixins:[ge],methods:{fetchData:async e=>(await l.signlist(e)).data,formatPhoneNumber:e=>e?e.replace(/(\d{3})\d{4}(\d{4})/,"$1****$2"):"",formatDate:e=>e.replace(/T/," ").replace(/(\+\d{2}:\d{2})/,""),gotojackpot(){uni.navigateTo({url:"/pages/jackpot/jackpot"})}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"me-container"},[e.createElementVNode("view",{class:"title"}," 打卡记录 "),e.createElementVNode("view",{class:"records"},[e.createElementVNode("view",{class:"market"}," 打卡市场 "),e.createElementVNode("view",{class:"time"}," 时间 ")]),e.createElementVNode("scroll-view",{class:"Stallholder","scroll-y":"true",onScrolltolower:a[0]||(a[0]=(...e)=>t.handleScrollToLower&&t.handleScrollToLower(...e)),style:e.normalizeStyle({height:"calc(90vh - 200rpx)"})},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.pageData,(t=>(e.openBlock(),e.createElementBlock("view",{class:"record-item",key:t.id},[e.createElementVNode("view",{class:"market"},e.toDisplayString(t.marketname),1),e.createElementVNode("view",{class:"time"},e.toDisplayString(n.formatDate(t.Created)),1)])))),128))],36),e.createElementVNode("view",{class:"lottery",onClick:a[1]||(a[1]=(...e)=>n.gotojackpot&&n.gotojackpot(...e))}," 免费抽奖 ")])}]]);const ai=W({data:()=>({pageData:[]}),computed:{sum(){let e=0;return this.pageData.forEach((t=>{1==t.isadd?e+=t.score:e-=t.score})),e}},onShow(){this.reloadData()},mixins:[ge],methods:{fetchData:async e=>(await l.scorelist(e)).data,formatPhoneNumber:e=>e?e.replace(/(\d{3})\d{4}(\d{4})/,"$1****$2"):"",formatDate:e=>e.replace(/T/," ").replace(/(\+\d{2}:\d{2})/,""),gotojackpot(){uni.navigateTo({url:"/pages/jackpot/jackpot"})}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"me-container"},[e.createElementVNode("view",{class:"title"}," 积分记录 "),e.createElementVNode("view",{class:"records"},[e.createElementVNode("view",{class:"market"}," 积分标题 "),e.createElementVNode("view",{class:"usejifen"}," 使用记录 "),e.createElementVNode("view",{class:"time"}," 时间 ")]),e.createElementVNode("scroll-view",{class:"Stallholder","scroll-y":"true",onScrolltolower:a[0]||(a[0]=(...e)=>t.handleScrollToLower&&t.handleScrollToLower(...e)),style:e.normalizeStyle({height:"calc(90vh - 200rpx)"})},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.pageData,(t=>(e.openBlock(),e.createElementBlock("view",{class:"record-item",key:t.id},[e.createElementVNode("view",{class:"market"},e.toDisplayString(t.memo),1),e.createElementVNode("view",{class:"usejifen"},[e.createElementVNode("view",{class:e.normalizeClass(["judgment",1===t.isadd?"green-text":"red-text"])},e.toDisplayString(1===t.isadd?"+":"-")+" "+e.toDisplayString(1===t.isadd?t.after-t.before:t.before-t.after),3)]),e.createElementVNode("view",{class:"time"},e.toDisplayString(n.formatDate(t.Created)),1)])))),128)),t.pageLoading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading"},"加载中...")):e.createCommentVNode("",!0),t.hasMore?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:1,class:"loading"},"剩余积分:"+e.toDisplayString(n.sum),1))],36),e.createElementVNode("view",{class:"lottery",onClick:a[1]||(a[1]=(...e)=>n.gotojackpot&&n.gotojackpot(...e))}," 免费抽奖 ")])}]]);const ii=W({data:()=>({tabs1:["全部","待支付","已完成"],stastatus:[0,1,3,5,6],tabs1Current:0,pageData:[]}),mixins:[ge],onLoad(e){if(this.orderStatus=e.orderStatus,this.orderStatus){const e=this.stastatus.indexOf(Number(this.orderStatus));-1!==e&&(this.tabs1Current=e)}this.reloadData()},methods:{initTime(e){let t=new Date(e).getTime();var a=10===String(t).length?new Date(1e3*parseInt(t)):new Date(parseInt(t)),i=a.getFullYear(),o=a.getMonth()+1;o<10&&(o="0"+o);var s=a.getDate();s<10&&(s="0"+s);var n=a.getHours();n<10&&(n="0"+n);var r=a.getMinutes();r<10&&(r="0"+r);var l=a.getSeconds();return l<10&&(l="0"+l),i+"-"+o+"-"+s+" "+n+":"+r+":"+l},handleTabChange(e){this.tabs1Current=e,this.reloadData()},async fetchData(e){const t={...e};0!==this.tabs1Current&&(t.status=this.stastatus[this.tabs1Current]);return(await l.shopoder(t)).data}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"me-container"},[e.createElementVNode("view",{class:"b-tabs"},[e.createElementVNode("scroll-view",{"scroll-x":""},[e.createElementVNode("view",{class:"b-tabs-container"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.tabs1,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["b-tabs-item",{"b-tabs-active":n.tabs1Current==a}]),key:a,onClick:e=>r.handleTabChange(a)},e.toDisplayString(t),11,["onClick"])))),128))])])]),e.createElementVNode("scroll-view",{class:"Stallholder","scroll-y":"true",onScrolltolower:i[0]||(i[0]=(...e)=>t.handleScrollToLower&&t.handleScrollToLower(...e)),style:{height:"100vh"}},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.pageData,(t=>(e.openBlock(),e.createElementBlock("view",{class:"list",key:t.id},[e.createElementVNode("view",{class:"Order-number"},[e.createElementVNode("text",{class:"orderstitle"},"订单号 "),e.createTextVNode(" "+e.toDisplayString(t.out_trade_no),1)]),e.createElementVNode("view",{class:"title"},[e.createElementVNode("view",null,e.toDisplayString(t.shop_name),1),e.createVNode(l,{type:"right",size:"20"})]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.list_arr,(t=>(e.openBlock(),e.createElementBlock("view",{class:"content",key:t.id},[e.createElementVNode("image",{class:"logo",src:t.imglogo,mode:"aspectFill"},null,8,["src"]),e.createElementVNode("view",{class:"info"},[e.createElementVNode("view",{class:"cgname"},e.toDisplayString(t.goodsname),1),e.createElementVNode("view",{class:"detail"},e.toDisplayString(t.content),1)]),e.createElementVNode("view",{class:"amount"},[e.createElementVNode("view",null,"¥ "+e.toDisplayString(t.price),1),e.createElementVNode("view",null,"× "+e.toDisplayString(t.goodsnum),1)])])))),128)),e.createElementVNode("view",{class:"orderTime"},"下单时间:"+e.toDisplayString(r.initTime(t.createtime)),1),e.createElementVNode("view",{class:"pay"},[e.createElementVNode("view",{class:"paydetail"},[1===t.payway?(e.openBlock(),e.createElementBlock("view",{key:0},"积分支付 ")):(e.openBlock(),e.createElementBlock("view",{key:1},"其他支付方式")),e.createElementVNode("view",{class:"Payprice"},e.toDisplayString(10*t.payprice),1)])]),e.createElementVNode("view",{class:"butt"},[e.createElementVNode("view",{class:"buy"},e.toDisplayString(n.tabs1[n.tabs1Current]),1)])])))),128))],32)])}]]);const oi=W({data:()=>({shopmoney:null,mymoney:null}),onLoad(){l.mymoney({}).then((({data:e})=>{this.mymoney=e.mymoney,this.shopmoney=e.shopmoney}))},methods:{goToBillRecord(){uni.navigateTo({url:"/subPackages/boothOwner/billRecord/billRecord"})},goToweChatCashwWithdrawal(){uni.navigateTo({url:"/pages/weChatCashwWithdrawal/weChatCashwWithdrawal"})}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"me-container"},[e.createElementVNode("view",{class:"asset"},[e.createElementVNode("view",{class:"card"},[e.createElementVNode("view",{class:"Total-assets"},[e.createElementVNode("text",null,"总资产(元)"),e.createElementVNode("view",{class:"money"},e.toDisplayString(n.shopmoney),1)]),e.createElementVNode("view",{class:"bottom"},[e.createElementVNode("view",{class:"recharge"},[e.createElementVNode("text",null,"累积收益"),e.createElementVNode("view",{class:"Cumulative-top-ups"}," 0.00 ")]),e.createElementVNode("view",{class:"consume"},[e.createElementVNode("text",null,"可提现"),e.createElementVNode("view",{class:"Cumulative-top-ups"},e.toDisplayString(n.shopmoney),1)])])]),e.createElementVNode("view",{class:"item"},[e.createElementVNode("view",{class:"Recording",onClick:i[0]||(i[0]=(...e)=>r.goToBillRecord&&r.goToBillRecord(...e))},[e.createVNode(l,{"custom-prefix":"iconfont",type:"icon-wodexiaofei",size:"30",color:"#007aff"}),e.createElementVNode("text",{class:"text"},"账单记录")]),e.createElementVNode("view",{class:"Recording"},[e.createVNode(l,{"custom-prefix":"iconfont",type:"icon-xiaofeijifenmingxi",size:"30",color:"#007aff",onClick:r.goToweChatCashwWithdrawal},null,8,["onClick"]),e.createElementVNode("text",{class:"text"},"申请提现")])])])])}]]);const si=W({data:()=>({pagedata:{truemoney:0,pagedata:0}}),onShow(){this.fetchData()},methods:{goTopagesSettrecords(){uni.navigateTo({url:"/pages/Settrecords/Settrecords"})},async fetchData(){try{const e=await l.mysorce();this.pagedata=e.data}catch(e){t("error","at pages/Points/Points.vue:78","获取积分数据失败：",e)}},gotoPointspayouts(){uni.navigateTo({url:"/pages/pointspayouts/pointspayouts"})}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"me-container"},[e.createElementVNode("view",{class:"asset"},[e.createElementVNode("view",{class:"card"},[e.createElementVNode("view",{class:"Total-assets"},[e.createElementVNode("text",null,"总积分"),e.createElementVNode("view",{class:"money"},e.toDisplayString(n.pagedata.score.toFixed(1)),1)]),e.createElementVNode("view",{class:"bottom"},[e.createElementVNode("view",{class:"recharge"},[e.createElementVNode("text",null,"累积收益"),e.createElementVNode("view",{class:"Cumulative-top-ups"}," 0 ")]),e.createElementVNode("view",{class:"consume"},[e.createElementVNode("text",null,"可提现"),e.createElementVNode("view",{class:"Cumulative-top-ups"},e.toDisplayString(n.pagedata.truemoney.toFixed(1)),1)]),e.createElementVNode("view",{class:"Not-received"},[e.createElementVNode("text",null,"已结算"),e.createElementVNode("view",{class:"Cumulative-top-ups"},e.toDisplayString(n.pagedata.paymoney),1)])])]),e.createElementVNode("view",{class:"item"},[e.createElementVNode("view",{class:"Recording",onClick:i[0]||(i[0]=(...e)=>r.goTopagesSettrecords&&r.goTopagesSettrecords(...e))},[e.createVNode(l,{"custom-prefix":"iconfont",type:"icon-wodexiaofei",size:"30",color:"#007aff"}),e.createElementVNode("text",{class:"text"},"账单记录")]),e.createElementVNode("view",{class:"Recording",onClick:i[1]||(i[1]=(...e)=>r.gotoPointspayouts&&r.gotoPointspayouts(...e))},[e.createVNode(l,{"custom-prefix":"iconfont",type:"icon-xiaofeijifenmingxi",size:"30",color:"#007aff"}),e.createElementVNode("text",{class:"text"},"积分结算")])])])])}]]);const ni=W({data:()=>({pagedata:{hasmoney:0},displayValue:""}),mounted(){this.fetchData()},computed:{displayValueConvert:function(){return(this.displayValue/10).toFixed(1)||0}},methods:{handleWithdrawAll(){this.displayValue=this.pagedata.hasmoney.toFixed(1)},async fetchData(){try{const e=await l.mysorce();this.pagedata=e.data}catch(e){t("error","at pages/pointspayouts/pointspayouts.vue:165","获取积分数据失败：",e)}},async submitSettlement(){if(!this.displayValue||isNaN(this.displayValue)||Number(this.displayValue)<=0)return void uni.showToast({title:"请输入有效的积分数",icon:"none"});const e=Number(this.displayValue);if(e<100)uni.showToast({title:"积分必须大于100",icon:"none"});else try{const t=await l.settlement({shopscore:e});200===t.code?uni.showToast({title:"积分结算申请成功",icon:"success"}):uni.showToast({title:t.message||"积分结算失败",icon:"none"})}catch(a){t("error","at pages/pointspayouts/pointspayouts.vue:205","提交请求失败",a),uni.showToast({title:"提交请求失败，请稍后重试",icon:"none"})}},gotoSettrecords(){uni.navigateTo({url:"/pages/Settrecords/Settrecords"})}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"me-container"},[e.createElementVNode("view",{class:"input-section"},[e.createElementVNode("view",{class:"input-box"},[e.withDirectives(e.createElementVNode("input",{class:"input-field",type:"number","onUpdate:modelValue":i[0]||(i[0]=e=>n.displayValue=e),placeholder:"可提现总积分为 "+(n.pagedata.hasmoney.toFixed(1)||"0"),inputmode:"numeric"},null,8,["placeholder"]),[[e.vModelText,n.displayValue,void 0,{number:!0}]]),e.createElementVNode("text",{class:"withdraw-all",onClick:i[1]||(i[1]=(...e)=>r.handleWithdrawAll&&r.handleWithdrawAll(...e))},"提现全部")])]),e.createElementVNode("view",{class:"amount-display"},[e.createElementVNode("text",{class:"amount-label"},"积分转换后的额度(元)"),e.createElementVNode("view",{class:"amount-value"},e.toDisplayString(r.displayValueConvert),1)]),e.createElementVNode("view",{class:"action-section"},[e.createElementVNode("view",{class:"submit-btn",onClick:i[2]||(i[2]=(...e)=>r.submitSettlement&&r.submitSettlement(...e))},"申请结算")]),e.createElementVNode("view",{class:"record-section",onClick:i[3]||(i[3]=(...e)=>r.gotoSettrecords&&r.gotoSettrecords(...e))},[e.createElementVNode("text",{class:"record-text"},"积分结算记录"),e.createVNode(l,{type:"arrowright",size:"16",color:"#666"})])])}]]),ri="/static/empty.png";const li=W({data:()=>({pageData:[],isLoading:!1}),onShow(){this.reloadData()},mixins:[ge],methods:{fetchData:async e=>(await l.shopsorcelist(e)).data,formatDate:e=>e.replace(/T/," ").replace(/(\+\d{2}:\d{2})/,""),getStatusLabel(e){switch(e){case 1:return"申请中";case 2:return"已结算";default:return""}}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"me-container"},[e.createElementVNode("view",{class:"page-title"},"积分结算记录"),e.createElementVNode("view",{class:"table-container"},[e.createElementVNode("view",{class:"table-header"},[e.createElementVNode("view",{class:"table-col time-col"},"时间"),e.createElementVNode("view",{class:"table-col amount-col"},"金额"),e.createElementVNode("view",{class:"table-col status-col"},"状态")]),e.createElementVNode("scroll-view",{class:"table-body","scroll-y":"true",onScrolltolower:a[0]||(a[0]=(...e)=>t.handleScrollToLower&&t.handleScrollToLower(...e)),style:e.normalizeStyle({height:"calc(100vh - 200rpx)"})},[s.isLoading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading"},[e.createElementVNode("view",{class:"spinner"}),e.createElementVNode("text",null,"加载中...")])):e.createCommentVNode("",!0),s.isLoading||0!==s.pageData.length?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-state"},[e.createElementVNode("image",{src:ri,mode:"widthFix",class:"empty-img"}),e.createElementVNode("text",null,"暂无结算记录")])),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.pageData,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"table-row",key:t.id},[e.createElementVNode("view",{class:"table-col time-col"},[e.createElementVNode("text",{class:"date"},e.toDisplayString(n.formatDate(t.Created).split(" ")[0]),1),e.createElementVNode("text",{class:"time"},e.toDisplayString(n.formatDate(t.Created).split(" ")[1]),1)]),e.createElementVNode("view",{class:"table-col amount-col"},[e.createElementVNode("text",{class:"amount"},e.toDisplayString(t.shopscore/10),1),e.createElementVNode("text",{class:"unit"},"元")]),e.createElementVNode("view",{class:"table-col status-col"},[e.createElementVNode("view",{class:e.normalizeClass(["status-tag",1===t.status?"pending":"completed"])},e.toDisplayString(n.getStatusLabel(t.status)),3)])])))),128)),t.hasMore?(e.openBlock(),e.createElementBlock("view",{key:2,class:"load-more"},[e.createElementVNode("view",{class:"spinner small"}),e.createElementVNode("text",null,"加载更多...")])):e.createCommentVNode("",!0)],36)])])}]]),ci={data:()=>({marketList:[],pickerRange1:[],selectedCategoryIndex1:0,isImageSelected:!1,isImageSelected2:!1,facelogo:"",isSubmitting:!1,businesslogo:""}),mounted(){this.fetchMarketList()},methods:{async customizeBack(){let e=await getCurrentPages();t("log","at pages/editshop/editshop.vue:56",e),e&&e.length>1?uni.navigateBack():history.back()},onMarketChange(e){this.selectedCategoryIndex1=e.detail.value},async fetchMarketList(){try{const e={limit:100,page:1},a=await l.getMyShops({...e});if(200===a.code){const e=a.data.listdata.map((e=>({id:e.id,title:e.title})));this.marketList=e,this.pickerRange1=[...e.map((e=>e.title))]}else t("error","at pages/editshop/editshop.vue:87","Failed to fetch market list:",a.msg)}catch(e){t("error","at pages/editshop/editshop.vue:90","Error fetching market list:",e)}},bindCategoryChange(e){const t=e.detail.value;this.selectedCategory=this.categoryList[t],this.category_id=this.categoryIdMap[this.selectedCategory]},chooseImage(){uni.chooseImage({count:1,sizeType:["compressed","original"],sourceType:["album","camera"],success:e=>{const t=e.tempFilePaths;if(t.length>0){const{upload:a,request:i}=Ae({uploadPath:"/group1/upload",tempFilePaths:t[0],file:e.tempFiles[0]});a().then((e=>{var t=JSON.parse(e);this.facelogo=o+t.data.path,this.isImageSelected=!0}))}}})},chooseImage2(){uni.chooseImage({count:1,sizeType:["compressed","original"],sourceType:["album","camera"],success:e=>{const t=e.tempFilePaths;if(t.length>0){const{upload:a,request:i}=Ae({uploadPath:"/group1/upload",tempFilePaths:t[0],file:e.tempFiles[0]});a().then((e=>{var t=JSON.parse(e);this.businesslogo=o+t.data.path,this.isImageSelected2=!0}))}}})},async submitForm(){if(!this.isSubmitting)if(this.facelogo&&this.businesslogo&&this.marketList[this.selectedCategoryIndex1]){this.isSubmitting=!0;try{const e={facelogo:this.facelogo,id:this.marketList[this.selectedCategoryIndex1].id,businesslogo:this.businesslogo},t=await l.editshop(e);200===t.code?(uni.showToast({title:"补充成功",icon:"success",duration:2e3}),setTimeout((()=>{this.customizeBack()}),2e3)):uni.showToast({title:t.msg||"提交失败",icon:"none"})}catch(e){t("error","at pages/editshop/editshop.vue:202","提交失败:",e),uni.showToast({title:"提交失败",icon:"none"})}finally{this.isSubmitting=!1}}else uni.showToast({title:"请填写完整的信息",icon:"none"})}}};const di=W(ci,[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"me-container"},[e.createElementVNode("view",{class:"store"},[e.createElementVNode("text",{style:{margin:"10rpx 20rpx"}},"补充摊铺信息"),e.createElementVNode("view",{class:"Address"},[e.createElementVNode("text",null,"选择摊位:"),e.createElementVNode("picker",{class:"picker",mode:"selector",range:s.pickerRange1,value:s.selectedCategoryIndex1,onChange:a[0]||(a[0]=(...e)=>n.onMarketChange&&n.onMarketChange(...e))},[e.createElementVNode("view",{class:"picker-text"},e.toDisplayString(s.pickerRange1[s.selectedCategoryIndex1]),1)],40,["range","value"])]),e.createElementVNode("view",{class:"BL1"},[e.createElementVNode("text",null,"摊主图片:"),e.createElementVNode("view",{class:"BLpicker",onClick:a[1]||(a[1]=(...e)=>n.chooseImage&&n.chooseImage(...e))},e.toDisplayString(s.isImageSelected?"已选择":"选择图片"),1)]),e.createElementVNode("view",{class:"BL"},[e.createElementVNode("text",null,"营业执照:"),e.createElementVNode("view",{class:"BLpicker",onClick:a[2]||(a[2]=(...e)=>n.chooseImage2&&n.chooseImage2(...e))},e.toDisplayString(s.isImageSelected2?"已选择":"选择图片"),1)])]),e.createElementVNode("button",{class:"submit",type:"primary",onClick:a[3]||(a[3]=(...e)=>n.submitForm&&n.submitForm(...e)),disabled:s.isSubmitting},"提交",8,["disabled"])])}]]);const ui=W({name:"UniTag",emits:["click"],props:{type:{type:String,default:"default"},size:{type:String,default:"normal"},text:{type:String,default:""},disabled:{type:[Boolean,String],default:!1},inverted:{type:[Boolean,String],default:!1},circle:{type:[Boolean,String],default:!1},mark:{type:[Boolean,String],default:!1},customStyle:{type:String,default:""}},computed:{classes(){const{type:e,disabled:t,inverted:a,circle:i,mark:o,size:s,isTrue:n}=this;return["uni-tag--"+e,"uni-tag--"+s,n(t)?"uni-tag--disabled":"",n(a)?"uni-tag--"+e+"--inverted":"",n(i)?"uni-tag--circle":"",n(o)?"uni-tag--mark":"",n(a)?"uni-tag--inverted uni-tag-text--"+e:"","small"===s?"uni-tag-text--small":""].join(" ")}},methods:{isTrue:e=>!0===e||"true"===e,onClick(){this.isTrue(this.disabled)||this.$emit("click")}}},[["render",function(t,a,i,o,s,n){return i.text?(e.openBlock(),e.createElementBlock("text",{key:0,class:e.normalizeClass(["uni-tag",n.classes]),style:e.normalizeStyle(i.customStyle),onClick:a[0]||(a[0]=(...e)=>n.onClick&&n.onClick(...e))},e.toDisplayString(i.text),7)):e.createCommentVNode("",!0)}],["__scopeId","data-v-c3d81dd8"]]);const mi=W({data:()=>({cardList:[]}),components:{bCard:W({name:"bCard",data:()=>({moreStatus:!1}),props:["info"],methods:{onLift(){this.moreStatus=!this.moreStatus},unbind(){uni.showModal({title:"真的要解除绑定吗??",cancelText:"否",confirmText:"是",success:async e=>{if(e.confirm){t("log","at components/bCard.vue:46",this.info);let e={id:this.info.Id,status:1};t("log","at components/bCard.vue:53",await l.editshopbank(e)),this.$emit("remove")}this.moreStatus=!1}})}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-tag"),ui),c=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",null,[e.createElementVNode("view",{class:"card"},[e.createElementVNode("view",{class:"card-title"},e.toDisplayString(o.info.bankname),1),e.createElementVNode("view",{class:"num"},[e.createElementVNode("view",null,e.toDisplayString(o.info.banknumber),1)]),e.withDirectives(e.createVNode(l,{text:"默认使用",type:"success",class:"tag",inverted:"true"},null,512),[[e.vShow,2==o.info.isuse]]),e.createElementVNode("view",{class:"edit"},[e.createVNode(c,{type:"more-filled",size:"20",onClick:e.withModifiers(r.onLift,["stop"])},null,8,["onClick"])]),e.createVNode(e.Transition,{name:"fade"},{default:e.withCtx((()=>[e.withDirectives(e.createElementVNode("view",{class:"lift",onClick:i[0]||(i[0]=e.withModifiers(((...e)=>r.unbind&&r.unbind(...e)),["stop"]))}," 解除绑定 ",512),[[e.vShow,n.moreStatus]])])),_:1})])])}],["__scopeId","data-v-c3f02db1"]])},onShow(){this.getCardDataList()},methods:{handleTouch(e){if("touchstart"===e.type||"click"===e.type||"tap"===e.type){let e=0,t=this.$refs[e];for(;t;)t[0].moreStatus=!1,t=this.$refs[++e]}},gotoAddCard(){uni.navigateTo({url:"/pages/addCard/addCard"})},async getCardDataList(){let{data:e}=await l.mybank({status:2,page:1,limit:100});this.cardList=e.listdata}}},[["render",function(t,i,o,s,n,r){const l=e.resolveComponent("bCard"),c=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"bank-card-container"},[e.createElementVNode("view",{class:"header-section"},[e.createElementVNode("text",{class:"title"},"我的银行卡"),e.createElementVNode("text",{class:"count"},"("+e.toDisplayString(n.cardList.length)+"张)",1)]),e.createElementVNode("view",{class:"card-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.cardList,((t,a)=>(e.openBlock(),e.createBlock(l,{ref_for:!0,ref:a,key:a,info:t,onRemove:r.getCardDataList,class:"card-item"},null,8,["info","onRemove"])))),128)),e.createElementVNode("view",{class:"add-card",onClick:i[0]||(i[0]=(...e)=>r.gotoAddCard&&r.gotoAddCard(...e))},[e.createVNode(c,{type:"plusempty",size:"24",color:"#2979FF"}),e.createElementVNode("text",{class:"add-text"},"添加银行卡")])])])}]]);const hi=W({data:()=>({info:{bankusername:"",banknumber:"",bankname:"",bankaddress:"",isuse:1}}),onShow(){this.checkToken()&&uni.navigateTo({url:"/pages/login/login"})},methods:{checkToken:()=>!uni.getStorageSync("token"),copyObj(e){let t={};for(let a in e)"object"==typeof e[a]?t[a]=copyObj(e[a]):t[a]=e[a];return t},isNumber:e=>!isNaN(e)&&!isNaN(parseFloat(e)),settleCardChange(e){},changeValue(e){this.info.isuse=parseInt(e.detail.value)},async customizeBack(){let e=await getCurrentPages();e&&e.length>1?uni.navigateBack():history.back()},async submit(){if(this.info.bankname&&this.info.bankusername&&this.info.bankaddress&&19==this.info.banknumber.toString().length&&this.isNumber(this.info.banknumber)){let e=this.copyObj(this.info);e.banknumber=String(BigInt(e.banknumber));let t=await l.addbank(e);200==t.code?(uni.showToast({title:"添加成功",icon:"success"}),this.customizeBack()):uni.showToast({title:t.msg,icon:"error"})}else uni.showToast({title:"填写信息有误",icon:"error"})}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"bigBox"},[e.createElementVNode("view",{class:"title"}," 添加银行卡 "),e.createElementVNode("view",{class:"card"},[e.createElementVNode("view",{class:"item-info"},[e.createElementVNode("view",{class:"name"},[e.createElementVNode("label",null,"账号名称:"),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>s.info.bankusername=e),type:"text",placeholder:"请填写账号名称"},null,512),[[e.vModelText,s.info.bankusername]])]),e.createElementVNode("view",{class:"name"},[e.createElementVNode("label",null,"开户银行:"),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>s.info.bankname=e),type:"text",placeholder:"请填写开户银行"},null,512),[[e.vModelText,s.info.bankname]])]),e.createElementVNode("view",{class:"name"},[e.createElementVNode("label",null,"银行地址:"),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":a[2]||(a[2]=e=>s.info.bankaddress=e),type:"text",placeholder:"请填写银行地址"},null,512),[[e.vModelText,s.info.bankaddress]])]),e.createElementVNode("view",{class:"cardnum"},[e.createElementVNode("label",null,"银行卡号:"),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":a[3]||(a[3]=e=>s.info.banknumber=e),type:"text",placeholder:"请填写银行卡号",onInput:a[4]||(a[4]=(...e)=>n.settleCardChange&&n.settleCardChange(...e))},null,544),[[e.vModelText,s.info.banknumber]])]),e.createElementVNode("view",{class:"cardnum"},[e.createElementVNode("label",null,"默认账户:"),e.createElementVNode("view",null,[e.createElementVNode("radio-group",{value:s.info.isuse,onChange:a[5]||(a[5]=(...e)=>n.changeValue&&n.changeValue(...e))},[e.createElementVNode("radio",{value:"2"}),e.createTextVNode("是 "),e.createElementVNode("radio",{value:"1",checked:"true"}),e.createTextVNode("否 ")],40,["value"])])])]),e.createElementVNode("button",{type:"primary",onClick:a[6]||(a[6]=(...e)=>n.submit&&n.submit(...e))},"提交")])])}]]);const pi=W({name:"UniSteps",props:{direction:{type:String,default:"row"},activeColor:{type:String,default:"#2979FF"},deactiveColor:{type:String,default:"#B7BDC6"},active:{type:Number,default:0},activeIcon:{type:String,default:"checkbox-filled"},options:{type:Array,default:()=>[]}},data:()=>({heightArr:[]}),mounted(){if("column"===this.direction){let e=this;uni.createSelectorQuery().in(this).selectAll(".uni-steps__column-text").boundingClientRect((t=>{e.heightArr=t.map((e=>e.height+1))})).exec()}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"uni-steps"},[e.createElementVNode("view",{class:e.normalizeClass(["column"===o.direction?"uni-steps__column":"uni-steps__row"])},[e.createElementVNode("view",{class:e.normalizeClass(["column"===o.direction?"uni-steps__column-text-container":"uni-steps__row-text-container"])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.options,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:e.normalizeClass(["column"===o.direction?"uni-steps__column-text":"uni-steps__row-text"])},[e.createElementVNode("text",{style:e.normalizeStyle({color:a===o.active?o.activeColor:o.deactiveColor}),class:e.normalizeClass(["column"===o.direction?"uni-steps__column-title":"uni-steps__row-title"])},e.toDisplayString(t.title),7),e.createElementVNode("text",{style:e.normalizeStyle({color:o.deactiveColor}),class:e.normalizeClass(["column"===o.direction?"uni-steps__column-desc":"uni-steps__row-desc"])},e.toDisplayString(t.desc),7)],2)))),128))],2),e.createElementVNode("view",{class:e.normalizeClass(["column"===o.direction?"uni-steps__column-container":"uni-steps__row-container"])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.options,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["column"===o.direction?"uni-steps__column-line-item":"uni-steps__row-line-item"]),key:a,style:e.normalizeStyle({height:"column"===o.direction?n.heightArr[a]+"px":"14px"})},[e.createElementVNode("view",{class:e.normalizeClass(["column"===o.direction?"uni-steps__column-line":"uni-steps__row-line","column"===o.direction?"uni-steps__column-line--before":"uni-steps__row-line--before"]),style:e.normalizeStyle({backgroundColor:a<=o.active&&0!==a?o.activeColor:0===a?"transparent":o.deactiveColor})},null,6),a===o.active?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["column"===o.direction?"uni-steps__column-check":"uni-steps__row-check"])},[e.createVNode(l,{color:o.activeColor,type:o.activeIcon,size:"14"},null,8,["color","type"])],2)):(e.openBlock(),e.createElementBlock("view",{key:1,class:e.normalizeClass(["column"===o.direction?"uni-steps__column-circle":"uni-steps__row-circle"]),style:e.normalizeStyle({backgroundColor:a<o.active?o.activeColor:o.deactiveColor})},null,6)),e.createElementVNode("view",{class:e.normalizeClass(["column"===o.direction?"uni-steps__column-line":"uni-steps__row-line","column"===o.direction?"uni-steps__column-line--after":"uni-steps__row-line--after"]),style:e.normalizeStyle({backgroundColor:a<o.active&&a!==o.options.length-1?o.activeColor:a===o.options.length-1?"transparent":o.deactiveColor})},null,6)],6)))),128))],2)],2)])}],["__scopeId","data-v-3c69c4c5"]]);const gi=W({name:"UniCard",emits:["click"],props:{title:{type:String,default:""},subTitle:{type:String,default:""},padding:{type:String,default:"10px"},margin:{type:String,default:"15px"},spacing:{type:String,default:"0 10px"},extra:{type:String,default:""},cover:{type:String,default:""},thumbnail:{type:String,default:""},isFull:{type:Boolean,default:!1},isShadow:{type:Boolean,default:!0},shadow:{type:String,default:"0px 0px 3px 1px rgba(0, 0, 0, 0.08)"},border:{type:Boolean,default:!0}},methods:{onClick(e){this.$emit("click",e)}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["uni-card",{"uni-card--full":i.isFull,"uni-card--shadow":i.isShadow,"uni-card--border":i.border}]),style:e.normalizeStyle({margin:i.isFull?0:i.margin,padding:i.spacing,"box-shadow":i.isShadow?i.shadow:""})},[e.renderSlot(t.$slots,"cover",{},(()=>[i.cover?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-card__cover"},[e.createElementVNode("image",{class:"uni-card__cover-image",mode:"widthFix",onClick:a[0]||(a[0]=e=>n.onClick("cover")),src:i.cover},null,8,["src"])])):e.createCommentVNode("",!0)]),!0),e.renderSlot(t.$slots,"title",{},(()=>[i.title||i.extra?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-card__header"},[e.createElementVNode("view",{class:"uni-card__header-box",onClick:a[1]||(a[1]=e=>n.onClick("title"))},[i.thumbnail?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-card__header-avatar"},[e.createElementVNode("image",{class:"uni-card__header-avatar-image",src:i.thumbnail,mode:"aspectFit"},null,8,["src"])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"uni-card__header-content"},[e.createElementVNode("text",{class:"uni-card__header-content-title uni-ellipsis"},e.toDisplayString(i.title),1),i.title&&i.subTitle?(e.openBlock(),e.createElementBlock("text",{key:0,class:"uni-card__header-content-subtitle uni-ellipsis"},e.toDisplayString(i.subTitle),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"uni-card__header-extra",onClick:a[2]||(a[2]=e=>n.onClick("extra"))},[e.createElementVNode("text",{class:"uni-card__header-extra-text"},e.toDisplayString(i.extra),1)])])):e.createCommentVNode("",!0)]),!0),e.createElementVNode("view",{class:"uni-card__content",style:e.normalizeStyle({padding:i.padding}),onClick:a[3]||(a[3]=e=>n.onClick("content"))},[e.renderSlot(t.$slots,"default",{},void 0,!0)],4),e.createElementVNode("view",{class:"uni-card__actions",onClick:a[4]||(a[4]=e=>n.onClick("actions"))},[e.renderSlot(t.$slots,"actions",{},void 0,!0)])],6)}],["__scopeId","data-v-a4d554f5"]]);const fi=W({name:"pop",data:()=>({show:!1,styles:{}}),onShow(){},methods:{receive(){this.$emit("receive"),this.show=!1},custom(){this.$refs.ani.step({translateY:"-2000px"},{duration:0}),this.$refs.ani.step({translateY:"-100px",opacity:1},{duration:500}),this.$refs.ani.run()}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K),c=a(e.resolveDynamicComponent("uni-transition"),Ga);return e.withDirectives((e.openBlock(),e.createElementBlock("view",{class:"pop"},[e.createVNode(c,{ref:"ani","custom-class":"transition","mode-class":"fade",styles:n.styles,show:!0},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"card"},[e.createElementVNode("view",{class:"bigTitle publicMargin"},"注册成功,获得大礼包"),e.createElementVNode("view",{class:"smaillTitle publicMargin"},'获得由"农链天下"官方送出的大礼包'),e.createElementVNode("view",{class:"money publicMargin"},[e.createVNode(l,{fontFamily:"CustomFont",size:26,color:"yellow"},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(""))])),_:1}),e.createElementVNode("view",{style:{color:"#f36018"}}," 100抵扣金 ")]),e.createElementVNode("view",{class:"btn",onClick:i[0]||(i[0]=(...e)=>r.receive&&r.receive(...e))}," 领取 ")])])),_:1},8,["styles"])],512)),[[e.vShow,n.show]])}],["__scopeId","data-v-8edd887d"]]),yi={data:()=>({options:[{title:"创建摊位"},{title:"用户信息"}],active:0,categoryList:["请选择分类"],selectedCategory:"请选择分类",userInfo:{name:null,location:null,index:null,lng:null,lat:null},title:"下一步",lock:!0,selectedCountry:"china",multiArray:[[],[],[]],multiIndex:[0,0,0],selectedMarketIndex:0,area_id:2313,market_id:null,overseasCountries:[],overseasCities:[],overseasCountryId:null,overseasCityId:null}),computed:{displayArray(){return"china"===this.selectedCountry?[this.multiArray[0],this.multiArray[1],this.multiArray[2]]:[this.multiArray[0],this.multiArray[1],[]]},displayMarketList(){return"china"===this.selectedCountry?this.marketList:["暂时还没有数据"]}},watch:{selectedCountry(e){this.selectCountry(e)}},async mounted(){await this.initializePicker(),this.fetchCategories()},components:{popVue:fi},methods:{async seachAddress(){if(this.userInfo.location){let e=await l.searchResolution({address:this.userInfo.location});e.error?(uni.showToast({icon:"error",title:"详细地址有误,获取不到经纬度"}),this.userInfo.lng=110.358001,this.userInfo.lat=19.681215):(this.userInfo.lng=e.lng,this.userInfo.lat=e.lat)}},async customizeBack(){let e=await getCurrentPages();e&&e.length>1?uni.navigateBack():history.back()},async over(){let e=await l.addfarmers({area_id:this.area_id,farmersname:this.userInfo.name,address:this.userInfo.location,category_id:this.userInfo.index,lng:this.userInfo.lng,lat:this.userInfo.lat});t("log","at pages/onlineBooth/onlineBooth.vue:348",e),200==e.code?uni.showToast({icon:"success",title:"注册成功"}).then((e=>{setTimeout((()=>{this.customizeBack()}),2e3)})):uni.showToast({icon:"error",title:e.msg||e.message})},register(){if(this.lock){let e=this.$refs.pop;e.show=!0,e.custom(),this.lock=!1}},async fetchCategories(){try{const e=await l.cglist();if(200!==e.code)throw new Error("Failed to fetch categories");{const t=e.data.listdata;this.categoryList=[...t.map((e=>e.title))],this.categoryIdMap=t.reduce(((e,t)=>(e[t.title]=t.id,e)),{})}}catch(e){t("error","at pages/onlineBooth/onlineBooth.vue:389","Failed to fetch categories:",e)}},bindCategoryChange(e){const t=e.detail.value;this.selectedCategory=this.categoryList[t],this.category_id=this.categoryIdMap[this.selectedCategory]},goToJackpot(){uni.navigateTo({url:"/pages/jackpot/jackpot"})},...$("location",["setStatus"]),async initializePicker(){try{if("china"===this.selectedCountry){const e=await this.fetchProvinces();if(this.multiArray[0]=e.map((e=>e.name)),e.length>0){const t=await this.fetchCities(e[20].id);if(this.multiArray[1]=t.map((e=>e.name)),t.length>0){const e=await this.fetchAreas(2306);this.multiArray[2]=e.map((e=>e.name))}}this.multiIndex=[20,3,6]}else if("overseas"===this.selectedCountry){const e=await this.fetchOverseas();this.multiArray[0]=e.map((e=>e.shortname)),this.multiArray[1]=[],this.multiArray[2]=[],this.multiIndex=[0,0,0]}}catch(e){t("error","at pages/onlineBooth/onlineBooth.vue:439","Failed to initialize picker:",e)}this.fetchMarkets(2313),this.selectedMarketIndex=1},async fetchProvinces(){try{const e=await l.citylist({level:1,limit:100});if(200===e.code)return this.provinceList=e.data.listdata,this.provinceList;throw new Error("Failed to fetch provinces")}catch(e){throw t("error","at pages/onlineBooth/onlineBooth.vue:459","Failed to fetch provinces:",e),e}},async fetchCities(e){try{const a=await l.citytree(e);return 200===a.code&&Array.isArray(a.data)?(this.cityList=a.data,a.data):(t("error","at pages/onlineBooth/onlineBooth.vue:470","No cities data found"),[])}catch(a){return t("error","at pages/onlineBooth/onlineBooth.vue:474","Failed to fetch cities:",a),[]}},async fetchAreas(e){try{const a=await l.citytree(e);return 200===a.code&&Array.isArray(a.data)?(this.districtList=a.data,a.data):(t("error","at pages/onlineBooth/onlineBooth.vue:485","No areas data found"),[])}catch(a){return t("error","at pages/onlineBooth/onlineBooth.vue:489","Failed to fetch areas:",a),[]}},async fetchOverseas(){try{const e=await l.countrylist(0,200,1);if(200===e.code)return this.overseasCountries=e.data.listdata,this.multiArray[0]=this.overseasCountries.map((e=>e.shortname)),this.multiArray[1]=[],this.multiArray[2]=[],this.multiIndex=[0,0,0],this.overseasCountries;throw new Error("Failed to fetch overseas continents")}catch(e){throw t("error","at pages/onlineBooth/onlineBooth.vue:507","Failed to fetch overseas continents:",e),e}},async fetchOverseasCities(e){try{const t=await l.countrylist(e,100,1);if(200===t.code)return this.overseasCities=t.data.listdata,this.multiArray[1]=this.overseasCities.map((e=>e.shortname)),this.multiArray[2]=[],this.multiIndex[1]=0,this.multiIndex[2]=0,this.overseasCities;throw new Error("Failed to fetch overseas countries")}catch(a){throw t("error","at pages/onlineBooth/onlineBooth.vue:525","Failed to fetch overseas countries:",a),a}},async selectCountry(e){this.selectedCountry=e,this.multiArray=[[],[],[]],this.marketList=[],this.selectedMarketIndex=0,this.area_id=null,this.market_id=null,"china"===e?await this.initializePicker():"overseas"===e&&await this.fetchOverseas()},async bindMultiPickerColumnChange(e){const t=e.detail.column,a=e.detail.value;if("china"===this.selectedCountry){if(0===t){const e=this.provinceList[a];if(e&&void 0!==e.id){const t=await this.fetchCities(e.id);if(this.multiArray[1]=t.map((e=>e.name)),t.length>0){const e=await this.fetchAreas(t[0].id);this.multiArray[2]=e.map((e=>e.name))}else this.multiArray[2]=[]}this.multiIndex[1]=0,this.multiIndex[2]=0}else if(1===t){const e=this.cityList[a];if(e&&void 0!==e.id){const t=await this.fetchAreas(e.id);this.multiArray[2]=t.map((e=>e.name))}else this.multiArray[2]=[];this.multiIndex[2]=0}}else if("overseas"===this.selectedCountry)if(0===t){const e=this.overseasCountries[a];e&&void 0!==e.id&&await this.fetchOverseasCities(e.id),this.multiArray[2]=[],this.multiIndex[1]=0,this.multiIndex[2]=0}else 1===t&&(this.multiArray[2]=[],this.multiIndex[2]=0);this.multiIndex[t]=a,this.multiIndex=[...this.multiIndex]},async bindMultiPickerChange(e){var t,a,i,o;if(this.multiIndex=e.detail.value,"china"===this.selectedCountry){const e=this.multiIndex[1],i=(null==(t=this.cityList[e])?void 0:t.id)||null;i&&(await this.fetchAreas(i),this.area_id=(null==(a=this.districtList[this.multiIndex[2]])?void 0:a.id)||null,await this.fetchMarkets(this.area_id))}else if("overseas"===this.selectedCountry){const e=this.multiIndex[0];this.overseasCountryId=(null==(i=this.overseasCountries[e])?void 0:i.id)||null;const t=this.multiIndex[1];this.overseasCountryId&&(await this.fetchOverseasCities(this.overseasCountryId),this.overseasCityId=(null==(o=this.overseasCities[t])?void 0:o.id)||null)}},async fetchMarkets(e){try{const a=100,i=await l.marketlist(e,a);200===i.code&&Array.isArray(i.data.listdata)?(this.marketList=i.data.listdata.map((e=>e.marketname)),this.marketIdMap=i.data.listdata.reduce(((e,t)=>(e[t.marketname]=t.id,e)),{})):(t("error","at pages/onlineBooth/onlineBooth.vue:626","No market data found"),this.marketList=[],this.marketIdMap={})}catch(a){t("error","at pages/onlineBooth/onlineBooth.vue:631","Failed to fetch markets:",a),this.marketList=[],this.marketIdMap={}}},bindMarketChange(e){this.selectedMarketIndex=e.detail.value;const t=this.marketList[this.selectedMarketIndex];this.market_id=this.marketIdMap[t]||null},next(){switch(this.active){case 0:this.active+=1,this.title="注册";break;case 1:this.userInfo.index=this.categoryList.findIndex((e=>e==this.selectedCategory)),this.userInfo.name&&this.userInfo.location&&-1!=this.userInfo.index?this.over():uni.showToast({icon:"error",title:"请补充完整信息"});break;case 2:"完成"==this.title&&uni.showToast({title:"注册完成"})}}}};const vi=W(yi,[["render",function(t,i,o,s,n,r){const l=e.resolveComponent("popVue"),c=a(e.resolveDynamicComponent("uni-steps"),pi),d=a(e.resolveDynamicComponent("uni-icons"),K),u=a(e.resolveDynamicComponent("uni-card"),gi);return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createVNode(l,{ref:"pop",onReceive:r.over},null,8,["onReceive"]),e.createElementVNode("view",{class:"header"},[e.createElementVNode("view",{class:"title"},[e.createTextVNode(" 轻松三步，成为农户 "),e.createElementVNode("view",{class:"decorate-line"})])]),e.createVNode(c,{options:n.options,active:n.active,class:"steps","active-color":"#00ff00"},null,8,["options","active"]),e.withDirectives(e.createElementVNode("view",{class:"step-content"},[e.createElementVNode("view",{class:"tip-text"},[e.createVNode(d,{type:"info",size:"16",color:"#6C757D"}),e.createTextVNode(" 先选择自己所在的城市地区，申请成功后将展示在该地区的所有范围 ")]),e.createVNode(u,{class:"form-card"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"card-title"},"所在地区"),e.createVNode(d,{type:"location-filled",size:"20",color:"#4A6572"})]),e.createElementVNode("picker",{class:"area-picker",mode:"multiSelector",range:n.multiArray,value:n.multiIndex,onChange:i[0]||(i[0]=(...e)=>r.bindMultiPickerChange&&r.bindMultiPickerChange(...e)),onColumnchange:i[1]||(i[1]=(...e)=>r.bindMultiPickerColumnChange&&r.bindMultiPickerColumnChange(...e))},[e.createElementVNode("view",{class:"picker-content"},[e.createTextVNode(e.toDisplayString(n.multiArray[0][n.multiIndex[0]])+" - "+e.toDisplayString(n.multiArray[1][n.multiIndex[1]])+" -"+e.toDisplayString("overseas"===n.selectedCountry?"":n.multiArray[2][n.multiIndex[2]])+" ",1),e.createVNode(d,{type:"arrowright",size:"18",color:"#8E9BA6"})])],40,["range","value"])])),_:1})],512),[[e.vShow,0==n.active]]),e.withDirectives(e.createElementVNode("view",{class:"step-content"},[e.createElementVNode("view",{class:"tip-text"},[e.createVNode(d,{type:"info",size:"16",color:"#6C757D"}),e.createTextVNode(" 请输入户主名称，选择您要卖的菜品所属分类，以及详细地址 ")]),e.createElementVNode("view",{class:"form-section"},[e.createVNode(u,{class:"form-card"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"item-label"},"户主名称"),e.withDirectives(e.createElementVNode("input",{class:"input-box","onUpdate:modelValue":i[2]||(i[2]=e=>n.userInfo.name=e),placeholder:"请输入名称","placeholder-style":"color:#ADB5BD"},null,512),[[e.vModelText,n.userInfo.name]])]),e.createElementVNode("view",{class:"divider"}),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"item-label"},"所售类目"),e.createElementVNode("picker",{class:"category-picker",mode:"selector",range:n.categoryList,onChange:i[3]||(i[3]=(...e)=>r.bindCategoryChange&&r.bindCategoryChange(...e))},[e.createElementVNode("view",{class:"picker-content"},[e.createTextVNode(e.toDisplayString(n.selectedCategory)+" ",1),e.createVNode(d,{type:"arrowright",size:"18",color:"#8E9BA6"})])],40,["range"])]),e.createElementVNode("view",{class:"divider"}),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"item-label"},"详细地址"),e.withDirectives(e.createElementVNode("input",{class:"input-box","onUpdate:modelValue":i[4]||(i[4]=e=>n.userInfo.location=e),placeholder:"请输入地址","placeholder-style":"color:#ADB5BD",onBlur:i[5]||(i[5]=(...e)=>r.seachAddress&&r.seachAddress(...e))},null,544),[[e.vModelText,n.userInfo.location]])])])),_:1})])],512),[[e.vShow,1==n.active]]),e.createElementVNode("button",{class:"next-btn",onClick:i[6]||(i[6]=(...e)=>r.next&&r.next(...e))},e.toDisplayString(n.title),1)])}],["__scopeId","data-v-b468e898"]]);const wi=W({data:()=>({}),onShow(){},methods:{goToRouter(e){try{uni.navigateTo({url:e})}catch{uni.switchTab({url:e})}},gotoOwneroders(e){uni.navigateTo({url:`/pages/Ownerorders/Ownerorders?orderStatus=${e}`})}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"all"},[e.createElementVNode("view",{class:"me-container"},[e.createElementVNode("view",{class:"outlets"},[e.createElementVNode("view",{class:"title"}," 我的摊铺 "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"item",onClick:i[0]||(i[0]=e=>r.goToRouter("/pages/Apply/Apply"))},[e.createVNode(l,{fontFamily:"CustomFont",size:26,color:"lightblue"},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(""))])),_:1}),e.createElementVNode("view",{class:"add-dishes"}," 注册摊位 ")]),e.createElementVNode("view",{class:"item",onClick:i[1]||(i[1]=e=>r.goToRouter("/pages/stalllist/stalllist"))},[e.createVNode(l,{fontFamily:"CustomFont",size:26,color:"lightgreen"},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(""))])),_:1}),e.createElementVNode("view",{class:"add-dishes"}," 我的摊铺 ")]),e.createElementVNode("view",{class:"item",onClick:i[2]||(i[2]=e=>r.goToRouter("/pages/editshop/editshop"))},[e.createVNode(l,{fontFamily:"CustomFont",size:26,color:"lightblue"},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(""))])),_:1}),e.createElementVNode("view",{class:"add-dishes"}," 补充资料 ")]),e.createElementVNode("view",{class:"item",onClick:i[3]||(i[3]=e=>r.goToRouter("/subPackages/boothOwner/salesApplication/salesApplication"))},[e.createVNode(l,{fontFamily:"CustomFont",size:26,color:"lightblue"},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(""))])),_:1}),e.createElementVNode("view",{class:"add-dishes"}," 代销申请 ")]),e.createElementVNode("view",{class:"item",onClick:i[4]||(i[4]=e=>r.goToRouter("/subPackages/boothOwner/storeSettings/storeSettings"))},[e.createVNode(l,{fontFamily:"CustomFont",size:26,color:"yellow"},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(""))])),_:1}),e.createElementVNode("view",{class:"add-dishes"}," 店铺设置 ")])])]),e.createElementVNode("view",{class:"dishes"},[e.createElementVNode("view",{class:"title"}," 我的菜品 "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"item",onClick:i[5]||(i[5]=e=>r.goToRouter("/pages/release/release"))},[e.createVNode(l,{fontFamily:"CustomFont",size:26,color:"lightblue"},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(""))])),_:1}),e.createElementVNode("view",{class:"add-dishes"}," 添加菜品 ")]),e.createElementVNode("view",{class:"item",onClick:i[6]||(i[6]=e=>r.goToRouter("/pages/publish/publish"))},[e.createVNode(l,{fontFamily:"CustomFont",size:26,color:"lightgreen"},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(""))])),_:1}),e.createElementVNode("view",{class:"add-dishes"}," 我的菜品 ")]),e.createElementVNode("view",{class:"item",onClick:i[7]||(i[7]=e=>r.goToRouter("/pages/Listed-Dishes/Listed-Dishes"))},[e.createVNode(l,{fontFamily:"CustomFont",size:26,color:"lightgreen"},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(""))])),_:1}),e.createElementVNode("view",{class:"add-dishes"}," 上架菜品 ")])])]),e.createElementVNode("view",{class:"orders"},[e.createElementVNode("view",{class:"title",onClick:i[8]||(i[8]=e=>r.gotoOwneroders(0))}," 我的订单 "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"item",onClick:i[9]||(i[9]=e=>r.gotoOwneroders(1))},[e.createVNode(l,{fontFamily:"CustomFont",size:26,color:"red"},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(""))])),_:1}),e.createElementVNode("view",{class:"add-dishes"}," 待支付 ")]),e.createElementVNode("view",{class:"item",onClick:i[10]||(i[10]=e=>r.gotoOwneroders(3))},[e.createVNode(l,{fontFamily:"CustomFont",size:26,color:"red"},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(""))])),_:1}),e.createElementVNode("view",{class:"add-dishes"}," 待收货 ")]),e.createElementVNode("view",{class:"item",onClick:i[11]||(i[11]=e=>r.gotoOwneroders(5))},[e.createVNode(l,{fontFamily:"CustomFont",size:26,color:"red"},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(""))])),_:1}),e.createElementVNode("view",{class:"add-dishes"}," 待结算 ")]),e.createElementVNode("view",{class:"item",onClick:i[12]||(i[12]=e=>r.gotoOwneroders(6))},[e.createVNode(l,{fontFamily:"CustomFont",size:26,color:"lightgreen"},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(""))])),_:1}),e.createElementVNode("view",{class:"add-dishes"}," 已结算 ")])])]),e.createElementVNode("view",{class:"earnings"},[e.createElementVNode("view",{class:"title"}," 我的收益 "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"item",onClick:i[13]||(i[13]=e=>r.goToRouter("/pages/wallet/wallet"))},[e.createVNode(l,{fontFamily:"CustomFont",size:26,color:"yellow"},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(""))])),_:1}),e.createElementVNode("view",{class:"add-dishes"}," 现金钱包 ")]),e.createElementVNode("view",{class:"item",onClick:i[14]||(i[14]=e=>r.goToRouter("/pages/Points/Points"))},[e.createVNode(l,{fontFamily:"CustomFont",size:26,color:"yellow"},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(""))])),_:1}),e.createElementVNode("view",{class:"add-dishes"}," 积分钱包 ")]),e.createElementVNode("view",{class:"item",onClick:i[15]||(i[15]=e=>r.goToRouter("/pages/pointspayouts/pointspayouts"))},[e.createVNode(l,{fontFamily:"CustomFont",size:26,color:"yellow"},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(""))])),_:1}),e.createElementVNode("view",{class:"add-dishes"}," 积分结算 ")]),e.createElementVNode("view",{class:"item",onClick:i[16]||(i[16]=e=>r.goToRouter("/pages/bankCard/bankCard"))},[e.createVNode(l,{fontFamily:"CustomFont",size:26,color:"yellow"},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(""))])),_:1}),e.createElementVNode("view",{class:"add-dishes"}," 银行卡 ")])])])])])}]]);const ki=W({data:()=>({}),onShow(){},methods:{goToRouter(e){try{uni.navigateTo({url:e})}catch{uni.switchTab({url:e})}},gotoOwneroders(e){uni.navigateTo({url:`/pages/Ownerorders/Ownerorders?orderStatus=${e}`})}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"all"},[e.createElementVNode("view",{class:"me-container"},[e.createElementVNode("view",{class:"outlets"},[e.createElementVNode("view",{class:"title"}," 我的户主 "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"item",onClick:i[0]||(i[0]=e=>r.goToRouter("/pages/onlineBooth/onlineBooth"))},[e.createVNode(l,{fontFamily:"CustomFont",size:26,color:"lightblue"},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(""))])),_:1}),e.createElementVNode("view",{class:"add-dishes"}," 申请户主 ")]),e.createElementVNode("view",{class:"item",onClick:i[1]||(i[1]=e=>r.goToRouter("/subPackages/aHouseholder/additionalInformation/additionalInformation"))},[e.createVNode(l,{fontFamily:"CustomFont",size:26,color:"lightblue"},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(""))])),_:1}),e.createElementVNode("view",{class:"add-dishes"}," 资料补充 ")]),e.createElementVNode("view",{class:"item",onClick:i[2]||(i[2]=e=>r.goToRouter("/subPackages/boothOwner/storeSettings/storeSettings"))},[e.createVNode(l,{fontFamily:"CustomFont",size:26,color:"yellow"},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(""))])),_:1}),e.createElementVNode("view",{class:"add-dishes"}," 店铺设置 ")])])]),e.createElementVNode("view",{class:"dishes"},[e.createElementVNode("view",{class:"title"}," 我的菜品 "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"item",onClick:i[3]||(i[3]=e=>r.goToRouter("/pages/preSale/preSale"))},[e.createVNode(l,{fontFamily:"CustomFont",size:26,color:"lightgreen"},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(""))])),_:1}),e.createElementVNode("view",{class:"add-dishes"}," 添加菜品 ")]),e.createElementVNode("view",{class:"item",onClick:i[4]||(i[4]=e=>r.goToRouter("/subPackages/aHouseholder/PreSoldDishesList/PreSoldDishesList"))},[e.createVNode(l,{fontFamily:"CustomFont",size:26,color:"lightgreen"},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(""))])),_:1}),e.createElementVNode("view",{class:"add-dishes"}," 我的菜品 ")]),e.createElementVNode("view",{class:"item",onClick:i[5]||(i[5]=e=>r.goToRouter("/subPackages/aHouseholder/alreadyListed/alreadyListed"))},[e.createVNode(l,{fontFamily:"CustomFont",size:26,color:"lightgreen"},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(""))])),_:1}),e.createElementVNode("view",{class:"add-dishes"}," 上架菜品 ")])])]),e.createElementVNode("view",{class:"orders"},[e.createElementVNode("view",{class:"title",onClick:i[6]||(i[6]=e=>r.gotoOwneroders(0))}," 我的订单 "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"item",onClick:i[7]||(i[7]=e=>r.gotoOwneroders(1))},[e.createVNode(l,{fontFamily:"CustomFont",size:26,color:"red"},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(""))])),_:1}),e.createElementVNode("view",{class:"add-dishes"}," 待支付 ")]),e.createElementVNode("view",{class:"item",onClick:i[8]||(i[8]=e=>r.gotoOwneroders(3))},[e.createVNode(l,{fontFamily:"CustomFont",size:26,color:"red"},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(""))])),_:1}),e.createElementVNode("view",{class:"add-dishes"}," 待收货 ")]),e.createElementVNode("view",{class:"item",onClick:i[9]||(i[9]=e=>r.gotoOwneroders(5))},[e.createVNode(l,{fontFamily:"CustomFont",size:26,color:"red"},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(""))])),_:1}),e.createElementVNode("view",{class:"add-dishes"}," 待结算 ")]),e.createElementVNode("view",{class:"item",onClick:i[10]||(i[10]=e=>r.gotoOwneroders(6))},[e.createVNode(l,{fontFamily:"CustomFont",size:26,color:"lightgreen"},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(""))])),_:1}),e.createElementVNode("view",{class:"add-dishes"}," 已结算 ")])])]),e.createElementVNode("view",{class:"earnings"},[e.createElementVNode("view",{class:"title"}," 我的收益 "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"item",onClick:i[11]||(i[11]=e=>r.goToRouter("/pages/wallet/wallet"))},[e.createVNode(l,{fontFamily:"CustomFont",size:26,color:"yellow"},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(""))])),_:1}),e.createElementVNode("view",{class:"add-dishes"}," 钱包 ")]),e.createElementVNode("view",{class:"item",onClick:i[12]||(i[12]=e=>r.goToRouter("/pages/bankCard/bankCard"))},[e.createVNode(l,{fontFamily:"CustomFont",size:26,color:"yellow"},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(""))])),_:1}),e.createElementVNode("view",{class:"add-dishes"}," 银行卡 ")])])])])])}]]);const Ei=W({name:"AgreementPage"},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"agreement-page"},[e.createElementVNode("view",{class:"agreement-title"},"【农链天下】服务协议"),e.createElementVNode("scroll-view",{class:"agreement-content","scroll-y":""},[e.createElementVNode("text",{class:"agreement-text"}," 本服务协议（以下简称“协议”）由海南积分宝电子商务有限公司（以下简称“本公司”）与使用【农链天下】的摊主（以下简称“摊主”）及用户（以下简称“用户”）共同缔结。本公司系依据中华人民共和国法律合法设立，统一社会信用代码/注册号为 91460000567989358W，注册地址位于海南省海口市秀英区海盛路35号旭源大厦2楼B211房。 为保障各方的合法权益，明确各方在使用【农链天下】过程中的权利和义务，特制定本协议。用户和摊主在使用本小程序时，应仔细阅读本协议的全部条款。一经使用，即视为已充分理解并同意接受本协议的约束。 一、服务范围 （一）摊主服务： 1. 摊主有权在【农链天下】内创建并管理自己的店铺，可上传包括但不限于菜品名称、价格、图片、详细描述等信息，以便用户浏览和选购。 2. 摊主需对店铺内产生的订单进行妥善管理，包括但不限于接收订单、处理用户的退款请求以及提供相应的售后服务。 3. 摊主必须确保所提供的菜品信息真实、准确、完整，且符合国家相关法律法规及食品安全标准，严禁提供虚假信息或违规产品信息。 （二）用户服务： 1. 用户可在【农链天下】内方便地浏览各摊主提供的菜品信息，并根据自身需求进行选购操作。 2. 用户可通过小程序内置的安全支付功能完成订单的支付流程，本公司将确保支付过程的安全性和稳定性。 3. 用户可随时查看订单的详细状态，如待支付、待发货、待收货、已完成等，同时可追溯历史订单记录并查看物流跟踪信息，以便掌握订单的最新进展。 二、用户注册与信息安全 1. 摊主和用户均须进行实名认证，提供真实、有效、准确且完整的个人信息，包括但不限于姓名、联系方式、身份证号等。 2. 各方有义务妥善保管登录密码和支付密码，因自身原因导致的账户被盗用、密码泄露或其他安全问题所造成的一切后果和损失，由其自行承担相应责任。 3. 本公司将严格遵守国家相关法律法规，对用户和摊主提供的个人信息进行收集、存储、使用、保护和管理，确保信息安全。在未获得用户和摊主的明确授权下，不会将信息泄露给第三方，但法律法规另有规定的除外。 三、商品交易 1. 摊主在【农链天下】上架菜品时，应确保菜品信息的真实性、准确性和合理性，遵循国家法律法规及食品安全标准。所提供的菜品价格应符合市场规律及合理定价原则。 2. 用户在本小程序内选购并完成支付操作后，摊主应在规定时间内依据订单要求及时发货，确保商品的质量和数量符合订单约定。 3. 摊主和用户均可在【农链天下】内方便地查看订单状态，并对订单进行相应操作和管理。 四、退款与售后服务 1. 对于符合退货条件的商品，用户可在【农链天下】内申请退货，退货流程及具体条件将在小程序内进行详细公示。用户应确保退货商品的完好性和可售性，在申请退货时需遵守相应的退货规则。 2. 若摊主和用户因商品交易产生纠纷，双方应首先秉持友好协商的原则解决问题。若协商无法达成一致，任何一方可联系本公司的客服人员介入处理，本公司将根据实际情况进行调解。 五、知识产权 1. 【农链天下】内的所有内容，包括但不限于文字、图片、音频、视频、软件代码及界面设计等，其版权及相关知识产权均归本公司或其他相关权利人所有。 2. 未经本公司或相关权利人的书面授权，摊主和用户不得以任何形式对上述内容进行复制、传播、修改、改编、分发或用于商业目的等，否则将承担相应的法律责任。 六、免责条款 1. 在服务过程中，如因不可抗力因素，包括但不限于自然灾害、网络故障、政府行为、战争、罢工等，导致服务中断、数据丢失或其他损失，本公司不承担任何责任。 2. 本公司对摊主或用户因使用【农链天下】服务而产生的任何直接、间接、特殊、偶然、必然或惩罚性的损失不承担赔偿责任，但法律法规另有规定的除外。 七、争议解决 1. 本协议的解释、效力及争议解决均适用中华人民共和国法律。 2. 在协议履行过程中，若双方因本协议的内容或履行事宜发生争议，应首先尝试通过友好协商解决。若协商不成，任何一方可向本公司所在地人民法院提起诉讼，通过法律途径解决争议。 八、其他 1. 本协议自摊主和用户注册、登录或开始使用【农链天下】之日起生效，对各方均具有法律约束力。 2. 本公司有权根据市场环境的变化、法律法规的调整及业务发展需要，适时调整服务内容、推出新的服务项目或暂停、终止部分服务。本公司将通过【农链天下】内的公告系统或其他合理的通讯方式提前通知用户和摊主，以便其知悉相关变更信息。 如有任何疑问或需要帮助，请随时联系我们的客户服务热线：68552337 或发送邮件至 13707589182@163.com。 ")])])}],["__scopeId","data-v-6ff0f095"]]);const Ni=W({name:"PrivacyAgreementPage"},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"privacy-agreement-page"},[e.createElementVNode("view",{class:"privacy-agreement-title"},"【农链天下】隐私协议"),e.createElementVNode("scroll-view",{class:"privacy-agreement-content","scroll-y":""},[e.createElementVNode("text",{class:"privacy-agreement-text"}," 本隐私协议（以下简称“协议”）由海南积分宝电子商务有限公司（以下简称“本公司”）与使用【农链天下】的摊主（以下简称“摊主”）及用户（以下简称“用户”）共同缔结。本公司致力于保护用户和摊主的隐私，在使用本小程序的过程中，本公司将依据国家相关法律法规及本协议规定，以合法、正当、必要的原则处理您的个人信息。 一、信息收集 1. 本公司会收集用户和摊主在使用【农链天下】时提供的各类个人信息，具体包括但不限于： - 基本身份信息：姓名、身份证号、联系方式（如手机号码、电子邮箱）等，这些信息对于用户和摊主的账户注册、身份验证以及服务使用至关重要。 - 店铺信息（仅针对摊主）：店铺名称、店铺地址、经营范围、营业执照编号等，以便为摊主提供店铺管理和运营服务。 - 交易信息：包括订单信息（如订单编号、商品信息、交易金额、交易时间等），这是为了完成订单处理、结算及售后服务所需。 - 支付信息：在用户进行支付操作时，会涉及支付账户信息，但本公司将确保支付信息的处理符合金融监管机构的要求，仅在完成支付流程中使用，且会通过安全加密机制保护其安全性。 - 设备信息：在您使用本小程序时，会自动收集您的设备相关信息，例如设备型号、操作系统版本、唯一设备标识符（如 IMEI 号、MAC 地址等），主要用于确保服务的兼容性、维护服务的安全性以及优化用户体验。这些信息将以匿名化和去标识化的方式进行处理，不会直接关联到您的个人身份，除非法律另有规定。 二、信息使用 1. 本公司将使用收集到的个人信息为您提供和优化服务，具体如下： - 提供服务：使用您的信息来创建和管理您的账户，处理订单，为摊主管理店铺、提供商品展示和销售服务，为用户提供商品选购、订单追踪及客户服务等。 - 业务运营：进行数据分析，包括但不限于统计分析用户和摊主的行为模式、偏好，以改进我们的服务，如调整菜品推荐算法、优化服务流程和功能，提升服务质量。 - 沟通与服务：使用您的信息向您发送与服务相关的通知，如订单状态更新、发货通知、服务维护通知等，以确保您能及时了解服务进展。同时，我们可能会根据您的偏好和历史行为向您推送个性化的推荐信息，如您可能感兴趣的菜品、促销活动或优惠信息。若您不希望接收营销信息，可以通过【农链天下】内的设置功能随时选择退订，我们将尊重您的选择。 - 安全与防欺诈：利用收集到的信息来维护服务的安全性，预防和检测可能的欺诈、安全漏洞及滥用行为，保障用户和摊主的权益。 三、信息共享 1. 未经您的明确同意，本公司不会将您的个人信息向第三方共享，以下情况除外： - 服务提供商：为了向您提供更优质的服务，我们可能会与部分服务提供商合作，如支付机构、物流配送公司、技术支持服务商等。在共享信息前，我们会与这些服务提供商签订严格的保密协议，确保其仅在为您提供服务的必要范围内使用您的信息，并采取适当的安全和保密措施。例如，支付机构仅会在处理支付事务时使用您的支付信息，且仅能访问其所需的最少信息；物流配送公司仅能获取发货所需的收货地址等信息。 - 法律要求：当法律、法规、司法或行政命令要求我们披露信息时，我们将依法配合，同时会在合理范围内保障您的权益。 - 合并与收购：在公司合并、收购、重组或出售部分业务时，您的信息可能会被转移至新的实体，但我们会确保新的实体继续履行本协议所规定的隐私保护义务。 四、信息存储 1. 本公司将根据国家法律法规的要求，以安全的方式存储您的个人信息，确保信息的保密性和完整性。存储时间将根据信息的使用目的和相关法律规定而定，对于不再需要的信息，我们将及时进行删除或匿名化处理。 2. 我们采用多种安全措施来保护信息存储的安全，包括但不限于： - 采用加密技术对存储的信息进行加密，防止未经授权的访问。 - 实施访问控制措施，仅允许授权人员在必要时访问信息。 - 定期进行数据备份和恢复测试，以防止数据丢失或损坏。 五、信息访问与修改 1. 您有权随时访问、更新和修改您在【农链天下】中的个人信息。您可以通过【农链天下】内的用户中心或摊主管理界面进行操作，或者联系我们的客户服务团队。我们将及时响应您的请求，并确保信息的更新准确反映您的最新情况。 2. 若您发现您的信息有误或不完整，您有权要求我们进行更正或补充。在某些情况下，您还可以请求删除您的部分或全部个人信息，但需注意，在删除信息可能影响服务提供或违反法律规定的情况下，我们可能会在合理范围内保留必要信息，并向您说明原因。 六、信息保护 1. 本公司高度重视信息保护，采取多维度的安全措施来防止未经授权的访问、使用、披露、修改或破坏您的个人信息，这些措施包括但不限于： - 技术防护：运用先进的安全技术和工具，如防火墙、加密技术、安全套接字层（SSL）协议等，确保信息在传输和存储过程中的安全。 - 人员管理：对员工进行信息安全培训，确保员工遵守严格的信息处理和保护规定，只有经授权的员工在必要时才能接触和处理用户信息。 - 安全审计：定期进行安全审计和风险评估，及时发现并解决潜在的安全风险。 2. 若发生信息安全事件，我们将按照法律法规的要求，在不影响调查和处理的前提下，尽快通知受影响的用户和摊主，并采取相应的补救措施，包括但不限于提供风险提示、协助您采取防范措施等。 七、第三方链接和服务 1. 【农链天下】可能包含指向第三方网站或服务的链接，这些第三方网站或服务有其独立的隐私政策和信息处理方式，本公司对其隐私政策和信息处理行为不承担责任。 2. 在使用第三方服务时，请您务必仔细阅读并理解其隐私政策，谨慎操作。当您点击这些链接时，即表示您将离开本公司的服务环境，本公司无法控制第三方对您信息的收集和处理，您需自行判断风险。 八、儿童隐私 1. 本小程序不针对儿童（不满 14 周岁）提供服务。我们致力于遵守相关儿童隐私保护法律法规，若发现我们收集了儿童的信息，将采取合理措施尽快删除相关信息。若您是儿童的家长或监护人，请及时联系我们，我们将协助您进行信息删除和保护操作。 九、隐私协议的变更 1. 本公司会根据业务发展、法律法规的更新或监管要求，适时更新本隐私协议。我们将通过【农链天下】内的公告系统、电子邮件或短信等合理的通讯方式向您通知协议的变更内容。 2. 您在收到隐私协议更新通知后继续使用【农链天下】，将视为您同意更新后的隐私协议；若您不同意更新内容，您有权停止使用本小程序。 十、法律适用和争议解决 1. 本隐私协议的解释、效力及争议解决均适用中华人民共和国法律。 2. 在协议履行过程中，若双方因本隐私协议的内容或履行事宜发生争议，应首先尝试通过友好协商解决；若协商不成，任何一方可向本公司所在地人民法院提起诉讼。 若您对本隐私协议有任何疑问或需要帮助，请随时联系我们的客户服务热线：68552337 或发送邮件至 13707589182@163.com。 ")])])}],["__scopeId","data-v-c4c9050f"]]);const bi=W({data:()=>({}),methods:{}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{style:{"margin-top":"100rpx"}},[e.createElementVNode("button",{type:"primary",plain:"true"},"开通微信分账")])}]]);const Vi=W({data:()=>({})},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"me-container"},[e.createElementVNode("view",{class:"title"}," 通知 "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"one"},"因春节期间，打卡人数未能达到开奖的最低人数数量，暂时停止开奖赠送积分活动，具体下一次赠送积分活动安排请会员关注农链天下小程序等塔岭农贸菜市场市场管理部通知。")]),e.createElementVNode("view",{class:"luokuan"},[e.createElementVNode("view",{class:"bomen"}," 塔岭农贸市场办公室 "),e.createElementVNode("view",{class:"dateTime"},"2025.2.02 ")])])}]]),Si={data:()=>({amount:null,method:"wechat",disabled:!0,methods:[{value:"wechat",label:"微信零钱"},{value:"card",label:"银行卡"}],feeRate:.1,minFee:1,shopmoney:null,mymoney:null}),onLoad(){this.updateMoney()},watch:{amount(e,t){e<=this.shopmoney&&e>=1?this.disabled=!1:this.disabled=!0}},methods:{updateMoney(){l.mymoney({}).then((({data:e})=>{this.mymoney=e.mymoney,this.shopmoney=e.shopmoney}))},validateAmount(){this.amount=this.amount.replace(/[^\d.]/g,"")},selectMethod(e){this.method=e.detail.value},async submitWithdraw(){if("wechat"===this.method)return void uni.showToast({icon:"error",title:"提现至微信暂不支持"});let e=await l.amount({mymoney:parseFloat(this.amount)});200==e.code?(uni.showToast({icon:"success",title:e.message}),this.updateMoney()):uni.showToast({icon:"error",title:e.message})}}};const xi=W(Si,[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"balance-box"},[e.createElementVNode("text",{class:"title"},"可提现余额"),e.createElementVNode("view",{class:"amount"},e.toDisplayString(n.shopmoney)+"元",1)]),e.createElementVNode("view",{class:"input-section",style:{position:"relative"}},[e.createElementVNode("view",{style:{position:"absolute",right:"20rpx",top:"43%","font-size":"26rpx","z-index":"1000"},onClick:i[0]||(i[0]=e=>n.amount=n.shopmoney)},"全部"),e.createElementVNode("text",{class:"label"},"提现金额（元）"),e.withDirectives(e.createElementVNode("input",{class:"input",type:"digit","onUpdate:modelValue":i[1]||(i[1]=e=>n.amount=e),placeholder:"请输入提现金额",onInput:i[2]||(i[2]=(...e)=>r.validateAmount&&r.validateAmount(...e))},null,544),[[e.vModelText,n.amount]]),e.createElementVNode("view",{class:"hint"},"单笔限额1-50000元")]),e.createElementVNode("view",{class:"method-section"},[e.createElementVNode("text",{class:"section-title"},"提现到"),e.createElementVNode("radio-group",{onChange:i[3]||(i[3]=(...e)=>r.selectMethod&&r.selectMethod(...e))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.methods,(t=>(e.openBlock(),e.createElementBlock("label",{class:"method-item",key:t.value},[e.createElementVNode("view",{style:{display:"flex",width:"100%","justify-content":"space-between"}},[e.createElementVNode("view",null,["wechat"==t.value?(e.openBlock(),e.createBlock(l,{key:0,fontFamily:"MyIconFont",size:26,color:"#09bb07;"},{default:e.withCtx((()=>[e.createTextVNode("  ")])),_:1})):e.createCommentVNode("",!0),"card"==t.value?(e.openBlock(),e.createBlock(l,{key:1,fontFamily:"MyIconFont",size:26},{default:e.withCtx((()=>[e.createTextVNode("  ")])),_:1})):e.createCommentVNode("",!0),e.createElementVNode("text",{style:{margin:"7rpx 0 0 10rpx","font-size":"30rpx",position:"absolute"}},e.toDisplayString(t.label),1)]),e.createElementVNode("view",null,[e.createElementVNode("radio",{value:t.value,checked:n.method===t.value},null,8,["value","checked"])])])])))),128))],32)]),e.createElementVNode("button",{class:"submit-btn",disabled:n.disabled,onClick:i[4]||(i[4]=(...e)=>r.submitWithdraw&&r.submitWithdraw(...e))},"立即提现",8,["disabled"]),e.createElementVNode("view",{class:"notice"},[e.createElementVNode("text",{class:"notice-title"},"温馨提示："),e.createElementVNode("view",null," 1. 提现申请将在1-3个工作日内到账; ")])])}],["__scopeId","data-v-94a5af10"]]),Ci={data(){return{statusBarHeight:20,typeOptions:["全部","收入","支出"],typeIndex:0,currentDate:this.formatDate(new Date),bills:[],pageSize:10,currentPage:1,loading:!1,hasMore:!0,themeColor:{primary:"#409EFF",danger:"#F56C6C"}}},computed:{rightTextStyle(){return{income:{color:this.themeColor.primary},expense:{color:this.themeColor.danger}}},filteredBills(){return this.bills.filter((e=>{const t=0===this.typeIndex||1===this.typeIndex&&"income"===e.type||2===this.typeIndex&&"expense"===e.type,a=new Date(e.date).getMonth()===new Date(this.currentDate).getMonth();return t&&a})).slice(0,this.currentPage*this.pageSize)},totalIncome(){return this.bills.filter((e=>"income"===e.type)).reduce(((e,t)=>e+Number(t.amount)),0).toFixed(2)},totalExpense(){return this.bills.filter((e=>"expense"===e.type)).reduce(((e,t)=>e+Number(t.amount)),0).toFixed(2)},navBarStyle(){return{paddingTop:`${this.statusBarHeight}px`,height:"44px",background:this.themeColor.primary}}},methods:{formatDate(e){const t=new Date(e);return`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}`},typeChange(e){this.typeIndex=e.detail.value,this.resetPagination()},dateChange(e){this.currentDate=e.detail.value,this.resetPagination()},resetPagination(){this.currentPage=1,this.hasMore=!0,this.bills=[],this.loadMore()},handleItemClick(e){uni.navigateTo({url:`/pages/bill/detail?id=${e.id}`})},getSystemInfo(){const e=uni.getSystemInfoSync();this.statusBarHeight=e.statusBarHeight||20},async loadMore(){if(!this.loading&&this.hasMore){this.loading=!0;try{const e=await this.mockFetchData();this.bills=[...this.bills,...e],this.hasMore=e.length>=this.pageSize,this.currentPage++}catch(e){t("error","at pages/billRecord/billRecord.vue:177",e)}finally{this.loading=!1}}},mockFetchData(){return new Promise((e=>{setTimeout((()=>{const t=Array.from({length:this.pageSize},((e,t)=>({id:Date.now()+t,type:Math.random()>.5?"income":"expense",category:["工资","餐饮","交通","购物"][Math.floor(4*Math.random())],amount:(2e3*Math.random()+100).toFixed(2),date:new Date((new Date).setDate(Math.floor(30*Math.random()+1))).toISOString().split("T")[0],remark:Math.random()>.7?"测试备注":""})));e(t)}),800)}))}},onLoad(){this.getSystemInfo(),this.loadMore()},onReachBottom(){this.loadMore()}};const Di=W(Ci,[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K),c=a(e.resolveDynamicComponent("uni-list-item"),Re),d=a(e.resolveDynamicComponent("uni-list"),$e);return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"custom-navbar",style:e.normalizeStyle(r.navBarStyle)},[e.createElementVNode("text",{class:"nav-title"},"账单记录")],4),e.createElementVNode("view",{class:"filter-card"},[e.createElementVNode("view",{class:"filter-group"},[e.createElementVNode("picker",{mode:"selector",range:n.typeOptions,onChange:i[0]||(i[0]=(...e)=>r.typeChange&&r.typeChange(...e))},[e.createElementVNode("view",{class:"filter-btn"},[e.createVNode(l,{type:"bars",size:"16",color:"#666"}),e.createElementVNode("text",null,e.toDisplayString(n.typeOptions[n.typeIndex]),1)])],40,["range"]),e.createElementVNode("picker",{mode:"date",fields:"month",onChange:i[1]||(i[1]=(...e)=>r.dateChange&&r.dateChange(...e))},[e.createElementVNode("view",{class:"filter-btn"},[e.createVNode(l,{type:"calendar",size:"16",color:"#666"}),e.createElementVNode("text",null,e.toDisplayString(n.currentDate),1)])],32)])]),e.createElementVNode("view",{class:"stats-card"},[e.createElementVNode("view",{class:"stat-item income"},[e.createElementVNode("text",{class:"stat-label"},"总收入"),e.createElementVNode("text",{class:"stat-value"},"+¥"+e.toDisplayString(r.totalIncome),1)]),e.createElementVNode("view",{class:"stat-item expense"},[e.createElementVNode("text",{class:"stat-label"},"总支出"),e.createElementVNode("text",{class:"stat-value"},"-¥"+e.toDisplayString(r.totalExpense),1)])]),e.createElementVNode("view",{class:"list-container"},[r.filteredBills.length?(e.openBlock(),e.createBlock(d,{key:0},{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.filteredBills,((t,a)=>(e.openBlock(),e.createBlock(c,{key:a,title:t.category,note:r.formatDate(t.date),rightText:"income"===t.type?"+"+t.amount:"-"+t.amount,rightTextStyle:"income"===t.type?r.rightTextStyle.income:r.rightTextStyle.expense,"hover-class":"none",onClick:e=>r.handleItemClick(t)},{footer:e.withCtx((()=>[e.createElementVNode("text",{class:"remark"},e.toDisplayString(t.remark||"暂无备注"),1)])),header:e.withCtx((()=>[e.createVNode(l,{type:"income"===t.type?"arrowthindown":"arrowthinup",color:"income"===t.type?n.themeColor.primary:n.themeColor.danger,size:"20"},null,8,["type","color"])])),_:2},1032,["title","note","rightText","rightTextStyle","onClick"])))),128))])),_:1})):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"loading-state"},[n.loading?(e.openBlock(),e.createElementBlock("text",{key:0,class:"loading-text"},"加载中...")):e.createCommentVNode("",!0),!n.hasMore&&r.filteredBills.length?(e.openBlock(),e.createElementBlock("text",{key:1,class:"no-more"},"已经到底啦\\~")):e.createCommentVNode("",!0)]),n.loading||r.filteredBills.length?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-state"},[e.createElementVNode("text",{class:"empty-text"},"本月还没有账单记录哦～")]))])])}]]);const Ti=W({data:()=>({cardHeight:"380rpx"}),onLoad(){this.calculateLayout()},methods:{goToAddPurchase(){uni.navigateTo({url:"/subPackages/Wholesale/addPurchase/addPurchase"})},goToAddSupply(){uni.navigateTo({url:"/subPackages/Wholesale/addSupply/addSupply"})},toggle(e){this.type=e,this.$refs.popup.open(e)},goToPurchase(){uni.navigateTo({url:"/subPackages/Wholesale/purchase/purchase"})},goToSupply(){uni.navigateTo({url:"/subPackages/Wholesale/supply/supply"})},calculateLayout(){const e=uni.getSystemInfoSync();this.cardHeight=.3*e.windowHeight+"px"},navigateTo(e){uni.navigateTo({url:{supply:"/pages/supply/supply",purchase:"/pages/purchase/purchase"}[e]})}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K),c=a(e.resolveDynamicComponent("uni-popup"),Ya);return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"header-bar"},[e.createElementVNode("text",{class:"platform-name"},"批发")]),e.createElementVNode("view",{class:"main-content"},[e.createElementVNode("view",{class:"nav-card supply-card",style:e.normalizeStyle({height:n.cardHeight}),onClick:i[0]||(i[0]=(...e)=>r.goToSupply&&r.goToSupply(...e))},[e.createElementVNode("view",{class:"card-inner"},[e.createVNode(l,{type:"shop-filled",size:"48",color:"#fff"}),e.createElementVNode("text",{class:"card-title"},"供应大厅"),e.createElementVNode("text",{class:"card-desc"},"浏览最新货源信息")])],4),e.createElementVNode("view",{class:"nav-card purchase-card",style:e.normalizeStyle({height:n.cardHeight}),onClick:i[1]||(i[1]=(...e)=>r.goToPurchase&&r.goToPurchase(...e))},[e.createElementVNode("view",{class:"card-inner"},[e.createVNode(l,{type:"cart-filled",size:"48",color:"#fff"}),e.createElementVNode("text",{class:"card-title"},"采购大厅"),e.createElementVNode("text",{class:"card-desc"},"发布采购需求")])],4),e.createElementVNode("view",{class:"stats-panel"},[e.createElementVNode("view",{class:"stats-item"},[e.createElementVNode("text",{class:"stats-value"},"1,502"),e.createElementVNode("text",{class:"stats-label"},"今日供应量")]),e.createElementVNode("view",{class:"stats-item"},[e.createElementVNode("text",{class:"stats-value"},"893"),e.createElementVNode("text",{class:"stats-label"},"今日采购量")])]),e.createElementVNode("view",{style:{margin:"30rpx 0 0 0",display:"flex","justify-content":"center"},onClick:i[2]||(i[2]=e=>r.toggle("bottom"))},[e.createVNode(l,{type:"plusempty",size:"40",style:{"background-color":"limegreen",padding:"20rpx","border-radius":"10rpx",color:"white"}})]),e.createVNode(c,{ref:"popup",style:{"padding-bottom":"0"}},{default:e.withCtx((()=>[e.createElementVNode("view",{style:{height:"30vh","border-radius":"30rpx 30rpx 0rpx 0rpx","background-color":"white",display:"flex","justify-content":"center","align-items":"center"}},[e.createElementVNode("view",{style:{"text-align":"center",margin:"0 50rpx 0 0"}},[e.createVNode(l,{type:"plusempty",size:"40",style:{"border-radius":"50%"},onClick:r.goToAddPurchase},null,8,["onClick"]),e.createElementVNode("view",{style:{"font-size":"30rpx","font-weight":"bold"}},"发采购"),e.createElementVNode("view",{class:"label"},"让百万供应商为你报价")]),e.createElementVNode("view",{style:{"text-align":"center"}},[e.createVNode(l,{type:"plusempty",size:"40",style:{"border-radius":"50%"},onClick:r.goToAddSupply},null,8,["onClick"]),e.createElementVNode("view",{style:{"font-size":"30rpx","font-weight":"bold"}},"发商品"),e.createElementVNode("view",{class:"label"},"千万采购商找到你")])])])),_:1},512)])])}],["__scopeId","data-v-767e7dd4"]]);const _i=W({data:()=>({})},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"me-container"})}]]);var Pi={email:/^\S+?@\S+?\.\S+?$/,idcard:/^[1-9]\d{5}(18|19|([23]\d))\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/,url:new RegExp("^(?!mailto:)(?:(?:http|https|ftp)://|//)(?:\\S+(?::\\S*)?@)?(?:(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[0-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))|localhost)(?::\\d{2,5})?(?:(/|\\?|#)[^\\s]*)?$","i")};const Ii={int:"integer",bool:"boolean",double:"number",long:"number",password:"string"};function Bi(e,t=""){["label"].forEach((t=>{void 0===e[t]&&(e[t]="")}));let a=t;for(let i in e){let t=new RegExp("{"+i+"}");a=a.replace(t,e[i])}return a}const Ai={integer:e=>Ai.number(e)&&parseInt(e,10)===e,string:e=>"string"==typeof e,number:e=>!isNaN(e)&&"number"==typeof e,boolean:function(e){return"boolean"==typeof e},float:function(e){return Ai.number(e)&&!Ai.integer(e)},array:e=>Array.isArray(e),object:e=>"object"==typeof e&&!Ai.array(e),date:e=>e instanceof Date,timestamp(e){return!(!this.integer(e)||Math.abs(e).toString().length>16)},file:e=>"string"==typeof e.url,email:e=>"string"==typeof e&&!!e.match(Pi.email)&&e.length<255,url:e=>"string"==typeof e&&!!e.match(Pi.url),pattern(e,t){try{return new RegExp(e).test(t)}catch(ms){return!1}},method:e=>"function"==typeof e,idcard:e=>"string"==typeof e&&!!e.match(Pi.idcard),"url-https"(e){return this.url(e)&&e.startsWith("https://")},"url-scheme":e=>e.startsWith("://"),"url-web":e=>!1};class Mi{constructor(e){this._message=e}async validateRule(e,t,a,i,o){var s=null;let n=t.rules;if(n.findIndex((e=>e.required))<0){if(null==a)return s;if("string"==typeof a&&!a.length)return s}var r=this._message;if(void 0===n)return r.default;for(var l=0;l<n.length;l++){let c=n[l],d=this._getValidateType(c);if(Object.assign(c,{label:t.label||`["${e}"]`}),Li[d]&&null!=(s=Li[d](c,a,r)))break;if(c.validateExpr){let e=Date.now();if(!1===c.validateExpr(a,o,e)){s=this._getMessage(c,c.errorMessage||this._message.default);break}}if(c.validateFunction&&null!==(s=await this.validateFunction(c,a,i,o,d)))break}return null!==s&&(s=r.TAG+s),s}async validateFunction(e,t,a,i,o){let s=null;try{let n=null;const r=await e.validateFunction(e,t,i||a,(e=>{n=e}));(n||"string"==typeof r&&r||!1===r)&&(s=this._getMessage(e,n||r,o))}catch(ms){s=this._getMessage(e,ms.message,o)}return s}_getMessage(e,t,a){return Bi(e,t||e.errorMessage||this._message[a]||t.default)}_getValidateType(e){var t="";return e.required?t="required":e.format?t="format":e.arrayType?t="arrayTypeFormat":e.range?t="range":void 0!==e.maximum||void 0!==e.minimum?t="rangeNumber":void 0!==e.maxLength||void 0!==e.minLength?t="rangeLength":e.pattern?t="pattern":e.validateFunction&&(t="validateFunction"),t}}const Li={required:(e,t,a)=>e.required&&function(e,t){return null==e||"string"==typeof e&&!e||!(!Array.isArray(e)||e.length)||"object"===t&&!Object.keys(e).length}(t,e.format||typeof t)?Bi(e,e.errorMessage||a.required):null,range(e,t,a){const{range:i,errorMessage:o}=e;let s=new Array(i.length);for(let r=0;r<i.length;r++){const e=i[r];Ai.object(e)&&void 0!==e.value?s[r]=e.value:s[r]=e}let n=!1;return Array.isArray(t)?n=new Set(t.concat(s)).size===s.length:s.indexOf(t)>-1&&(n=!0),n?null:Bi(e,o||a.enum)},rangeNumber(e,t,a){if(!Ai.number(t))return Bi(e,e.errorMessage||a.pattern.mismatch);let{minimum:i,maximum:o,exclusiveMinimum:s,exclusiveMaximum:n}=e,r=s?t<=i:t<i,l=n?t>=o:t>o;return void 0!==i&&r?Bi(e,e.errorMessage||a.number[s?"exclusiveMinimum":"minimum"]):void 0!==o&&l?Bi(e,e.errorMessage||a.number[n?"exclusiveMaximum":"maximum"]):void 0!==i&&void 0!==o&&(r||l)?Bi(e,e.errorMessage||a.number.range):null},rangeLength(e,t,a){if(!Ai.string(t)&&!Ai.array(t))return Bi(e,e.errorMessage||a.pattern.mismatch);let i=e.minLength,o=e.maxLength,s=t.length;return void 0!==i&&s<i?Bi(e,e.errorMessage||a.length.minLength):void 0!==o&&s>o?Bi(e,e.errorMessage||a.length.maxLength):void 0!==i&&void 0!==o&&(s<i||s>o)?Bi(e,e.errorMessage||a.length.range):null},pattern:(e,t,a)=>Ai.pattern(e.pattern,t)?null:Bi(e,e.errorMessage||a.pattern.mismatch),format(e,t,a){var i=Object.keys(Ai),o=Ii[e.format]?Ii[e.format]:e.format||e.arrayType;return i.indexOf(o)>-1&&!Ai[o](t)?Bi(e,e.errorMessage||a.typeError):null},arrayTypeFormat(e,t,a){if(!Array.isArray(t))return Bi(e,e.errorMessage||a.typeError);for(let i=0;i<t.length;i++){const o=t[i];let s=this.format(e,o,a);if(null!==s)return s}return null}};class Oi extends Mi{constructor(e,t){super(Oi.message),this._schema=e,this._options=t||null}updateSchema(e){this._schema=e}async validate(e,t){let a=this._checkFieldInSchema(e);return a||(a=await this.invokeValidate(e,!1,t)),a.length?a[0]:null}async validateAll(e,t){let a=this._checkFieldInSchema(e);return a||(a=await this.invokeValidate(e,!0,t)),a}async validateUpdate(e,t){let a=this._checkFieldInSchema(e);return a||(a=await this.invokeValidateUpdate(e,!1,t)),a.length?a[0]:null}async invokeValidate(e,t,a){let i=[],o=this._schema;for(let s in o){let n=o[s],r=await this.validateRule(s,n,e[s],e,a);if(null!=r&&(i.push({key:s,errorMessage:r}),!t))break}return i}async invokeValidateUpdate(e,t,a){let i=[];for(let o in e){let s=await this.validateRule(o,this._schema[o],e[o],e,a);if(null!=s&&(i.push({key:o,errorMessage:s}),!t))break}return i}_checkFieldInSchema(e){var t=Object.keys(e),a=Object.keys(this._schema);if(new Set(t.concat(a)).size===a.length)return"";var i=t.filter((e=>a.indexOf(e)<0));return[{key:"invalid",errorMessage:Bi({field:JSON.stringify(i)},Oi.message.TAG+Oi.message.defaultInvalid)}]}}Oi.message=new function(){return{TAG:"",default:"验证错误",defaultInvalid:"提交的字段{field}在数据库中并不存在",validateFunction:"验证无效",required:"{label}必填",enum:"{label}超出范围",timestamp:"{label}格式无效",whitespace:"{label}不能为空",typeError:"{label}类型无效",date:{format:"{label}日期{value}格式无效",parse:"{label}日期无法解析,{value}无效",invalid:"{label}日期{value}无效"},length:{minLength:"{label}长度不能少于{minLength}",maxLength:"{label}长度不能超过{maxLength}",range:"{label}必须介于{minLength}和{maxLength}之间"},number:{minimum:"{label}不能小于{minimum}",maximum:"{label}不能大于{maximum}",exclusiveMinimum:"{label}不能小于等于{minimum}",exclusiveMaximum:"{label}不能大于等于{maximum}",range:"{label}必须介于{minimum}and{maximum}之间"},pattern:{mismatch:"{label}格式不匹配"}}};const Fi=(e,t,a)=>{const i=a.find((e=>{return e.format&&("int"===(t=e.format)||"double"===t||"number"===t||"timestamp"===t);var t})),o=a.find((e=>e.format&&"boolean"===e.format||"bool"===e.format));return i&&(t=t||0===t?Hi(Number(t))?Number(t):t:null),o&&(t=!!Wi(t)&&t),t},Ri=(e,t)=>qi(t,e),zi=(e,t={})=>{const a=Ui(e);if("object"==typeof a&&Array.isArray(a)&&a.length>1){return a.reduce(((e,t)=>e+`#${t}`),"_formdata_")}return a[0]||e},$i=e=>{let t=e.replace("_formdata_#","");return t=t.split("#").map((e=>Hi(e)?Number(e):e)),t},ji=(e,t,a)=>("object"!=typeof e||Ui(t).reduce(((e,t,i,o)=>i===o.length-1?(e[t]=a,null):(t in e||(e[t]=/^[0-9]{1,}$/.test(o[i+1])?[]:{}),e[t])),e),e);function Ui(e){return Array.isArray(e)?e:e.replace(/\[/g,".").replace(/\]/g,"").split(".")}const qi=(e,t,a="undefined")=>{let i=Ui(t).reduce(((e,t)=>(e||{})[t]),e);return i&&void 0===i?a:i},Hi=e=>!isNaN(Number(e)),Wi=e=>"boolean"==typeof e;const Gi=W({name:"uniForms",emits:["validate","submit"],options:{virtualHost:!0},props:{value:{type:Object,default:()=>null},modelValue:{type:Object,default:()=>null},model:{type:Object,default:()=>null},rules:{type:Object,default:()=>({})},errShowType:{type:String,default:"undertext"},validateTrigger:{type:String,default:"submit"},labelPosition:{type:String,default:"left"},labelWidth:{type:[String,Number],default:""},labelAlign:{type:String,default:"left"},border:{type:Boolean,default:!1}},provide(){return{uniForm:this}},data:()=>({formData:{},formRules:{}}),computed:{localData(){const e=this.model||this.modelValue||this.value;return e?(t=e,JSON.parse(JSON.stringify(t))):{};var t}},watch:{rules:{handler:function(e,t){this.setRules(e)},deep:!0,immediate:!0}},created(){getApp().$vm.$.appContext.config.globalProperties.binddata||(getApp().$vm.$.appContext.config.globalProperties.binddata=function(e,a,i){if(i)this.$refs[i].setValue(e,a);else{let i;for(let e in this.$refs){const t=this.$refs[e];if(t&&t.$options&&"uniForms"===t.$options.name){i=t;break}}if(!i)return t("error","at uni_modules/uni-forms/components/uni-forms/uni-forms.vue:182","当前 uni-froms 组件缺少 ref 属性");i.setValue(e,a)}}),this.childrens=[],this.inputChildrens=[],this.setRules(this.rules)},methods:{setRules(e){this.formRules=Object.assign({},this.formRules,e),this.validator=new Oi(e)},setValue(e,t){let a=this.childrens.find((t=>t.name===e));return a?(this.formData[e]=Fi(0,t,this.formRules[e]&&this.formRules[e].rules||[]),a.onFieldChange(this.formData[e])):null},validate(e,t){return this.checkAll(this.formData,e,t)},validateField(e=[],t){e=[].concat(e);let a={};return this.childrens.forEach((t=>{const i=zi(t.name);-1!==e.indexOf(i)&&(a=Object.assign({},a,{[i]:this.formData[i]}))})),this.checkAll(a,[],t)},clearValidate(e=[]){e=[].concat(e),this.childrens.forEach((t=>{if(0===e.length)t.errMsg="";else{const a=zi(t.name);-1!==e.indexOf(a)&&(t.errMsg="")}}))},submit(e,a,i){for(let t in this.dataValue){this.childrens.find((e=>e.name===t))&&void 0===this.formData[t]&&(this.formData[t]=this._getValue(t,this.dataValue[t]))}return i||t("warn","at uni_modules/uni-forms/components/uni-forms/uni-forms.vue:289","submit 方法即将废弃，请使用validate方法代替！"),this.checkAll(this.formData,e,a,"submit")},async checkAll(e,t,a,i){if(!this.validator)return;let o,s=[];for(let c in e){const e=this.childrens.find((e=>zi(e.name)===c));e&&s.push(e)}a||"function"!=typeof t||(a=t),!a&&"function"!=typeof a&&Promise&&(o=new Promise(((e,t)=>{a=function(a,i){a?t(a):e(i)}})));let n=[],r=JSON.parse(JSON.stringify(e));for(let c in s){const e=s[c];let t=zi(e.name);const a=await e.onFieldChange(r[t]);if(a&&(n.push(a),"toast"===this.errShowType||"modal"===this.errShowType))break}Array.isArray(n)&&0===n.length&&(n=null),Array.isArray(t)&&t.forEach((e=>{let t=zi(e),a=Ri(e,this.localData);void 0!==a&&(r[t]=a)})),"submit"===i?this.$emit("submit",{detail:{value:r,errors:n}}):this.$emit("validate",n);let l={};return l=((e={})=>{let t=JSON.parse(JSON.stringify(e)),a={};for(let i in t){let e=$i(i);ji(a,e,t[i])}return a})(r,this.name),a&&"function"==typeof a&&a(n,l),o&&a?o:null},validateCheck(e){this.$emit("validate",e)},_getValue:Fi,_isRequiredField:e=>{let t=!1;for(let a=0;a<e.length;a++){if(e[a].required){t=!0;break}}return t},_setDataValue:(e,t,a)=>(t[e]=a,a||""),_getDataValue:Ri,_realName:zi,_isRealName:e=>/^_formdata_#*/.test(e),_isEqual:(e,t)=>{if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;var a=toString.call(e);if(a!==toString.call(t))return!1;switch(a){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:0==+e?1/+e==1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t}if("[object Object]"==a){var i=Object.getOwnPropertyNames(e),o=Object.getOwnPropertyNames(t);if(i.length!=o.length)return!1;for(var s=0;s<i.length;s++){var n=i[s];if(e[n]!==t[n])return!1}return!0}return"[object Array]"==a?e.toString()==t.toString():void 0}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"uni-forms"},[e.createElementVNode("form",null,[e.renderSlot(t.$slots,"default",{},void 0,!0)])])}],["__scopeId","data-v-bdc00db0"]]),Ji={mixins:[pt],data:()=>({selectedCategoryIndex:0,pickerRange:[],isImageSelected:!1,imglogo:null,setp:1,isPaid:!1,formData:{goodsname:null,imglogo:null,category_id:null}}),computed:{BtnText(){return 1==this.setp?"下一步":"提交"}},onLoad(){this.fetchCategories()},methods:{onCategoryChange(e){const t=e.detail.value;this.selectedCategoryIndex=t,this.formData.category_id=t>0?this.categories[t-1].id:""},fetchCategories(){l.cglist().then((e=>{if(200===e.code){const t=e.data.listdata.map((e=>({id:e.id,content:e.content})));this.categories=t,this.pickerRange=["请选择分类",...t.map((e=>e.content))],t.length>0&&(this.category_id=t[0].id)}else uni.showToast({title:e.message||"获取分类失败",icon:"none"})})).catch((e=>{t("error","at pages/preSale/preSale.vue:330",e),uni.showToast({title:"获取分类失败",icon:"none"})}))},handleConfirm(){l.addPreSale(this.formData).then((e=>{t("log","at pages/preSale/preSale.vue:340",e),200==e.code?(uni.showToast({icon:"success",title:"添加成功"}),setTimeout((()=>{this.customizeBack()}),2e3)):uni.showToast({icon:"error",title:e.msg})}))},chooseImage(){uni.chooseImage({count:1,sizeType:["compressed","original"],sourceType:["album","camera"],success:e=>{const t=e.tempFilePaths;if(t.length>0){const{upload:a,request:i}=Ae({uploadPath:"/group1/upload",tempFilePaths:t[0],file:e.tempFiles[0]});a().then((e=>{var t=JSON.parse(e);this.formData.imglogo=o+t.data.path,this.isImageSelected=!0}))}}})},formatWeek(e){const t=new Date;t.setDate(t.getDate()+7*(e-1));const a=new Date(t);return a.setDate(t.getDate()+6),`${this.formatDate(t)} 至 ${this.formatDate(a)}`},formatDate:e=>`${e.getMonth()+1}-${e.getDate()}`,async gotoSupplement(){this.setp++,this.setp>2&&this.handleConfirm()}}};const Yi=W(Ji,[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K),c=a(e.resolveDynamicComponent("uni-easyinput"),He),d=a(e.resolveDynamicComponent("uni-forms"),Gi);return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"progress-steps"},[e.createElementVNode("view",{class:"step-line"}),e.createElementVNode("view",{class:e.normalizeClass(["step-item",{active:n.setp>=1}])},[e.createElementVNode("view",{class:"step-dot"}),e.createElementVNode("text",{class:"step-text"},"基本信息")],2),e.createElementVNode("view",{class:e.normalizeClass(["step-item",{active:n.setp>=2}])},[e.createElementVNode("view",{class:"step-dot"}),e.createElementVNode("text",{class:"step-text"},"确认提交")],2)]),e.createElementVNode("scroll-view",{"scroll-y":""},[e.withDirectives(e.createElementVNode("view",{class:"form-container"},[e.createElementVNode("view",{class:"form-header"},[e.createVNode(l,{type:"info",size:"20",color:"#2979FF"}),e.createElementVNode("text",{class:"form-title"},"菜品信息")]),e.createVNode(d,{ref:"form",modelValue:n.formData,"label-position":"top"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("label",{class:"form-label"},"预售菜品"),e.createVNode(c,{type:"text",modelValue:n.formData.goodsname,"onUpdate:modelValue":i[0]||(i[0]=e=>n.formData.goodsname=e),placeholder:"请输入菜品名称"},null,8,["modelValue"])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("label",{class:"form-label"},"菜品分类"),e.createElementVNode("picker",{class:"category-picker",range:n.pickerRange,value:n.selectedCategoryIndex,onChange:i[1]||(i[1]=(...e)=>r.onCategoryChange&&r.onCategoryChange(...e))},[e.createElementVNode("view",{class:"picker-content"},[e.createElementVNode("text",null,e.toDisplayString(n.pickerRange[n.selectedCategoryIndex]),1),e.createVNode(l,{type:"arrowdown",size:"14",color:"#666"})])],40,["range","value"])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("label",{class:"form-label upload-label"},[e.createVNode(l,{type:"image",size:"18",color:"#2979FF"}),e.createElementVNode("text",null,"菜品图片")]),e.createElementVNode("view",{class:e.normalizeClass(["upload-area",{"has-image":n.isImageSelected}]),onClick:i[2]||(i[2]=(...e)=>r.chooseImage&&r.chooseImage(...e))},[e.createVNode(l,{type:n.isImageSelected?"checkmarkempty":"plusempty",size:"32",color:n.isImageSelected?"#67C23A":"#C0C4CC"},null,8,["type","color"]),e.createElementVNode("text",{class:"upload-tip"},e.toDisplayString(n.isImageSelected?"上传成功":"点击上传"),1)],2)])])),_:1},8,["modelValue"])],512),[[e.vShow,1==n.setp]]),e.withDirectives(e.createElementVNode("view",{class:"form-container"},[e.createElementVNode("view",{class:"regulations"},[e.createElementVNode("view",{class:"title"},"第一条 商品信息"),e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",null,"1.1"),e.createElementVNode("view",null,"1.2")])]),e.createElementVNode("view",{class:"regulations"},[e.createElementVNode("view",{class:"title"},"第二条 质量保证"),e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",null,"2.1"),e.createElementVNode("view",null,"2.2")])])],512),[[e.vShow,2==n.setp]]),e.createElementVNode("button",{onClick:i[3]||(i[3]=(...e)=>r.gotoSupplement&&r.gotoSupplement(...e)),style:{color:"#ffffff","background-color":"#007aff"}},e.toDisplayString(r.BtnText),1)])])}]]),Ki={subPackages:[{root:"subPackages/PaymentModule",pages:[{path:"PaymentMethod/PaymentMethod",style:{navigationBarTitleText:"支付方式"}},{path:"collectOnDelivery/collectOnDelivery",style:{navigationBarTitleText:"订单状态"}}]},{root:"subPackages/agent",pages:[{path:"cooperation/cooperation",style:{navigationBarTitleText:"申请合作"}},{path:"datacenter/datacenter",style:{navigationBarTitleText:"数据中心"}},{path:"AgentRevenue/AgentRevenue",style:{navigationBarTitleText:""}}]},{root:"subPackages/aHouseholder",pages:[{path:"additionalInformation/additionalInformation",style:{navigationBarTitleText:"补充资料"}},{path:"publishDishes/publishDishes",style:{navigationBarTitleText:"发布菜品"}},{path:"Traceability/Traceability",style:{navigationBarTitleText:"溯源信息补充"}},{path:"lookTraceability/lookTraceability",style:{navigationBarTitleText:"查看溯源信息"}},{path:"PreSoldDishesList/PreSoldDishesList",style:{navigationBarTitleText:"预卖菜品"}},{path:"modifyPreSoldDishes/modifyPreSoldDishes",style:{navigationBarTitleText:"修改预卖菜品"}},{path:"beListed/beListed",style:{navigationBarTitleText:"上市"}},{path:"alreadyListed/alreadyListed",style:{navigationBarTitleText:"已上架"}}]},{root:"subPackages/Wholesale",pages:[{path:"supply/supply",style:{navigationBarTitleText:"供应"}},{path:"purchase/purchase",style:{navigationBarTitleText:"采购"}},{path:"addSupply/addSupply",style:{navigationBarTitleText:"发布供应"}},{path:"addPurchase/addPurchase",style:{navigationBarTitleText:"发布采购"}},{path:"wholesaleNavigation/wholesaleNavigation",style:{navigationBarTitleText:"我的批发"}},{path:"mySupply/mySupply",style:{navigationBarTitleText:"我的供应"}},{path:"myProcurement/myProcurement",style:{navigationBarTitleText:"我的采购"}},{path:"quotation/quotation",style:{navigationBarTitleText:"报价"}}]},{root:"subPackages/shoppingPageList",pages:[{path:"villageZone/villageZone",style:{navigationBarTitleText:"预卖菜品"}},{path:"nearbyFarmers/nearbyFarmers",style:{navigationBarTitleText:"附近农户"}},{path:"agriculturalAssistanceZone/agriculturalAssistanceZone",style:{navigationBarTitleText:"扶贫专区"}},{path:"official/official",style:{navigationBarTitleText:"官方直营"}},{path:"rentalStorefront/rentalStorefront",style:{navigationBarTitleText:"铺面详情"}},{path:"rentalStorefrontList/rentalStorefrontList",style:{navigationBarTitleText:"铺面列表"}},{path:"prePurchaseOrder/prePurchaseOrder",style:{navigationBarTitleText:"预购订单"}},{path:"prePurchaseDeposit/prePurchaseDeposit",style:{navigationBarTitleText:"预买"}},{path:"merchantDetails/merchantDetails",style:{navigationBarTitleText:"农户详情"}},{path:"realTimeInfo/realTimeInfo",style:{navigationBarTitleText:"资讯",disableScroll:!0}},{path:"realTimeInfoDetail/realTimeInfoDetail",style:{navigationBarTitleText:"新闻详情"}},{path:"freeGroceryShopping/freeGroceryShopping",style:{navigationBarTitleText:"免费买菜"}},{path:"statisticsMap/statisticsMap",style:{navigationBarTitleText:""}}]},{root:"subPackages/boothOwner",pages:[{path:"salesApplication/salesApplication",style:{navigationBarTitleText:"代销申请"}},{path:"billRecord/billRecord",style:{navigationBarTitleText:"账单记录"}},{path:"storeSettings/storeSettings",style:{navigationBarTitleText:"店铺设置"}}]},{root:"subPackages/settings",pages:[{path:"user-edit/user-edit",style:{navigationBarTitleText:"修改信息"}},{path:"updatePwd/updatePwd",style:{navigationBarTitleText:"更新密码",enablePullDownRefresh:!1}},{path:"aboutUs/aboutUs",style:{navigationBarTitleText:"关于我们"}},{path:"version/version",style:{navigationBarTitleText:"版本更新"}},{path:"myAddress/myAddress",style:{navigationBarTitleText:"我的地址"}},{path:"addAddress/addAddress",style:{navigationBarTitleText:"地址"}}]}],pages:[{path:"pages/index1/index1",style:{navigationBarTitleText:"首页"}},{path:"pages/index/index",style:{navigationBarTitleText:"农链天下",disableScroll:!0}},{path:"pages/login/login",style:{navigationBarTitleText:"登录"}},{path:"pages/register/register",style:{navigationBarTitleText:"注册"}},{path:"pages/select/select",style:{navigationBarTitleText:"选择登录"}},{path:"pages/sVegetables/sVegetables",style:{navigationBarTitleText:"卖菜"}},{path:"pages/user/user",style:{navigationBarTitleText:"个人中心"}},{path:"pages/ShopDetails/ShopDetails",style:{navigationBarTitleText:"摊主详情","app-plus":{softinputMode:"adjustResize"}}},{path:"pages/Apply/Apply",style:{navigationBarTitleText:"摊主申请"}},{path:"pages/Buy/Buy",style:{navigationBarTitleText:"提交订单"}},{path:"pages/publish/publish",style:{navigationBarTitleText:"菜品新增"}},{path:"pages/release/release",style:{navigationBarTitleText:"发布"}},{path:"pages/stalllist/stalllist",style:{navigationBarTitleText:"摊位列表"}},{path:"pages/coupons/coupons",style:{navigationBarTitleText:"奖品"}},{path:"pages/lottery/lottery",style:{navigationBarTitleText:"抽奖"}},{path:"pages/rules/rules",style:{navigationBarTitleText:"积分活动说明"}},{path:"pages/jackpot/jackpot",style:{navigationBarTitleText:"摇号结果"}},{path:"pages/orders/orders",style:{navigationBarTitleText:"订单"}},{path:"pages/Stalls-dishes/Stalls-dishes",style:{navigationBarTitleText:"菜品"}},{path:"pages/Listed-Dishes/Listed-Dishes",style:{navigationBarTitleText:"上架菜品"}},{path:"pages/usecoupons/usecoupons",style:{navigationBarTitleText:"使用优惠卷"}},{path:"pages/Clock/Clock",style:{navigationBarTitleText:"签到"}},{path:"pages/clock-records/clock-records",style:{navigationBarTitleText:"打卡记录"}},{path:"pages/MyPoints-records/MyPoints-records",style:{navigationBarTitleText:"我的积分"}},{path:"pages/Ownerorders/Ownerorders",style:{navigationBarTitleText:"摊主订单"}},{path:"pages/wallet/wallet",style:{navigationBarTitleText:"钱包"}},{path:"pages/Points/Points",style:{navigationBarTitleText:"积分钱包"}},{path:"pages/pointspayouts/pointspayouts",style:{navigationBarTitleText:"积分提现"}},{path:"pages/Settrecords/Settrecords",style:{navigationBarTitleText:"积分结算记录"}},{path:"pages/editshop/editshop",style:{navigationBarTitleText:"补充摊铺信息",enablePullDownRefresh:!1}},{path:"pages/bankCard/bankCard",style:{navigationBarTitleText:"银行卡",enablePullDownRefresh:!1}},{path:"pages/addCard/addCard",style:{navigationBarTitleText:"添加银行卡",enablePullDownRefresh:!1}},{path:"pages/onlineBooth/onlineBooth",style:{navigationBarTitleText:"网络摊位",enablePullDownRefresh:!1}},{path:"pages/boothOwner/boothOwner",style:{navigationBarTitleText:"摊主"}},{path:"pages/aHouseholder/aHouseholder",style:{navigationBarTitleText:"户主"}},{path:"pages/userServiceAgreement/userServiceAgreement",style:{navigationBarTitleText:"用户服务协议",disableScroll:!0}},{path:"pages/privacyAgreement/privacyAgreement",style:{navigationBarTitleText:"隐私协议",disableScroll:!0}},{path:"pages/OpenAccountSharing/OpenAccountSharing",style:{navigationBarTitleText:"开通分账"}},{path:"pages/arrangeNotification/arrangeNotification",style:{navigationBarTitleText:"通知"}},{path:"pages/weChatCashwWithdrawal/weChatCashwWithdrawal",style:{navigationBarTitleText:""}},{path:"pages/billRecord/billRecord",style:{navigationBarTitleText:"账单记录"}},{path:"pages/wholesale/wholesale",style:{navigationBarTitleText:"批发"}},{path:"pages/prizeDraw/prizeDraw",style:{navigationBarTitleText:"抽奖"}},{path:"pages/preSale/preSale",style:{navigationBarTitleText:"预卖"}},{path:"pages/additionalinformation/additionalinformation",style:{navigationBarTitleText:"补充资料",disableScroll:!0}},{path:"pages/Presalemenulist/Presalemenulist",style:{navigationBarTitleText:""}},{path:"pages/dynamics/dynamics",style:{navigationBarTitleText:"种养来历",disableScroll:!0}},{path:"pages/demo/demo",style:{navigationBarTitleText:""}},{path:"pages/merchantComplaints/merchantComplaints",style:{navigationBarTitleText:"投诉商家"}},{path:"pages/myComplaint/myComplaint",style:{navigationBarTitleText:"我的投诉"}},{path:"pages/complaintDetails/complaintDetails",style:{navigationBarTitleText:"投诉详情",disableScroll:!0}},{path:"pages/settings/settings",style:{navigationBarTitleText:"设置"}},{path:"pages/commodityDetail/commodityDetail",style:{navigationBarTitleText:"商品详情"}},{path:"pages/invitation/invitation",style:{navigationBarTitleText:"邀请好友"}},{path:"pages/earningsRecord/earningsRecord",style:{navigationBarTitleText:""}},{path:"pages/certification/certification",style:{navigationBarTitleText:"认证"}},{path:"pages/agent/agent",style:{navigationBarTitleText:""}}],globalStyle:{navigationBarTextStyle:"black",navigationBarTitleText:"uni-app",navigationBarBackgroundColor:"#F8F8F8",backgroundColor:"#F8F8F8","app-plus":{titleNView:!1}},tabBar:{color:"#666666",selectedColor:"#333333",backgroundColor:"#FFFFFF",list:[{selectedIconPath:"static/image/area_s.png",iconPath:"static/image/area.png",pagePath:"pages/index1/index1",text:"首页"},{selectedIconPath:"static/image/home_s.png",iconPath:"static/image/home.png",pagePath:"pages/index/index",text:"买菜"},{selectedIconPath:"static/image/wholesaleActive.png",iconPath:"static/image/wholesale.png",pagePath:"pages/wholesale/wholesale",text:"批发"},{selectedIconPath:"static/image/selling_s.png",iconPath:"static/image/selling.png",pagePath:"pages/sVegetables/sVegetables",text:"卖菜"},{selectedIconPath:"static/image/user_s.png",iconPath:"static/image/user.png",pagePath:"pages/user/user",text:"我的"}]}};function Zi(e,t,a){return e(a={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&a.path)}},a.exports),a.exports}var Qi=Zi((function(e,t){var a;e.exports=(a=a||function(e){var t=Object.create||function(){function e(){}return function(t){var a;return e.prototype=t,a=new e,e.prototype=null,a}}(),a={},i=a.lib={},o=i.Base={extend:function(e){var a=t(this);return e&&a.mixIn(e),a.hasOwnProperty("init")&&this.init!==a.init||(a.init=function(){a.$super.init.apply(this,arguments)}),a.init.prototype=a,a.$super=this,a},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},s=i.WordArray=o.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||r).stringify(this)},concat:function(e){var t=this.words,a=e.words,i=this.sigBytes,o=e.sigBytes;if(this.clamp(),i%4)for(var s=0;s<o;s++){var n=a[s>>>2]>>>24-s%4*8&255;t[i+s>>>2]|=n<<24-(i+s)%4*8}else for(s=0;s<o;s+=4)t[i+s>>>2]=a[s>>>2];return this.sigBytes+=o,this},clamp:function(){var t=this.words,a=this.sigBytes;t[a>>>2]&=4294967295<<32-a%4*8,t.length=e.ceil(a/4)},clone:function(){var e=o.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var a,i=[],o=function(t){var a=987654321,i=4294967295;return function(){var o=((a=36969*(65535&a)+(a>>16)&i)<<16)+(t=18e3*(65535&t)+(t>>16)&i)&i;return o/=4294967296,(o+=.5)*(e.random()>.5?1:-1)}},n=0;n<t;n+=4){var r=o(4294967296*(a||e.random()));a=987654071*r(),i.push(4294967296*r()|0)}return new s.init(i,t)}}),n=a.enc={},r=n.Hex={stringify:function(e){for(var t=e.words,a=e.sigBytes,i=[],o=0;o<a;o++){var s=t[o>>>2]>>>24-o%4*8&255;i.push((s>>>4).toString(16)),i.push((15&s).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,a=[],i=0;i<t;i+=2)a[i>>>3]|=parseInt(e.substr(i,2),16)<<24-i%8*4;return new s.init(a,t/2)}},l=n.Latin1={stringify:function(e){for(var t=e.words,a=e.sigBytes,i=[],o=0;o<a;o++){var s=t[o>>>2]>>>24-o%4*8&255;i.push(String.fromCharCode(s))}return i.join("")},parse:function(e){for(var t=e.length,a=[],i=0;i<t;i++)a[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;return new s.init(a,t)}},c=n.Utf8={stringify:function(e){try{return decodeURIComponent(escape(l.stringify(e)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(e){return l.parse(unescape(encodeURIComponent(e)))}},d=i.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=c.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var a=this._data,i=a.words,o=a.sigBytes,n=this.blockSize,r=o/(4*n),l=(r=t?e.ceil(r):e.max((0|r)-this._minBufferSize,0))*n,c=e.min(4*l,o);if(l){for(var d=0;d<l;d+=n)this._doProcessBlock(i,d);var u=i.splice(0,l);a.sigBytes-=c}return new s.init(u,c)},clone:function(){var e=o.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});i.Hasher=d.extend({cfg:o.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,a){return new e.init(a).finalize(t)}},_createHmacHelper:function(e){return function(t,a){return new u.HMAC.init(e,a).finalize(t)}}});var u=a.algo={};return a}(Math),a)})),Xi=Qi,eo=(Zi((function(e,t){var a;e.exports=(a=Xi,function(e){var t=a,i=t.lib,o=i.WordArray,s=i.Hasher,n=t.algo,r=[];!function(){for(var t=0;t<64;t++)r[t]=4294967296*e.abs(e.sin(t+1))|0}();var l=n.MD5=s.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var a=0;a<16;a++){var i=t+a,o=e[i];e[i]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}var s=this._hash.words,n=e[t+0],l=e[t+1],h=e[t+2],p=e[t+3],g=e[t+4],f=e[t+5],y=e[t+6],v=e[t+7],w=e[t+8],k=e[t+9],E=e[t+10],N=e[t+11],b=e[t+12],V=e[t+13],S=e[t+14],x=e[t+15],C=s[0],D=s[1],T=s[2],_=s[3];C=c(C,D,T,_,n,7,r[0]),_=c(_,C,D,T,l,12,r[1]),T=c(T,_,C,D,h,17,r[2]),D=c(D,T,_,C,p,22,r[3]),C=c(C,D,T,_,g,7,r[4]),_=c(_,C,D,T,f,12,r[5]),T=c(T,_,C,D,y,17,r[6]),D=c(D,T,_,C,v,22,r[7]),C=c(C,D,T,_,w,7,r[8]),_=c(_,C,D,T,k,12,r[9]),T=c(T,_,C,D,E,17,r[10]),D=c(D,T,_,C,N,22,r[11]),C=c(C,D,T,_,b,7,r[12]),_=c(_,C,D,T,V,12,r[13]),T=c(T,_,C,D,S,17,r[14]),C=d(C,D=c(D,T,_,C,x,22,r[15]),T,_,l,5,r[16]),_=d(_,C,D,T,y,9,r[17]),T=d(T,_,C,D,N,14,r[18]),D=d(D,T,_,C,n,20,r[19]),C=d(C,D,T,_,f,5,r[20]),_=d(_,C,D,T,E,9,r[21]),T=d(T,_,C,D,x,14,r[22]),D=d(D,T,_,C,g,20,r[23]),C=d(C,D,T,_,k,5,r[24]),_=d(_,C,D,T,S,9,r[25]),T=d(T,_,C,D,p,14,r[26]),D=d(D,T,_,C,w,20,r[27]),C=d(C,D,T,_,V,5,r[28]),_=d(_,C,D,T,h,9,r[29]),T=d(T,_,C,D,v,14,r[30]),C=u(C,D=d(D,T,_,C,b,20,r[31]),T,_,f,4,r[32]),_=u(_,C,D,T,w,11,r[33]),T=u(T,_,C,D,N,16,r[34]),D=u(D,T,_,C,S,23,r[35]),C=u(C,D,T,_,l,4,r[36]),_=u(_,C,D,T,g,11,r[37]),T=u(T,_,C,D,v,16,r[38]),D=u(D,T,_,C,E,23,r[39]),C=u(C,D,T,_,V,4,r[40]),_=u(_,C,D,T,n,11,r[41]),T=u(T,_,C,D,p,16,r[42]),D=u(D,T,_,C,y,23,r[43]),C=u(C,D,T,_,k,4,r[44]),_=u(_,C,D,T,b,11,r[45]),T=u(T,_,C,D,x,16,r[46]),C=m(C,D=u(D,T,_,C,h,23,r[47]),T,_,n,6,r[48]),_=m(_,C,D,T,v,10,r[49]),T=m(T,_,C,D,S,15,r[50]),D=m(D,T,_,C,f,21,r[51]),C=m(C,D,T,_,b,6,r[52]),_=m(_,C,D,T,p,10,r[53]),T=m(T,_,C,D,E,15,r[54]),D=m(D,T,_,C,l,21,r[55]),C=m(C,D,T,_,w,6,r[56]),_=m(_,C,D,T,x,10,r[57]),T=m(T,_,C,D,y,15,r[58]),D=m(D,T,_,C,V,21,r[59]),C=m(C,D,T,_,g,6,r[60]),_=m(_,C,D,T,N,10,r[61]),T=m(T,_,C,D,h,15,r[62]),D=m(D,T,_,C,k,21,r[63]),s[0]=s[0]+C|0,s[1]=s[1]+D|0,s[2]=s[2]+T|0,s[3]=s[3]+_|0},_doFinalize:function(){var t=this._data,a=t.words,i=8*this._nDataBytes,o=8*t.sigBytes;a[o>>>5]|=128<<24-o%32;var s=e.floor(i/4294967296),n=i;a[15+(o+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),a[14+(o+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),t.sigBytes=4*(a.length+1),this._process();for(var r=this._hash,l=r.words,c=0;c<4;c++){var d=l[c];l[c]=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8)}return r},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}});function c(e,t,a,i,o,s,n){var r=e+(t&a|~t&i)+o+n;return(r<<s|r>>>32-s)+t}function d(e,t,a,i,o,s,n){var r=e+(t&i|a&~i)+o+n;return(r<<s|r>>>32-s)+t}function u(e,t,a,i,o,s,n){var r=e+(t^a^i)+o+n;return(r<<s|r>>>32-s)+t}function m(e,t,a,i,o,s,n){var r=e+(a^(t|~i))+o+n;return(r<<s|r>>>32-s)+t}t.MD5=s._createHelper(l),t.HmacMD5=s._createHmacHelper(l)}(Math),a.MD5)})),Zi((function(e,t){var a,i,o;e.exports=(i=(a=Xi).lib.Base,o=a.enc.Utf8,void(a.algo.HMAC=i.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=o.parse(t));var a=e.blockSize,i=4*a;t.sigBytes>i&&(t=e.finalize(t)),t.clamp();for(var s=this._oKey=t.clone(),n=this._iKey=t.clone(),r=s.words,l=n.words,c=0;c<a;c++)r[c]^=1549556828,l[c]^=909522486;s.sigBytes=n.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,a=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(a))}})))})),Zi((function(e,t){e.exports=Xi.HmacMD5}))),to=Zi((function(e,t){e.exports=Xi.enc.Utf8})),ao=Zi((function(e,t){var a,i,o;e.exports=(o=(i=a=Xi).lib.WordArray,i.enc.Base64={stringify:function(e){var t=e.words,a=e.sigBytes,i=this._map;e.clamp();for(var o=[],s=0;s<a;s+=3)for(var n=(t[s>>>2]>>>24-s%4*8&255)<<16|(t[s+1>>>2]>>>24-(s+1)%4*8&255)<<8|t[s+2>>>2]>>>24-(s+2)%4*8&255,r=0;r<4&&s+.75*r<a;r++)o.push(i.charAt(n>>>6*(3-r)&63));var l=i.charAt(64);if(l)for(;o.length%4;)o.push(l);return o.join("")},parse:function(e){var t=e.length,a=this._map,i=this._reverseMap;if(!i){i=this._reverseMap=[];for(var s=0;s<a.length;s++)i[a.charCodeAt(s)]=s}var n=a.charAt(64);if(n){var r=e.indexOf(n);-1!==r&&(t=r)}return function(e,t,a){for(var i=[],s=0,n=0;n<t;n++)if(n%4){var r=a[e.charCodeAt(n-1)]<<n%4*2,l=a[e.charCodeAt(n)]>>>6-n%4*2;i[s>>>2]|=(r|l)<<24-s%4*8,s++}return o.create(i,s)}(e,t,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},a.enc.Base64)}));const io="uni_id_token",oo="uni_id_token_expired",so="uniIdToken",no="FUNCTION",ro="OBJECT",lo="CLIENT_DB",co="pending",uo="rejected";function mo(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function ho(e){return"object"===mo(e)}function po(e){return"function"==typeof e}function go(e){return function(){try{return e.apply(e,arguments)}catch(t){console.error(t)}}}const fo="REJECTED",yo="NOT_PENDING";class vo{constructor({createPromise:e,retryRule:t=fo}={}){this.createPromise=e,this.status=null,this.promise=null,this.retryRule=t}get needRetry(){if(!this.status)return!0;switch(this.retryRule){case fo:return this.status===uo;case yo:return this.status!==co}}exec(){return this.needRetry?(this.status=co,this.promise=this.createPromise().then((e=>(this.status="fulfilled",Promise.resolve(e))),(e=>(this.status=uo,Promise.reject(e)))),this.promise):this.promise}}class wo{constructor(){this._callback={}}addListener(e,t){this._callback[e]||(this._callback[e]=[]),this._callback[e].push(t)}on(e,t){return this.addListener(e,t)}removeListener(e,t){if(!t)throw new Error('The "listener" argument must be of type function. Received undefined');const a=this._callback[e];if(!a)return;const i=function(e,t){for(let a=e.length-1;a>=0;a--)if(e[a]===t)return a;return-1}(a,t);a.splice(i,1)}off(e,t){return this.removeListener(e,t)}removeAllListener(e){delete this._callback[e]}emit(e,...t){const a=this._callback[e];if(a)for(let i=0;i<a.length;i++)a[i](...t)}}function ko(e){return e&&"string"==typeof e?JSON.parse(e):e}const Eo=ko([]),No="app";ko("");const bo=ko("[]")||[];let Vo="";try{Vo="__UNI__600C35E"}catch(ms){}let So,xo={};function Co(e,t={}){var a,i;return a=xo,i=e,Object.prototype.hasOwnProperty.call(a,i)||(xo[e]=t),xo[e]}xo=uni._globalUniCloudObj?uni._globalUniCloudObj:uni._globalUniCloudObj={};const Do=["invoke","success","fail","complete"],To=Co("_globalUniCloudInterceptor");function _o(e,t){To[e]||(To[e]={}),ho(t)&&Object.keys(t).forEach((a=>{Do.indexOf(a)>-1&&function(e,t,a){let i=To[e][t];i||(i=To[e][t]=[]),-1===i.indexOf(a)&&po(a)&&i.push(a)}(e,a,t[a])}))}function Po(e,t){To[e]||(To[e]={}),ho(t)?Object.keys(t).forEach((a=>{Do.indexOf(a)>-1&&function(e,t,a){const i=To[e][t];if(!i)return;const o=i.indexOf(a);o>-1&&i.splice(o,1)}(e,a,t[a])})):delete To[e]}function Io(e,t){return e&&0!==e.length?e.reduce(((e,a)=>e.then((()=>a(t)))),Promise.resolve()):Promise.resolve()}function Bo(e,t){return To[e]&&To[e][t]||[]}function Ao(e){_o("callObject",e)}const Mo=Co("_globalUniCloudListener"),Lo={RESPONSE:"response",NEED_LOGIN:"needLogin",REFRESH_TOKEN:"refreshToken"},Oo="clientdb",Fo="cloudfunction",Ro="cloudobject";function zo(e){return Mo[e]||(Mo[e]=[]),Mo[e]}function $o(e,t){const a=zo(e);a.includes(t)||a.push(t)}function jo(e,t){const a=zo(e),i=a.indexOf(t);-1!==i&&a.splice(i,1)}function Uo(e,t){const a=zo(e);for(let i=0;i<a.length;i++)(0,a[i])(t)}let qo,Ho=!1;function Wo(){return qo||(qo=new Promise((e=>{Ho&&e(),function t(){if("function"==typeof getCurrentPages){const t=getCurrentPages();t&&t[0]&&(Ho=!0,e())}Ho||setTimeout((()=>{t()}),30)}()})),qo)}function Go(e){const t={};for(const a in e){const i=e[a];po(i)&&(t[a]=go(i))}return t}class Jo extends Error{constructor(e){const t=e.message||e.errMsg||"unknown system error";super(t),this.errMsg=t,this.code=this.errCode=e.code||e.errCode||"SYSTEM_ERROR",this.errSubject=this.subject=e.subject||e.errSubject,this.cause=e.cause,this.requestId=e.requestId}toJson(e=0){if(!(e>=10))return e++,{errCode:this.errCode,errMsg:this.errMsg,errSubject:this.errSubject,cause:this.cause&&this.cause.toJson?this.cause.toJson(e):this.cause}}}var Yo={request:e=>uni.request(e),uploadFile:e=>uni.uploadFile(e),setStorageSync:(e,t)=>uni.setStorageSync(e,t),getStorageSync:e=>uni.getStorageSync(e),removeStorageSync:e=>uni.removeStorageSync(e),clearStorageSync:()=>uni.clearStorageSync(),connectSocket:e=>uni.connectSocket(e)};function Ko(e){return e&&Ko(e.__v_raw)||e}function Zo(){return{token:Yo.getStorageSync(io)||Yo.getStorageSync(so),tokenExpired:Yo.getStorageSync(oo)}}function Qo({token:e,tokenExpired:t}={}){e&&Yo.setStorageSync(io,e),t&&Yo.setStorageSync(oo,t)}let Xo,es;function ts(){return Xo||(Xo=uni.getSystemInfoSync()),Xo}function as(){let e,t;try{if(uni.getLaunchOptionsSync){if(uni.getLaunchOptionsSync.toString().indexOf("not yet implemented")>-1)return;const{scene:a,channel:i}=uni.getLaunchOptionsSync();e=i,t=a}}catch(a){}return{channel:e,scene:t}}let is={};function os(){const e=uni.getLocale&&uni.getLocale()||"en";if(es)return{...is,...es,locale:e,LOCALE:e};const t=ts(),{deviceId:a,osName:i,uniPlatform:o,appId:s}=t,n=["appId","appLanguage","appName","appVersion","appVersionCode","appWgtVersion","browserName","browserVersion","deviceBrand","deviceId","deviceModel","deviceType","osName","osVersion","romName","romVersion","ua","hostName","hostVersion","uniPlatform","uniRuntimeVersion","uniRuntimeVersionCode","uniCompilerVersion","uniCompilerVersionCode"];for(const r in t)Object.hasOwnProperty.call(t,r)&&-1===n.indexOf(r)&&delete t[r];return es={PLATFORM:o,OS:i,APPID:s,DEVICEID:a,...as(),...t},{...is,...es,locale:e,LOCALE:e}}var ss=function(e,t){let a="";return Object.keys(e).sort().forEach((function(t){e[t]&&(a=a+"&"+t+"="+e[t])})),a=a.slice(1),eo(a,t).toString()},ns=function(e,t){return new Promise(((a,i)=>{t(Object.assign(e,{complete(e){e||(e={});const t=e.data&&e.data.header&&e.data.header["x-serverless-request-id"]||e.header&&e.header["request-id"];if(!e.statusCode||e.statusCode>=400){const a=e.data&&e.data.error&&e.data.error.code||"SYS_ERR",o=e.data&&e.data.error&&e.data.error.message||e.errMsg||"request:fail";return i(new Jo({code:a,message:o,requestId:t}))}const o=e.data;if(o.error)return i(new Jo({code:o.error.code,message:o.error.message,requestId:t}));o.result=o.data,o.requestId=t,delete o.data,a(o)}}))}))},rs=function(e){return ao.stringify(to.parse(e))},ls=class{constructor(e){["spaceId","clientSecret"].forEach((t=>{if(!Object.prototype.hasOwnProperty.call(e,t))throw new Error(`${t} required`)})),this.config=Object.assign({},{endpoint:0===e.spaceId.indexOf("mp-")?"https://api.next.bspapp.com":"https://api.bspapp.com"},e),this.config.provider="aliyun",this.config.requestUrl=this.config.endpoint+"/client",this.config.envType=this.config.envType||"public",this.config.accessTokenKey="access_token_"+this.config.spaceId,this.adapter=Yo,this._getAccessTokenPromiseHub=new vo({createPromise:()=>this.requestAuth(this.setupRequest({method:"serverless.auth.user.anonymousAuthorize",params:"{}"},"auth")).then((e=>{if(!e.result||!e.result.accessToken)throw new Jo({code:"AUTH_FAILED",message:"获取accessToken失败"});this.setAccessToken(e.result.accessToken)})),retryRule:yo})}get hasAccessToken(){return!!this.accessToken}setAccessToken(e){this.accessToken=e}requestWrapped(e){return ns(e,this.adapter.request)}requestAuth(e){return this.requestWrapped(e)}request(e,t){return Promise.resolve().then((()=>this.hasAccessToken?t?this.requestWrapped(e):this.requestWrapped(e).catch((t=>new Promise(((e,a)=>{!t||"GATEWAY_INVALID_TOKEN"!==t.code&&"InvalidParameter.InvalidToken"!==t.code?a(t):e()})).then((()=>this.getAccessToken())).then((()=>{const t=this.rebuildRequest(e);return this.request(t,!0)})))):this.getAccessToken().then((()=>{const t=this.rebuildRequest(e);return this.request(t,!0)}))))}rebuildRequest(e){const t=Object.assign({},e);return t.data.token=this.accessToken,t.header["x-basement-token"]=this.accessToken,t.header["x-serverless-sign"]=ss(t.data,this.config.clientSecret),t}setupRequest(e,t){const a=Object.assign({},e,{spaceId:this.config.spaceId,timestamp:Date.now()}),i={"Content-Type":"application/json"};return"auth"!==t&&(a.token=this.accessToken,i["x-basement-token"]=this.accessToken),i["x-serverless-sign"]=ss(a,this.config.clientSecret),{url:this.config.requestUrl,method:"POST",data:a,dataType:"json",header:i}}getAccessToken(){return this._getAccessTokenPromiseHub.exec()}async authorize(){await this.getAccessToken()}callFunction(e){const t={method:"serverless.function.runtime.invoke",params:JSON.stringify({functionTarget:e.name,functionArgs:e.data||{}})};return this.request({...this.setupRequest(t),timeout:e.timeout})}getOSSUploadOptionsFromPath(e){const t={method:"serverless.file.resource.generateProximalSign",params:JSON.stringify(e)};return this.request(this.setupRequest(t))}uploadFileToOSS({url:e,formData:t,name:a,filePath:i,fileType:o,onUploadProgress:s}){return new Promise(((n,r)=>{const l=this.adapter.uploadFile({url:e,formData:t,name:a,filePath:i,fileType:o,header:{"X-OSS-server-side-encrpytion":"AES256"},success(e){e&&e.statusCode<400?n(e):r(new Jo({code:"UPLOAD_FAILED",message:"文件上传失败"}))},fail(e){r(new Jo({code:e.code||"UPLOAD_FAILED",message:e.message||e.errMsg||"文件上传失败"}))}});"function"==typeof s&&l&&"function"==typeof l.onProgressUpdate&&l.onProgressUpdate((e=>{s({loaded:e.totalBytesSent,total:e.totalBytesExpectedToSend})}))}))}reportOSSUpload(e){const t={method:"serverless.file.resource.report",params:JSON.stringify(e)};return this.request(this.setupRequest(t))}async uploadFile({filePath:e,cloudPath:t,fileType:a="image",cloudPathAsRealPath:i=!1,onUploadProgress:o,config:s}){if("string"!==mo(t))throw new Jo({code:"INVALID_PARAM",message:"cloudPath必须为字符串类型"});if(!(t=t.trim()))throw new Jo({code:"INVALID_PARAM",message:"cloudPath不可为空"});if(/:\/\//.test(t))throw new Jo({code:"INVALID_PARAM",message:"cloudPath不合法"});const n=s&&s.envType||this.config.envType;if(i&&("/"!==t[0]&&(t="/"+t),t.indexOf("\\")>-1))throw new Jo({code:"INVALID_PARAM",message:"使用cloudPath作为路径时，cloudPath不可包含“\\”"});const r=(await this.getOSSUploadOptionsFromPath({env:n,filename:i?t.split("/").pop():t,fileId:i?t:void 0})).result,l="https://"+r.cdnDomain+"/"+r.ossPath,{securityToken:c,accessKeyId:d,signature:u,host:m,ossPath:h,id:p,policy:g,ossCallbackUrl:f}=r,y={"Cache-Control":"max-age=2592000","Content-Disposition":"attachment",OSSAccessKeyId:d,Signature:u,host:m,id:p,key:h,policy:g,success_action_status:200};if(c&&(y["x-oss-security-token"]=c),f){const e=JSON.stringify({callbackUrl:f,callbackBody:JSON.stringify({fileId:p,spaceId:this.config.spaceId}),callbackBodyType:"application/json"});y.callback=rs(e)}const v={url:"https://"+r.host,formData:y,fileName:"file",name:"file",filePath:e,fileType:a};if(await this.uploadFileToOSS(Object.assign({},v,{onUploadProgress:o})),f)return{success:!0,filePath:e,fileID:l};if((await this.reportOSSUpload({id:p})).success)return{success:!0,filePath:e,fileID:l};throw new Jo({code:"UPLOAD_FAILED",message:"文件上传失败"})}getTempFileURL({fileList:e}={}){return new Promise(((t,a)=>{Array.isArray(e)&&0!==e.length||a(new Jo({code:"INVALID_PARAM",message:"fileList的元素必须是非空的字符串"})),this.getFileInfo({fileList:e}).then((a=>{t({fileList:e.map(((e,t)=>{const i=a.fileList[t];return{fileID:e,tempFileURL:i&&i.url||e}}))})}))}))}async getFileInfo({fileList:e}={}){if(!Array.isArray(e)||0===e.length)throw new Jo({code:"INVALID_PARAM",message:"fileList的元素必须是非空的字符串"});const t={method:"serverless.file.resource.info",params:JSON.stringify({id:e.map((e=>e.split("?")[0])).join(",")})};return{fileList:(await this.request(this.setupRequest(t))).result}}},cs={init(e){const t=new ls(e),a={signInAnonymously:function(){return t.authorize()},getLoginState:function(){return Promise.resolve(!1)}};return t.auth=function(){return a},t.customAuth=t.auth,t}};const ds="undefined"!=typeof location&&"http:"===location.protocol?"http:":"https:";var us,ms;(ms=us||(us={})).local="local",ms.none="none",ms.session="session";var hs=function(){},ps=Zi((function(e,t){var a;e.exports=(a=Xi,function(e){var t=a,i=t.lib,o=i.WordArray,s=i.Hasher,n=t.algo,r=[],l=[];!function(){function t(t){for(var a=e.sqrt(t),i=2;i<=a;i++)if(!(t%i))return!1;return!0}function a(e){return 4294967296*(e-(0|e))|0}for(var i=2,o=0;o<64;)t(i)&&(o<8&&(r[o]=a(e.pow(i,.5))),l[o]=a(e.pow(i,1/3)),o++),i++}();var c=[],d=n.SHA256=s.extend({_doReset:function(){this._hash=new o.init(r.slice(0))},_doProcessBlock:function(e,t){for(var a=this._hash.words,i=a[0],o=a[1],s=a[2],n=a[3],r=a[4],d=a[5],u=a[6],m=a[7],h=0;h<64;h++){if(h<16)c[h]=0|e[t+h];else{var p=c[h-15],g=(p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3,f=c[h-2],y=(f<<15|f>>>17)^(f<<13|f>>>19)^f>>>10;c[h]=g+c[h-7]+y+c[h-16]}var v=i&o^i&s^o&s,w=(i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22),k=m+((r<<26|r>>>6)^(r<<21|r>>>11)^(r<<7|r>>>25))+(r&d^~r&u)+l[h]+c[h];m=u,u=d,d=r,r=n+k|0,n=s,s=o,o=i,i=k+(w+v)|0}a[0]=a[0]+i|0,a[1]=a[1]+o|0,a[2]=a[2]+s|0,a[3]=a[3]+n|0,a[4]=a[4]+r|0,a[5]=a[5]+d|0,a[6]=a[6]+u|0,a[7]=a[7]+m|0},_doFinalize:function(){var t=this._data,a=t.words,i=8*this._nDataBytes,o=8*t.sigBytes;return a[o>>>5]|=128<<24-o%32,a[14+(o+64>>>9<<4)]=e.floor(i/4294967296),a[15+(o+64>>>9<<4)]=i,t.sigBytes=4*a.length,this._process(),this._hash},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=s._createHelper(d),t.HmacSHA256=s._createHmacHelper(d)}(Math),a.SHA256)})),gs=ps,fs=Zi((function(e,t){e.exports=Xi.HmacSHA256}));const ys=()=>{let e;if(!Promise){e=()=>{},e.promise={};const t=()=>{throw new Jo({message:'Your Node runtime does support ES6 Promises. Set "global.Promise" to your preferred implementation of promises.'})};return Object.defineProperty(e.promise,"then",{get:t}),Object.defineProperty(e.promise,"catch",{get:t}),e}const t=new Promise(((t,a)=>{e=(e,i)=>e?a(e):t(i)}));return e.promise=t,e};function vs(e){return void 0===e}function ws(e){return"[object Null]"===Object.prototype.toString.call(e)}function ks(e=""){return e.replace(/([\s\S]+)\s+(请前往云开发AI小助手查看问题：.*)/,"$1")}function Es(e=32){let t="";for(let a=0;a<e;a++)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return t}var Ns;!function(e){e.WEB="web",e.WX_MP="wx_mp"}(Ns||(Ns={}));const bs={adapter:null,runtime:void 0},Vs=["anonymousUuidKey"];class Ss extends hs{constructor(){super(),bs.adapter.root.tcbObject||(bs.adapter.root.tcbObject={})}setItem(e,t){bs.adapter.root.tcbObject[e]=t}getItem(e){return bs.adapter.root.tcbObject[e]}removeItem(e){delete bs.adapter.root.tcbObject[e]}clear(){delete bs.adapter.root.tcbObject}}function xs(e,t){switch(e){case"local":return t.localStorage||new Ss;case"none":return new Ss;default:return t.sessionStorage||new Ss}}class Cs{constructor(e){if(!this._storage){this._persistence=bs.adapter.primaryStorage||e.persistence,this._storage=xs(this._persistence,bs.adapter);const t=`access_token_${e.env}`,a=`access_token_expire_${e.env}`,i=`refresh_token_${e.env}`,o=`anonymous_uuid_${e.env}`,s=`login_type_${e.env}`,n="device_id",r=`token_type_${e.env}`,l=`user_info_${e.env}`;this.keys={accessTokenKey:t,accessTokenExpireKey:a,refreshTokenKey:i,anonymousUuidKey:o,loginTypeKey:s,userInfoKey:l,deviceIdKey:n,tokenTypeKey:r}}}updatePersistence(e){if(e===this._persistence)return;const t="local"===this._persistence;this._persistence=e;const a=xs(e,bs.adapter);for(const i in this.keys){const e=this.keys[i];if(t&&Vs.includes(i))continue;const o=this._storage.getItem(e);vs(o)||ws(o)||(a.setItem(e,o),this._storage.removeItem(e))}this._storage=a}setStore(e,t,a){if(!this._storage)return;const i={version:a||"localCachev1",content:t},o=JSON.stringify(i);try{this._storage.setItem(e,o)}catch(s){throw s}}getStore(e,t){try{if(!this._storage)return}catch(i){return""}t=t||"localCachev1";const a=this._storage.getItem(e);return a&&a.indexOf(t)>=0?JSON.parse(a).content:""}removeStore(e){this._storage.removeItem(e)}}const Ds={},Ts={};function _s(e){return Ds[e]}class Ps{constructor(e,t){this.data=t||null,this.name=e}}class Is extends Ps{constructor(e,t){super("error",{error:e,data:t}),this.error=e}}const Bs=new class{constructor(){this._listeners={}}on(e,t){return a=e,i=t,(o=this._listeners)[a]=o[a]||[],o[a].push(i),this;var a,i,o}off(e,t){return function(e,t,a){if(a&&a[e]){const i=a[e].indexOf(t);-1!==i&&a[e].splice(i,1)}}(e,t,this._listeners),this}fire(e,t){if(e instanceof Is)return console.error(e.error),this;const a="string"==typeof e?new Ps(e,t||{}):e,i=a.name;if(this._listens(i)){a.target=this;const e=this._listeners[i]?[...this._listeners[i]]:[];for(const t of e)t.call(this,a)}return this}_listens(e){return this._listeners[e]&&this._listeners[e].length>0}};function As(e,t){Bs.on(e,t)}function Ms(e,t={}){Bs.fire(e,t)}function Ls(e,t){Bs.off(e,t)}const Os="loginStateChanged",Fs="loginStateExpire",Rs="loginTypeChanged",zs="anonymousConverted",$s="refreshAccessToken";var js;!function(e){e.ANONYMOUS="ANONYMOUS",e.WECHAT="WECHAT",e.WECHAT_PUBLIC="WECHAT-PUBLIC",e.WECHAT_OPEN="WECHAT-OPEN",e.CUSTOM="CUSTOM",e.EMAIL="EMAIL",e.USERNAME="USERNAME",e.NULL="NULL"}(js||(js={}));class Us{constructor(){this._fnPromiseMap=new Map}async run(e,t){let a=this._fnPromiseMap.get(e);return a||(a=new Promise((async(a,i)=>{try{await this._runIdlePromise();const e=t();a(await e)}catch(o){i(o)}finally{this._fnPromiseMap.delete(e)}})),this._fnPromiseMap.set(e,a)),a}_runIdlePromise(){return Promise.resolve()}}class qs{constructor(e){this._singlePromise=new Us,this._cache=_s(e.env),this._baseURL=`https://${e.env}.ap-shanghai.tcb-api.tencentcloudapi.com`,this._reqClass=new bs.adapter.reqClass({timeout:e.timeout,timeoutMsg:`请求在${e.timeout/1e3}s内未完成，已中断`,restrictedMethods:["post"]})}_getDeviceId(){if(this._deviceID)return this._deviceID;const{deviceIdKey:e}=this._cache.keys;let t=this._cache.getStore(e);return"string"==typeof t&&t.length>=16&&t.length<=48||(t=Es(),this._cache.setStore(e,t)),this._deviceID=t,t}async _request(e,t,a={}){const i={"x-request-id":Es(),"x-device-id":this._getDeviceId()};if(a.withAccessToken){const{tokenTypeKey:e}=this._cache.keys,t=await this.getAccessToken(),a=this._cache.getStore(e);i.authorization=`${a} ${t}`}return this._reqClass["get"===a.method?"get":"post"]({url:`${this._baseURL}${e}`,data:t,headers:i})}async _fetchAccessToken(){const{loginTypeKey:e,accessTokenKey:t,accessTokenExpireKey:a,tokenTypeKey:i}=this._cache.keys,o=this._cache.getStore(e);if(o&&o!==js.ANONYMOUS)throw new Jo({code:"INVALID_OPERATION",message:"非匿名登录不支持刷新 access token"});const s=await this._singlePromise.run("fetchAccessToken",(async()=>(await this._request("/auth/v1/signin/anonymously",{},{method:"post"})).data)),{access_token:n,expires_in:r,token_type:l}=s;return this._cache.setStore(i,l),this._cache.setStore(t,n),this._cache.setStore(a,Date.now()+1e3*r),n}isAccessTokenExpired(e,t){let a=!0;return e&&t&&(a=t<Date.now()),a}async getAccessToken(){const{accessTokenKey:e,accessTokenExpireKey:t}=this._cache.keys,a=this._cache.getStore(e),i=this._cache.getStore(t);return this.isAccessTokenExpired(a,i)?this._fetchAccessToken():a}async refreshAccessToken(){const{accessTokenKey:e,accessTokenExpireKey:t,loginTypeKey:a}=this._cache.keys;return this._cache.removeStore(e),this._cache.removeStore(t),this._cache.setStore(a,js.ANONYMOUS),this.getAccessToken()}async getUserInfo(){return this._singlePromise.run("getUserInfo",(async()=>(await this._request("/auth/v1/user/me",{},{withAccessToken:!0,method:"get"})).data))}}const Hs=["auth.getJwt","auth.logout","auth.signInWithTicket","auth.signInAnonymously","auth.signIn","auth.fetchAccessTokenWithRefreshToken","auth.signUpWithEmailAndPassword","auth.activateEndUserMail","auth.sendPasswordResetEmail","auth.resetPasswordWithToken","auth.isUsernameRegistered"],Ws={"X-SDK-Version":"1.3.5"};function Gs(e,t,a){const i=e[t];e[t]=function(t){const o={},s={};a.forEach((a=>{const{data:i,headers:n}=a.call(e,t);Object.assign(o,i),Object.assign(s,n)}));const n=t.data;return n&&(()=>{var e;if(e=n,"[object FormData]"!==Object.prototype.toString.call(e))t.data={...n,...o};else for(const t in o)n.append(t,o[t])})(),t.headers={...t.headers||{},...s},i.call(e,t)}}function Js(){const e=Math.random().toString(16).slice(2);return{data:{seqId:e},headers:{...Ws,"x-seqid":e}}}class Ys{constructor(e={}){var t;this.config=e,this._reqClass=new bs.adapter.reqClass({timeout:this.config.timeout,timeoutMsg:`请求在${this.config.timeout/1e3}s内未完成，已中断`,restrictedMethods:["post"]}),this._cache=_s(this.config.env),this._localCache=(t=this.config.env,Ts[t]),this.oauth=new qs(this.config),Gs(this._reqClass,"post",[Js]),Gs(this._reqClass,"upload",[Js]),Gs(this._reqClass,"download",[Js])}async post(e){return await this._reqClass.post(e)}async upload(e){return await this._reqClass.upload(e)}async download(e){return await this._reqClass.download(e)}async refreshAccessToken(){let e,t;this._refreshAccessTokenPromise||(this._refreshAccessTokenPromise=this._refreshAccessToken());try{e=await this._refreshAccessTokenPromise}catch(a){t=a}if(this._refreshAccessTokenPromise=null,this._shouldRefreshAccessTokenHook=null,t)throw t;return e}async _refreshAccessToken(){const{accessTokenKey:e,accessTokenExpireKey:t,refreshTokenKey:a,loginTypeKey:i,anonymousUuidKey:o}=this._cache.keys;this._cache.removeStore(e),this._cache.removeStore(t);let s=this._cache.getStore(a);if(!s)throw new Jo({message:"未登录CloudBase"});const n={refresh_token:s},r=await this.request("auth.fetchAccessTokenWithRefreshToken",n);if(r.data.code){const{code:e}=r.data;if("SIGN_PARAM_INVALID"===e||"REFRESH_TOKEN_EXPIRED"===e||"INVALID_REFRESH_TOKEN"===e){if(this._cache.getStore(i)===js.ANONYMOUS&&"INVALID_REFRESH_TOKEN"===e){const e=this._cache.getStore(o),t=this._cache.getStore(a),i=await this.send("auth.signInAnonymously",{anonymous_uuid:e,refresh_token:t});return this.setRefreshToken(i.refresh_token),this._refreshAccessToken()}Ms(Fs),this._cache.removeStore(a)}throw new Jo({code:r.data.code,message:`刷新access token失败：${r.data.code}`})}if(r.data.access_token)return Ms($s),this._cache.setStore(e,r.data.access_token),this._cache.setStore(t,r.data.access_token_expire+Date.now()),{accessToken:r.data.access_token,accessTokenExpire:r.data.access_token_expire};r.data.refresh_token&&(this._cache.removeStore(a),this._cache.setStore(a,r.data.refresh_token),this._refreshAccessToken())}async getAccessToken(){const{accessTokenKey:e,accessTokenExpireKey:t,refreshTokenKey:a}=this._cache.keys;if(!this._cache.getStore(a))throw new Jo({message:"refresh token不存在，登录状态异常"});let i=this._cache.getStore(e),o=this._cache.getStore(t),s=!0;return this._shouldRefreshAccessTokenHook&&!(await this._shouldRefreshAccessTokenHook(i,o))&&(s=!1),(!i||!o||o<Date.now())&&s?this.refreshAccessToken():{accessToken:i,accessTokenExpire:o}}async request(e,t,a){const i=`x-tcb-trace_${this.config.env}`;let o="application/x-www-form-urlencoded";const s={action:e,env:this.config.env,dataVersion:"2019-08-16",...t};let n;if(-1===Hs.indexOf(e)&&(this._cache.keys,s.access_token=await this.oauth.getAccessToken()),"storage.uploadFile"===e){n=new FormData;for(let e in n)n.hasOwnProperty(e)&&void 0!==n[e]&&n.append(e,s[e]);o="multipart/form-data"}else{o="application/json",n={};for(let e in s)void 0!==s[e]&&(n[e]=s[e])}let r={headers:{"content-type":o}};a&&a.timeout&&(r.timeout=a.timeout),a&&a.onUploadProgress&&(r.onUploadProgress=a.onUploadProgress);const l=this._localCache.getStore(i);l&&(r.headers["X-TCB-Trace"]=l);const{parse:c,inQuery:d,search:u}=t;let m={env:this.config.env};c&&(m.parse=!0),d&&(m={...d,...m});let h=function(e,t,a={}){const i=/\?/.test(t);let o="";for(let s in a)""===o?!i&&(t+="?"):o+="&",o+=`${s}=${encodeURIComponent(a[s])}`;return/^http(s)?\:\/\//.test(t+=o)?t:`${e}${t}`}(ds,"//tcb-api.tencentcloudapi.com/web",m);u&&(h+=u);const p=await this.post({url:h,data:n,...r}),g=p.header&&p.header["x-tcb-trace"];if(g&&this._localCache.setStore(i,g),200!==Number(p.status)&&200!==Number(p.statusCode)||!p.data)throw new Jo({code:"NETWORK_ERROR",message:"network request error"});return p}async send(e,t={},a={}){const i=await this.request(e,t,{...a,onUploadProgress:t.onUploadProgress});if(("ACCESS_TOKEN_DISABLED"===i.data.code||"ACCESS_TOKEN_EXPIRED"===i.data.code)&&-1===Hs.indexOf(e)){await this.oauth.refreshAccessToken();const i=await this.request(e,t,{...a,onUploadProgress:t.onUploadProgress});if(i.data.code)throw new Jo({code:i.data.code,message:ks(i.data.message)});return i.data}if(i.data.code)throw new Jo({code:i.data.code,message:ks(i.data.message)});return i.data}setRefreshToken(e){const{accessTokenKey:t,accessTokenExpireKey:a,refreshTokenKey:i}=this._cache.keys;this._cache.removeStore(t),this._cache.removeStore(a),this._cache.setStore(i,e)}}const Ks={};function Zs(e){return Ks[e]}class Qs{constructor(e){this.config=e,this._cache=_s(e.env),this._request=Zs(e.env)}setRefreshToken(e){const{accessTokenKey:t,accessTokenExpireKey:a,refreshTokenKey:i}=this._cache.keys;this._cache.removeStore(t),this._cache.removeStore(a),this._cache.setStore(i,e)}setAccessToken(e,t){const{accessTokenKey:a,accessTokenExpireKey:i}=this._cache.keys;this._cache.setStore(a,e),this._cache.setStore(i,t)}async refreshUserInfo(){const{data:e}=await this._request.send("auth.getUserInfo",{});return this.setLocalUserInfo(e),e}setLocalUserInfo(e){const{userInfoKey:t}=this._cache.keys;this._cache.setStore(t,e)}}class Xs{constructor(e){if(!e)throw new Jo({code:"PARAM_ERROR",message:"envId is not defined"});this._envId=e,this._cache=_s(this._envId),this._request=Zs(this._envId),this.setUserInfo()}linkWithTicket(e){if("string"!=typeof e)throw new Jo({code:"PARAM_ERROR",message:"ticket must be string"});return this._request.send("auth.linkWithTicket",{ticket:e})}linkWithRedirect(e){e.signInWithRedirect()}updatePassword(e,t){return this._request.send("auth.updatePassword",{oldPassword:t,newPassword:e})}updateEmail(e){return this._request.send("auth.updateEmail",{newEmail:e})}updateUsername(e){if("string"!=typeof e)throw new Jo({code:"PARAM_ERROR",message:"username must be a string"});return this._request.send("auth.updateUsername",{username:e})}async getLinkedUidList(){const{data:e}=await this._request.send("auth.getLinkedUidList",{});let t=!1;const{users:a}=e;return a.forEach((e=>{e.wxOpenId&&e.wxPublicId&&(t=!0)})),{users:a,hasPrimaryUid:t}}setPrimaryUid(e){return this._request.send("auth.setPrimaryUid",{uid:e})}unlink(e){return this._request.send("auth.unlink",{platform:e})}async update(e){const{nickName:t,gender:a,avatarUrl:i,province:o,country:s,city:n}=e,{data:r}=await this._request.send("auth.updateUserInfo",{nickName:t,gender:a,avatarUrl:i,province:o,country:s,city:n});this.setLocalUserInfo(r)}async refresh(){const e=await this._request.oauth.getUserInfo();return this.setLocalUserInfo(e),e}setUserInfo(){const{userInfoKey:e}=this._cache.keys,t=this._cache.getStore(e);["uid","loginType","openid","wxOpenId","wxPublicId","unionId","qqMiniOpenId","email","hasPassword","customUserId","nickName","gender","avatarUrl"].forEach((e=>{this[e]=t[e]})),this.location={country:t.country,province:t.province,city:t.city}}setLocalUserInfo(e){const{userInfoKey:t}=this._cache.keys;this._cache.setStore(t,e),this.setUserInfo()}}class en{constructor(e){if(!e)throw new Jo({code:"PARAM_ERROR",message:"envId is not defined"});this._cache=_s(e);const{refreshTokenKey:t,accessTokenKey:a,accessTokenExpireKey:i}=this._cache.keys,o=this._cache.getStore(t),s=this._cache.getStore(a),n=this._cache.getStore(i);this.credential={refreshToken:o,accessToken:s,accessTokenExpire:n},this.user=new Xs(e)}get isAnonymousAuth(){return this.loginType===js.ANONYMOUS}get isCustomAuth(){return this.loginType===js.CUSTOM}get isWeixinAuth(){return this.loginType===js.WECHAT||this.loginType===js.WECHAT_OPEN||this.loginType===js.WECHAT_PUBLIC}get loginType(){return this._cache.getStore(this._cache.keys.loginTypeKey)}}class tn extends Qs{async signIn(){this._cache.updatePersistence("local"),await this._request.oauth.getAccessToken(),Ms(Os),Ms(Rs,{env:this.config.env,loginType:js.ANONYMOUS,persistence:"local"});const e=new en(this.config.env);return await e.user.refresh(),e}async linkAndRetrieveDataWithTicket(e){const{anonymousUuidKey:t,refreshTokenKey:a}=this._cache.keys,i=this._cache.getStore(t),o=this._cache.getStore(a),s=await this._request.send("auth.linkAndRetrieveDataWithTicket",{anonymous_uuid:i,refresh_token:o,ticket:e});if(s.refresh_token)return this._clearAnonymousUUID(),this.setRefreshToken(s.refresh_token),await this._request.refreshAccessToken(),Ms(zs,{env:this.config.env}),Ms(Rs,{loginType:js.CUSTOM,persistence:"local"}),{credential:{refreshToken:s.refresh_token}};throw new Jo({message:"匿名转化失败"})}_setAnonymousUUID(e){const{anonymousUuidKey:t,loginTypeKey:a}=this._cache.keys;this._cache.removeStore(t),this._cache.setStore(t,e),this._cache.setStore(a,js.ANONYMOUS)}_clearAnonymousUUID(){this._cache.removeStore(this._cache.keys.anonymousUuidKey)}}class an extends Qs{async signIn(e){if("string"!=typeof e)throw new Jo({code:"PARAM_ERROR",message:"ticket must be a string"});const{refreshTokenKey:t}=this._cache.keys,a=await this._request.send("auth.signInWithTicket",{ticket:e,refresh_token:this._cache.getStore(t)||""});if(a.refresh_token)return this.setRefreshToken(a.refresh_token),await this._request.refreshAccessToken(),Ms(Os),Ms(Rs,{env:this.config.env,loginType:js.CUSTOM,persistence:this.config.persistence}),await this.refreshUserInfo(),new en(this.config.env);throw new Jo({message:"自定义登录失败"})}}class on extends Qs{async signIn(e,t){if("string"!=typeof e)throw new Jo({code:"PARAM_ERROR",message:"email must be a string"});const{refreshTokenKey:a}=this._cache.keys,i=await this._request.send("auth.signIn",{loginType:"EMAIL",email:e,password:t,refresh_token:this._cache.getStore(a)||""}),{refresh_token:o,access_token:s,access_token_expire:n}=i;if(o)return this.setRefreshToken(o),s&&n?this.setAccessToken(s,n):await this._request.refreshAccessToken(),await this.refreshUserInfo(),Ms(Os),Ms(Rs,{env:this.config.env,loginType:js.EMAIL,persistence:this.config.persistence}),new en(this.config.env);throw i.code?new Jo({code:i.code,message:`邮箱登录失败: ${i.message}`}):new Jo({message:"邮箱登录失败"})}async activate(e){return this._request.send("auth.activateEndUserMail",{token:e})}async resetPasswordWithToken(e,t){return this._request.send("auth.resetPasswordWithToken",{token:e,newPassword:t})}}class sn extends Qs{async signIn(e,t){if("string"!=typeof e)throw new Jo({code:"PARAM_ERROR",message:"username must be a string"});"string"!=typeof t&&(t="",console.warn("password is empty"));const{refreshTokenKey:a}=this._cache.keys,i=await this._request.send("auth.signIn",{loginType:js.USERNAME,username:e,password:t,refresh_token:this._cache.getStore(a)||""}),{refresh_token:o,access_token_expire:s,access_token:n}=i;if(o)return this.setRefreshToken(o),n&&s?this.setAccessToken(n,s):await this._request.refreshAccessToken(),await this.refreshUserInfo(),Ms(Os),Ms(Rs,{env:this.config.env,loginType:js.USERNAME,persistence:this.config.persistence}),new en(this.config.env);throw i.code?new Jo({code:i.code,message:`用户名密码登录失败: ${i.message}`}):new Jo({message:"用户名密码登录失败"})}}class nn{constructor(e){this.config=e,this._cache=_s(e.env),this._request=Zs(e.env),this._onAnonymousConverted=this._onAnonymousConverted.bind(this),this._onLoginTypeChanged=this._onLoginTypeChanged.bind(this),As(Rs,this._onLoginTypeChanged)}get currentUser(){const e=this.hasLoginState();return e&&e.user||null}get loginType(){return this._cache.getStore(this._cache.keys.loginTypeKey)}anonymousAuthProvider(){return new tn(this.config)}customAuthProvider(){return new an(this.config)}emailAuthProvider(){return new on(this.config)}usernameAuthProvider(){return new sn(this.config)}async signInAnonymously(){return new tn(this.config).signIn()}async signInWithEmailAndPassword(e,t){return new on(this.config).signIn(e,t)}signInWithUsernameAndPassword(e,t){return new sn(this.config).signIn(e,t)}async linkAndRetrieveDataWithTicket(e){return this._anonymousAuthProvider||(this._anonymousAuthProvider=new tn(this.config)),As(zs,this._onAnonymousConverted),await this._anonymousAuthProvider.linkAndRetrieveDataWithTicket(e)}async signOut(){if(this.loginType===js.ANONYMOUS)throw new Jo({message:"匿名用户不支持登出操作"});const{refreshTokenKey:e,accessTokenKey:t,accessTokenExpireKey:a}=this._cache.keys,i=this._cache.getStore(e);if(!i)return;const o=await this._request.send("auth.logout",{refresh_token:i});return this._cache.removeStore(e),this._cache.removeStore(t),this._cache.removeStore(a),Ms(Os),Ms(Rs,{env:this.config.env,loginType:js.NULL,persistence:this.config.persistence}),o}async signUpWithEmailAndPassword(e,t){return this._request.send("auth.signUpWithEmailAndPassword",{email:e,password:t})}async sendPasswordResetEmail(e){return this._request.send("auth.sendPasswordResetEmail",{email:e})}onLoginStateChanged(e){As(Os,(()=>{const t=this.hasLoginState();e.call(this,t)}));const t=this.hasLoginState();e.call(this,t)}onLoginStateExpired(e){As(Fs,e.bind(this))}onAccessTokenRefreshed(e){As($s,e.bind(this))}onAnonymousConverted(e){As(zs,e.bind(this))}onLoginTypeChanged(e){As(Rs,(()=>{const t=this.hasLoginState();e.call(this,t)}))}async getAccessToken(){return{accessToken:(await this._request.getAccessToken()).accessToken,env:this.config.env}}hasLoginState(){const{accessTokenKey:e,accessTokenExpireKey:t}=this._cache.keys,a=this._cache.getStore(e),i=this._cache.getStore(t);return this._request.oauth.isAccessTokenExpired(a,i)?null:new en(this.config.env)}async isUsernameRegistered(e){if("string"!=typeof e)throw new Jo({code:"PARAM_ERROR",message:"username must be a string"});const{data:t}=await this._request.send("auth.isUsernameRegistered",{username:e});return t&&t.isRegistered}getLoginState(){return Promise.resolve(this.hasLoginState())}async signInWithTicket(e){return new an(this.config).signIn(e)}shouldRefreshAccessToken(e){this._request._shouldRefreshAccessTokenHook=e.bind(this)}getUserInfo(){return this._request.send("auth.getUserInfo",{}).then((e=>e.code?e:{...e.data,requestId:e.seqId}))}getAuthHeader(){const{refreshTokenKey:e,accessTokenKey:t}=this._cache.keys,a=this._cache.getStore(e);return{"x-cloudbase-credentials":this._cache.getStore(t)+"/@@/"+a}}_onAnonymousConverted(e){const{env:t}=e.data;t===this.config.env&&this._cache.updatePersistence(this.config.persistence)}_onLoginTypeChanged(e){const{loginType:t,persistence:a,env:i}=e.data;i===this.config.env&&(this._cache.updatePersistence(a),this._cache.setStore(this._cache.keys.loginTypeKey,t))}}const rn=function(e,t){t=t||ys();const a=Zs(this.config.env),{cloudPath:i,filePath:o,onUploadProgress:s,fileType:n="image"}=e;return a.send("storage.getUploadMetadata",{path:i}).then((e=>{const{data:{url:r,authorization:l,token:c,fileId:d,cosFileId:u},requestId:m}=e,h={key:i,signature:l,"x-cos-meta-fileid":u,success_action_status:"201","x-cos-security-token":c};a.upload({url:r,data:h,file:o,name:i,fileType:n,onUploadProgress:s}).then((e=>{201===e.statusCode?t(null,{fileID:d,requestId:m}):t(new Jo({code:"STORAGE_REQUEST_FAIL",message:`STORAGE_REQUEST_FAIL: ${e.data}`}))})).catch((e=>{t(e)}))})).catch((e=>{t(e)})),t.promise},ln=function(e,t){t=t||ys();const a=Zs(this.config.env),{cloudPath:i}=e;return a.send("storage.getUploadMetadata",{path:i}).then((e=>{t(null,e)})).catch((e=>{t(e)})),t.promise},cn=function({fileList:e},t){if(t=t||ys(),!e||!Array.isArray(e))return{code:"INVALID_PARAM",message:"fileList必须是非空的数组"};for(let i of e)if(!i||"string"!=typeof i)return{code:"INVALID_PARAM",message:"fileList的元素必须是非空的字符串"};const a={fileid_list:e};return Zs(this.config.env).send("storage.batchDeleteFile",a).then((e=>{e.code?t(null,e):t(null,{fileList:e.data.delete_list,requestId:e.requestId})})).catch((e=>{t(e)})),t.promise},dn=function({fileList:e},t){t=t||ys(),e&&Array.isArray(e)||t(null,{code:"INVALID_PARAM",message:"fileList必须是非空的数组"});let a=[];for(let o of e)"object"==typeof o?(o.hasOwnProperty("fileID")&&o.hasOwnProperty("maxAge")||t(null,{code:"INVALID_PARAM",message:"fileList的元素必须是包含fileID和maxAge的对象"}),a.push({fileid:o.fileID,max_age:o.maxAge})):"string"==typeof o?a.push({fileid:o}):t(null,{code:"INVALID_PARAM",message:"fileList的元素必须是字符串"});const i={file_list:a};return Zs(this.config.env).send("storage.batchGetDownloadUrl",i).then((e=>{e.code?t(null,e):t(null,{fileList:e.data.download_list,requestId:e.requestId})})).catch((e=>{t(e)})),t.promise},un=async function({fileID:e},t){const a=(await dn.call(this,{fileList:[{fileID:e,maxAge:600}]})).fileList[0];if("SUCCESS"!==a.code)return t?t(a):new Promise((e=>{e(a)}));const i=Zs(this.config.env);let o=a.download_url;if(o=encodeURI(o),!t)return i.download({url:o});t(await i.download({url:o}))},mn=function({name:e,data:t,query:a,parse:i,search:o,timeout:s},n){const r=n||ys();let l;try{l=t?JSON.stringify(t):""}catch(d){return Promise.reject(d)}if(!e)return Promise.reject(new Jo({code:"PARAM_ERROR",message:"函数名不能为空"}));const c={inQuery:a,parse:i,search:o,function_name:e,request_data:l};return Zs(this.config.env).send("functions.invokeFunction",c,{timeout:s}).then((e=>{if(e.code)r(null,e);else{let a=e.data.response_data;if(i)r(null,{result:a,requestId:e.requestId});else try{a=JSON.parse(e.data.response_data),r(null,{result:a,requestId:e.requestId})}catch(t){r(new Jo({message:"response data must be json"}))}}return r.promise})).catch((e=>{r(e)})),r.promise},hn={timeout:15e3,persistence:"session"},pn=6e5,gn={};class fn{constructor(e){this.config=e||this.config,this.authObj=void 0}init(e){switch(bs.adapter||(this.requestClient=new bs.adapter.reqClass({timeout:e.timeout||5e3,timeoutMsg:`请求在${(e.timeout||5e3)/1e3}s内未完成，已中断`})),this.config={...hn,...e},!0){case this.config.timeout>pn:console.warn("timeout大于可配置上限[10分钟]，已重置为上限数值"),this.config.timeout=pn;break;case this.config.timeout<100:console.warn("timeout小于可配置下限[100ms]，已重置为下限数值"),this.config.timeout=100}return new fn(this.config)}auth({persistence:e}={}){if(this.authObj)return this.authObj;const t=e||bs.adapter.primaryStorage||hn.persistence;var a;return t!==this.config.persistence&&(this.config.persistence=t),function(e){const{env:t}=e;Ds[t]=new Cs(e),Ts[t]=new Cs({...e,persistence:"local"})}(this.config),a=this.config,Ks[a.env]=new Ys(a),this.authObj=new nn(this.config),this.authObj}on(e,t){return As.apply(this,[e,t])}off(e,t){return Ls.apply(this,[e,t])}callFunction(e,t){return mn.apply(this,[e,t])}deleteFile(e,t){return cn.apply(this,[e,t])}getTempFileURL(e,t){return dn.apply(this,[e,t])}downloadFile(e,t){return un.apply(this,[e,t])}uploadFile(e,t){return rn.apply(this,[e,t])}getUploadMetadata(e,t){return ln.apply(this,[e,t])}registerExtension(e){gn[e.name]=e}async invokeExtension(e,t){const a=gn[e];if(!a)throw new Jo({message:`扩展${e} 必须先注册`});return await a.invoke(t,this)}useAdapters(e){const{adapter:t,runtime:a}=function(e){const t=(a=e,"[object Array]"===Object.prototype.toString.call(a)?e:[e]);var a;for(const i of t){const{isMatch:e,genAdapter:t,runtime:a}=i;if(e())return{adapter:t(),runtime:a}}}(e)||{};t&&(bs.adapter=t),a&&(bs.runtime=a)}}var yn=new fn;function vn(e,t,a){void 0===a&&(a={});var i=/\?/.test(t),o="";for(var s in a)""===o?!i&&(t+="?"):o+="&",o+=s+"="+encodeURIComponent(a[s]);return/^http(s)?:\/\//.test(t+=o)?t:""+e+t}class wn{get(e){const{url:t,data:a,headers:i,timeout:o}=e;return new Promise(((e,s)=>{Yo.request({url:vn("https:",t),data:a,method:"GET",header:i,timeout:o,success(t){e(t)},fail(e){s(e)}})}))}post(e){const{url:t,data:a,headers:i,timeout:o}=e;return new Promise(((e,s)=>{Yo.request({url:vn("https:",t),data:a,method:"POST",header:i,timeout:o,success(t){e(t)},fail(e){s(e)}})}))}upload(e){return new Promise(((t,a)=>{const{url:i,file:o,data:s,headers:n,fileType:r}=e,l=Yo.uploadFile({url:vn("https:",i),name:"file",formData:Object.assign({},s),filePath:o,fileType:r,header:n,success(e){const a={statusCode:e.statusCode,data:e.data||{}};200===e.statusCode&&s.success_action_status&&(a.statusCode=parseInt(s.success_action_status,10)),t(a)},fail(e){a(new Error(e.errMsg||"uploadFile:fail"))}});"function"==typeof e.onUploadProgress&&l&&"function"==typeof l.onProgressUpdate&&l.onProgressUpdate((t=>{e.onUploadProgress({loaded:t.totalBytesSent,total:t.totalBytesExpectedToSend})}))}))}}const kn={setItem(e,t){Yo.setStorageSync(e,t)},getItem:e=>Yo.getStorageSync(e),removeItem(e){Yo.removeStorageSync(e)},clear(){Yo.clearStorageSync()}};var En={genAdapter:function(){return{root:{},reqClass:wn,localStorage:kn,primaryStorage:"local"}},isMatch:function(){return!0},runtime:"uni_app"};yn.useAdapters(En);const Nn=yn,bn=Nn.init;Nn.init=function(e){e.env=e.spaceId;const t=bn.call(this,e);t.config.provider="tencent",t.config.spaceId=e.spaceId;const a=t.auth;return t.auth=function(e){const t=a.call(this,e);return["linkAndRetrieveDataWithTicket","signInAnonymously","signOut","getAccessToken","getLoginState","signInWithTicket","getUserInfo"].forEach((e=>{var a;t[e]=(a=t[e],function(e){e=e||{};const{success:t,fail:i,complete:o}=Go(e);if(!(t||i||o))return a.call(this,e);a.call(this,e).then((e=>{t&&t(e),o&&o(e)}),(e=>{i&&i(e),o&&o(e)}))}).bind(t)})),t},t.customAuth=t.auth,t};var Vn=Nn;async function Sn(e,t){const a=`http://${e}:${t}/system/ping`;try{const e=await(i={url:a,timeout:500},new Promise(((e,t)=>{Yo.request({...i,success(t){e(t)},fail(e){t(e)}})})));return!(!e.data||0!==e.data.code)}catch(o){return!1}var i}const xn={"serverless.file.resource.generateProximalSign":"storage/generate-proximal-sign","serverless.file.resource.report":"storage/report","serverless.file.resource.delete":"storage/delete","serverless.file.resource.getTempFileURL":"storage/get-temp-file-url"};var Cn=class{constructor(e){if(["spaceId","clientSecret"].forEach((t=>{if(!Object.prototype.hasOwnProperty.call(e,t))throw new Error(`${t} required`)})),!e.endpoint)throw new Error("集群空间未配置ApiEndpoint，配置后需要重新关联服务空间后生效");this.config=Object.assign({},e),this.config.provider="dcloud",this.config.requestUrl=this.config.endpoint+"/client",this.config.envType=this.config.envType||"public",this.adapter=Yo}async request(e,t=!0){return e=this.setupRequest(e),Promise.resolve().then((()=>ns(e,this.adapter.request)))}requestLocal(e){return new Promise(((t,a)=>{this.adapter.request(Object.assign(e,{complete(e){if(e||(e={}),!e.statusCode||e.statusCode>=400){const t=e.data&&e.data.code||"SYS_ERR",i=e.data&&e.data.message||"request:fail";return a(new Jo({code:t,message:i}))}t({success:!0,result:e.data})}}))}))}setupRequest(e){const t=Object.assign({},e,{spaceId:this.config.spaceId,timestamp:Date.now()}),a={"Content-Type":"application/json"};a["x-serverless-sign"]=ss(t,this.config.clientSecret);const i=os();a["x-client-info"]=encodeURIComponent(JSON.stringify(i));const{token:o}=Zo();return a["x-client-token"]=o,{url:this.config.requestUrl,method:"POST",data:t,dataType:"json",header:JSON.parse(JSON.stringify(a))}}async setupLocalRequest(e){const t=os(),{token:a}=Zo(),i=Object.assign({},e,{spaceId:this.config.spaceId,timestamp:Date.now(),clientInfo:t,token:a}),{address:o,servePort:s}=this.__dev__&&this.__dev__.debugInfo||{},{address:n}=await async function(e,t){let a;for(let i=0;i<e.length;i++){const o=e[i];if(await Sn(o,t)){a=o;break}}return{address:a,port:t}}(o,s);return{url:`http://${n}:${s}/${xn[e.method]}`,method:"POST",data:i,dataType:"json",header:JSON.parse(JSON.stringify({"Content-Type":"application/json"}))}}callFunction(e){const t={method:"serverless.function.runtime.invoke",params:JSON.stringify({functionTarget:e.name,functionArgs:e.data||{}})};return this.request(t,!1)}getUploadFileOptions(e){const t={method:"serverless.file.resource.generateProximalSign",params:JSON.stringify(e)};return this.request(t)}reportUploadFile(e){const t={method:"serverless.file.resource.report",params:JSON.stringify(e)};return this.request(t)}uploadFile({filePath:e,cloudPath:t,fileType:a="image",onUploadProgress:i}){if(!t)throw new Jo({code:"CLOUDPATH_REQUIRED",message:"cloudPath不可为空"});let o;return this.getUploadFileOptions({cloudPath:t}).then((t=>{const{url:s,formData:n,name:r}=t.result;return o=t.result.fileUrl,new Promise(((t,o)=>{const l=this.adapter.uploadFile({url:s,formData:n,name:r,filePath:e,fileType:a,success(e){e&&e.statusCode<400?t(e):o(new Jo({code:"UPLOAD_FAILED",message:"文件上传失败"}))},fail(e){o(new Jo({code:e.code||"UPLOAD_FAILED",message:e.message||e.errMsg||"文件上传失败"}))}});"function"==typeof i&&l&&"function"==typeof l.onProgressUpdate&&l.onProgressUpdate((e=>{i({loaded:e.totalBytesSent,total:e.totalBytesExpectedToSend})}))}))})).then((()=>this.reportUploadFile({cloudPath:t}))).then((t=>new Promise(((a,i)=>{t.success?a({success:!0,filePath:e,fileID:o}):i(new Jo({code:"UPLOAD_FAILED",message:"文件上传失败"}))}))))}deleteFile({fileList:e}){const t={method:"serverless.file.resource.delete",params:JSON.stringify({fileList:e})};return this.request(t).then((e=>{if(e.success)return e.result;throw new Jo({code:"DELETE_FILE_FAILED",message:"删除文件失败"})}))}getTempFileURL({fileList:e,maxAge:t}={}){if(!Array.isArray(e)||0===e.length)throw new Jo({code:"INVALID_PARAM",message:"fileList的元素必须是非空的字符串"});const a={method:"serverless.file.resource.getTempFileURL",params:JSON.stringify({fileList:e,maxAge:t})};return this.request(a).then((e=>{if(e.success)return{fileList:e.result.fileList.map((e=>({fileID:e.fileID,tempFileURL:e.tempFileURL})))};throw new Jo({code:"GET_TEMP_FILE_URL_FAILED",message:"获取临时文件链接失败"})}))}},Dn={init(e){const t=new Cn(e),a={signInAnonymously:function(){return Promise.resolve()},getLoginState:function(){return Promise.resolve(!1)}};return t.auth=function(){return a},t.customAuth=t.auth,t}},Tn=Zi((function(e,t){e.exports=Xi.enc.Hex}));function _n(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}function Pn(e="",t={}){const{data:a,functionName:i,method:o,headers:s,signHeaderKeys:n=[],config:r}=t,l=String(Date.now()),c=_n(),d=Object.assign({},s,{"x-from-app-id":r.spaceAppId,"x-from-env-id":r.spaceId,"x-to-env-id":r.spaceId,"x-from-instance-id":l,"x-from-function-name":i,"x-client-timestamp":l,"x-alipay-source":"client","x-request-id":c,"x-alipay-callid":c,"x-trace-id":c}),u=["x-from-app-id","x-from-env-id","x-to-env-id","x-from-instance-id","x-from-function-name","x-client-timestamp"].concat(n),[m="",h=""]=e.split("?")||[],p=function(e){const t="HMAC-SHA256",a=e.signedHeaders.join(";"),i=e.signedHeaders.map((t=>`${t.toLowerCase()}:${e.headers[t]}\n`)).join(""),o=gs(e.body).toString(Tn),s=`${e.method.toUpperCase()}\n${e.path}\n${e.query}\n${i}\n${a}\n${o}\n`,n=gs(s).toString(Tn),r=`${t}\n${e.timestamp}\n${n}\n`,l=fs(r,e.secretKey).toString(Tn);return`${t} Credential=${e.secretId}, SignedHeaders=${a}, Signature=${l}`}({path:m,query:h,method:o,headers:d,timestamp:l,body:JSON.stringify(a),secretId:r.accessKey,secretKey:r.secretKey,signedHeaders:u.sort()});return{url:`${r.endpoint}${e}`,headers:Object.assign({},d,{Authorization:p})}}function In({url:e,data:t,method:a="POST",headers:i={},timeout:o}){return new Promise(((s,n)=>{Yo.request({url:e,method:a,data:"object"==typeof t?JSON.stringify(t):t,header:i,dataType:"json",timeout:o,complete:(e={})=>{const t=i["x-trace-id"]||"";if(!e.statusCode||e.statusCode>=400){const{message:a,errMsg:i,trace_id:o}=e.data||{};return n(new Jo({code:"SYS_ERR",message:a||i||"request:fail",requestId:o||t}))}s({status:e.statusCode,data:e.data,headers:e.header,requestId:t})}})}))}function Bn(e,t){const{path:a,data:i,method:o="GET"}=e,{url:s,headers:n}=Pn(a,{functionName:"",data:i,method:o,headers:{"x-alipay-cloud-mode":"oss","x-data-api-type":"oss","x-expire-timestamp":String(Date.now()+6e4)},signHeaderKeys:["x-data-api-type","x-expire-timestamp"],config:t});return In({url:s,data:i,method:o,headers:n}).then((e=>{const t=e.data||{};if(!t.success)throw new Jo({code:e.errCode,message:e.errMsg,requestId:e.requestId});return t.data||{}})).catch((e=>{throw new Jo({code:e.errCode,message:e.errMsg,requestId:e.requestId})}))}function An(e=""){const t=e.trim().replace(/^cloud:\/\//,""),a=t.indexOf("/");if(a<=0)throw new Jo({code:"INVALID_PARAM",message:"fileID不合法"});const i=t.substring(0,a),o=t.substring(a+1);return i!==this.config.spaceId&&console.warn("file ".concat(e," does not belong to env ").concat(this.config.spaceId)),o}function Mn(e=""){return"cloud://".concat(this.config.spaceId,"/").concat(e.replace(/^\/+/,""))}class Ln{constructor(e){this.config=e}signedURL(e,t={}){const a=`/ws/function/${e}`,i=this.config.wsEndpoint.replace(/^ws(s)?:\/\//,""),o=Object.assign({},t,{accessKeyId:this.config.accessKey,signatureNonce:_n(),timestamp:""+Date.now()}),s=[a,["accessKeyId","authorization","signatureNonce","timestamp"].sort().map((function(e){return o[e]?"".concat(e,"=").concat(o[e]):null})).filter(Boolean).join("&"),`host:${i}`].join("\n"),n=["HMAC-SHA256",gs(s).toString(Tn)].join("\n"),r=fs(n,this.config.secretKey).toString(Tn),l=Object.keys(o).map((e=>`${e}=${encodeURIComponent(o[e])}`)).join("&");return`${this.config.wsEndpoint}${a}?${l}&signature=${r}`}}var On=class{constructor(e){if(["spaceId","spaceAppId","accessKey","secretKey"].forEach((t=>{if(!Object.prototype.hasOwnProperty.call(e,t))throw new Error(`${t} required`)})),e.endpoint){if("string"!=typeof e.endpoint)throw new Error("endpoint must be string");if(!/^https:\/\//.test(e.endpoint))throw new Error("endpoint must start with https://");e.endpoint=e.endpoint.replace(/\/$/,"")}this.config=Object.assign({},e,{endpoint:e.endpoint||`https://${e.spaceId}.api-hz.cloudbasefunction.cn`,wsEndpoint:e.wsEndpoint||`wss://${e.spaceId}.api-hz.cloudbasefunction.cn`}),this._websocket=new Ln(this.config)}callFunction(e){return function(e,t){const{name:a,data:i,async:o=!1,timeout:s}=e,n="POST",r={"x-to-function-name":a};o&&(r["x-function-invoke-type"]="async");const{url:l,headers:c}=Pn("/functions/invokeFunction",{functionName:a,data:i,method:n,headers:r,signHeaderKeys:["x-to-function-name"],config:t});return In({url:l,data:i,method:n,headers:c,timeout:s}).then((e=>{let t=0;if(o){const a=e.data||{};t="200"===a.errCode?0:a.errCode,e.data=a.data||{},e.errMsg=a.errMsg}if(0!==t)throw new Jo({code:t,message:e.errMsg,requestId:e.requestId});return{errCode:t,success:0===t,requestId:e.requestId,result:e.data}})).catch((e=>{throw new Jo({code:e.errCode,message:e.errMsg,requestId:e.requestId})}))}(e,this.config)}uploadFileToOSS({url:e,filePath:t,fileType:a,formData:i,onUploadProgress:o}){return new Promise(((s,n)=>{const r=Yo.uploadFile({url:e,filePath:t,fileType:a,formData:i,name:"file",success(e){e&&e.statusCode<400?s(e):n(new Jo({code:"UPLOAD_FAILED",message:"文件上传失败"}))},fail(e){n(new Jo({code:e.code||"UPLOAD_FAILED",message:e.message||e.errMsg||"文件上传失败"}))}});"function"==typeof o&&r&&"function"==typeof r.onProgressUpdate&&r.onProgressUpdate((e=>{o({loaded:e.totalBytesSent,total:e.totalBytesExpectedToSend})}))}))}async uploadFile({filePath:e,cloudPath:t="",fileType:a="image",onUploadProgress:i}){if("string"!==mo(t))throw new Jo({code:"INVALID_PARAM",message:"cloudPath必须为字符串类型"});if(!(t=t.trim()))throw new Jo({code:"INVALID_PARAM",message:"cloudPath不可为空"});if(/:\/\//.test(t))throw new Jo({code:"INVALID_PARAM",message:"cloudPath不合法"});const o=await Bn({path:"/".concat(t.replace(/^\//,""),"?post_url")},this.config),{file_id:s,upload_url:n,form_data:r}=o,l=r&&r.reduce(((e,t)=>(e[t.key]=t.value,e)),{});return this.uploadFileToOSS({url:n,filePath:e,fileType:a,formData:l,onUploadProgress:i}).then((()=>({fileID:s})))}async getTempFileURL({fileList:e}){return new Promise(((t,a)=>{(!e||e.length<0)&&t({code:"INVALID_PARAM",message:"fileList不能为空数组"}),e.length>50&&t({code:"INVALID_PARAM",message:"fileList数组长度不能超过50"});const i=[];for(const s of e){let e;"string"!==mo(s)&&t({code:"INVALID_PARAM",message:"fileList的元素必须是非空的字符串"});try{e=An.call(this,s)}catch(o){console.warn(o.errCode,o.errMsg),e=s}i.push({file_id:e,expire:600})}Bn({path:"/?download_url",data:{file_list:i},method:"POST"},this.config).then((e=>{const{file_list:a=[]}=e;t({fileList:a.map((e=>({fileID:Mn.call(this,e.file_id),tempFileURL:e.download_url})))})})).catch((e=>a(e)))}))}async connectWebSocket(e){const{name:t,query:a}=e;return Yo.connectSocket({url:this._websocket.signedURL(t,a),complete:()=>{}})}},Fn={init:e=>{e.provider="alipay";const t=new On(e);return t.auth=function(){return{signInAnonymously:function(){return Promise.resolve()},getLoginState:function(){return Promise.resolve(!0)}}},t}};function Rn({data:e}){let t;t=os();const a=JSON.parse(JSON.stringify(e||{}));if(Object.assign(a,{clientInfo:t}),!a.uniIdToken){const{token:e}=Zo();e&&(a.uniIdToken=e)}return a}const zn=[{rule:/fc_function_not_found|FUNCTION_NOT_FOUND/,content:"，云函数[{functionName}]在云端不存在，请检查此云函数名称是否正确以及该云函数是否已上传到服务空间",mode:"append"}];var $n=/[\\^$.*+?()[\]{}|]/g,jn=RegExp($n.source);function Un(e,t,a){return e.replace(new RegExp((i=t)&&jn.test(i)?i.replace($n,"\\$&"):i,"g"),a);var i}const qn={NONE:"none",REQUEST:"request",RESPONSE:"response",BOTH:"both"},Hn="_globalUniCloudStatus",Wn="_globalUniCloudSecureNetworkCache__{spaceId}",Gn="uni-secure-network",Jn={SYSTEM_ERROR:{code:2e4,message:"System error"},APP_INFO_INVALID:{code:20101,message:"Invalid client"},GET_ENCRYPT_KEY_FAILED:{code:20102,message:"Get encrypt key failed"}};function Yn(e){const{errSubject:t,subject:a,errCode:i,errMsg:o,code:s,message:n,cause:r}=e||{};return new Jo({subject:t||a||Gn,code:i||s||Jn.SYSTEM_ERROR.code,message:o||n,cause:r})}let Kn;function Zn({secretType:e}={}){return e===qn.REQUEST||e===qn.RESPONSE||e===qn.BOTH}function Qn({name:e,data:t={}}={}){return"DCloud-clientDB"===e&&"encryption"===t.redirectTo&&"getAppClientKey"===t.action}function Xn({functionName:e,result:t,logPvd:a}){}function er(e){const t=e.callFunction,a=function(a){const i=a.name;a.data=Rn.call(e,{data:a.data});const o={aliyun:"aliyun",tencent:"tcb",tcb:"tcb",alipay:"alipay",dcloud:"dcloud"}[this.config.provider],s=Zn(a),n=Qn(a),r=s||n;return t.call(this,a).then((e=>(e.errCode=0,!r&&Xn.call(this,{functionName:i,result:e,logPvd:o}),Promise.resolve(e))),(e=>(!r&&Xn.call(this,{functionName:i,result:e,logPvd:o}),e&&e.message&&(e.message=function({message:e="",extraInfo:t={},formatter:a=[]}={}){for(let i=0;i<a.length;i++){const{rule:o,content:s,mode:n}=a[i],r=e.match(o);if(!r)continue;let l=s;for(let e=1;e<r.length;e++)l=Un(l,`{$${e}}`,r[e]);for(const e in t)l=Un(l,`{${e}}`,t[e]);return"replace"===n?l:e+l}return e}({message:`[${a.name}]: ${e.message}`,formatter:zn,extraInfo:{functionName:i}})),Promise.reject(e))))};e.callFunction=function(t){const{provider:i,spaceId:o}=e.config,s=t.name;let n,r;return t.data=t.data||{},n=a,n=n.bind(e),r=Qn(t)?a.call(e,t):Zn(t)?new Kn({secretType:t.secretType,uniCloudIns:e}).wrapEncryptDataCallFunction(a.bind(e))(t):function({provider:e,spaceId:t,functionName:a}={}){const{appId:i,uniPlatform:o,osName:s}=ts();let n=o;"app"===o&&(n=s);const r=function({provider:e,spaceId:t}={}){const a=Eo;if(!a)return{};e=function(e){return"tencent"===e?"tcb":e}(e);const i=a.find((a=>a.provider===e&&a.spaceId===t));return i&&i.config}({provider:e,spaceId:t});if(!r||!r.accessControl||!r.accessControl.enable)return!1;const l=r.accessControl.function||{},c=Object.keys(l);if(0===c.length)return!0;const d=function(e,t){let a,i,o;for(let s=0;s<e.length;s++){const n=e[s];n!==t?"*"!==n?n.split(",").map((e=>e.trim())).indexOf(t)>-1&&(i=n):o=n:a=n}return a||i||o}(c,a);if(!d)return!1;if((l[d]||[]).find(((e={})=>e.appId===i&&(e.platform||"").toLowerCase()===n.toLowerCase())))return!0;throw console.error(`此应用[appId: ${i}, platform: ${n}]不在云端配置的允许访问的应用列表内，参考：https://uniapp.dcloud.net.cn/uniCloud/secure-network.html#verify-client`),Yn(Jn.APP_INFO_INVALID)}({provider:i,spaceId:o,functionName:s})?new Kn({secretType:t.secretType,uniCloudIns:e}).wrapVerifyClientCallFunction(a.bind(e))(t):n(t),Object.defineProperty(r,"result",{get:()=>(console.warn("当前返回结果为Promise类型，不可直接访问其result属性，详情请参考：https://uniapp.dcloud.net.cn/uniCloud/faq?id=promise"),{})}),r.then((e=>e))}}Kn=class{constructor(){throw Yn({message:`Platform ${No} is not enabled, please check whether secure network module is enabled in your manifest.json`})}};const tr=Symbol("CLIENT_DB_INTERNAL");function ar(e,t){return e.then="DoNotReturnProxyWithAFunctionNamedThen",e._internalType=tr,e.inspect=null,e.__v_raw=void 0,new Proxy(e,{get(e,a,i){if("_uniClient"===a)return null;if("symbol"==typeof a)return e[a];if(a in e||"string"!=typeof a){const t=e[a];return"function"==typeof t?t.bind(e):t}return t.get(e,a,i)}})}function ir(e){return{on:(t,a)=>{e[t]=e[t]||[],e[t].indexOf(a)>-1||e[t].push(a)},off:(t,a)=>{e[t]=e[t]||[];const i=e[t].indexOf(a);-1!==i&&e[t].splice(i,1)}}}const or=["db.Geo","db.command","command.aggregate"];function sr(e,t){return or.indexOf(`${e}.${t}`)>-1}function nr(e){switch(mo(e=Ko(e))){case"array":return e.map((e=>nr(e)));case"object":return e._internalType===tr||Object.keys(e).forEach((t=>{e[t]=nr(e[t])})),e;case"regexp":return{$regexp:{source:e.source,flags:e.flags}};case"date":return{$date:e.toISOString()};default:return e}}function rr(e){return e&&e.content&&e.content.$method}class lr{constructor(e,t,a){this.content=e,this.prevStage=t||null,this.udb=null,this._database=a}toJSON(){let e=this;const t=[e.content];for(;e.prevStage;)e=e.prevStage,t.push(e.content);return{$db:t.reverse().map((e=>({$method:e.$method,$param:nr(e.$param)})))}}toString(){return JSON.stringify(this.toJSON())}getAction(){const e=this.toJSON().$db.find((e=>"action"===e.$method));return e&&e.$param&&e.$param[0]}getCommand(){return{$db:this.toJSON().$db.filter((e=>"action"!==e.$method))}}get isAggregate(){let e=this;for(;e;){const t=rr(e),a=rr(e.prevStage);if("aggregate"===t&&"collection"===a||"pipeline"===t)return!0;e=e.prevStage}return!1}get isCommand(){let e=this;for(;e;){if("command"===rr(e))return!0;e=e.prevStage}return!1}get isAggregateCommand(){let e=this;for(;e;){const t=rr(e),a=rr(e.prevStage);if("aggregate"===t&&"command"===a)return!0;e=e.prevStage}return!1}getNextStageFn(e){const t=this;return function(){return cr({$method:e,$param:nr(Array.from(arguments))},t,t._database)}}get count(){return this.isAggregate?this.getNextStageFn("count"):function(){return this._send("count",Array.from(arguments))}}get remove(){return this.isCommand?this.getNextStageFn("remove"):function(){return this._send("remove",Array.from(arguments))}}get(){return this._send("get",Array.from(arguments))}get add(){return this.isCommand?this.getNextStageFn("add"):function(){return this._send("add",Array.from(arguments))}}update(){return this._send("update",Array.from(arguments))}end(){return this._send("end",Array.from(arguments))}get set(){return this.isCommand?this.getNextStageFn("set"):function(){throw new Error("JQL禁止使用set方法")}}_send(e,t){const a=this.getAction(),i=this.getCommand();return i.$db.push({$method:e,$param:nr(t)}),this._database._callCloudFunction({action:a,command:i})}}function cr(e,t,a){return ar(new lr(e,t,a),{get(e,t){let i="db";return e&&e.content&&(i=e.content.$method),sr(i,t)?cr({$method:t},e,a):function(){return cr({$method:t,$param:nr(Array.from(arguments))},e,a)}}})}function dr({path:e,method:t}){return class{constructor(){this.param=Array.from(arguments)}toJSON(){return{$newDb:[...e.map((e=>({$method:e}))),{$method:t,$param:this.param}]}}toString(){return JSON.stringify(this.toJSON())}}}class ur{constructor({uniClient:e={},isJQL:t=!1}={}){this._uniClient=e,this._authCallBacks={},this._dbCallBacks={},e._isDefault&&(this._dbCallBacks=Co("_globalUniCloudDatabaseCallback")),t||(this.auth=ir(this._authCallBacks)),this._isJQL=t,Object.assign(this,ir(this._dbCallBacks)),this.env=ar({},{get:(e,t)=>({$env:t})}),this.Geo=ar({},{get:(e,t)=>dr({path:["Geo"],method:t})}),this.serverDate=dr({path:[],method:"serverDate"}),this.RegExp=dr({path:[],method:"RegExp"})}getCloudEnv(e){if("string"!=typeof e||!e.trim())throw new Error("getCloudEnv参数错误");return{$env:e.replace("$cloudEnv_","")}}_callback(e,t){const a=this._dbCallBacks;a[e]&&a[e].forEach((e=>{e(...t)}))}_callbackAuth(e,t){const a=this._authCallBacks;a[e]&&a[e].forEach((e=>{e(...t)}))}multiSend(){const e=Array.from(arguments),t=e.map((e=>{const t=e.getAction(),a=e.getCommand();if("getTemp"!==a.$db[a.$db.length-1].$method)throw new Error("multiSend只支持子命令内使用getTemp");return{action:t,command:a}}));return this._callCloudFunction({multiCommand:t,queryList:e})}}function mr(e,t={}){return ar(new e(t),{get:(e,t)=>sr("db",t)?cr({$method:t},null,e):function(){return cr({$method:t,$param:nr(Array.from(arguments))},null,e)}})}class hr extends ur{_parseResult(e){return this._isJQL?e.result:e}_callCloudFunction({action:e,command:t,multiCommand:a,queryList:i}){function o(e,t){if(a&&i)for(let a=0;a<i.length;a++){const o=i[a];o.udb&&"function"==typeof o.udb.setResult&&(t?o.udb.setResult(t):o.udb.setResult(e.result.dataList[a]))}}const s=this,n=this._isJQL?"databaseForJQL":"database";function r(e){return s._callback("error",[e]),Io(Bo(n,"fail"),e).then((()=>Io(Bo(n,"complete"),e))).then((()=>(o(null,e),Uo(Lo.RESPONSE,{type:Oo,content:e}),Promise.reject(e))))}const l=Io(Bo(n,"invoke")),c=this._uniClient;return l.then((()=>c.callFunction({name:"DCloud-clientDB",type:lo,data:{action:e,command:t,multiCommand:a}}))).then((e=>{const{code:t,message:a,token:i,tokenExpired:l,systemInfo:c=[]}=e.result;if(c)for(let o=0;o<c.length;o++){const{level:e,message:t,detail:a}=c[o];let i="[System Info]"+t;a&&(i=`${i}\n详细信息：${a}`),(console["warn"===e?"error":e]||console.log)(i)}if(t)return r(new Jo({code:t,message:a,requestId:e.requestId}));e.result.errCode=e.result.errCode||e.result.code,e.result.errMsg=e.result.errMsg||e.result.message,i&&l&&(Qo({token:i,tokenExpired:l}),this._callbackAuth("refreshToken",[{token:i,tokenExpired:l}]),this._callback("refreshToken",[{token:i,tokenExpired:l}]),Uo(Lo.REFRESH_TOKEN,{token:i,tokenExpired:l}));const d=[{prop:"affectedDocs",tips:"affectedDocs不再推荐使用，请使用inserted/deleted/updated/data.length替代"},{prop:"code",tips:"code不再推荐使用，请使用errCode替代"},{prop:"message",tips:"message不再推荐使用，请使用errMsg替代"}];for(let o=0;o<d.length;o++){const{prop:t,tips:a}=d[o];if(t in e.result){const i=e.result[t];Object.defineProperty(e.result,t,{get:()=>(console.warn(a),i)})}}return u=e,Io(Bo(n,"success"),u).then((()=>Io(Bo(n,"complete"),u))).then((()=>{o(u,null);const e=s._parseResult(u);return Uo(Lo.RESPONSE,{type:Oo,content:e}),Promise.resolve(e)}));var u}),(e=>(/fc_function_not_found|FUNCTION_NOT_FOUND/g.test(e.message)&&console.warn("clientDB未初始化，请在web控制台保存一次schema以开启clientDB"),r(new Jo({code:e.code||"SYSTEM_ERROR",message:e.message,requestId:e.requestId})))))}}const pr="token无效，跳转登录页面",gr="token过期，跳转登录页面",fr={TOKEN_INVALID_TOKEN_EXPIRED:gr,TOKEN_INVALID_INVALID_CLIENTID:pr,TOKEN_INVALID:pr,TOKEN_INVALID_WRONG_TOKEN:pr,TOKEN_INVALID_ANONYMOUS_USER:pr},yr={"uni-id-token-expired":gr,"uni-id-check-token-failed":pr,"uni-id-token-not-exist":pr,"uni-id-check-device-feature-failed":pr},vr={...fr,...yr,default:"用户未登录或登录状态过期，自动跳转登录页面"};function wr(e,t){let a="";return a=e?`${e}/${t}`:t,a.replace(/^\//,"")}function kr(e=[],t=""){const a=[],i=[];return e.forEach((e=>{!0===e.needLogin?a.push(wr(t,e.path)):!1===e.needLogin&&i.push(wr(t,e.path))})),{needLoginPage:a,notNeedLoginPage:i}}function Er(e){return e.split("?")[0].replace(/^\//,"")}function Nr(){return function(e){let t=e&&e.$page&&e.$page.fullPath;return t?("/"!==t.charAt(0)&&(t="/"+t),t):""}(function(){const e=getCurrentPages();return e[e.length-1]}())}function br(){return Er(Nr())}function Vr(e="",t={}){if(!e)return!1;if(!(t&&t.list&&t.list.length))return!1;const a=t.list,i=Er(e);return a.some((e=>e.pagePath===i))}const Sr=!!Ki.uniIdRouter,{loginPage:xr,routerNeedLogin:Cr,resToLogin:Dr,needLoginPage:Tr,notNeedLoginPage:_r,loginPageInTabBar:Pr}=function({pages:e=[],subPackages:t=[],uniIdRouter:a={},tabBar:i={}}=Ki){const{loginPage:o,needLogin:s=[],resToLogin:n=!0}=a,{needLoginPage:r,notNeedLoginPage:l}=kr(e),{needLoginPage:c,notNeedLoginPage:d}=function(e=[]){const t=[],a=[];return e.forEach((e=>{const{root:i,pages:o=[]}=e,{needLoginPage:s,notNeedLoginPage:n}=kr(o,i);t.push(...s),a.push(...n)})),{needLoginPage:t,notNeedLoginPage:a}}(t);return{loginPage:o,routerNeedLogin:s,resToLogin:n,needLoginPage:[...r,...c],notNeedLoginPage:[...l,...d],loginPageInTabBar:Vr(o,i)}}();if(Tr.indexOf(xr)>-1)throw new Error(`Login page [${xr}] should not be "needLogin", please check your pages.json`);function Ir(e){const t=br();if("/"===e.charAt(0))return e;const[a,i]=e.split("?"),o=a.replace(/^\//,"").split("/"),s=t.split("/");s.pop();for(let n=0;n<o.length;n++){const e=o[n];".."===e?s.pop():"."!==e&&s.push(e)}return""===s[0]&&s.shift(),"/"+s.join("/")+(i?"?"+i:"")}function Br({redirect:e}){const t=Er(e),a=Er(xr);return br()!==a&&t!==a}function Ar({api:e,redirect:t}={}){if(!t||!Br({redirect:t}))return;const a=(o=t,"/"!==(i=xr).charAt(0)&&(i="/"+i),o?i.indexOf("?")>-1?i+`&uniIdRedirectUrl=${encodeURIComponent(o)}`:i+`?uniIdRedirectUrl=${encodeURIComponent(o)}`:i);var i,o;Pr?"navigateTo"!==e&&"redirectTo"!==e||(e="switchTab"):"switchTab"===e&&(e="navigateTo");const s={navigateTo:uni.navigateTo,redirectTo:uni.redirectTo,switchTab:uni.switchTab,reLaunch:uni.reLaunch};setTimeout((()=>{s[e]({url:a})}),0)}function Mr({url:e}={}){const t={abortLoginPageJump:!1,autoToLoginPage:!1},a=function(){const{token:e,tokenExpired:t}=Zo();let a;if(e){if(t<Date.now()){const e="uni-id-token-expired";a={errCode:e,errMsg:vr[e]}}}else{const e="uni-id-check-token-failed";a={errCode:e,errMsg:vr[e]}}return a}();if(function(e){const t=Er(Ir(e));return!(_r.indexOf(t)>-1)&&(Tr.indexOf(t)>-1||Cr.some((t=>{return a=e,new RegExp(t).test(a);var a})))}(e)&&a){if(a.uniIdRedirectUrl=e,zo(Lo.NEED_LOGIN).length>0)return setTimeout((()=>{Uo(Lo.NEED_LOGIN,a)}),0),t.abortLoginPageJump=!0,t;t.autoToLoginPage=!0}return t}function Lr(){!function(){const e=Nr(),{abortLoginPageJump:t,autoToLoginPage:a}=Mr({url:e});t||a&&Ar({api:"redirectTo",redirect:e})}();const e=["navigateTo","redirectTo","reLaunch","switchTab"];for(let t=0;t<e.length;t++){const a=e[t];uni.addInterceptor(a,{invoke(e){const{abortLoginPageJump:t,autoToLoginPage:i}=Mr({url:e.url});return t?e:i?(Ar({api:a,redirect:Ir(e.url)}),!1):e}})}}function Or(){this.onResponse((e=>{const{type:t,content:a}=e;let i=!1;switch(t){case"cloudobject":i=function(e){if("object"!=typeof e)return!1;const{errCode:t}=e||{};return t in vr}(a);break;case"clientdb":i=function(e){if("object"!=typeof e)return!1;const{errCode:t}=e||{};return t in fr}(a)}i&&function(e={}){const t=zo(Lo.NEED_LOGIN);Wo().then((()=>{const a=Nr();if(a&&Br({redirect:a}))return t.length>0?Uo(Lo.NEED_LOGIN,Object.assign({uniIdRedirectUrl:a},e)):void(xr&&Ar({api:"navigateTo",redirect:a}))}))}(a)}))}function Fr(e){var t;(t=e).onResponse=function(e){$o(Lo.RESPONSE,e)},t.offResponse=function(e){jo(Lo.RESPONSE,e)},function(e){e.onNeedLogin=function(e){$o(Lo.NEED_LOGIN,e)},e.offNeedLogin=function(e){jo(Lo.NEED_LOGIN,e)},Sr&&(Co(Hn).needLoginInit||(Co(Hn).needLoginInit=!0,Wo().then((()=>{Lr.call(e)})),Dr&&Or.call(e)))}(e),function(e){e.onRefreshToken=function(e){$o(Lo.REFRESH_TOKEN,e)},e.offRefreshToken=function(e){jo(Lo.REFRESH_TOKEN,e)}}(e)}let Rr;const zr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",$r=/^(?:[A-Za-z\d+/]{4})*?(?:[A-Za-z\d+/]{2}(?:==)?|[A-Za-z\d+/]{3}=?)?$/;function jr(){const e=Zo().token||"",t=e.split(".");if(!e||3!==t.length)return{uid:null,role:[],permission:[],tokenExpired:0};let a;try{a=JSON.parse((i=t[1],decodeURIComponent(Rr(i).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))))}catch(o){throw new Error("获取当前用户信息出错，详细错误信息为："+o.message)}var i;return a.tokenExpired=1e3*a.exp,delete a.exp,delete a.iat,a}Rr="function"!=typeof atob?function(e){if(e=String(e).replace(/[\t\n\f\r ]+/g,""),!$r.test(e))throw new Error("Failed to execute 'atob' on 'Window': The string to be decoded is not correctly encoded.");var t;e+="==".slice(2-(3&e.length));for(var a,i,o="",s=0;s<e.length;)t=zr.indexOf(e.charAt(s++))<<18|zr.indexOf(e.charAt(s++))<<12|(a=zr.indexOf(e.charAt(s++)))<<6|(i=zr.indexOf(e.charAt(s++))),o+=64===a?String.fromCharCode(t>>16&255):64===i?String.fromCharCode(t>>16&255,t>>8&255):String.fromCharCode(t>>16&255,t>>8&255,255&t);return o}:atob;var Ur=function(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}(Zi((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const a="chooseAndUploadFile:ok",i="chooseAndUploadFile:fail";function o(e,t){return e.tempFiles.forEach(((e,a)=>{e.name||(e.name=e.path.substring(e.path.lastIndexOf("/")+1)),t&&(e.fileType=t),e.cloudPath=Date.now()+"_"+a+e.name.substring(e.name.lastIndexOf("."))})),e.tempFilePaths||(e.tempFilePaths=e.tempFiles.map((e=>e.path))),e}function s(e,t,{onChooseFile:i,onUploadProgress:o}){return t.then((e=>{if(i){const t=i(e);if(void 0!==t)return Promise.resolve(t).then((t=>void 0===t?e:t))}return e})).then((t=>!1===t?{errMsg:a,tempFilePaths:[],tempFiles:[]}:function(e,t,i=5,o){(t=Object.assign({},t)).errMsg=a;const s=t.tempFiles,n=s.length;let r=0;return new Promise((a=>{for(;r<i;)l();function l(){const i=r++;if(i>=n)return void(!s.find((e=>!e.url&&!e.errMsg))&&a(t));const c=s[i];e.uploadFile({provider:c.provider,filePath:c.path,cloudPath:c.cloudPath,fileType:c.fileType,cloudPathAsRealPath:c.cloudPathAsRealPath,onUploadProgress(e){e.index=i,e.tempFile=c,e.tempFilePath=c.path,o&&o(e)}}).then((e=>{c.url=e.fileID,i<n&&l()})).catch((e=>{c.errMsg=e.errMsg||e.message,i<n&&l()}))}}))}(e,t,5,o)))}t.initChooseAndUploadFile=function(e){return function(t={type:"all"}){return"image"===t.type?s(e,function(e){const{count:t,sizeType:a,sourceType:s=["album","camera"],extension:n}=e;return new Promise(((e,r)=>{uni.chooseImage({count:t,sizeType:a,sourceType:s,extension:n,success(t){e(o(t,"image"))},fail(e){r({errMsg:e.errMsg.replace("chooseImage:fail",i)})}})}))}(t),t):"video"===t.type?s(e,function(e){const{camera:t,compressed:a,maxDuration:s,sourceType:n=["album","camera"],extension:r}=e;return new Promise(((e,l)=>{uni.chooseVideo({camera:t,compressed:a,maxDuration:s,sourceType:n,extension:r,success(t){const{tempFilePath:a,duration:i,size:s,height:n,width:r}=t;e(o({errMsg:"chooseVideo:ok",tempFilePaths:[a],tempFiles:[{name:t.tempFile&&t.tempFile.name||"",path:a,size:s,type:t.tempFile&&t.tempFile.type||"",width:r,height:n,duration:i,fileType:"video",cloudPath:""}]},"video"))},fail(e){l({errMsg:e.errMsg.replace("chooseVideo:fail",i)})}})}))}(t),t):s(e,function(e){const{count:t,extension:a}=e;return new Promise(((e,s)=>{let n=uni.chooseFile;if("undefined"!=typeof wx&&"function"==typeof wx.chooseMessageFile&&(n=wx.chooseMessageFile),"function"!=typeof n)return s({errMsg:i+" 请指定 type 类型，该平台仅支持选择 image 或 video。"});n({type:"all",count:t,extension:a,success(t){e(o(t))},fail(e){s({errMsg:e.errMsg.replace("chooseFile:fail",i)})}})}))}(t),t)}}})));const qr="manual";function Hr(e){return{props:{localdata:{type:Array,default:()=>[]},options:{type:[Object,Array],default:()=>({})},spaceInfo:{type:Object,default:()=>({})},collection:{type:[String,Array],default:""},action:{type:String,default:""},field:{type:String,default:""},orderby:{type:String,default:""},where:{type:[String,Object],default:""},pageData:{type:String,default:"add"},pageCurrent:{type:Number,default:1},pageSize:{type:Number,default:20},getcount:{type:[Boolean,String],default:!1},gettree:{type:[Boolean,String],default:!1},gettreepath:{type:[Boolean,String],default:!1},startwith:{type:String,default:""},limitlevel:{type:Number,default:10},groupby:{type:String,default:""},groupField:{type:String,default:""},distinct:{type:[Boolean,String],default:!1},foreignKey:{type:String,default:""},loadtime:{type:String,default:"auto"},manual:{type:Boolean,default:!1}},data:()=>({mixinDatacomLoading:!1,mixinDatacomHasMore:!1,mixinDatacomResData:[],mixinDatacomErrorMessage:"",mixinDatacomPage:{},mixinDatacomError:null}),created(){this.mixinDatacomPage={current:this.pageCurrent,size:this.pageSize,count:0},this.$watch((()=>{var e=[];return["pageCurrent","pageSize","localdata","collection","action","field","orderby","where","getont","getcount","gettree","groupby","groupField","distinct"].forEach((t=>{e.push(this[t])})),e}),((e,t)=>{if(this.loadtime===qr)return;let a=!1;const i=[];for(let o=2;o<e.length;o++)e[o]!==t[o]&&(i.push(e[o]),a=!0);e[0]!==t[0]&&(this.mixinDatacomPage.current=this.pageCurrent),this.mixinDatacomPage.size=this.pageSize,this.onMixinDatacomPropsChange(a,i)}))},methods:{onMixinDatacomPropsChange(e,t){},mixinDatacomEasyGet({getone:e=!1,success:t,fail:a}={}){this.mixinDatacomLoading||(this.mixinDatacomLoading=!0,this.mixinDatacomErrorMessage="",this.mixinDatacomError=null,this.mixinDatacomGet().then((a=>{this.mixinDatacomLoading=!1;const{data:i,count:o}=a.result;this.getcount&&(this.mixinDatacomPage.count=o),this.mixinDatacomHasMore=i.length<this.pageSize;const s=e?i.length?i[0]:void 0:i;this.mixinDatacomResData=s,t&&t(s)})).catch((e=>{this.mixinDatacomLoading=!1,this.mixinDatacomErrorMessage=e,this.mixinDatacomError=e,a&&a(e)})))},mixinDatacomGet(t={}){let a;t=t||{},a="undefined"!=typeof __uniX&&__uniX?e.databaseForJQL(this.spaceInfo):e.database(this.spaceInfo);const i=t.action||this.action;i&&(a=a.action(i));const o=t.collection||this.collection;a=Array.isArray(o)?a.collection(...o):a.collection(o);const s=t.where||this.where;s&&Object.keys(s).length&&(a=a.where(s));const n=t.field||this.field;n&&(a=a.field(n));const r=t.foreignKey||this.foreignKey;r&&(a=a.foreignKey(r));const l=t.groupby||this.groupby;l&&(a=a.groupBy(l));const c=t.groupField||this.groupField;c&&(a=a.groupField(c)),!0===(void 0!==t.distinct?t.distinct:this.distinct)&&(a=a.distinct());const d=t.orderby||this.orderby;d&&(a=a.orderBy(d));const u=void 0!==t.pageCurrent?t.pageCurrent:this.mixinDatacomPage.current,m=void 0!==t.pageSize?t.pageSize:this.mixinDatacomPage.size,h=void 0!==t.getcount?t.getcount:this.getcount,p=void 0!==t.gettree?t.gettree:this.gettree,g=void 0!==t.gettreepath?t.gettreepath:this.gettreepath,f={getCount:h},y={limitLevel:void 0!==t.limitlevel?t.limitlevel:this.limitlevel,startWith:void 0!==t.startwith?t.startwith:this.startwith};return p&&(f.getTree=y),g&&(f.getTreePath=y),a=a.skip(m*(u-1)).limit(m).get(f),a}}}}function Wr(e){return Co(Wn.replace("{spaceId}",e.config.spaceId))}async function Gr({openid:e,callLoginByWeixin:t=!1}={}){throw Wr(this),new Error(`[SecureNetwork] API \`initSecureNetworkByWeixin\` is not supported on platform \`${No}\``)}async function Jr(e){const t=Wr(this);return t.initPromise||(t.initPromise=Gr.call(this,e).then((e=>e)).catch((e=>{throw delete t.initPromise,e}))),t.initPromise}function Yr(e){is=e}function Kr(e){const t={getAppBaseInfo:uni.getSystemInfo,getPushClientId:uni.getPushClientId};return function(a){return new Promise(((i,o)=>{t[e]({...a,success(e){i(e)},fail(e){o(e)}})}))}}class Zr extends wo{constructor(){super(),this._uniPushMessageCallback=this._receivePushMessage.bind(this),this._currentMessageId=-1,this._payloadQueue=[]}init(){return Promise.all([Kr("getAppBaseInfo")(),Kr("getPushClientId")()]).then((([{appId:e}={},{cid:t}={}]=[])=>{if(!e)throw new Error("Invalid appId, please check the manifest.json file");if(!t)throw new Error("Invalid push client id");this._appId=e,this._pushClientId=t,this._seqId=Date.now()+"-"+Math.floor(9e5*Math.random()+1e5),this.emit("open"),this._initMessageListener()}),(e=>{throw this.emit("error",e),this.close(),e}))}async open(){return this.init()}_isUniCloudSSE(e){if("receive"!==e.type)return!1;const t=e&&e.data&&e.data.payload;return!(!t||"UNI_CLOUD_SSE"!==t.channel||t.seqId!==this._seqId)}_receivePushMessage(e){if(!this._isUniCloudSSE(e))return;const t=e&&e.data&&e.data.payload,{action:a,messageId:i,message:o}=t;this._payloadQueue.push({action:a,messageId:i,message:o}),this._consumMessage()}_consumMessage(){for(;;){const e=this._payloadQueue.find((e=>e.messageId===this._currentMessageId+1));if(!e)break;this._currentMessageId++,this._parseMessagePayload(e)}}_parseMessagePayload(e){const{action:t,messageId:a,message:i}=e;"end"===t?this._end({messageId:a,message:i}):"message"===t&&this._appendMessage({messageId:a,message:i})}_appendMessage({messageId:e,message:t}={}){this.emit("message",t)}_end({messageId:e,message:t}={}){this.emit("end",t),this.close()}_initMessageListener(){uni.onPushMessage(this._uniPushMessageCallback)}_destroy(){uni.offPushMessage(this._uniPushMessageCallback)}toJSON(){return{appId:this._appId,pushClientId:this._pushClientId,seqId:this._seqId}}close(){this._destroy(),this.emit("close")}}const Qr={tcb:Vn,tencent:Vn,aliyun:cs,private:Dn,dcloud:Dn,alipay:Fn};let Xr=new class{init(e){let t={};const a=Qr[e.provider];if(!a)throw new Error("未提供正确的provider参数");var i;return t=a.init(e),function(e){e._initPromiseHub||(e._initPromiseHub=new vo({createPromise:function(){let t=Promise.resolve();t=new Promise((e=>{setTimeout((()=>{e()}),1)}));const a=e.auth();return t.then((()=>a.getLoginState())).then((e=>e?Promise.resolve():a.signInAnonymously()))}}))}(t),er(t),function(e){const t=e.uploadFile;e.uploadFile=function(e){return t.call(this,e)}}(t),(i=t).database=function(e){if(e&&Object.keys(e).length>0)return i.init(e).database();if(this._database)return this._database;const t=mr(hr,{uniClient:i});return this._database=t,t},i.databaseForJQL=function(e){if(e&&Object.keys(e).length>0)return i.init(e).databaseForJQL();if(this._databaseForJQL)return this._databaseForJQL;const t=mr(hr,{uniClient:i,isJQL:!0});return this._databaseForJQL=t,t},function(e){e.getCurrentUserInfo=jr,e.chooseAndUploadFile=Ur.initChooseAndUploadFile(e),Object.assign(e,{get mixinDatacom(){return Hr(e)}}),e.SSEChannel=Zr,e.initSecureNetworkByWeixin=function(e){return function({openid:t,callLoginByWeixin:a=!1}={}){return Jr.call(e,{openid:t,callLoginByWeixin:a})}}(e),e.setCustomClientInfo=Yr,e.importObject=function(t){return function(a,i={}){i=function(e,t={}){return e.customUI=t.customUI||e.customUI,e.parseSystemError=t.parseSystemError||e.parseSystemError,Object.assign(e.loadingOptions,t.loadingOptions),Object.assign(e.errorOptions,t.errorOptions),"object"==typeof t.secretMethods&&(e.secretMethods=t.secretMethods),e}({customUI:!1,loadingOptions:{title:"加载中...",mask:!0},errorOptions:{type:"modal",retry:!1}},i);const{customUI:o,loadingOptions:s,errorOptions:n,parseSystemError:r}=i,l=!o;return new Proxy({},{get(o,c){switch(c){case"toString":return"[object UniCloudObject]";case"toJSON":return{}}return function({fn:e,interceptorName:t,getCallbackArgs:a}={}){return async function(...i){const o=a?a({params:i}):{};let s,n;try{return await Io(Bo(t,"invoke"),{...o}),s=await e(...i),await Io(Bo(t,"success"),{...o,result:s}),s}catch(r){throw n=r,await Io(Bo(t,"fail"),{...o,error:n}),n}finally{await Io(Bo(t,"complete"),n?{...o,error:n}:{...o,result:s})}}}({fn:async function o(...d){let u;l&&uni.showLoading({title:s.title,mask:s.mask});const m={name:a,type:ro,data:{method:c,params:d}};"object"==typeof i.secretMethods&&function(e,t){const a=t.data.method,i=e.secretMethods||{},o=i[a]||i["*"];o&&(t.secretType=o)}(i,m);let h=!1;try{u=await t.callFunction(m)}catch(e){h=!0,u={result:new Jo(e)}}const{errSubject:p,errCode:g,errMsg:f,newToken:y}=u.result||{};if(l&&uni.hideLoading(),y&&y.token&&y.tokenExpired&&(Qo(y),Uo(Lo.REFRESH_TOKEN,{...y})),g){let e=f;if(h&&r&&(e=(await r({objectName:a,methodName:c,params:d,errSubject:p,errCode:g,errMsg:f})).errMsg||f),l)if("toast"===n.type)uni.showToast({title:e,icon:"none"});else{if("modal"!==n.type)throw new Error(`Invalid errorOptions.type: ${n.type}`);{const{confirm:t}=await async function({title:e,content:t,showCancel:a,cancelText:i,confirmText:o}={}){return new Promise(((s,n)=>{uni.showModal({title:e,content:t,showCancel:a,cancelText:i,confirmText:o,success(e){s(e)},fail(){s({confirm:!1,cancel:!0})}})}))}({title:"提示",content:e,showCancel:n.retry,cancelText:"取消",confirmText:n.retry?"重试":"确定"});if(n.retry&&t)return o(...d)}}const t=new Jo({subject:p,code:g,message:f,requestId:u.requestId});throw t.detail=u.result,Uo(Lo.RESPONSE,{type:Ro,content:t}),t}return Uo(Lo.RESPONSE,{type:Ro,content:u.result}),u.result},interceptorName:"callObject",getCallbackArgs:function({params:e}={}){return{objectName:a,methodName:c,params:e}}})}})}}(e)}(t),["callFunction","uploadFile","deleteFile","getTempFileURL","downloadFile","chooseAndUploadFile"].forEach((e=>{if(!t[e])return;const a=t[e];t[e]=function(){return a.apply(t,Array.from(arguments))},t[e]=function(e,t){return function(a){let i=!1;if("callFunction"===t){const e=a&&a.type||no;i=e!==no}const o="callFunction"===t&&!i,s=this._initPromiseHub.exec();a=a||{};const{success:n,fail:r,complete:l}=Go(a),c=s.then((()=>i?Promise.resolve():Io(Bo(t,"invoke"),a))).then((()=>e.call(this,a))).then((e=>i?Promise.resolve(e):Io(Bo(t,"success"),e).then((()=>Io(Bo(t,"complete"),e))).then((()=>(o&&Uo(Lo.RESPONSE,{type:Fo,content:e}),Promise.resolve(e))))),(e=>i?Promise.reject(e):Io(Bo(t,"fail"),e).then((()=>Io(Bo(t,"complete"),e))).then((()=>(Uo(Lo.RESPONSE,{type:Fo,content:e}),Promise.reject(e))))));if(!(n||r||l))return c;c.then((e=>{n&&n(e),l&&l(e),o&&Uo(Lo.RESPONSE,{type:Fo,content:e})}),(e=>{r&&r(e),l&&l(e),o&&Uo(Lo.RESPONSE,{type:Fo,content:e})}))}}(t[e],e).bind(t)})),t.init=this.init,t}};(()=>{const e=bo;let t={};if(e&&1===e.length)t=e[0],Xr=Xr.init(t),Xr._isDefault=!0;else{const t=["auth","callFunction","uploadFile","deleteFile","getTempFileURL","downloadFile"],a=["database","getCurrentUserInfo","importObject"];let i;i=e&&e.length>0?"应用有多个服务空间，请通过uniCloud.init方法指定要使用的服务空间":"应用未关联服务空间，请在uniCloud目录右键关联服务空间",[...t,...a].forEach((e=>{Xr[e]=function(){if(console.error(i),-1===a.indexOf(e))return Promise.reject(new Jo({code:"SYS_ERR",message:i}));console.error(i)}}))}if(Object.assign(Xr,{get mixinDatacom(){return Hr(Xr)}}),Fr(Xr),Xr.addInterceptor=_o,Xr.removeInterceptor=Po,Xr.interceptObject=Ao,uni.__uniCloud=Xr,"app"===No){const e=So||(So=function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;function e(){return this}return void 0!==e()?e():new Function("return this")()}(),So);e.uniCloud=Xr,e.UniCloudError=Jo}})();const el=W({name:"uni-data-select",mixins:[Xr.mixinDatacom||{}],props:{localdata:{type:Array,default:()=>[]},value:{type:[String,Number],default:""},modelValue:{type:[String,Number],default:""},label:{type:String,default:""},placeholder:{type:String,default:"请选择"},emptyTips:{type:String,default:"无选项"},clear:{type:Boolean,default:!0},defItem:{type:Number,default:0},disabled:{type:Boolean,default:!1},format:{type:String,default:""},placement:{type:String,default:"bottom"}},data:()=>({showSelector:!1,current:"",mixinDatacomResData:[],apps:[],channels:[],cacheKey:"uni-data-select-lastSelectedValue"}),created(){this.debounceGet=this.debounce((()=>{this.query()}),300),this.collection&&!this.localdata.length&&this.debounceGet()},computed:{typePlaceholder(){const e=this.placeholder,t={"opendb-stat-app-versions":"版本","opendb-app-channels":"渠道","opendb-app-list":"应用"}[this.collection];return t?e+t:e},valueCom(){return this.modelValue},textShow(){let e=this.current;return e.length>10?e.slice(0,25)+"...":e},getOffsetByPlacement(){switch(this.placement){case"top":return"bottom:calc(100% + 12px);";case"bottom":return"top:calc(100% + 12px);"}}},watch:{localdata:{immediate:!0,handler(e,t){Array.isArray(e)&&t!==e&&(this.mixinDatacomResData=e)}},valueCom(e,t){this.initDefVal()},mixinDatacomResData:{immediate:!0,handler(e){e.length&&this.initDefVal()}}},methods:{debounce(e,t=100){let a=null;return function(...i){a&&clearTimeout(a),a=setTimeout((()=>{e.apply(this,i)}),t)}},query(){this.mixinDatacomEasyGet()},onMixinDatacomPropsChange(){this.collection&&this.debounceGet()},initDefVal(){let e="";if(!this.valueCom&&0!==this.valueCom||this.isDisabled(this.valueCom)){let t;if(this.collection&&(t=this.getCache()),t||0===t)e=t;else{let t="";this.defItem>0&&this.defItem<=this.mixinDatacomResData.length&&(t=this.mixinDatacomResData[this.defItem-1].value),e=t}(e||0===e)&&this.emit(e)}else e=this.valueCom;const t=this.mixinDatacomResData.find((t=>t.value===e));this.current=t?this.formatItemName(t):""},isDisabled(e){let t=!1;return this.mixinDatacomResData.forEach((a=>{a.value===e&&(t=a.disable)})),t},clearVal(){this.emit(""),this.collection&&this.removeCache()},change(e){e.disable||(this.showSelector=!1,this.current=this.formatItemName(e),this.emit(e.value))},emit(e){this.$emit("input",e),this.$emit("update:modelValue",e),this.$emit("change",e),this.collection&&this.setCache(e)},toggleSelector(){this.disabled||(this.showSelector=!this.showSelector)},formatItemName(e){let{text:t,value:a,channel_code:i}=e;if(i=i?`(${i})`:"",this.format){let t="";t=this.format;for(let a in e)t=t.replace(new RegExp(`{${a}}`,"g"),e[a]);return t}return this.collection.indexOf("app-list")>0?`${t}(${a})`:t||`未命名${i}`},getLoadData(){return this.mixinDatacomResData},getCurrentCacheKey(){return this.collection},getCache(e=this.getCurrentCacheKey()){return(uni.getStorageSync(this.cacheKey)||{})[e]},setCache(e,t=this.getCurrentCacheKey()){let a=uni.getStorageSync(this.cacheKey)||{};a[t]=e,uni.setStorageSync(this.cacheKey,a)},removeCache(e=this.getCurrentCacheKey()){let t=uni.getStorageSync(this.cacheKey)||{};delete t[e],uni.setStorageSync(this.cacheKey,t)}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"uni-stat__select"},[o.label?(e.openBlock(),e.createElementBlock("span",{key:0,class:"uni-label-text hide-on-phone"},e.toDisplayString(o.label+"："),1)):e.createCommentVNode("",!0),e.createElementVNode("view",{class:e.normalizeClass(["uni-stat-box",{"uni-stat__actived":n.current}])},[e.createElementVNode("view",{class:e.normalizeClass(["uni-select",{"uni-select--disabled":o.disabled}])},[e.createElementVNode("view",{class:"uni-select__input-box",onClick:i[1]||(i[1]=(...e)=>r.toggleSelector&&r.toggleSelector(...e))},[n.current?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-select__input-text"},e.toDisplayString(r.textShow),1)):(e.openBlock(),e.createElementBlock("view",{key:1,class:"uni-select__input-text uni-select__input-placeholder"},e.toDisplayString(r.typePlaceholder),1)),n.current&&o.clear&&!o.disabled?(e.openBlock(),e.createElementBlock("view",{key:2,onClick:i[0]||(i[0]=e.withModifiers(((...e)=>r.clearVal&&r.clearVal(...e)),["stop"]))},[e.createVNode(l,{type:"clear",color:"#c0c4cc",size:"24"})])):(e.openBlock(),e.createElementBlock("view",{key:3},[e.createVNode(l,{type:n.showSelector?"top":"bottom",size:"14",color:"#999"},null,8,["type"])]))]),n.showSelector?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-select--mask",onClick:i[2]||(i[2]=(...e)=>r.toggleSelector&&r.toggleSelector(...e))})):e.createCommentVNode("",!0),n.showSelector?(e.openBlock(),e.createElementBlock("view",{key:1,class:"uni-select__selector",style:e.normalizeStyle(r.getOffsetByPlacement)},[e.createElementVNode("view",{class:e.normalizeClass("bottom"==o.placement?"uni-popper__arrow_bottom":"uni-popper__arrow_top")},null,2),e.createElementVNode("scroll-view",{"scroll-y":"true",class:"uni-select__selector-scroll"},[0===n.mixinDatacomResData.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-select__selector-empty"},[e.createElementVNode("text",null,e.toDisplayString(o.emptyTips),1)])):(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:1},e.renderList(n.mixinDatacomResData,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-select__selector-item",key:a,onClick:e=>r.change(t)},[e.createElementVNode("text",{class:e.normalizeClass({"uni-select__selector__disabled":t.disable})},e.toDisplayString(r.formatItemName(t)),3)],8,["onClick"])))),128))])],4)):e.createCommentVNode("",!0)],2)],2)])}],["__scopeId","data-v-6d601b46"]]);const tl=W({name:"uniFormsItem",options:{virtualHost:!0},provide(){return{uniFormItem:this}},inject:{form:{from:"uniForm",default:null}},props:{rules:{type:Array,default:()=>null},name:{type:[String,Array],default:""},required:{type:Boolean,default:!1},label:{type:String,default:""},labelWidth:{type:[String,Number],default:""},labelAlign:{type:String,default:""},errorMessage:{type:[String,Boolean],default:""},leftIcon:String,iconColor:{type:String,default:"#606266"}},data:()=>({errMsg:"",userRules:null,localLabelAlign:"left",localLabelWidth:"70px",localLabelPos:"left",border:!1,isFirstBorder:!1}),computed:{msg(){return this.errorMessage||this.errMsg}},watch:{"form.formRules"(e){this.init()},"form.labelWidth"(e){this.localLabelWidth=this._labelWidthUnit(e)},"form.labelPosition"(e){this.localLabelPos=this._labelPosition()},"form.labelAlign"(e){}},created(){this.init(!0),this.name&&this.form&&this.$watch((()=>this.form._getDataValue(this.name,this.form.localData)),((e,t)=>{if(!this.form._isEqual(e,t)){const t=this.itemSetValue(e);this.onFieldChange(t,!1)}}),{immediate:!1})},unmounted(){this.__isUnmounted=!0,this.unInit()},methods:{setRules(e=null){this.userRules=e,this.init(!1)},setValue(){},async onFieldChange(e,t=!0){const{formData:a,localData:i,errShowType:o,validateCheck:s,validateTrigger:n,_isRequiredField:r,_realName:l}=this.form,c=l(this.name);e||(e=this.form.formData[c]);const d=this.itemRules.rules&&this.itemRules.rules.length;if(!this.validator||!d||0===d)return;const u=r(this.itemRules.rules||[]);let m=null;return"bind"===n||t?(m=await this.validator.validateUpdate({[c]:e},a),u||void 0!==e&&""!==e||(m=null),m&&m.errorMessage?("undertext"===o&&(this.errMsg=m?m.errorMessage:""),"toast"===o&&uni.showToast({title:m.errorMessage||"校验错误",icon:"none"}),"modal"===o&&uni.showModal({title:"提示",content:m.errorMessage||"校验错误"})):this.errMsg="",s(m||null)):this.errMsg="",m||null},init(e=!1){const{validator:t,formRules:a,childrens:i,formData:o,localData:s,_realName:n,labelWidth:r,_getDataValue:l,_setDataValue:c}=this.form||{};if(this.localLabelAlign=this._justifyContent(),this.localLabelWidth=this._labelWidthUnit(r),this.localLabelPos=this._labelPosition(),this.form&&e&&i.push(this),!t||!a)return;this.form.isFirstBorder||(this.form.isFirstBorder=!0,this.isFirstBorder=!0),this.group&&(this.group.isFirstBorder||(this.group.isFirstBorder=!0,this.isFirstBorder=!0)),this.border=this.form.border;const d=n(this.name),u=this.userRules||this.rules;"object"==typeof a&&u&&(a[d]={rules:u},t.updateSchema(a));const m=a[d]||{};this.itemRules=m,this.validator=t,this.itemSetValue(l(this.name,s))},unInit(){if(this.form){const{childrens:e,formData:t,_realName:a}=this.form;e.forEach(((e,i)=>{e===this&&(this.form.childrens.splice(i,1),delete t[a(e.name)])}))}},itemSetValue(e){const t=this.form._realName(this.name),a=this.itemRules.rules||[],i=this.form._getValue(t,e,a);return this.form._setDataValue(t,this.form.formData,i),i},clearValidate(){this.errMsg=""},_isRequired(){return this.required},_justifyContent(){if(this.form){const{labelAlign:e}=this.form;let t=this.labelAlign?this.labelAlign:e;if("left"===t)return"flex-start";if("center"===t)return"center";if("right"===t)return"flex-end"}return"flex-start"},_labelWidthUnit(e){return this.num2px(this.labelWidth?this.labelWidth:e||(this.label?70:"auto"))},_labelPosition(){return this.form&&this.form.labelPosition||"left"},isTrigger:(e,t,a)=>"submit"!==e&&e?"bind":void 0===e?"bind"!==t?t?"submit":""===a?"bind":"submit":"bind":"submit",num2px:e=>"number"==typeof e?`${e}px`:e}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["uni-forms-item",["is-direction-"+s.localLabelPos,s.border?"uni-forms-item--border":"",s.border&&s.isFirstBorder?"is-first-border":""]])},[e.renderSlot(t.$slots,"label",{},(()=>[e.createElementVNode("view",{class:e.normalizeClass(["uni-forms-item__label",{"no-label":!i.label&&!i.required}]),style:e.normalizeStyle({width:s.localLabelWidth,justifyContent:s.localLabelAlign})},[i.required?(e.openBlock(),e.createElementBlock("text",{key:0,class:"is-required"},"*")):e.createCommentVNode("",!0),e.createElementVNode("text",null,e.toDisplayString(i.label),1)],6)]),!0),e.createElementVNode("view",{class:"uni-forms-item__content"},[e.renderSlot(t.$slots,"default",{},void 0,!0),e.createElementVNode("view",{class:e.normalizeClass(["uni-forms-item__error",{"msg--active":n.msg}])},[e.createElementVNode("text",null,e.toDisplayString(n.msg),1)],2)])],2)}],["__scopeId","data-v-7b97b15c"]]);var al={exports:{}};!function(e){e.exports=function(){var e=1e3,t=6e4,a=36e5,i="millisecond",o="second",s="minute",n="hour",r="day",l="week",c="month",d="quarter",u="year",m="date",h="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,g=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,f={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],a=e%100;return"["+e+(t[(a-20)%10]||t[a]||t[0])+"]"}},y=function(e,t,a){var i=String(e);return!i||i.length>=t?e:""+Array(t+1-i.length).join(a)+e},v={s:y,z:function(e){var t=-e.utcOffset(),a=Math.abs(t),i=Math.floor(a/60),o=a%60;return(t<=0?"+":"-")+y(i,2,"0")+":"+y(o,2,"0")},m:function e(t,a){if(t.date()<a.date())return-e(a,t);var i=12*(a.year()-t.year())+(a.month()-t.month()),o=t.clone().add(i,c),s=a-o<0,n=t.clone().add(i+(s?-1:1),c);return+(-(i+(a-o)/(s?o-n:n-o))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:u,w:l,d:r,D:m,h:n,m:s,s:o,ms:i,Q:d}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},w="en",k={};k[w]=f;var E="$isDayjsObject",N=function(e){return e instanceof x||!(!e||!e[E])},b=function e(t,a,i){var o;if(!t)return w;if("string"==typeof t){var s=t.toLowerCase();k[s]&&(o=s),a&&(k[s]=a,o=s);var n=t.split("-");if(!o&&n.length>1)return e(n[0])}else{var r=t.name;k[r]=t,o=r}return!i&&o&&(w=o),o||!i&&w},V=function(e,t){if(N(e))return e.clone();var a="object"==typeof t?t:{};return a.date=e,a.args=arguments,new x(a)},S=v;S.l=b,S.i=N,S.w=function(e,t){return V(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var x=function(){function f(e){this.$L=b(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[E]=!0}var y=f.prototype;return y.parse=function(e){this.$d=function(e){var t=e.date,a=e.utc;if(null===t)return new Date(NaN);if(S.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var i=t.match(p);if(i){var o=i[2]-1||0,s=(i[7]||"0").substring(0,3);return a?new Date(Date.UTC(i[1],o,i[3]||1,i[4]||0,i[5]||0,i[6]||0,s)):new Date(i[1],o,i[3]||1,i[4]||0,i[5]||0,i[6]||0,s)}}return new Date(t)}(e),this.init()},y.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},y.$utils=function(){return S},y.isValid=function(){return!(this.$d.toString()===h)},y.isSame=function(e,t){var a=V(e);return this.startOf(t)<=a&&a<=this.endOf(t)},y.isAfter=function(e,t){return V(e)<this.startOf(t)},y.isBefore=function(e,t){return this.endOf(t)<V(e)},y.$g=function(e,t,a){return S.u(e)?this[t]:this.set(a,e)},y.unix=function(){return Math.floor(this.valueOf()/1e3)},y.valueOf=function(){return this.$d.getTime()},y.startOf=function(e,t){var a=this,i=!!S.u(t)||t,d=S.p(e),h=function(e,t){var o=S.w(a.$u?Date.UTC(a.$y,t,e):new Date(a.$y,t,e),a);return i?o:o.endOf(r)},p=function(e,t){return S.w(a.toDate()[e].apply(a.toDate("s"),(i?[0,0,0,0]:[23,59,59,999]).slice(t)),a)},g=this.$W,f=this.$M,y=this.$D,v="set"+(this.$u?"UTC":"");switch(d){case u:return i?h(1,0):h(31,11);case c:return i?h(1,f):h(0,f+1);case l:var w=this.$locale().weekStart||0,k=(g<w?g+7:g)-w;return h(i?y-k:y+(6-k),f);case r:case m:return p(v+"Hours",0);case n:return p(v+"Minutes",1);case s:return p(v+"Seconds",2);case o:return p(v+"Milliseconds",3);default:return this.clone()}},y.endOf=function(e){return this.startOf(e,!1)},y.$set=function(e,t){var a,l=S.p(e),d="set"+(this.$u?"UTC":""),h=(a={},a[r]=d+"Date",a[m]=d+"Date",a[c]=d+"Month",a[u]=d+"FullYear",a[n]=d+"Hours",a[s]=d+"Minutes",a[o]=d+"Seconds",a[i]=d+"Milliseconds",a)[l],p=l===r?this.$D+(t-this.$W):t;if(l===c||l===u){var g=this.clone().set(m,1);g.$d[h](p),g.init(),this.$d=g.set(m,Math.min(this.$D,g.daysInMonth())).$d}else h&&this.$d[h](p);return this.init(),this},y.set=function(e,t){return this.clone().$set(e,t)},y.get=function(e){return this[S.p(e)]()},y.add=function(i,d){var m,h=this;i=Number(i);var p=S.p(d),g=function(e){var t=V(h);return S.w(t.date(t.date()+Math.round(e*i)),h)};if(p===c)return this.set(c,this.$M+i);if(p===u)return this.set(u,this.$y+i);if(p===r)return g(1);if(p===l)return g(7);var f=(m={},m[s]=t,m[n]=a,m[o]=e,m)[p]||1,y=this.$d.getTime()+i*f;return S.w(y,this)},y.subtract=function(e,t){return this.add(-1*e,t)},y.format=function(e){var t=this,a=this.$locale();if(!this.isValid())return a.invalidDate||h;var i=e||"YYYY-MM-DDTHH:mm:ssZ",o=S.z(this),s=this.$H,n=this.$m,r=this.$M,l=a.weekdays,c=a.months,d=a.meridiem,u=function(e,a,o,s){return e&&(e[a]||e(t,i))||o[a].slice(0,s)},m=function(e){return S.s(s%12||12,e,"0")},p=d||function(e,t,a){var i=e<12?"AM":"PM";return a?i.toLowerCase():i};return i.replace(g,(function(e,i){return i||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return S.s(t.$y,4,"0");case"M":return r+1;case"MM":return S.s(r+1,2,"0");case"MMM":return u(a.monthsShort,r,c,3);case"MMMM":return u(c,r);case"D":return t.$D;case"DD":return S.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return u(a.weekdaysMin,t.$W,l,2);case"ddd":return u(a.weekdaysShort,t.$W,l,3);case"dddd":return l[t.$W];case"H":return String(s);case"HH":return S.s(s,2,"0");case"h":return m(1);case"hh":return m(2);case"a":return p(s,n,!0);case"A":return p(s,n,!1);case"m":return String(n);case"mm":return S.s(n,2,"0");case"s":return String(t.$s);case"ss":return S.s(t.$s,2,"0");case"SSS":return S.s(t.$ms,3,"0");case"Z":return o}return null}(e)||o.replace(":","")}))},y.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},y.diff=function(i,m,h){var p,g=this,f=S.p(m),y=V(i),v=(y.utcOffset()-this.utcOffset())*t,w=this-y,k=function(){return S.m(g,y)};switch(f){case u:p=k()/12;break;case c:p=k();break;case d:p=k()/3;break;case l:p=(w-v)/6048e5;break;case r:p=(w-v)/864e5;break;case n:p=w/a;break;case s:p=w/t;break;case o:p=w/e;break;default:p=w}return h?p:S.a(p)},y.daysInMonth=function(){return this.endOf(c).$D},y.$locale=function(){return k[this.$L]},y.locale=function(e,t){if(!e)return this.$L;var a=this.clone(),i=b(e,t,!0);return i&&(a.$L=i),a},y.clone=function(){return S.w(this.$d,this)},y.toDate=function(){return new Date(this.valueOf())},y.toJSON=function(){return this.isValid()?this.toISOString():null},y.toISOString=function(){return this.$d.toISOString()},y.toString=function(){return this.$d.toUTCString()},f}(),C=x.prototype;return V.prototype=C,[["$ms",i],["$s",o],["$m",s],["$H",n],["$W",r],["$M",c],["$y",u],["$D",m]].forEach((function(e){C[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),V.extend=function(e,t){return e.$i||(e(t,x,V),e.$i=!0),V},V.locale=b,V.isDayjs=N,V.unix=function(e){return V(1e3*e)},V.en=k[w],V.Ls=k,V.p={},V}()}(al);const il=nt(al.exports);const ol=W({data:()=>({selectedProduct:null,products:[],timelineData:[],activeIndex:-1,tempImage:"",tempText:"",currentDate:"",formData:{page:1,limit:30},fileList:[],viewImgAndVideo:null,openId:null}),mixins:[pt],watch:{selectedProduct(e,t){this.lifeCycleData()}},async onLoad(){let e=await l.goodslist(this.formData);if(200==e.code){let t=e.data.listdata.map(((e,t)=>{let a=e.sellbegintime,i=e.sellendtime,o=`${il(a).$y}-${il(a).month()+1}-${il(a).date()}`,s=`${il(i).$y}-${il(i).month()+1}-${il(i).date()}`;const n=il(o);return il(s).diff(n,"day"),{value:e.id,text:e.goodsname}}));this.products=t,this.products&&(this.selectedProduct=this.products[0].value,this.lifeCycleData())}},methods:{viewImage(e){t("log","at pages/additionalinformation/additionalinformation.vue:179",e),uni.previewImage({showmenu:!1,urls:[e]})},async removeItem(){let e=await l.delMoments({id:this.openId});200==e.code&&uni.showToast({icon:"success",title:e.message||e.msg}).then((e=>{this.initPorp(),this.lifeCycleData()}))},editPanelClosePopup(){this.initPorp()},viewPanelClosePopup(){this.initPorp()},async lifeCycleData(){let e=await l.goodsinfoList({page:1,limit:100,farmersgoods_id:this.selectedProduct});e.data.listdata.forEach((e=>{})),this.timelineData=e.data.listdata},handleDelete(e){this.fileList.splice(e,1)},addRecord(){this.$refs.editPanel.open()},generateTimeline(){if(!this.selectedProduct)return void(this.timelineData=[]);const e=this.products.find((e=>e.value===this.selectedProduct));this.timelineData=Array.from({length:e.days},((t,a)=>({day:a+1,date:il(e.endDate).subtract(e.days-a-1,"day").format("MM/DD"),fullDate:il(e.endDate).subtract(e.days-a-1,"day").format("YYYY-MM-DD"),image:"",text:"",status:"pending"})))},handleDayClick(e){if(this.$refs.viewPanel.open(),this.tempText=e.content,e.imgs){let t=[];t=e.imgs.split(",");let a=t.map((e=>"mp4"==e.slice(e.length-3)?{fileType:"video",path:e}:{fileType:"image",path:e}));this.viewImgAndVideo=a}this.openId=e.id},saveImage:e=>new Promise(((t,a)=>{uni.uploadFile({url:"https://image.xcbdsc.com/group1/upload",name:"file",filePath:e,formData:{output:"json2"},success:e=>{t(JSON.parse(e.data))},fail:e=>{a(e),uni.showToast({title:"上传失败",icon:"error"})}})})),initPorp(){uni.hideLoading(),this.$refs.editPanel.close(),this.$refs.viewPanel.close(),this.tempText="",this.fileList=[]},async selectImage(){uni.chooseImage({count:9,mediaType:"mix",sourceType:["album","camera"],maxDuration:30,camera:"back",mediaType:["image"],success:e=>{let t=e.tempFiles.map((e=>({...e,fileType:"image"})));this.fileList=[...this.fileList,...t]}})},saveContent(){if(null==this.selectedProduct)return void uni.showToast({title:"请选择菜品",icon:"error"});uni.showLoading({title:"正在上传中....."});const e=this.fileList.map((e=>this.saveImage(e.tempFilePath)));Promise.all(e).then((e=>{let t=[];e.forEach((e=>{e&&t.push(e.data.url)}));let a={farmersgoods_id:this.selectedProduct,imgs:t.join(","),type:1,content:this.tempText};l.addinfos(a).then((e=>{this.initPorp(),this.lifeCycleData()}))})).catch((e=>{uni.showToast({title:"部分文件上传失败",icon:"none"})}))},getStatusClass:e=>({completed:"completed"===e.status,pending:"pending"===e.status}),closeEditor(){this.$refs.editPanel.close(),this.tempImage="",this.tempText=""}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-data-select"),el),c=a(e.resolveDynamicComponent("uni-forms-item"),tl),d=a(e.resolveDynamicComponent("uni-icons"),K),u=a(e.resolveDynamicComponent("uni-popup"),Ya);return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"background-wave"}),e.createElementVNode("view",{class:"product-selector"},[e.createVNode(c,{label:"选择菜品","label-width":"80","label-align":"right"},{default:e.withCtx((()=>[e.createVNode(l,{modelValue:n.selectedProduct,"onUpdate:modelValue":i[0]||(i[0]=e=>n.selectedProduct=e),localdata:n.products,placeholder:"请选择菜品",class:"nature-select"},null,8,["modelValue","localdata"])])),_:1})]),e.createElementVNode("scroll-view",{"scroll-y":"true",class:"timeline-container",style:e.normalizeStyle({visibility:n.timelineData.length?"visible":"hidden"})},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.timelineData,((a,i)=>(e.openBlock(),e.createElementBlock("view",{key:i,class:"timeline-item"},[e.createElementVNode("view",{class:"timeline-marker"},[e.createElementVNode("view",{class:"marker-icon"},[e.createVNode(d,{type:"calendar",size:"28",color:"#fff"})]),e.createElementVNode("view",{class:"timeline-connector"})]),e.createElementVNode("view",{class:"nature-card",onClick:e=>r.handleDayClick(a)},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"date-label"},e.toDisplayString(t.initTime(a.created)),1)]),e.createElementVNode("view",{class:"card-content"},[e.createElementVNode("text",{class:"content-text"},"点击查看生长情况")]),e.createElementVNode("view",{class:e.normalizeClass(["status-tag","completed"])}," 已完成 ")],8,["onClick"])])))),128))],4),e.createVNode(u,{ref:"editPanel",type:"bottom"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"edit-panel"},[e.createElementVNode("view",{class:"panel-header"},[e.createElementVNode("text",{class:"panel-title"},e.toDisplayString(n.currentDate)+" 生长记录",1)]),e.createElementVNode("view",{class:"panel-body"},[e.createElementVNode("button",{class:"action-button",onClick:i[1]||(i[1]=(...e)=>r.selectImage&&r.selectImage(...e))},[e.createVNode(d,{type:"camera",size:"20",color:"#fff"}),e.createElementVNode("text",null,"上传照片")]),e.createElementVNode("view",{class:"delete-icon",onClick:i[2]||(i[2]=(...e)=>r.editPanelClosePopup&&r.editPanelClosePopup(...e))},"×"),e.createElementVNode("scroll-view",{class:"preview-container","scroll-x":"true"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.fileList,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:"preview-item"},["image"===t.fileType?(e.openBlock(),e.createElementBlock("image",{key:0,src:t.tempFilePath,mode:"aspectFill",class:"media-content",onClick:e=>r.viewImage(t.tempFilePath)},null,8,["src","onClick"])):(e.openBlock(),e.createElementBlock("video",{key:1,src:t.tempFilePath,controls:"",class:"media-content",objectFit:"cover"},null,8,["src"])),e.createElementVNode("view",{class:"delete-icon",onClick:e=>r.handleDelete(a)},"×",8,["onClick"])])))),128))]),n.tempImage?(e.openBlock(),e.createElementBlock("image",{key:0,src:n.tempImage,class:"image-preview",mode:"aspectFit"},null,8,["src"])):e.createCommentVNode("",!0),e.withDirectives(e.createElementVNode("textarea",{"onUpdate:modelValue":i[3]||(i[3]=e=>n.tempText=e),placeholder:"请输入详细记录...",class:"record-textarea"},null,512),[[e.vModelText,n.tempText]]),e.createElementVNode("button",{class:"confirm-button",onClick:i[4]||(i[4]=(...e)=>r.saveContent&&r.saveContent(...e))},"保存记录")])])])),_:1},512),n.timelineData.length?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-text"},"请先选择种植商品")])),e.createVNode(u,{ref:"viewPanel",type:"bottom"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"edit-panel"},[e.createElementVNode("view",{class:"panel-header"},[e.createElementVNode("text",{class:"panel-title"},e.toDisplayString(n.currentDate)+" 生长记录",1)]),e.createElementVNode("view",{class:"panel-body"},[e.createElementVNode("view",{class:"delete-icon",onClick:i[5]||(i[5]=(...e)=>r.viewPanelClosePopup&&r.viewPanelClosePopup(...e))},"×"),e.createElementVNode("scroll-view",{class:"preview-container","scroll-x":"true"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.viewImgAndVideo,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:"preview-item"},["image"===t.fileType?(e.openBlock(),e.createElementBlock("image",{key:0,src:t.path,mode:"aspectFill",class:"media-content",onClick:e=>r.viewImage(t.path)},null,8,["src","onClick"])):(e.openBlock(),e.createElementBlock("video",{key:1,src:t.path,controls:"",class:"media-content",objectFit:"cover"},null,8,["src"]))])))),128))]),n.tempImage?(e.openBlock(),e.createElementBlock("image",{key:0,src:n.tempImage,class:"image-preview",mode:"aspectFit"},null,8,["src"])):e.createCommentVNode("",!0),e.withDirectives(e.createElementVNode("textarea",{"onUpdate:modelValue":i[6]||(i[6]=e=>n.tempText=e),placeholder:"",class:"record-textarea",disabled:""},null,512),[[e.vModelText,n.tempText]]),e.createElementVNode("button",{class:"confirm-button",style:{"background-color":"red"},onClick:i[7]||(i[7]=(...e)=>r.removeItem&&r.removeItem(...e))},"删除记录")])])])),_:1},512),e.createElementVNode("view",{class:"float-btn",onClick:i[8]||(i[8]=(...e)=>r.addRecord&&r.addRecord(...e))},[e.createVNode(d,{type:"plusempty",size:"30",color:"#fff"})])])}],["__scopeId","data-v-5477e344"]]);const sl=W({data:()=>({}),methods:{}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view")}]]);const nl=W({mixins:[pt],data:()=>({posts:[],queryData:{page:1,limit:10}}),computed:{timelineGroups(){return this.posts.reduce(((e,t)=>{const a=this.initDate(t.created);return e[a]=e[a]||[],e[a].push(t),e}),{})}},async onLoad(e){e.id&&(this.queryData.farmersgoods_id=parseInt(e.id)),this.getData()},methods:{viewImage(e){uni.previewImage({showmenu:!1,urls:[e]})},async getData(){let e=await l.dynamicsDataList(this.queryData);if(200==e.code){let t=e.data.listdata.map((e=>{if(!e.imgs)return e;e.imgs=e.imgs.split(",");let t=e.imgs.map((e=>"mp4"==e.slice(e.length-3)?{fileType:"video",path:e}:{fileType:"image",path:e}));return e.imgs=t,e}));this.posts=[...this.posts,...t],this.noMore=t.length<this.queryData.limit}},loadMore(){this.noMore||(this.queryData.page++,this.getData())},toggleReaction(e){const t=this.posts[e];t.liked=!t.liked,t.likes+=t.liked?1:-1},previewMedia(e){uni.previewImage({urls:[e]})},createPost(){uni.navigateTo({url:"/pages/post/create"})}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"dynamic-header"},[e.createElementVNode("text",{class:"header-title"},"种养朋友圈"),e.createElementVNode("view",{class:"header-gradient"}),e.createElementVNode("view",{class:"update-notice"},"按时间追溯农产品生长历程")]),e.createElementVNode("scroll-view",{class:"timeline-container","scroll-y":"",onScrolltolower:i[0]||(i[0]=(...e)=>r.loadMore&&r.loadMore(...e))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.timelineGroups,((a,i)=>(e.openBlock(),e.createElementBlock("view",{key:i,class:"timeline-group"},[e.createElementVNode("view",{class:"timeline-date"},[e.createElementVNode("view",{class:"timeline-dot"}),e.createElementVNode("text",{class:"date-label"},e.toDisplayString(i),1)]),e.createElementVNode("view",{class:"timeline-cards"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a,((a,i)=>(e.openBlock(),e.createElementBlock("view",{key:i,class:"neo-card"},[e.createElementVNode("view",{class:"user-header"},[e.createElementVNode("view",{class:"post-time"},"发布时间:"+e.toDisplayString(t.initTime(a.created)),1),e.createElementVNode("view",{class:"username"},e.toDisplayString(a.farmersgoodsname),1)]),e.createElementVNode("scroll-view",{class:"media-scroller","scroll-x":"","scroll-with-animation":!0,"show-scrollbar":!1},[e.createElementVNode("view",{class:"media-container"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.imgs,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:"media-item"},["image"===t.fileType?(e.openBlock(),e.createElementBlock("image",{key:0,src:t.path,mode:"aspectFill",class:"media-content",onClick:e=>r.viewImage(t.path)},null,8,["src","onClick"])):(e.openBlock(),e.createElementBlock("video",{key:1,src:t.path,controls:"",class:"media-content",objectFit:"cover"},null,8,["src"]))])))),128))])]),e.createElementVNode("view",{class:"content-section"},[e.createElementVNode("text",{class:"post-content"},e.toDisplayString(a.content),1),e.createElementVNode("view",{class:"interaction-panel"},[e.createElementVNode("view",{class:"action-btn",onClick:e=>r.toggleReaction(a.id)},[e.createVNode(l,{type:a.liked?"heart-filled":"heart",color:a.liked?"#FF6B6B":"#7A9D7E",size:"20"},null,8,["type","color"]),e.createElementVNode("text",{class:"count"},e.toDisplayString(a.likes),1)],8,["onClick"]),e.createElementVNode("view",{class:"action-btn"},[e.createVNode(l,{type:"chat",color:"#7A9D7E",size:"20"}),e.createElementVNode("text",{class:"count"},e.toDisplayString(a.comments),1)])])])])))),128))])])))),128)),n.posts.length<=0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-tip"}," 暂无种植记录 ")):e.createCommentVNode("",!0)],32)])}],["__scopeId","data-v-f2de4ab1"]]);const rl=W({mixins:[],components:{},data:()=>({}),onReady(){this.drawPureCanvas()},methods:{loadImageUrl:e=>new Promise(((t,a)=>{uni.getImageInfo({src:e,success:e=>t(e.path),fail:e=>a(new Error(`图片加载失败：${e.errMsg}`))})})),drawRoundRect(e,t,a,i,o,s){e.beginPath(),e.arc(t+s,a+s,s,Math.PI,1.5*Math.PI),e.arc(t+i-s,a+s,s,1.5*Math.PI,2*Math.PI),e.arc(t+i-s,a+o-s,s,0,.5*Math.PI),e.arc(t+s,a+o-s,s,.5*Math.PI,Math.PI),e.closePath()},async drawPureCanvas(){try{const e=uni.createCanvasContext("pureCanvas",this),t=400,a=200,i=e.createLinearGradient(0,0,0,a);i.addColorStop(0,"#409EFF"),i.addColorStop(1,"#B37EF1"),e.setFillStyle(i),e.fillRect(0,0,t,a),e.setFillStyle("#FFFFFF"),e.setFontSize(18),e.fillText("王启军",20,40),e.setFontSize(12),e.fillText("我在这个平台发现了好东西，邀请你一起加入～",20,70);const o=20,s=90,n=t-90,r=90,l=8;e.setFillStyle("#FFFFFF"),this.drawRoundRect(e,o,s,n,r,l),e.fill(),e.setFillStyle("#333333"),e.setFontSize(12),e.fillText('邀请你加入"农链天下"',40,130);const c="https://image.xcbdsc.com/group1/default/20241103/15/40/8/d772fe7b3a949cf0f63a97cd0c7cd258.jpg",d=await this.loadImageUrl(c),u=80,m=t-80-u,h=s+(r-u)/2;e.drawImage(d,m,h,u,u),e.draw()}catch(e){t("error","at pages/demo/demo.vue:104","Canvas绘制错误：",e)}}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("canvas",{"canvas-id":"pureCanvas",style:{width:"700rpx",height:"600rpx"}})}]]);const ll=W({mixins:[pt],data:()=>({formData:{title:"",content:"",phone:""},fileList:[],query:null}),computed:{},onLoad(e){t("log","at pages/merchantComplaints/merchantComplaints.vue:100",e),this.query=e},methods:{saveImage:e=>new Promise(((t,a)=>{uni.uploadFile({url:"https://image.xcbdsc.com/group1/upload",name:"file",filePath:e,formData:{output:"json2"},success:e=>{t(JSON.parse(e.data))},fail:e=>{a(e),uni.showToast({title:"上传失败",icon:"error"})}})})),async selectImage(){uni.chooseMedia({count:6,mediaType:"mix",sourceType:["album","camera"],maxDuration:30,camera:"back",success:e=>{const t=e.tempFiles.map((e=>this.saveImage(e.tempFilePath)));Promise.all(t).then((e=>{this.fileList=[...this.fileList,...e]}))}})},removeFile(e){this.fileList.splice(e,1)},async handleSubmit(){this.formData.shop_id=parseInt(this.query.id);let e=this.fileList.map((e=>e.data.url));this.formData.complaint_img=e.join(","),uni.showToast({icon:"loading",title:"正在提交"}),l.submitComplaint(this.formData).then((e=>{200==e.code?(uni.showToast({icon:"success",title:"投诉成功"}),setTimeout((()=>{this.customizeBack()}),2e3)):uni.showToast({icon:"error",title:e.msg})}))}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"complaint-container"},[e.createElementVNode("view",{class:"complaint-header"},[e.createElementVNode("text",{class:"title"},"提交投诉"),e.createElementVNode("text",{class:"subtitle"},"请补充投诉“"+e.toDisplayString(n.query.title)+"”的具体依据",1)]),e.createElementVNode("view",{class:"complaint-form"},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"item-label"},[e.createTextVNode("投诉标题"),e.createElementVNode("text",{class:"required"},"*")]),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":i[0]||(i[0]=e=>n.formData.title=e),placeholder:"请简述一下您遇到的问题",style:{"background-color":"#F8F9FA",padding:"30rpx","font-size":"28rpx"}},null,512),[[e.vModelText,n.formData.title]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"item-label"},[e.createTextVNode("投诉描述"),e.createElementVNode("text",{class:"required"},"*")]),e.withDirectives(e.createElementVNode("textarea",{"onUpdate:modelValue":i[1]||(i[1]=e=>n.formData.content=e),placeholder:"请详细描述遇到的问题（建议包含时间、地点、具体经过）",class:"content-input",maxlength:"500"},null,512),[[e.vModelText,n.formData.content]]),e.createElementVNode("view",{class:"word-counter"},e.toDisplayString(n.formData.content.length)+"/500 ",1)]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"item-label"},"上传凭证"),e.createElementVNode("view",{class:"upload-area"},[e.createElementVNode("view",{class:"upload-card",onClick:i[2]||(i[2]=(...e)=>r.selectImage&&r.selectImage(...e))},[e.createVNode(l,{type:"plusempty",size:"36",color:"#7A9D7E"}),e.createElementVNode("text",{class:"upload-tip"},"请选择上传图片"),e.createElementVNode("text",{class:"upload-subtip"},"最多6张图片")]),n.fileList.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"preview-grid"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.fileList,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:"preview-item"},[e.createElementVNode("image",{src:t.data.url,class:"preview-image",mode:"aspectFill"},null,8,["src"]),e.createVNode(l,{type:"close",size:"18",class:"delete-icon",onClick:e=>r.removeFile(a)},null,8,["onClick"])])))),128))])):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"item-label"},[e.createTextVNode("联系电话"),e.createElementVNode("text",{class:"required"},"*")]),e.createElementVNode("view",{class:"phone-input"},[e.createVNode(l,{type:"phone",size:"20",color:"#7A9D7E"}),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":i[3]||(i[3]=e=>n.formData.phone=e),type:"number",placeholder:"请输入您的手机号码",maxlength:"11"},null,512),[[e.vModelText,n.formData.phone]])])])]),e.createElementVNode("view",{class:"submit-area"},[e.createElementVNode("button",{class:"submit-btn",onClick:i[4]||(i[4]=(...e)=>r.handleSubmit&&r.handleSubmit(...e))}," 立即提交 "),e.createElementVNode("text",{class:"agreement-tip"},"提交之后工作人员将在两个小时之后联系您，请保持通话正常")])])}],["__scopeId","data-v-bc7b0d72"]]);const cl=W({mixins:[pt],data:()=>({total:null,processing:3,records:[],query:{page:1,limit:10},lock:!1,statusLabels:["处理中","已受理","调解中","已完结"],statusColors:["#FF9F43","#2E86DE","#10AC84","#8395A7"],cardStyle:{}}),onLoad(){this.getData()},methods:{viewDetail(e){let t=JSON.stringify(e);uni.navigateTo({url:`/pages/complaintDetails/complaintDetails?strJsonData=${t}`})},changePageAndGetData(){this.lock||(this.query.page+=1,this.getData())},async getData(){let e=await l.mylist(this.query);200==e.code&&(e.data.listdata<this.query.limit&&(this.lock=!0),this.total=e.data.totalnum,this.records=[...this.records,...e.data.listdata])},progressWidth:e=>["30%","60%","100%","0%"][e-1],tagStyle(e){return{background:this.statusColors[e]+"15",Color:this.statusColors[e]}}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"data-panel"},[e.createElementVNode("view",{class:"stats-card gradient-purple"},[e.createElementVNode("text",{class:"stats-number"},e.toDisplayString(n.total),1),e.createElementVNode("text",{class:"stats-label"},"总投诉量")])]),e.createElementVNode("scroll-view",{"scroll-y":"",class:"record-list",onScrolltolower:i[0]||(i[0]=(...e)=>r.changePageAndGetData&&r.changePageAndGetData(...e))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.records,((a,i)=>(e.openBlock(),e.createElementBlock("view",{key:a.id,class:e.normalizeClass(["record-card","status-"+a.status]),style:e.normalizeStyle(n.cardStyle[i]),onClick:e=>r.viewDetail(a)},[e.createElementVNode("view",{class:"card-content"},[e.createElementVNode("text",{class:"title"},e.toDisplayString(a.title),1),e.createElementVNode("view",{class:"info-row"},[e.createElementVNode("view",{class:"time-info"},[e.createVNode(l,{type:"calendar",size:"16",color:"#999"}),e.createElementVNode("text",null,e.toDisplayString(t.initTime(a.created)),1)]),e.createElementVNode("view",{class:"status-tag",style:e.normalizeStyle([r.tagStyle(a.status-1)])},e.toDisplayString(n.statusLabels[a.status-1]),5)]),e.createElementVNode("view",{class:"progress-bar"},[e.createElementVNode("view",{class:"progress-fill",style:e.normalizeStyle({width:r.progressWidth(a.status)})},null,4)])])],14,["onClick"])))),128)),0===n.records.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("image",{src:"/static/empty-state.svg",class:"empty-image"}),e.createElementVNode("text",{class:"empty-text"},"暂无投诉记录")])):e.createCommentVNode("",!0)],32)])}],["__scopeId","data-v-8d3da9a8"]]);const dl=W({mixins:[pt],data:()=>({statusTypes:["处理中","已受理","调解中","已完结"],detail:{id:"TS20231015001",status:0,createTime:"2023-10-15 14:30:45",phone:"138****1234",content:"购买的菜品质量不行，还有商家的态度极差",images:[]},processSteps:[{title:"处理中",time:"2023-10-15 14:30"},{title:"已受理",time:"2023-10-15 15:15"},{title:"调解中",time:"2023-10-16 09:30"},{title:"已完结",time:"2023-10-17 14:00"}],statusColors:["#FF9F43","#2E86DE","#10AC84","#8395A7"]}),onLoad({strJsonData:e}){if(e){let t=JSON.parse(e);t.complaint_img&&(t.complaint_img=t.complaint_img.split(",")),this.detail=t}},methods:{tagStyle(e){return{background:this.statusColors[e]+"15",Color:this.statusColors[e]}},goBack(){uni.navigateBack()},previewImage(e){uni.previewImage({current:e,urls:this.detail.complaint_img})}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"detail-container"},[e.createElementVNode("scroll-view",{"scroll-y":"",class:"content-wrapper"},[e.createElementVNode("view",{class:"status-box"},[e.createElementVNode("view",{class:"status-tag",style:e.normalizeStyle([n.tagStyle(s.detail.status-1)])},e.toDisplayString(s.statusTypes[s.detail.status-1]),5),e.createElementVNode("view",{class:"status-info"},[e.createElementVNode("text",{class:"info-item"},"提交时间："+e.toDisplayString(t.initTime(s.detail.createtime)),1),e.createElementVNode("text",{class:"info-item"},"联系电话："+e.toDisplayString(s.detail.phone),1)])]),e.createElementVNode("view",{class:"content-box"},[e.createElementVNode("view",{class:"section-title"},"投诉内容"),e.createElementVNode("view",{class:"content-text"},e.toDisplayString(s.detail.content),1)]),e.createElementVNode("view",{class:"image-box"},[e.createElementVNode("view",{class:"section-title"},"上传凭证（"+e.toDisplayString(s.detail.complaint_img.length)+"张）",1),e.createElementVNode("view",{class:"image-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.detail.complaint_img,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:"image-item",onClick:e=>n.previewImage(a)},[e.createElementVNode("image",{src:t,mode:"aspectFill",class:"image"},null,8,["src"]),e.createElementVNode("view",{class:"image-overlay"})],8,["onClick"])))),128))]),s.detail.complaint_img.length<=0?(e.openBlock(),e.createElementBlock("text",{key:0,style:{color:"gray","font-size":"23rpx"}},"暂无图片")):e.createCommentVNode("",!0)])])])}],["__scopeId","data-v-0f237a8c"]]),ul={methods:{navTo(e){uni.navigateTo({url:e})},logout(){try{uni.removeStorageSync("token"),uni.removeStorageSync("nickname"),t("log","at pages/settings/settings.vue:72","Token and nickname removed from storage")}catch(ms){t("error","at pages/settings/settings.vue:74","Failed to remove token or nickname from storage",ms)}this.isLoggedIn=!1,this.nickname="",this.userName="",uni.redirectTo({url:"/pages/login/login"})},async bindingWechat(){let e=await uni.getSystemInfo();e[1].host&&"WeChat"==e[1].host.env?uni.login({provider:"true",success:async e=>{t("log","at pages/settings/settings.vue:93",e.code,"这是用户唯一标识");let a=await l.bindingOpenid({code:e.code}),i=a.message;200==a.code?uni.showToast({title:i,icon:"success"}):uni.showToast({title:i,icon:"error"})},fail:()=>{},complete:()=>{}}):uni.showToast({title:"请前往小程序端进行账号绑定",duration:3e3,icon:"error"})}}};const ml=W(ul,[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"settings-container"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("text",{class:"title"},"系统设置")]),e.createElementVNode("scroll-view",{"scroll-y":"",class:"settings-list"},[e.createElementVNode("view",{class:"section"},[e.createElementVNode("view",{class:"section-title"},"账号管理"),e.createElementVNode("view",{class:"item",onClick:i[0]||(i[0]=e=>r.navTo("/subPackages/settings/user-edit/user-edit"))},[e.createElementVNode("text",null,"个人信息"),e.createVNode(l,{type:"right",size:"18",color:"#999"})]),e.createElementVNode("view",{class:"item",onClick:i[1]||(i[1]=e=>r.navTo("/subPackages/settings/myAddress/myAddress"))},[e.createElementVNode("text",null,"我的地址"),e.createVNode(l,{type:"right",size:"18",color:"#999"})])]),e.createElementVNode("view",{class:"section"},[e.createElementVNode("view",{class:"section-title"},"安全设置"),e.createElementVNode("view",{class:"item",onClick:i[2]||(i[2]=(...e)=>r.bindingWechat&&r.bindingWechat(...e))},[e.createElementVNode("text",null,"绑定微信"),e.createVNode(l,{type:"right",size:"18",color:"#999"})]),e.createElementVNode("view",{class:"item",onClick:i[3]||(i[3]=e=>r.navTo("/subPackages/settings/updatePwd/updatePwd"))},[e.createElementVNode("text",null,"修改密码"),e.createVNode(l,{type:"right",size:"18",color:"#999"})])]),e.createElementVNode("view",{class:"section"},[e.createElementVNode("view",{class:"item",onClick:i[4]||(i[4]=e=>r.navTo("/subPackages/settings/aboutUs/aboutUs"))},[e.createElementVNode("text",null,"关于我们"),e.createVNode(l,{type:"right",size:"18",color:"#999"})]),e.createElementVNode("view",{class:"item",onClick:i[5]||(i[5]=e=>r.navTo("/subPackages/settings/version/version"))},[e.createElementVNode("text",null,"版本更新"),e.createVNode(l,{type:"right",size:"18",color:"#999"})])]),e.createElementVNode("button",{type:"warn",onClick:i[6]||(i[6]=(...e)=>r.logout&&r.logout(...e)),style:{width:"700rpx"}},"退出登录")])])}]]);const hl=W({async onLoad({query:e}){e&&(this.product=JSON.parse(e),this.product.images=[]),this.initCount();let t=await l.traceabilityInfo({goods_id:Number(this.product.goods_id)}),a=await l.getManyImages({goodsid:Number(this.product.goods_id)});200==a.code&&a.data.forEach((e=>{this.product.images.push(e.url),this.swiperKey++})),this.product.description=t.data.content,this.product.traceability=t.data.fromcontent},data:()=>({showCountInput:!1,swiperKey:0,product:{id:1,title:"有机生态种植红富士苹果 5斤装 新鲜水果 脆甜多汁",price:39.9,originalPrice:59.9,salesVolume:null,rating:4.7,reviewCount:328,images:[],description:"",traceability:null,reviews:[]},relatedProducts:[],tabs:[{name:"基础信息"},{name:"溯源信息"}],activeTab:0,selectedSpecIndex:0,isFavorite:!1,count:1}),methods:{initCount(){let e=this.getTempCount()(this.product.id);e>1&&(this.count=e)},...j("cart",["getTempCount"]),...$("cart",["addItem","anyNumber","subItem"]),onShare(){},cancelAddToCart(){this.showCountInput=!1,uni.showToast({icon:"success",title:"已取消"}),this.initCount()},confirmAddToCart(){this.product.count=this.count,this.anyNumber(this.product),uni.showToast({icon:"success",title:"已加入"}),this.showCountInput=!1},decreaseQuantity(){this.count<=0||this.count--},increaseQuantity(){this.count++},viewReport(){},loadMoreReviews(){},addToFavorites(){},contactSeller(){},addToCart(){}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"product-detail-page"},[e.createElementVNode("view",{class:"product-images"},[(e.openBlock(),e.createElementBlock("swiper",{"indicator-dots":!0,autoplay:!0,interval:3e3,duration:500,"indicator-active-color":"#ffffff",circular:!0,key:s.swiperKey},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.product.images,(t=>(e.openBlock(),e.createElementBlock("swiper-item",null,[e.createElementVNode("image",{src:t,mode:"widthFix",class:"product-img"},null,8,["src"])])))),256))]))]),e.createElementVNode("view",{class:"product-base-info"},[e.createElementVNode("view",{class:"product-title"},e.toDisplayString(s.product.commodity_name),1),e.createElementVNode("view",{class:"product-price"},[e.createElementVNode("text",{class:"current-price"},"¥"+e.toDisplayString(s.product.price.toFixed(2)),1)])]),e.createElementVNode("view",{class:"product-tabs"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.tabs,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["tab-item",{active:s.activeTab===a}]),key:a,onClick:e=>s.activeTab=a},e.toDisplayString(t.name),11,["onClick"])))),128))]),e.createElementVNode("view",{class:"tab-content"},[0===s.activeTab?(e.openBlock(),e.createElementBlock("view",{key:0,class:"detail-content"},[e.createElementVNode("view",{class:"product-description"},[e.createElementVNode("rich-text",{nodes:s.product.description},null,8,["nodes"])])])):e.createCommentVNode("",!0),1===s.activeTab?(e.openBlock(),e.createElementBlock("view",{key:1,class:"traceability-content"},[e.createElementVNode("view",{class:"product-description"},[e.createElementVNode("rich-text",{nodes:s.product.traceability},null,8,["nodes"])])])):e.createCommentVNode("",!0),2===s.activeTab?(e.openBlock(),e.createElementBlock("view",{key:2,class:"reviews-content"})):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"bottom-bar"},[s.showCountInput?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("button",{key:0,class:"bar-btn cart-btn",onClick:a[0]||(a[0]=e=>s.showCountInput=!0)}," 加入购物车 ")),s.showCountInput?(e.openBlock(),e.createElementBlock("view",{key:1,class:"count-control"},[e.createElementVNode("button",{class:"count-btn minus",onClick:a[1]||(a[1]=(...e)=>n.decreaseQuantity&&n.decreaseQuantity(...e)),style:{display:"flex","font-size":"50rpx","align-items":"center","justify-content":"center"}},"-"),e.withDirectives(e.createElementVNode("input",{type:"number","onUpdate:modelValue":a[2]||(a[2]=e=>s.count=e),class:"count-input",min:"1"},null,512),[[e.vModelText,s.count]]),e.createElementVNode("button",{class:"count-btn plus",onClick:a[3]||(a[3]=(...e)=>n.increaseQuantity&&n.increaseQuantity(...e)),style:{display:"flex","font-size":"50rpx","align-items":"center","justify-content":"center"}},"+"),e.createElementVNode("button",{class:"bar-btn confirm-btn",onClick:a[4]||(a[4]=(...e)=>n.confirmAddToCart&&n.confirmAddToCart(...e))}," 确认加入 "),e.createElementVNode("button",{class:"bar-btn confirm-btn",style:{"background-color":"#4aff08"},onClick:a[5]||(a[5]=(...e)=>n.cancelAddToCart&&n.cancelAddToCart(...e))}," 考虑一下 ")])):e.createCommentVNode("",!0)])])}],["__scopeId","data-v-c5744b27"]]);const pl=W({components:{posterVue:W({data:()=>({scene:null,canvasWidth:300,canvasHeight:220,scale:1}),props:{name:{type:String,default:"无人测试"}},onLoad(){const{windowWidth:e}=uni.getSystemInfoSync();this.canvasWidth=Math.floor(.8*e),this.canvasHeight=Math.floor(.73*this.canvasWidth),this.scale=this.canvasWidth/300},async onReady(){try{const e=await l.getqrcode({});this.$emit("initLoad",e.data.userid),this.scene=e.data.fileURL,setTimeout((()=>{this.drawPureCanvas()}),100)}catch(e){t("error","at components/poster.vue:55","获取二维码失败：",e),uni.showToast({title:"二维码加载失败",icon:"none"})}},methods:{adapt(e){return Math.floor(e*this.scale)},doSaveImage(){uni.canvasToTempFilePath({canvasId:"pureCanvas",width:this.canvasWidth,height:this.canvasHeight,destWidth:3*this.canvasWidth,destHeight:3*this.canvasHeight,quality:1,success:e=>{uni.saveImageToPhotosAlbum({filePath:e.tempFilePath,success:()=>uni.showToast({title:"保存成功",icon:"success"}),fail:()=>uni.showToast({title:"保存失败",icon:"none"})})},fail:()=>uni.showToast({title:"生成图片失败",icon:"none"})},this)},saveCanvasImage(){},loadImageUrl:e=>new Promise(((t,a)=>{uni.getImageInfo({src:e,success:e=>t(e.path),fail:e=>a(`图片加载失败：${e.errMsg}`)})})),drawRoundRect(e,t,a,i,o,s){e.beginPath(),e.arc(t+s,a+s,s,Math.PI,1.5*Math.PI),e.arc(t+i-s,a+s,s,1.5*Math.PI,2*Math.PI),e.arc(t+i-s,a+o-s,s,0,.5*Math.PI),e.arc(t+s,a+o-s,s,.5*Math.PI,Math.PI),e.closePath()},async drawPureCanvas(){try{const e=uni.createCanvasContext("pureCanvas",this),t=e.createLinearGradient(0,0,0,this.canvasHeight);t.addColorStop(0,"#409EFF"),t.addColorStop(1,"#B37EF1"),e.setFillStyle(t),e.fillRect(0,0,this.canvasWidth,this.canvasHeight),e.setFillStyle("#FFFFFF"),e.setFontSize(this.adapt(18));const a=this.adapt(30);e.fillText("农链天下",this.adapt(20),a),e.setFontSize(this.adapt(12));const i=this.adapt(60);e.fillText("我在这个平台发现了好东西，邀请你一起加入～",this.adapt(20),i);const o=this.adapt(20),s=this.adapt(80),n=this.canvasWidth-this.adapt(40),r=this.adapt(90),l=this.adapt(8);e.setFillStyle("#FFFFFF"),this.drawRoundRect(e,o,s,n,r,l),e.fill(),e.setFillStyle("#333333"),e.setFontSize(this.adapt(12));const c=s+this.adapt(30);e.fillText('邀请你加入"农链天下"',o+this.adapt(20),c);const d=s+this.adapt(55);if(e.fillText("微信长按识别二维码",o+this.adapt(20),d),!this.scene)throw new Error("二维码地址为空");const u=await this.loadImageUrl(this.scene),m=this.adapt(70),h=this.canvasWidth-this.adapt(20)-m,p=s+(r-m)/2;e.drawImage(u,h,p,m,m),e.draw()}catch(e){t("error","at components/poster.vue:186","绘制失败：",e),uni.showToast({title:"绘制失败",icon:"none"})}}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("canvas",{"canvas-id":"pureCanvas",style:e.normalizeStyle({width:s.canvasWidth+"px",height:s.canvasHeight+"px"}),class:"canvas"},null,4),e.createElementVNode("button",{onClick:a[0]||(a[0]=(...e)=>n.saveCanvasImage&&n.saveCanvasImage(...e)),class:"save-btn"}," 保存图片到相册 ")])}],["__scopeId","data-v-35980455"]])},mixins:[pt],data:()=>({inviteCode:"INV8866",inviteRecords:[],query:{page:1,limit:10},turnThePage:!0}),onLoad(){this.getFromuserlist()},methods:{loadInviteCode(e){this.inviteCode=e},changePage(){this.turnThePage&&(this.query.page++,this.getFromuserlist())},async getFromuserlist(){let e=await l.fromuserlist(this.query);200==e.code&&(this.inviteRecords=[...this.inviteRecords,...e.data.data],this.turnThePage=!(e.data.data.length<this.query.limit))},routePush(e){uni.navigateTo({url:e})},async showInvitePoster(){this.$refs.posterPopup.open()},onShareTimeline(e){return{title:"好友邀请你加入平台，注册即得20元券，我还能得现金奖励",query:`/pages/register/register?scene=${this.inviteCode}`,success:()=>{uni.showToast({title:"分享成功",icon:"success"})}}},onShareAppMessage(e){return{title:"我在这个平台发现了好东西，邀请你一起加入～",path:`/pages/register/register?scene=${this.inviteCode}`,imageUrl:"/static/favicon.ico",success:()=>{uni.showToast({title:"分享成功",icon:"success"})}}}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K),c=a(e.resolveDynamicComponent("uni-collapse-item"),je),d=a(e.resolveDynamicComponent("uni-collapse"),Ue),u=e.resolveComponent("posterVue"),m=a(e.resolveDynamicComponent("uni-popup"),Ya);return e.openBlock(),e.createElementBlock("view",{class:"invite-page"},[e.createElementVNode("view",{class:"invite-reward card"},[e.createElementVNode("view",{class:"reward-title"},[e.createVNode(l,{type:"gift",size:"24",color:"#FF7A45"}),e.createElementVNode("text",null,"邀请福利")]),e.createElementVNode("view",{class:"reward-list"},[e.createElementVNode("view",{class:"reward-item"},[e.createElementVNode("text",{class:"reward-tag"},"好友奖励"),e.createElementVNode("text",{class:"reward-content"},"新用户注册即得20元无门槛券")]),e.createElementVNode("view",{class:"reward-item"},[e.createElementVNode("text",{class:"reward-tag"},"你的奖励"),e.createElementVNode("text",{class:"reward-content"},"好友首次消费后，你得15元现金+500积分")])])]),e.createElementVNode("view",{class:"invite-core card"},[e.createElementVNode("view",{class:"core-title"},"分享你的专属邀请码"),e.createElementVNode("view",{class:"share-buttons"},[e.createElementVNode("button",{class:"share-btn","open-type":"share","data-share-type":"wechat"},[e.createElementVNode("text",null,"微信好友")]),e.createElementVNode("button",{class:"share-btn",onClick:i[0]||(i[0]=(...e)=>r.showInvitePoster&&r.showInvitePoster(...e))},[e.createElementVNode("text",null,"生成海报")])])]),e.createElementVNode("view",{class:"invite-record card"},[e.createElementVNode("view",{class:"record-title"},[e.createElementVNode("text",null,"邀请记录")]),n.inviteRecords.length>0?(e.openBlock(),e.createElementBlock("scroll-view",{key:0,"scroll-y":!0,class:"record-list",onScrolltolower:i[1]||(i[1]=(...e)=>r.changePage&&r.changePage(...e))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.inviteRecords,((a,i)=>(e.openBlock(),e.createElementBlock("view",{class:"record-item",key:i},[e.createElementVNode("view",{class:"record-info"},[e.createElementVNode("text",{class:"friend-name"},e.toDisplayString(t.hidePhone(a.phone)),1),e.createElementVNode("text",{class:"invite-time"},e.toDisplayString(t.initTime(a.Created)),1)]),e.createElementVNode("text",{class:e.normalizeClass(["record-status","status-pending"])}," 已入驻 ")])))),128))],32)):(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-record"},[e.createVNode(l,{type:"empty",size:"48",color:"#ccc"}),e.createElementVNode("text",null,"还没有邀请记录，快去邀请好友吧～")]))]),e.createElementVNode("view",{class:"invite-rules card"},[e.createVNode(d,null,{default:e.withCtx((()=>[e.createVNode(c,{title:"邀请规则说明","title-style":{fontSize:"24rpx",color:"#666"}},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"rules-content"},[e.createElementVNode("view",{class:"rule-item"},"（通过自己二维码发展的农户商户获得收益）：10%"),e.createElementVNode("view",{class:"rule-item"},"（通过扫自己二维码发展的消费者会员获得）：10%")])])),_:1})])),_:1})]),e.createVNode(m,{ref:"posterPopup"},{default:e.withCtx((()=>[e.createElementVNode("view",null,[e.createVNode(u,{onInitLoad:r.loadInviteCode},null,8,["onInitLoad"])])])),_:1},512)])}],["__scopeId","data-v-3292b67b"]]);const gl=W({mixins:[pt],data:()=>({rewardRecords:[],totalMoney:0,query:{page:1,limit:20}}),onLoad(){this.getdata()},methods:{async getdata(){let e=await l.userRevenue(this.query);200==e.code&&(this.totalMoney=e.data.totalMoney,this.rewardRecords=[...this.rewardRecords,...e.data.listdata],t("log","at pages/earningsRecord/earningsRecord.vue:81",e))}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"reward-page"},[e.createElementVNode("view",{class:"navbar"},[e.createElementVNode("text",{class:"nav-title"},"邀请奖励记录")]),e.createElementVNode("view",{class:"overview-card"},[e.createElementVNode("view",{class:"overview-item"},[e.createElementVNode("text",{class:"overview-label"},"累计邀请奖励 (元)"),e.createElementVNode("text",{class:"overview-value"},"¥ "+e.toDisplayString(s.totalMoney),1)]),e.createElementVNode("view",{class:"overview-item"},[e.createElementVNode("text",{class:"overview-label"},"本月新增奖励 (元)"),e.createElementVNode("text",{class:"overview-value today-value"},"¥ 0")])]),e.createElementVNode("view",{class:"explanation"},[e.createElementVNode("text",null,"奖励规则：被邀请人消费后，您将获得相应比例奖励")]),e.createElementVNode("scroll-view",{class:"reward-list","scroll-y":""},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.rewardRecords,((a,i)=>(e.openBlock(),e.createElementBlock("view",{class:"list-item",key:i},[e.createElementVNode("view",{class:"item-left"},[e.createElementVNode("view",{class:"invite-icon"},[e.createElementVNode("text",{class:"icon-text"},"邀")]),e.createElementVNode("view",{class:"item-info"},[e.createElementVNode("text",{class:"item-time"},e.toDisplayString(t.initTime(a.createtime)),1),e.createElementVNode("text",{class:"item-from"},"来自：推广个人收益")])]),e.createElementVNode("text",{class:"item-amount"},"+¥"+e.toDisplayString(a.level6money),1)])))),128)),0===s.rewardRecords.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-text"},"暂无邀请奖励记录"),e.createElementVNode("text",{class:"empty-hint"},"被邀请人消费后，奖励将显示在这里")])):e.createCommentVNode("",!0)])])}],["__scopeId","data-v-3636f282"]]),fl={data:()=>({}),methods:{handleBack(){uni.showModal({title:"提示",content:"未完成实名认证将无法使用店铺入驻、商品发布等功能，确定要离开吗？",confirmText:"暂不认证",cancelText:"继续认证",success:e=>{e.confirm&&uni.navigateBack()}})},showHelp(){this.showHelpModal=!0},onIntentChange(e){this.selectedIntent=this.businessIntents[e.detail.value]},chooseImage(e){uni.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:t=>{this.idImages[e]=t.tempFilePaths[0]}})},deleteImage(e){this.idImages[e]=""},prevStep(){this.currentStep--,uni.pageScrollTo({scrollTop:0,duration:300})},nextStep(){if(0===this.currentStep){if(!this.baseInfo.accountName)return void this.showToast("请设置账号名称");if(!this.baseInfo.phone||11!==this.baseInfo.phone.length)return void this.showToast("请输入正确的手机号");if(!this.selectedIntent)return void this.showToast("请选择经营意向")}else if(1===this.currentStep){if(!this.idInfo.realName)return void this.showToast("请输入真实姓名");if(!this.idInfo.idNumber||18!==this.idInfo.idNumber.length)return void this.showToast("请输入正确的身份证号");if(!this.idImages.front)return void this.showToast("请上传身份证正面");if(!this.idImages.back)return void this.showToast("请上传身份证反面")}this.currentStep++,uni.pageScrollTo({scrollTop:0,duration:300})},submitAuth(){this.agreeAgreement?(uni.showLoading({title:"提交中..."}),setTimeout((()=>{uni.hideLoading(),uni.showModal({title:"认证提交成功",content:"您的实名认证申请已提交，1-2个工作日内完成审核。审核通过后，可直接使用店铺入驻和商品发布功能",showCancel:!1,confirmText:"前往首页",success:()=>{uni.switchTab({url:"/pages/index"})}})}),1500)):this.showToast("请阅读并同意信息使用授权")},showToast(e){uni.showToast({title:e,icon:"none",duration:2e3})},maskPhone:e=>e?e.replace(/(\d{3})(\d{4})(\d{4})/,"$1****$3"):"",maskIdCard:e=>e?e.replace(/(\d{6})(\d{8})(\d{4})/,"$1********$3"):""}};const yl=W(fl,[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"core-verification-page"})}],["__scopeId","data-v-6a2a57c9"]]);const vl=W({mixins:[pt],data:()=>({showStatus:null}),onShow(){},async onLoad(){this.showStatus=await this.checkApplyStatus(),t("log","at pages/agent/agent.vue:90",this.showStatus,"申请状态"),1==this.showStatus&&uni.showModal({showCancel:!1,content:"申请审核中,请耐心等待"}).then((()=>{}))},methods:{goToRouter(e){try{uni.navigateTo({url:e})}catch{uni.switchTab({url:e})}},gotoOwneroders(e){uni.navigateTo({url:`/pages/Ownerorders/Ownerorders?orderStatus=${e}`})}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"all"},[e.createElementVNode("view",{class:"me-container"},[e.createElementVNode("view",{class:"outlets"},[e.createElementVNode("view",{class:"title"}," 代理商 "),e.createElementVNode("view",{class:"content"},[0==n.showStatus?(e.openBlock(),e.createElementBlock("view",{key:0,class:"item",onClick:i[0]||(i[0]=e=>r.goToRouter("/subPackages/agent/cooperation/cooperation"))},[e.createVNode(l,{fontFamily:"CustomFont",size:26,color:"lightblue"},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(""))])),_:1}),e.createElementVNode("view",{class:"add-dishes"}," 立即申请 ")])):e.createCommentVNode("",!0),2==n.showStatus?(e.openBlock(),e.createElementBlock("view",{key:1,class:"item",onClick:i[1]||(i[1]=e=>r.goToRouter("/subPackages/agent/datacenter/datacenter"))},[e.createVNode(l,{fontFamily:"CustomFont",size:26,color:"lightblue"},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(""))])),_:1}),e.createElementVNode("view",{class:"add-dishes"}," 数据中心 ")])):e.createCommentVNode("",!0),2==n.showStatus?(e.openBlock(),e.createElementBlock("view",{key:2,class:"item",onClick:i[2]||(i[2]=e=>r.goToRouter("/subPackages/agent/AgentRevenue/AgentRevenue"))},[e.createVNode(l,{fontFamily:"CustomFont",size:26,color:"lightblue"},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(""))])),_:1}),e.createElementVNode("view",{class:"add-dishes"}," 收益 ")])):e.createCommentVNode("",!0)])])])])}]]);const wl=W({data:()=>({playmenthodList:[{title:"积分支付",code:0},{title:"微信支付",code:1},{title:"数字人名币",code:2}],selectCode:0,remainingAmount:"",OrderNo:""}),onLoad(e){let{OrderNo:t,remainingAmount:a}=e;this.OrderNo=t,this.remainingAmount=a},methods:{select(e){this.selectCode=e,t("log","at subPackages/PaymentModule/PaymentMethod/PaymentMethod.vue:66",this.playmenthodList[e])}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",null,[e.createElementVNode("view",{class:"payCard"},[e.createElementVNode("view",{class:"title"},"支付订单"),e.createElementVNode("view",{class:"money"},"￥"+e.toDisplayString(n.remainingAmount),1),e.createElementVNode("view",null,[e.createElementVNode("view",{class:"prompt"}," 订单应付￥"+e.toDisplayString(n.remainingAmount),1),e.createElementVNode("view",{class:"prompt"}," 订单号："+e.toDisplayString(n.OrderNo),1),e.createElementVNode("view",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.playmenthodList,(t=>(e.openBlock(),e.createElementBlock("view",{class:"option",key:t.code},["积分支付"==t.title?(e.openBlock(),e.createBlock(l,{key:0,fontFamily:"MyIconFont",size:26,color:"#ee6770;"},{default:e.withCtx((()=>[e.createTextVNode("  ")])),_:1})):e.createCommentVNode("",!0),"微信支付"==t.title?(e.openBlock(),e.createBlock(l,{key:1,fontFamily:"MyIconFont",size:26,color:"#09bb07;"},{default:e.withCtx((()=>[e.createTextVNode("  ")])),_:1})):e.createCommentVNode("",!0),"数字人名币"==t.title?(e.openBlock(),e.createBlock(l,{key:2,fontFamily:"MyIconFont",size:26,color:"#ffd345;"},{default:e.withCtx((()=>[e.createTextVNode("  ")])),_:1})):e.createCommentVNode("",!0),e.createElementVNode("view",null,e.toDisplayString(t.title),1),e.createElementVNode("view",{class:e.normalizeClass(["btn",n.selectCode==t.code?"select":""]),onClick:e=>r.select(t.code)},null,10,["onClick"])])))),128))])]),e.createElementVNode("view",{class:"payBtn"}," 支付 ￥"+e.toDisplayString(n.remainingAmount),1)])])}]]);const kl=W({data:()=>({isPayment:!1,out_trade_no:null,createtime:null,productList:[],totalPrice:0,otherFees:0,totalAmount:0,countDownTime:15,countDown:null,isTimeOut:!1,formattedCountDown:"",PaymentTimer:null,paymentMethods:[{title:"微信支付",code:1},{title:"积分支付",code:2},{title:"数字人民币",code:3}],selectedPaymentMethod:2,supportMethod:[1,2]}),mounted(){this.startCountDown(),this.PaymentTimer=setInterval((async()=>{let{data:e}=await l.getorderinfo({out_trade_no:this.out_trade_no});2==e.is_pay&&""!=e.success_time&&(clearInterval(this.PaymentTimer),uni.redirectTo({url:"/pages/orders/orders?orderStatus=3"}))}),2500)},beforeDestroy(){this.clearCountDown()},async onLoad(e){this.out_trade_no=e.out_trade_no;let t=await l.myorders(e);if(200==t.code){let e=t.data.listdata[0];this.createtime=e.createtime,this.productList=e.list_arr,this.totalPrice=e.price,this.totalAmount=this.totalPrice+this.otherFees}else uni.showToast({title:t.msg||t.message})},onUnload(){clearInterval(this.PaymentTimer)},methods:{initTime(e){let t=new Date(e).getTime();var a=10===String(t).length?new Date(1e3*parseInt(t)):new Date(parseInt(t)),i=a.getFullYear(),o=a.getMonth()+1;o<10&&(o="0"+o);var s=a.getDate();s<10&&(s="0"+s);var n=a.getHours();n<10&&(n="0"+n);var r=a.getMinutes();r<10&&(r="0"+r);var l=a.getSeconds();return l<10&&(l="0"+l),i+"-"+o+"-"+s+" "+n+":"+r+":"+l},goBack(){uni.navigateBack()},selectPaymentMethod(e){this.selectedPaymentMethod=e.code},async startPayment(e){let a=await l.wechatpay({out_trade_no:this.out_trade_no});200==a.code?(a.data.timeStamp+="",uni.requestPayment({...a.data})):202==a.code?uni.login({provider:"true",success:async e=>{let i=await l.bindingOpenid({code:e.code});if(t("log","at subPackages/PaymentModule/collectOnDelivery/collectOnDelivery.vue:224",i,a),200==i.code){let e=await l.wechatpay({out_trade_no:this.out_trade_no});200==e.code?(e.data.timeStamp+="",uni.requestPayment({...e.data})):uni.showToast({title:e.message,icon:"error"})}else uni.showToast({title:i.message,icon:"error"})}}):uni.showToast({title:a.msg||a.message,icon:"error"})},async prepay(){if(this.supportMethod.includes(this.selectedPaymentMethod))switch(this.selectedPaymentMethod){case 1:this.startPayment(this.out_trade_no);break;case 2:let e=await l.payscore({out_trade_no:this.out_trade_no});t("log","at subPackages/PaymentModule/collectOnDelivery/collectOnDelivery.vue:314",e),200==e.code?(uni.showToast({title:"支付成功",icon:"success"}),this.isPayment=!0,this.clearCountDown(),clearInterval(this.PaymentTimer),uni.redirectTo({url:"/pages/orders/orders?orderStatus=3"})):uni.showToast({title:e.msg||e.message,icon:"error"});break;case 3:t("log","at subPackages/PaymentModule/collectOnDelivery/collectOnDelivery.vue:338","数字人民币")}else uni.showToast({title:"暂未开通"+this.paymentMethods[this.selectedPaymentMethod-1].title,icon:"error"})},startCountDown(){let e=60*this.countDownTime;this.countDown=setInterval((async()=>{if(e<=0)return this.isTimeOut=!0,this.clearCountDown(),void t("log","at subPackages/PaymentModule/collectOnDelivery/collectOnDelivery.vue:356","订单超时，已自动取消");const a=Math.floor(e/60),i=e%60;this.formattedCountDown=`${this.padZero(a)}:${this.padZero(i)}`,e--}),1e3)},clearCountDown(){this.countDown&&clearInterval(this.countDown)},padZero:e=>e<10?`0${e}`:e.toString()}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"order-detail-page"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("view",{class:"back-btn",onClick:i[0]||(i[0]=(...e)=>r.goBack&&r.goBack(...e))},[e.createElementVNode("text",{class:"iconfont icon-fanhui"})]),e.createElementVNode("text",{class:"title"},"订单详情")]),e.createElementVNode("view",{class:"order-base-info"},[e.createElementVNode("view",null,[e.createElementVNode("text",{class:"info-label"},"订单编号："),e.createElementVNode("text",{class:"order-id"},e.toDisplayString(n.out_trade_no),1)]),e.createElementVNode("view",null,[e.createElementVNode("text",{class:"info-label"},"下单时间："),e.createElementVNode("text",{class:"order-time"},e.toDisplayString(r.initTime(n.createtime)),1)])]),e.createElementVNode("view",{class:"product-info"},[e.createElementVNode("view",{class:"product-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.productList,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"product-item",key:a},[e.createElementVNode("image",{src:t.imglogo,class:"product-img"},null,8,["src"]),e.createElementVNode("view",{class:"product-details"},[e.createElementVNode("text",{class:"product-name"},e.toDisplayString(t.goodsname),1),e.createElementVNode("text",{class:"product-quantity"},e.toDisplayString(t.price)+"￥×"+e.toDisplayString(t.goodsnum)+"斤",1)])])))),128))])]),e.createElementVNode("view",{class:"order-amount-info"},[e.createElementVNode("view",{class:"total-price"},[e.createElementVNode("text",{class:"amount-label"},"菜品总价："),e.createElementVNode("text",{class:"price-value"},e.toDisplayString(n.totalPrice)+" 元",1)]),e.createElementVNode("view",{class:"other-fees"},[e.createElementVNode("text",{class:"amount-label"},"其他费用："),e.createElementVNode("text",{class:"price-value"},e.toDisplayString(n.otherFees)+" 元",1)]),e.createElementVNode("view",{class:"total-amount"},[e.createElementVNode("text",{class:"amount-label"},"应付总额："),e.createElementVNode("text",{class:"price-value amount-total"},e.toDisplayString(n.totalAmount)+" 元",1)])]),e.createElementVNode("view",{class:"payment-methods"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.paymentMethods,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["payment-method-item",{active:n.selectedPaymentMethod===t.code}]),key:a,onClick:e=>r.selectPaymentMethod(t)},["积分支付"==t.title?(e.openBlock(),e.createBlock(l,{key:0,fontFamily:"MyIconFont",size:26,color:"#ee6770;"},{default:e.withCtx((()=>[e.createTextVNode("  ")])),_:1})):e.createCommentVNode("",!0),"微信支付"==t.title?(e.openBlock(),e.createBlock(l,{key:1,fontFamily:"MyIconFont",size:26,color:"#09bb07;"},{default:e.withCtx((()=>[e.createTextVNode("  ")])),_:1})):e.createCommentVNode("",!0),"数字人民币"==t.title?(e.openBlock(),e.createBlock(l,{key:2,fontFamily:"MyIconFont",size:26,color:"#ffd345;"},{default:e.withCtx((()=>[e.createTextVNode("  ")])),_:1})):e.createCommentVNode("",!0),e.createElementVNode("text",{class:"payment-name"},e.toDisplayString(t.title),1)],10,["onClick"])))),128))]),e.createElementVNode("view",{class:"payment-btn-area"},[e.createElementVNode("button",{type:"primary",onClick:i[1]||(i[1]=(...e)=>r.prepay&&r.prepay(...e)),disabled:n.isTimeOut||!n.selectedPaymentMethod,"open-type":"getAuthorize"},e.toDisplayString(n.isPayment?"已支付":"立即付款"),9,["disabled"])]),e.createElementVNode("view",{class:"payment-tips"},[e.createElementVNode("text",null,"请在"+e.toDisplayString(n.countDownTime)+"分钟内完成支付，逾期未支付订单将自动取消哦~",1)]),e.createElementVNode("view",{class:"countdown-area"},[e.createElementVNode("text",{class:"countdown-text"},"剩余时间："+e.toDisplayString(n.formattedCountDown),1)])])}]]),El={mixins:[pt],data:()=>({formData:{nickname:"",phone:"",email:"",province:"",city:"",remark:"",type:null,status:1},errorTips:{},regionRange:[[],[]],provinceMapData:[],cityMapData:[],regionIndex:[0,0],agentTypeList:[["省级","市级"]],agentTypeIndex:[[0]],isSubmitting:!1,isShowLoading:!1,isSubmit:!1,key:!1}),async onLoad(){let e=await l.getqrcode();200==e.code&&(this.formData.userid=e.data.userid),this.initRegion()},methods:{async getCityData(e){if(e){this.regionIndex[1]=0,this.cityMapData=[],this.regionRange.splice(1,1,[]);try{const a=await l.citytree(e);if(200===a.code&&Array.isArray(a.data)){const e=[],t=[];a.data.forEach((a=>{e.push(a.id),t.push(a.name)})),this.cityMapData=e,this.regionRange[1]=t}else t("warn","at subPackages/agent/cooperation/cooperation.vue:195","城市数据返回格式异常",a)}catch(a){t("error","at subPackages/agent/cooperation/cooperation.vue:198","获取城市数据失败",a)}finally{this.$nextTick((()=>{this.$forceUpdate()}))}}else t("warn","at subPackages/agent/cooperation/cooperation.vue:174","缺少省份ID，无法获取城市数据")},async initRegion(){let e=await l.citylist({level:1,limit:100});200==e.code&&e.data.listdata.forEach((e=>{this.provinceMapData.push(e.id),this.regionRange[0].push(e.name)})),this.getCityData(this.provinceMapData[0])},navigateBack(){uni.navigateBack({delta:1})},handlePhoneInput(e){this.formData.phone=e.detail.value.replace(/\D/g,"").slice(0,11)},onRegionColumnChange({detail:e}){t("log","at subPackages/agent/cooperation/cooperation.vue:237",e),0==e.column&&(this.regionIndex[0]=e.value,this.getCityData(this.provinceMapData[e.value]))},onAgentTypeChange({detail:e}){this.agentTypeIndex[0]=e.value[0],this.$nextTick((()=>{this.$forceUpdate()}))},onRegionChange({detail:e}){this.regionIndex=e.value},validateField(e){const t="region"===e?this.regionIndex[0]:this.formData[e],a={};switch(e){case"nickname":t||(a.nickname="请输入您的真实姓名");break;case"phone":t?11!==t.length&&(a.phone="请输入11位有效手机号码"):a.phone="请输入联系电话";break;case"email":t?/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$/.test(t)||(a.email="请输入有效的邮箱格式（例：xxx@xx.com）"):a.email="请输入电子邮箱";break;case"company":t||(a.company="请输入公司名称");break;case"address":t||(a.address="请输入公司详细地址");break;case"region":null===t&&(a.region="请选择意向代理区域");break;case"intention":t?t.length>200&&(a.intention="合作意向描述不能超过200字"):a.intention="请描述您的合作意向"}return this.$set(this.errorTips,e,a[e]||""),!a[e]},validateForm(){let e=!0;return["name","phone","email","company","address","region","intention"].forEach((t=>{this.validateField(t)||(e=!1)})),e},async submitForm(){switch(this.agentTypeList[0][this.agentTypeIndex[0]]){case"省级":this.formData.type=1;break;case"市级":this.formData.type=2}this.formData.province=this.provinceMapData[this.regionIndex[0]],this.formData.city=this.cityMapData[this.regionIndex[1]],this.formData.agentType=Number(this.agentTypeIndex[0])+1,await l.agentApply(this.formData),this.isSubmit=!0,this.isSubmitting=!0,this.isShowLoading=!0,setTimeout((()=>{this.isShowLoading=!1,this.isSubmitting=!1,this.resetForm()}),2500)},resetForm(){this.formData={name:"",phone:"",email:"",intention:""},this.regionIndex=[null,null],this.errorTips={}}}};const Nl=W(El,[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"agent-apply-page"},[e.createElementVNode("view",{class:"form-container"},[e.createElementVNode("view",{class:"form-header"},[e.createElementVNode("view",{class:"form-title"},"代理申请表"),e.createElementVNode("view",{class:"form-subtitle"},"请如实填写信息，我们将尽快与您对接")]),n.isSubmit?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"form-wrapper"},[e.createElementVNode("form",{class:"agent-form"},[e.createElementVNode("view",{class:"form-card"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("view",{class:"section-icon"},[e.createVNode(l,{type:"contact",size:"20",color:"#4285F4"})]),e.createElementVNode("view",{class:"section-name"},"个人信息")]),e.createElementVNode("view",{class:"form-group"},[e.createElementVNode("view",{class:"form-label required"},"姓名"),e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":i[0]||(i[0]=e=>n.formData.nickname=e),placeholder:"请输入您的真实姓名",class:"form-input"},null,512),[[e.vModelText,n.formData.nickname]]),n.errorTips.name?(e.openBlock(),e.createElementBlock("view",{key:0,class:"error-tip"},e.toDisplayString(n.errorTips.name),1)):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"form-group"},[e.createElementVNode("view",{class:"form-label required"},"联系电话"),e.withDirectives(e.createElementVNode("input",{type:"number","onUpdate:modelValue":i[1]||(i[1]=e=>n.formData.phone=e),placeholder:"请输入11位手机号码",class:"form-input",onInput:i[2]||(i[2]=(...e)=>r.handlePhoneInput&&r.handlePhoneInput(...e))},null,544),[[e.vModelText,n.formData.phone]]),n.errorTips.phone?(e.openBlock(),e.createElementBlock("view",{key:0,class:"error-tip"},e.toDisplayString(n.errorTips.phone),1)):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"form-group"},[e.createElementVNode("view",{class:"form-label required"},"电子邮箱"),e.withDirectives(e.createElementVNode("input",{type:"email","onUpdate:modelValue":i[3]||(i[3]=e=>n.formData.email=e),placeholder:"请输入常用邮箱（例：xxx@xx.com）",class:"form-input"},null,512),[[e.vModelText,n.formData.email]]),n.errorTips.email?(e.openBlock(),e.createElementBlock("view",{key:0,class:"error-tip"},e.toDisplayString(n.errorTips.email),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"form-card"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("view",{class:"section-icon"},[e.createVNode(l,{type:"map-pin",size:"20",color:"#FBBC05"})]),e.createElementVNode("view",{class:"section-name"},"代理信息")]),e.createElementVNode("view",{class:"form-group"},[e.createElementVNode("view",{class:"form-label required"},"代理区域"),e.createElementVNode("picker",{mode:"multiSelector",range:n.regionRange,value:n.regionIndex,onChange:i[4]||(i[4]=(...e)=>r.onRegionChange&&r.onRegionChange(...e)),onColumnchange:i[5]||(i[5]=(...e)=>r.onRegionColumnChange&&r.onRegionColumnChange(...e)),class:"form-picker"},[e.createElementVNode("view",{class:"picker-view"},e.toDisplayString(null!==n.regionIndex[0]?`${n.regionRange[0][n.regionIndex[0]]} - ${n.regionRange[1][n.regionIndex[1]]}`:"选择区域"),1)],40,["range","value"]),n.errorTips.region?(e.openBlock(),e.createElementBlock("view",{key:0,class:"error-tip"},e.toDisplayString(n.errorTips.region),1)):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"form-group"},[e.createElementVNode("view",{class:"form-label required"},"代理级别"),e.createElementVNode("picker",{mode:"multiSelector",class:"form-picker",range:n.agentTypeList,onChange:i[6]||(i[6]=(...e)=>r.onAgentTypeChange&&r.onAgentTypeChange(...e))},[e.createElementVNode("view",{class:"picker-view"},e.toDisplayString(null!==n.agentTypeIndex[0]?`${n.agentTypeList[0][n.agentTypeIndex[0]]}`:"选择代理级别"),1)],40,["range"]),n.errorTips.region?(e.openBlock(),e.createElementBlock("view",{key:0,class:"error-tip"},e.toDisplayString(n.errorTips.region),1)):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"form-group"},[e.createElementVNode("view",{class:"form-label"},"补充说明"),e.withDirectives(e.createElementVNode("textarea",{"onUpdate:modelValue":i[7]||(i[7]=e=>n.formData.remark=e),placeholder:"其他需要说明的信息",class:"form-textarea",rows:"3"},null,512),[[e.vModelText,n.formData.remark]]),e.createElementVNode("view",{class:"word-count"},e.toDisplayString(n.formData.remark.length)+"/150",1)])]),e.createElementVNode("button",{"form-type":"submit",class:"submit-btn",onClick:i[8]||(i[8]=(...e)=>r.submitForm&&r.submitForm(...e)),loading:n.isSubmitting,disabled:n.isSubmitting,"hover-class":"submit-btn-hover"},[n.isSubmitting?(e.openBlock(),e.createBlock(l,{key:1,type:"spinner",size:"18",color:"#fff",class:"submit-loading"})):(e.openBlock(),e.createElementBlock("span",{key:0},"提交申请"))],8,["loading","disabled"])]),e.createCommentVNode("",!0)])),n.isSubmit?(e.openBlock(),e.createElementBlock("view",{key:1,style:{display:"flex","justify-content":"center"},animation:!0,"animation-duration":"300"},[e.createElementVNode("view",{class:"popup-content"},[e.createElementVNode("view",{class:"popup-icon"},[e.createVNode(l,{type:"success-circle",size:"60",color:"#34A853"})]),e.createElementVNode("view",{class:"popup-title"},"申请提交成功！"),e.createElementVNode("view",{class:"popup-desc"},[e.createTextVNode(" 我们已收到您的申请，"),e.createElementVNode("br"),e.createTextVNode("专属客户经理将在3个工作日内与您联系 ")]),e.createElementVNode("button",{class:"popup-btn",onClick:i[9]||(i[9]=(...e)=>t.customizeBack&&t.customizeBack(...e)),"hover-class":"popup-btn-hover"}," 好的 ")])])):e.createCommentVNode("",!0)])])}],["__scopeId","data-v-992cb331"]]),bl={data:()=>({coreData:{totalSales:0,monthSales:0,totalOrders:0,monthOrders:0,totalCustomers:0,newCustomers:0,totalProfit:0,monthProfit:0,targetRate:0,targetAmount:0,completedAmount:0},recentOrders:[],trendRange:["近7天","近30天","近90天"],selectedTrendRange:1,trendData:{},chartOpts:{color:["#4285F4"],padding:[15,15,0,15],legend:{show:!1},xAxis:{type:"grid",gridType:"dash",dashLength:2,axisLine:!1,labelCount:5,fontSize:11,color:"#999"},yAxis:{gridType:"dash",dashLength:2,axisLine:!1,labelCount:4,fontSize:11,color:"#999"},extra:{line:{width:2,type:"curve"}}}}),onLoad(){this.loadData()},methods:{async loadData(){try{uni.showLoading({title:"加载中...",mask:!0});const[e,t,a]=await Promise.all([l.getAgentCoreData(),l.getRecentOrders({limit:5}),l.getSalesTrend({range:this.trendRange[this.selectedTrendRange]})]);200===e.code&&(this.coreData=e.data),200===t.code&&(this.recentOrders=t.data),200===a.code&&(this.trendData=a.data)}catch(e){t("error","at subPackages/agent/datacenter/datacenter.vue:208","数据加载失败:",e),uni.showToast({title:"数据加载失败",icon:"none",duration:2e3})}finally{uni.hideLoading()}},changeTrendRange(e){this.selectedTrendRange=e.detail.value,this.loadData()},formatDate:e=>formatDate(e,"YYYY-MM-DD HH:mm"),getStatusText:e=>({PENDING:"待支付",PAID:"已支付",SHIPPED:"已发货",COMPLETED:"已完成",CANCELLED:"已取消"}[e]||e),viewAllOrders(){uni.navigateTo({url:"/pages/agent/all-orders"})}}};const Vl=W(bl,[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"agent-data-page"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("view",{class:"header-title"},"代理商数据中心"),e.createElementVNode("view",{class:"header-subtitle"},"实时查看您的业务数据概况")]),e.createElementVNode("view",{class:"data-container"},[e.createElementVNode("view",{class:"data-card"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("view",{class:"section-icon"},[e.createVNode(l,{type:"chart",size:"20",color:"#4285F4"})]),e.createElementVNode("view",{class:"section-name"},"核心业务数据")]),e.createElementVNode("view",{class:"data-grid"},[e.createElementVNode("view",{class:"data-item"},[e.createElementVNode("view",{class:"data-label"},"累计销售额"),e.createElementVNode("view",{class:"data-value"},"¥"+e.toDisplayString(n.coreData.totalSales.toLocaleString()),1),e.createElementVNode("view",{class:"data-desc"},"本月：¥"+e.toDisplayString(n.coreData.monthSales.toLocaleString()),1)]),e.createElementVNode("view",{class:"data-item"},[e.createElementVNode("view",{class:"data-label"},"累计订单数"),e.createElementVNode("view",{class:"data-value"},e.toDisplayString(n.coreData.totalOrders.toLocaleString()),1),e.createElementVNode("view",{class:"data-desc"},"本月："+e.toDisplayString(n.coreData.monthOrders.toLocaleString()),1)]),e.createElementVNode("view",{class:"data-item"},[e.createElementVNode("view",{class:"data-label"},"服务客户数"),e.createElementVNode("view",{class:"data-value"},e.toDisplayString(n.coreData.totalCustomers.toLocaleString()),1),e.createElementVNode("view",{class:"data-desc"},"新增："+e.toDisplayString(n.coreData.newCustomers.toLocaleString()),1)]),e.createElementVNode("view",{class:"data-item"},[e.createElementVNode("view",{class:"data-label"},"累计收益"),e.createElementVNode("view",{class:"data-value"},"¥"+e.toDisplayString(n.coreData.totalProfit.toLocaleString()),1),e.createElementVNode("view",{class:"data-desc"},"本月：¥"+e.toDisplayString(n.coreData.monthProfit.toLocaleString()),1)])])]),e.createElementVNode("view",{class:"data-card"},[e.createElementVNode("view",{class:"target-progress"},[e.createElementVNode("view",{class:"target-info"},[e.createElementVNode("view",{class:"target-label"},"业绩达成率"),e.createElementVNode("view",{class:"target-value"},e.toDisplayString(n.coreData.targetRate)+"%",1)]),e.createElementVNode("view",{class:"progress-bar"},[e.createElementVNode("view",{class:"progress-fill",style:e.normalizeStyle({width:n.coreData.targetRate+"%"})},null,4)]),e.createElementVNode("view",{class:"target-detail"},[e.createElementVNode("view",{class:"detail-item"},"目标：¥"+e.toDisplayString(n.coreData.targetAmount.toLocaleString()),1),e.createElementVNode("view",{class:"detail-item"},"已完成：¥"+e.toDisplayString(n.coreData.completedAmount.toLocaleString()),1)])])]),e.createElementVNode("view",{class:"data-card"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("view",{class:"section-icon"},[e.createVNode(l,{type:"orders-o",size:"20",color:"#34A853"})]),e.createElementVNode("view",{class:"section-name"},"近期订单明细")]),e.createElementVNode("view",{class:"order-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.recentOrders,(t=>(e.openBlock(),e.createElementBlock("view",{class:"order-item",key:t.id},[e.createElementVNode("view",{class:"order-left"},[e.createElementVNode("view",{class:"order-no"},"订单号："+e.toDisplayString(t.orderNo),1),e.createElementVNode("view",{class:"order-date"},e.toDisplayString(r.formatDate(t.createTime)),1)]),e.createElementVNode("view",{class:"order-right"},[e.createElementVNode("view",{class:"order-amount"},"¥"+e.toDisplayString(t.amount.toFixed(2)),1),e.createElementVNode("view",{class:e.normalizeClass(["order-status","status-"+t.status])},e.toDisplayString(r.getStatusText(t.status)),3)])])))),128)),e.createElementVNode("view",{class:"view-all",onClick:i[0]||(i[0]=(...e)=>r.viewAllOrders&&r.viewAllOrders(...e))},"查看全部订单 →")])]),e.createElementVNode("view",{class:"data-card"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("view",{class:"section-icon"},[e.createVNode(l,{type:"calendar",size:"20",color:"#EA4335"})]),e.createElementVNode("view",{class:"section-name"},"数据统计趋势")]),e.createElementVNode("view",{class:"trend-filter"},[e.createElementVNode("picker",{mode:"selector",range:n.trendRange,value:n.selectedTrendRange,onChange:i[1]||(i[1]=(...e)=>r.changeTrendRange&&r.changeTrendRange(...e))},[e.createElementVNode("view",{class:"filter-text"},e.toDisplayString(n.trendRange[n.selectedTrendRange]),1),e.createVNode(l,{type:"down",size:"14",class:"filter-icon"})],40,["range","value"])]),e.createElementVNode("view",{class:"trend-chart"})])])])}],["__scopeId","data-v-29c210c1"]]);const Sl=W({mixins:[pt],data:()=>({totalMoney:0,profitRecords:[],query:{page:1,limit:10},loading:!1,loadStatus:"more",hasMore:!0}),onLoad(){this.fetchProfitData()},methods:{formatTime(e){if(!e)return"";const t=new Date(e);return`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getDate().toString().padStart(2,"0")} ${t.getHours().toString().padStart(2,"0")}:${t.getMinutes().toString().padStart(2,"0")}`},async fetchProfitData(){this.loading=!0,this.loadStatus="loading";try{const e=await l.cityAgentRevenue(this.query);if(200===e.code){const t=e.data;this.totalMoney=t.totalMoney||0,1===this.query.page?this.profitRecords=t.listdata||[]:this.profitRecords=[...this.profitRecords,...t.listdata],this.hasMore=this.query.page*this.query.limit<t.total_count,this.loadStatus=this.hasMore?"more":"noMore"}else uni.showToast({title:e.message||"获取收益数据失败",icon:"none"}),this.loadStatus="more"}catch(e){t("error","at subPackages/agent/AgentRevenue/AgentRevenue.vue:114","获取代理商收益数据失败:",e),uni.showToast({title:"网络请求异常",icon:"none"}),this.loadStatus="more"}finally{this.loading=!1}},loadMore(){this.hasMore&&!this.loading&&(this.query.page++,this.fetchProfitData())}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-load-more"),me);return e.openBlock(),e.createElementBlock("view",{class:"agent-profit-page"},[e.createElementVNode("view",{class:"overview-container"},[e.createElementVNode("view",{class:"overview-card"},[e.createElementVNode("view",{class:"overview-item"},[e.createElementVNode("text",{class:"overview-label"},"累计收益 (元)"),e.createElementVNode("text",{class:"overview-value pending-value"},"¥ "+e.toDisplayString(n.totalMoney.toFixed(2)),1)])])]),e.createElementVNode("view",{class:"explanation"},[e.createElementVNode("text",null,"推广说明：您推广的用户完成订单支付后，系统将自动计算并发放收益。")]),e.createElementVNode("scroll-view",{class:"profit-list","scroll-y":"",onScrolltolower:i[0]||(i[0]=(...e)=>r.loadMore&&r.loadMore(...e))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.profitRecords,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"list-item",key:a},[e.createElementVNode("view",{class:"item-left"},[e.createElementVNode("view",{class:"order-icon"},[e.createElementVNode("text",{class:"icon-text"},"订")]),e.createElementVNode("view",{class:"item-info"},[e.createElementVNode("view",{class:"item-order-no"},"订单号:"+e.toDisplayString(t.out_trade_no),1),e.createElementVNode("view",{class:"item-time"},"创建时间："+e.toDisplayString(r.formatTime(t.createtime)),1)])]),e.createElementVNode("view",{class:"item-right"},[e.createElementVNode("text",{class:e.normalizeClass(["item-amount",{"amount-pending":"pending"===t.status,"amount-settled":"settled"===t.status}])},e.toDisplayString("pending"===t.status?"+¥":"¥")+e.toDisplayString(t.level4money.toFixed(2)),3)])])))),128)),0!==n.profitRecords.length||n.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-text"},"暂无推广收益记录"),e.createElementVNode("text",{class:"empty-hint"},"分享您的推广链接，邀请用户下单即可获得收益")])),n.loading?(e.openBlock(),e.createElementBlock("view",{key:1,class:"loading-state"},[e.createVNode(l,{status:n.loadStatus},null,8,["status"])])):e.createCommentVNode("",!0)],32)])}],["__scopeId","data-v-9937bec8"]]);const xl=W({data:()=>({userinfo:{reallyname:"",cardnumber:"",avatar:"",address:""},oldDataInfo:null}),async onLoad(){let e=await l.myInfo({});this.oldDataInfo=e.data},methods:{commitAvater(){uni.chooseImage({count:1,sizeType:["compressed","original"],sourceType:["album","camera"],success:e=>{const t=e.tempFilePaths;if(t.length>0){const{upload:a,request:i}=Ae({uploadPath:"/group1/upload",tempFilePaths:t[0],file:e.tempFiles[0]});a().then((e=>{var t=JSON.parse(e);this.userinfo.avatar=t.data.url}))}}})},async customizeBack(){let e=await getCurrentPages();t("log","at subPackages/aHouseholder/additionalInformation/additionalInformation.vue:216",e),e&&e.length>1?uni.navigateBack():history.back()},async submitForm(){let e=await l.upFarmers({id:this.oldDataInfo.id,...this.userinfo});200==e.code&&(uni.showToast({icon:"success",title:e.msg}),this.customizeBack()),uni.showToast({icon:"error",title:e.msg})}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"profile-page"},[e.createElementVNode("text",{class:"page-title"},"户主资料补充"),e.createElementVNode("view",{class:"form-container"},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("label",{class:"form-label"},"真实姓名："),e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":i[0]||(i[0]=e=>n.userinfo.reallyname=e),placeholder:"请输入真实姓名",class:"form-input"},null,512),[[e.vModelText,n.userinfo.reallyname]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("label",{class:"form-label"},"身份证："),e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":i[1]||(i[1]=e=>n.userinfo.cardnumber=e),placeholder:"请输入身份证号码",class:"form-input"},null,512),[[e.vModelText,n.userinfo.cardnumber]])]),e.createElementVNode("view",{class:"form-item avatar-item"},[e.createElementVNode("label",{class:"form-label"},"头像："),e.createElementVNode("view",{class:"avatar-wrapper"},[e.withDirectives(e.createElementVNode("image",{src:n.userinfo.avatar,mode:"aspectFit",class:"avatar-image",onClick:i[2]||(i[2]=(...e)=>r.commitAvater&&r.commitAvater(...e))},null,8,["src"]),[[e.vShow,n.userinfo.avatar]]),e.withDirectives(e.createVNode(l,{type:"plusempty",size:"50",class:"avatar-placeholder",onClick:r.commitAvater},null,8,["onClick"]),[[e.vShow,!n.userinfo.avatar]])])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("label",{class:"form-label"},"详细地址："),e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":i[3]||(i[3]=e=>n.userinfo.address=e),placeholder:"请输入详细地址",class:"form-input"},null,512),[[e.vModelText,n.userinfo.address]])])]),e.createElementVNode("view",{class:"button-container"},[e.createElementVNode("button",{onClick:i[4]||(i[4]=(...e)=>r.submitForm&&r.submitForm(...e)),class:"submit-btn"},"提交信息")])])}],["__scopeId","data-v-842715e9"]]);const Cl=W({data:()=>({dish:{name:"",price:0,imagesList:[]}}),methods:{deleteItem(e){uni.showModal({content:"是否删除照片",complete:a=>{t("log","at subPackages/aHouseholder/publishDishes/publishDishes.vue:44",a),a.confirm&&this.dish.imagesList.splice(e,1)}})},handleSubmit(){t("log","at subPackages/aHouseholder/publishDishes/publishDishes.vue:53","提交的菜品信息：",this.dish)},commitAvater(){uni.chooseImage({count:1,sizeType:["compressed","original"],sourceType:["album","camera"],success:e=>{const t=e.tempFilePaths;if(t.length>0){const{upload:a,request:i}=Ae({uploadPath:"/group1/upload",tempFilePaths:t[0],file:e.tempFiles[0]});a().then((e=>{var t=JSON.parse(e);this.dish.imagesList.push(t.data.url)}))}}})}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"form-container"},[e.createElementVNode("form",{onSubmit:i[1]||(i[1]=e.withModifiers(((...e)=>r.handleSubmit&&r.handleSubmit(...e)),["prevent"]))},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("label",{class:"label"},"菜品名称"),e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":i[0]||(i[0]=e=>n.dish.name=e),class:"input",placeholder:"请输入菜品名称",required:""},null,512),[[e.vModelText,n.dish.name]])]),e.createElementVNode("view",{class:"form-item",style:{position:"relative"}},[e.createElementVNode("label",{class:"label"},[e.createTextVNode("上传实物图片 "),e.createElementVNode("text",{style:{"font-size":"20rpx",color:"rgb(170, 0, 0)"}},"(上传图片之后长按图片可以删除)")]),e.createElementVNode("view",{class:"images"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.dish.imagesList,((t,a)=>(e.openBlock(),e.createElementBlock("image",{src:t,mode:"aspectFit",key:t+a,onLongpress:e=>r.deleteItem(a)},null,40,["src","onLongpress"])))),128)),e.createVNode(l,{type:"plusempty",size:"50",onClick:r.commitAvater},null,8,["onClick"])])]),e.createElementVNode("button",{type:"submit",class:"submit-btn"},"发布菜品")],32)])])}],["__scopeId","data-v-32b308ad"]]),Dl={onLoad(e){try{e.type&&(this.type=Number(e.type))}catch{}this.id=e.id,this.goodsname=e.goodsname,this.formData.goods_id=Number(e.id),this.uploadImageback()},data:()=>({type:1,goodsname:null,id:null,activeTab:0,selectedSource:"",sourceTypes:["自家种植","合作社供货","批发市场进货","产地直采"],categories:["种植/养殖场景","进货单据","摊位实拍","商品细节","质检报告"],activeCategory:0,images:[],formData:{content:null,fromcontent:""}}),methods:{async uploadImageback(){let e=await l.getManyImages({goodsid:Number(this.id),limit:100,page:1});200==e.code&&(t("log","at subPackages/aHouseholder/Traceability/Traceability.vue:174",e.data),this.images=[...e.data])},onSourceChange(e){this.selectedSource=this.sourceTypes[e.detail.value]},saveImage:e=>new Promise(((t,a)=>{uni.uploadFile({url:"https://image.xcbdsc.com/group1/upload",name:"file",filePath:e,formData:{output:"json2"},success:e=>{t(JSON.parse(e.data))},fail:e=>{a(e),uni.showToast({title:"上传失败",icon:"error"})}})})),chooseImage(){uni.chooseImage({count:9-this.images.length,sizeType:["original","compressed"],sourceType:["album","camera"],success:e=>{const a=e.tempFilePaths.map((e=>({url:e}))).map((e=>this.saveImage(e.url)));Promise.all(a).then((async e=>{e.forEach((e=>{l.manyImages({goodsid:Number(this.id),url:e.data.url}).then((e=>{this.images.push({url:e.data.url,id:e.data.id}),t("log","at subPackages/aHouseholder/Traceability/Traceability.vue:231",this.images)}))}))}))}})},deleteImage(e){uni.showModal({title:"提示",content:"确定要删除这张图片吗？",success:t=>{t.confirm&&l.delManyImages({id:e}).then((e=>{this.uploadImageback()}))}})},async submitForm(){let e=null;1==this.type?e=l.addTraceability:(this.formData.id=this.formData.goods_id,delete this.formData.goods_id,e=l.updateDish),t("log","at subPackages/aHouseholder/Traceability/Traceability.vue:269",await e(this.formData)),uni.showLoading({title:"提交中..."}),setTimeout((()=>{uni.hideLoading(),uni.showToast({title:"提交成功，等待审核",icon:"success",duration:2e3})}),1500)}}};const Tl=W(Dl,[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"traceability-tab-page"},[e.createElementVNode("view",{class:"tab-nav"},[e.createElementVNode("view",{class:e.normalizeClass(["tab-item",{active:0===n.activeTab}]),onClick:i[0]||(i[0]=e=>n.activeTab=0)},[e.createElementVNode("text",null,"溯源信息"),0===n.activeTab?(e.openBlock(),e.createElementBlock("view",{key:0,class:"tab-indicator"})):e.createCommentVNode("",!0)],2),1==n.type?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["tab-item",{active:1===n.activeTab}]),onClick:i[1]||(i[1]=e=>n.activeTab=1)},[e.createElementVNode("text",null,"图片上传"),1===n.activeTab?(e.openBlock(),e.createElementBlock("view",{key:0,class:"tab-indicator"})):e.createCommentVNode("",!0)],2)):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"tab-content"},[0===n.activeTab?(e.openBlock(),e.createElementBlock("view",{key:0,class:"tab-panel"},[e.createElementVNode("view",{class:"intro-card"},[e.createElementVNode("view",{class:"intro-icon"}),e.createElementVNode("view",{class:"intro-content"},[e.createElementVNode("view",{class:"intro-title"},"补充溯源信息，生意更旺！"),e.createElementVNode("view",{class:"intro-points"},[e.createElementVNode("view",{class:"intro-point"},"• 买家看得到来源，买得更放心"),e.createElementVNode("view",{class:"intro-point"},"• 平台优先推荐，曝光更多"),e.createElementVNode("view",{class:"intro-point"},"• 农产品/生鲜专属标签，区别普通商品")])])]),e.createElementVNode("view",{class:"form-container"},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"item-label required"},"选中商品"),e.createElementVNode("view",{class:"item-content"},[e.createElementVNode("view",{class:"picker-view"},e.toDisplayString(n.goodsname),1)])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"item-label required"},"基础信息"),e.createElementVNode("view",{class:"item-content"},[e.withDirectives(e.createElementVNode("textarea",{placeholder:"输入产品基本信息:",maxlength:"2000",style:{padding:"10rpx","font-size":"38rpx"},"onUpdate:modelValue":i[2]||(i[2]=e=>n.formData.content=e)},null,512),[[e.vModelText,n.formData.content]])])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"item-label required"},"溯源信息描述"),e.createElementVNode("view",{class:"item-content"},[e.withDirectives(e.createElementVNode("textarea",{placeholder:"输入溯源信息：1. 生产环节:产地、种植/生产方式、周期等2.质检情况:检测标准、结果、机构等3. 物流信息:仓储条件、运输方式等4. 其他:原料来源、工艺特点等...","onUpdate:modelValue":i[3]||(i[3]=e=>n.formData.fromcontent=e),maxlength:"2000",style:{padding:"10rpx","font-size":"38rpx"}},null,512),[[e.vModelText,n.formData.fromcontent]]),e.createElementVNode("view",{class:"word-count"},e.toDisplayString(n.formData.fromcontent.length||0)+" / 2000",1),e.createElementVNode("view",{class:"info-hint"},[e.createElementVNode("text",null,"真实细节越丰富，买家信任度越高，平台推荐越多")])])])])])):e.createCommentVNode("",!0),1===n.activeTab?(e.openBlock(),e.createElementBlock("view",{key:1,class:"tab-panel"},[e.createElementVNode("view",{class:"upload-guide-card"},[e.createElementVNode("view",{class:"guide-icon"}),e.createElementVNode("view",{class:"guide-content"},[e.createElementVNode("view",{class:"guide-title"},"上传优质图片，提升溯源可信度"),e.createElementVNode("view",{class:"guide-points"},[e.createElementVNode("view",{class:"guide-point"},"• 清晰展示商品真实情况，避免模糊、歪斜"),e.createElementVNode("view",{class:"guide-point"},"• 不同场景分类上传，方便买家了解全过程"),e.createElementVNode("view",{class:"guide-point"},"• 最多可上传9张")])])]),e.createElementVNode("view",{class:"upload-container"},[e.createElementVNode("view",{class:"image-grid"},[n.images.length<9?(e.openBlock(),e.createElementBlock("view",{key:0,class:"upload-btn",onClick:i[4]||(i[4]=(...e)=>r.chooseImage&&r.chooseImage(...e))},[e.createElementVNode("text",null,"拍摄/选择")])):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.images,(t=>(e.openBlock(),e.createElementBlock("view",{class:"image-item",key:t.id},[e.createElementVNode("image",{src:t.url,mode:"aspectFill"},null,8,["src"]),e.createElementVNode("view",{class:"image-overlay"},[e.createVNode(l,{type:"clear",size:"20",color:"#fff",class:"delete-icon",onClick:e.withModifiers((e=>r.deleteImage(t.id)),["stop"])},null,8,["onClick"])])])))),128))]),e.createElementVNode("view",{class:"image-count"}," 已上传 "+e.toDisplayString(n.images.length)+" / 9 张图片 ",1)])])):e.createCommentVNode("",!0)]),0==n.activeTab?(e.openBlock(),e.createElementBlock("button",{key:0,class:"submit-btn",onClick:i[5]||(i[5]=(...e)=>r.submitForm&&r.submitForm(...e))},[e.createElementVNode("text",null,"提交溯源信息")])):e.createCommentVNode("",!0)])}],["__scopeId","data-v-9413ce3f"]]);const _l=W({data:()=>({productInfo:{},dataIsNull:!1}),mixins:[pt],onLoad(e){l.lookTraceability({commodity_id:parseInt(e.commodity_id)}).then((e=>{200==e.code?this.productInfo=e.data:this.dataIsNull=!0}))},methods:{submitFeedback(){uni.showLoading({title:"正在提交....",success:()=>{setTimeout((()=>{uni.hideLoading(),uni.showToast({icon:"success",title:"提交成功",success:()=>{setTimeout((()=>this.customizeBack()),1e3)}})}),1e3)}})}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"traceability-view-page"},[s.dataIsNull?(e.openBlock(),e.createElementBlock("view",{key:1},[e.createElementVNode("view",{style:{"font-size":"30rpx","font-weight":"bold"}},"该商品暂未上传溯源信息")])):(e.openBlock(),e.createElementBlock("view",{key:0,class:"form-container"},[e.createElementVNode("view",{class:"page-title"},"产品溯源信息查看"),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"产品:"),e.createElementVNode("view",{class:"input-field"},e.toDisplayString(s.productInfo.commodity_name),1)]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"生源地:"),e.createElementVNode("view",{class:"input-field"},e.toDisplayString(s.productInfo.baddress),1)]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"生产日期:"),e.createElementVNode("view",{class:"input-field"},e.toDisplayString(t.initDate(s.productInfo.btime)),1)]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"饲料名称:"),e.createElementVNode("view",{class:"input-field"},e.toDisplayString(s.productInfo.fodder),1)]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"饲料来源:"),e.createElementVNode("view",{class:"input-field"},e.toDisplayString(s.productInfo.fodderfrom),1)]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"饲料厂家地址:"),e.createElementVNode("view",{class:"input-field"},e.toDisplayString(s.productInfo.fodderaddress),1)]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"饲料厂家电话:"),e.createElementVNode("view",{class:"input-field"},e.toDisplayString(s.productInfo.fodderphone),1)]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"农药名称:"),e.createElementVNode("view",{class:"input-field"},e.toDisplayString(s.productInfo.pesticide),1)]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"农药来源:"),e.createElementVNode("view",{class:"input-field"},e.toDisplayString(s.productInfo.pesticidefrom),1)]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"店铺地址:"),e.createElementVNode("view",{class:"input-field"},e.toDisplayString(s.productInfo.pesticideaddress),1)]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"药店电话:"),e.createElementVNode("view",{class:"input-field"},e.toDisplayString(s.productInfo.pesticidephone),1)])]))])}]]),Pl={data:()=>({}),created(){this.popup=this.getParent()},methods:{getParent(e="uniPopup"){let t=this.$parent,a=t.$options.name;for(;a!==e;){if(t=t.$parent,!t)return!1;a=t.$options.name}return t}}},Il={en:{"uni-popup.cancel":"cancel","uni-popup.ok":"ok","uni-popup.placeholder":"pleace enter","uni-popup.title":"Hint","uni-popup.shareTitle":"Share to"},"zh-Hans":{"uni-popup.cancel":"取消","uni-popup.ok":"确定","uni-popup.placeholder":"请输入","uni-popup.title":"提示","uni-popup.shareTitle":"分享到"},"zh-Hant":{"uni-popup.cancel":"取消","uni-popup.ok":"確定","uni-popup.placeholder":"請輸入","uni-popup.title":"提示","uni-popup.shareTitle":"分享到"}},{t:Bl}=le(Il);const Al=W({name:"uniPopupDialog",mixins:[Pl],emits:["confirm","close","update:modelValue","input"],props:{inputType:{type:String,default:"text"},showClose:{type:Boolean,default:!0},modelValue:{type:[Number,String],default:""},placeholder:{type:[String,Number],default:""},type:{type:String,default:"error"},mode:{type:String,default:"base"},title:{type:String,default:""},content:{type:String,default:""},beforeClose:{type:Boolean,default:!1},cancelText:{type:String,default:""},confirmText:{type:String,default:""},maxlength:{type:Number,default:-1},focus:{type:Boolean,default:!0}},data:()=>({dialogType:"error",val:""}),computed:{okText(){return this.confirmText||Bl("uni-popup.ok")},closeText(){return this.cancelText||Bl("uni-popup.cancel")},placeholderText(){return this.placeholder||Bl("uni-popup.placeholder")},titleText(){return this.title||Bl("uni-popup.title")}},watch:{type(e){this.dialogType=e},mode(e){"input"===e&&(this.dialogType="info")},value(e){-1!=this.maxlength&&"input"===this.mode?this.val=e.slice(0,this.maxlength):this.val=e},val(e){this.$emit("update:modelValue",e)}},created(){this.popup.disableMask(),"input"===this.mode?(this.dialogType="info",this.val=this.value,this.val=this.modelValue):this.dialogType=this.type},methods:{onOk(){"input"===this.mode?this.$emit("confirm",this.val):this.$emit("confirm"),this.beforeClose||this.popup.close()},closeDialog(){this.$emit("close"),this.beforeClose||this.popup.close()},close(){this.popup.close()}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"uni-popup-dialog"},[e.createElementVNode("view",{class:"uni-dialog-title"},[e.createElementVNode("text",{class:e.normalizeClass(["uni-dialog-title-text",["uni-popup__"+s.dialogType]])},e.toDisplayString(n.titleText),3)]),"base"===i.mode?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-dialog-content"},[e.renderSlot(t.$slots,"default",{},(()=>[e.createElementVNode("text",{class:"uni-dialog-content-text"},e.toDisplayString(i.content),1)]),!0)])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"uni-dialog-content"},[e.renderSlot(t.$slots,"default",{},(()=>[e.withDirectives(e.createElementVNode("input",{class:"uni-dialog-input",maxlength:i.maxlength,"onUpdate:modelValue":a[0]||(a[0]=e=>s.val=e),type:i.inputType,placeholder:n.placeholderText,focus:i.focus},null,8,["maxlength","type","placeholder","focus"]),[[e.vModelDynamic,s.val]])]),!0)])),e.createElementVNode("view",{class:"uni-dialog-button-group"},[i.showClose?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-dialog-button",onClick:a[1]||(a[1]=(...e)=>n.closeDialog&&n.closeDialog(...e))},[e.createElementVNode("text",{class:"uni-dialog-button-text"},e.toDisplayString(n.closeText),1)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:e.normalizeClass(["uni-dialog-button",i.showClose?"uni-border-left":""]),onClick:a[2]||(a[2]=(...e)=>n.onOk&&n.onOk(...e))},[e.createElementVNode("text",{class:"uni-dialog-button-text uni-button-color"},e.toDisplayString(n.okText),1)],2)])])}],["__scopeId","data-v-dc2a088f"]]);const Ml=W({data:()=>({activeNav:0,navItems:["预卖菜品列表"],deleteId:null,vegetables:[],livestock:[],formData:{farmersgoods_id:null,page:1,limit:30}}),mixins:[pt],onShow(){this.getData()},methods:{origin(e){t("log","at subPackages/aHouseholder/PreSoldDishesList/PreSoldDishesList.vue:132",e),uni.navigateTo({url:`/subPackages/aHouseholder/Traceability/Traceability?id=${e.id}&goodsname=${e.goodsname}&type=2`})},additionalinformation(){uni.navigateTo({url:"/pages/additionalinformation/additionalinformation"})},beListed(e){let t=JSON.stringify(e);uni.navigateTo({url:"/subPackages/aHouseholder/beListed/beListed?pramas="+t})},editItem(e){let t=JSON.stringify(e);uni.navigateTo({url:"/subPackages/aHouseholder/modifyPreSoldDishes/modifyPreSoldDishes?pramas="+t})},switchNav(e){this.activeNav=e},async getData(){let e=await l.goodslist(this.formData);200==e.code&&(this.vegetables=e.data.listdata)},getStatusStyle:e=>({"生长中":{background:"#E8F5E9",color:"#4CAF50"},"已采收":{background:"#F5F5F5",color:"#9E9E9E"}}[e]||{}),showDeleteConfirm(e){this.deleteId=e,this.$refs.deletePopup.open()},confirmDelete(){l.delDishes({id:this.deleteId}).then((e=>{t("log","at subPackages/aHouseholder/PreSoldDishesList/PreSoldDishesList.vue:185",e),200==e.code&&(this.getData(),uni.showToast({title:e.message,icon:"success"}))})),this.$refs.deletePopup.close()},cancelDelete(){this.deleteId=null,this.$refs.deletePopup.close()}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K),c=a(e.resolveDynamicComponent("uni-popup-dialog"),Al),d=a(e.resolveDynamicComponent("uni-popup"),Ya);return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("scroll-view",{class:"list-container","scroll-y":""},[0===n.activeNav?(e.openBlock(),e.createElementBlock("view",{key:0,class:"product-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.vegetables,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:t.id,class:"product-card veg-card"},[e.createElementVNode("image",{src:t.imglogo,class:"product-image",mode:"aspectFill"},null,8,["src"]),e.createElementVNode("view",{class:"product-info"},[e.createElementVNode("view",{class:"info-header"},[e.createElementVNode("text",{class:"product-name"},e.toDisplayString(t.goodsname),1)]),n.formData.id?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"action-bar",style:{"text-align":"center"}},[e.createElementVNode("view",null,[e.createElementVNode("button",{class:"delete-btn",onClick:e=>r.showDeleteConfirm(t.id)},[e.createVNode(l,{type:"trash",size:"18",color:"#fff"})],8,["onClick"]),e.createTextVNode(" 删除 ")]),e.createElementVNode("view",null,[e.createElementVNode("button",{class:"delete-btn",onClick:e=>r.beListed(t),style:{"background-color":"#32ff13"}},[e.createVNode(l,{type:"upload",size:"18",color:"#fff"})],8,["onClick"]),e.createTextVNode(" 上市 ")]),e.createElementVNode("view",null,[e.createElementVNode("button",{class:"delete-btn",onClick:e=>r.additionalinformation(t),style:{"background-color":"#57fffa"}},[e.createVNode(l,{type:"staff",size:"18",color:"#fff"})],8,["onClick"]),e.createTextVNode(" 朋友圈 ")]),e.createElementVNode("view",null,[e.createElementVNode("button",{class:"delete-btn",onClick:e=>r.origin(t),style:{"background-color":"#aaaa00"}},[e.createVNode(l,{type:"staff",size:"18",color:"#fff"})],8,["onClick"]),e.createTextVNode(" 溯源 ")]),e.createElementVNode("view",null,[e.createElementVNode("button",{class:"delete-btn",onClick:e=>r.editItem(t),style:{"background-color":"#ffe4de"}},[e.createVNode(l,{type:"staff",size:"18",color:"#fff"})],8,["onClick"]),e.createTextVNode(" 编辑 ")])]))])])))),128))])):e.createCommentVNode("",!0),1===n.activeNav?(e.openBlock(),e.createElementBlock("view",{key:1,class:"product-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.livestock,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:t.id,class:"product-card animal-card"})))),128))])):e.createCommentVNode("",!0)]),n.vegetables.length<=0?(e.openBlock(),e.createElementBlock("view",{key:0,style:{"text-align":"center","font-size":"40rpx","font-weight":"bold","margin-top":"100px"}},"暂无菜品")):e.createCommentVNode("",!0),e.createVNode(d,{ref:"deletePopup",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(c,{mode:"base",title:"确认删除",content:"确定要删除这个预卖菜品？",onConfirm:r.confirmDelete,onCancel:r.cancelDelete},null,8,["onConfirm","onCancel"])])),_:1},512)])}],["__scopeId","data-v-cdc99ebd"]]),Ll={data:()=>({formData:{},pickerRange:[],selectedCategoryIndex:0,currentItem:{}}),mixins:[pt],methods:{uploadcuisine(){uni.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:e=>{const a=e.tempFilePaths;if(a.length>0){t("log","at subPackages/aHouseholder/modifyPreSoldDishes/modifyPreSoldDishes.vue:69",66676,e.tempFiles[0]);const{upload:i,request:o}=Ae({uploadPath:"/group1/upload",tempFilePaths:a[0],file:e.tempFiles[0]});i().then((e=>{e=JSON.parse(e),this.currentItem.imglogo=e.data.url}))}}})},onCategoryChange(e){this.selectedCategoryIndex=e.detail.value,this.currentItem.category_id=this.categories[this.selectedCategoryIndex].id},fetchCategories(){l.cglist().then((e=>{if(200===e.code){const a=e.data.listdata.map((e=>({id:e.id,content:e.content})));this.categories=a,this.pickerRange=[...a.map((e=>e.content))],t("log","at subPackages/aHouseholder/modifyPreSoldDishes/modifyPreSoldDishes.vue:117",this.pickerRange)}}))},submit(){t("log","at subPackages/aHouseholder/modifyPreSoldDishes/modifyPreSoldDishes.vue:122",this.currentItem),uni.showToast({icon:"loading",title:"正在修改...."}),setTimeout((()=>{l.updateDish({id:this.currentItem.id,goodsname:this.currentItem.goodsname,imglogo:this.currentItem.imglogo,category_id:this.currentItem.category_id}).then((e=>{200==e.code&&this.customizeBack()}))}),2e3)}},onLoad({pramas:e}){e&&(this.currentItem=JSON.parse(e)),this.fetchCategories(),this.selectedCategoryIndex=this.currentItem.category_id-1}};const Ol=W(Ll,[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"form-container"},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"item-header"},[e.createElementVNode("text",{class:"label"},"菜名")]),e.createElementVNode("view",{class:"input-group"},[e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>s.currentItem.goodsname=e),placeholder:"输入名称",class:"price-input"},null,512),[[e.vModelText,s.currentItem.goodsname]])])]),e.createElementVNode("view",{class:"form-item",style:{display:"flex","justify-content":"space-between",width:"130px"}},[e.createElementVNode("view",{class:"item-header"},[e.createElementVNode("text",{class:"label"},"分类")]),e.createElementVNode("picker",{class:"picker",range:s.pickerRange,value:s.selectedCategoryIndex,onChange:a[1]||(a[1]=(...e)=>n.onCategoryChange&&n.onCategoryChange(...e))},[e.createElementVNode("view",{style:{"font-size":"40rpx"}},e.toDisplayString(s.pickerRange[s.selectedCategoryIndex]),1)],40,["range","value"])]),e.createElementVNode("view",{class:"form-item",style:{display:"flex","justify-content":"space-between",width:"600rpx"}},[e.createElementVNode("view",{class:"item-header"},[e.createElementVNode("text",{class:"label"},"图片")]),e.createElementVNode("image",{class:"cimg",src:s.currentItem.imglogo,mode:"aspectFit",onClick:a[2]||(a[2]=(...e)=>n.uploadcuisine&&n.uploadcuisine(...e))},null,8,["src"])])]),e.createElementVNode("view",{class:"submit-container"},[e.createElementVNode("button",{class:"submit-btn",onClick:a[3]||(a[3]=(...e)=>n.submit&&n.submit(...e))},"保存修改")])])}]]),Fl={name:"one",mounted(){this.initializePicker(),this.fetchMarkets()},data:()=>({multiArray:[[],[],[]],multiIndex:[0,0,0],provinceList:[],cityList:[],districtList:[],marketList:[],marketIdMap:{},selectedMarketIndex:0,area_id:null,market_id:null,isSubmitting:!1,formData:{sellstatus:1,farmersgoods_id:null,market_id:null,area_id:null,unit:null,ispresale:2,sellbegintime:null,sellendtime:null,presaleprice:null,price:null,goodstotal:null,contactpeople:null,contactphone:null,pickaddress:null}}),methods:{submit(){this.$emit("open","自销")},async initializePicker(){try{const e=await this.fetchProvinces();this.multiArray[0]=e.map((e=>e.name));const t=await this.fetchCities(e[0].id);this.multiArray[1]=t.map((e=>e.name));const a=await this.fetchAreas(t[0].id);this.multiArray[2]=a.map((e=>e.name)),this.multiIndex=[0,0,0]}catch(e){t("error","at subPackages/aHouseholder/beListed/componment/one.vue:201","Failed to initialize picker:",e)}},async fetchProvinces(){try{const e=await l.citylist({level:1,limit:100});if(200===e.code)return this.provinceList=e.data.listdata,this.provinceList;throw new Error("Failed to fetch provinces")}catch(e){throw t("error","at subPackages/aHouseholder/beListed/componment/one.vue:217","Failed to fetch provinces:",e),e}},async fetchCities(e){try{const a=await l.citytree(e);return 200===a.code&&Array.isArray(a.data)?a.data:(t("error","at subPackages/aHouseholder/beListed/componment/one.vue:229","No cities data found"),[])}catch(a){return t("error","at subPackages/aHouseholder/beListed/componment/one.vue:233","Failed to fetch cities:",a),[]}},async fetchAreas(e){try{const a=await l.citytree(e);return 200===a.code&&Array.isArray(a.data)?a.data:(t("error","at subPackages/aHouseholder/beListed/componment/one.vue:245","No areas data found"),[])}catch(a){return t("error","at subPackages/aHouseholder/beListed/componment/one.vue:249","Failed to fetch areas:",a),[]}},bindMultiPickerChange(e){this.multiIndex=e.detail.value;const a=this.multiArray[0][this.multiIndex[0]],i=this.multiArray[1][this.multiIndex[1]],o=this.multiArray[2][this.multiIndex[2]],s=this.districtList[this.multiIndex[2]].id;t("log","at subPackages/aHouseholder/beListed/componment/one.vue:259","选择的省市区:",a,i,o),this.area_id=s,this.fetchMarkets(s)},async bindMultiPickerColumnChange(e){const t=e.detail.column,a=e.detail.value;if(this.multiIndex[t]=a,0===t){const e=this.provinceList[a].id,t=await this.fetchCities(e);this.cityList=t,this.multiArray[1]=t.map((e=>e.name)),this.multiArray[2]=t?t[0].Children.map((e=>e.name)):[],this.multiIndex[1]=0,this.multiIndex[2]=0}else if(1===t){const e=this.cityList[a].id,t=await this.fetchAreas(e);this.districtList=t,this.multiArray[2]=t.map((e=>e.name)),this.multiIndex[2]=0}this.multiIndex=[...this.multiIndex]},async fetchMarkets(e){try{const a=100,i=await l.marketlist(e,a);200===i.code?(this.marketData=i.data.listdata,this.marketList=i.data.listdata.map((e=>e.marketname)),this.marketIdMap=this.marketData.reduce(((e,t)=>(e[t.marketname]=t.id,e)),{})):t("error","at subPackages/aHouseholder/beListed/componment/one.vue:302","Failed to fetch markets:",i.message)}catch(a){t("error","at subPackages/aHouseholder/beListed/componment/one.vue:305","Failed to fetch markets:",a)}},bindMarketChange(e){this.selectedMarketIndex=e.detail.value;const t=this.marketList[this.selectedMarketIndex];this.market_id=this.marketIdMap[t]||null}}};const Rl=W(Fl,[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K),c=a(e.resolveDynamicComponent("uni-datetime-picker"),Ot);return e.openBlock(),e.createElementBlock("view",{class:"me-container"},[e.createElementVNode("view",{class:"form-card"},[e.createElementVNode("view",{class:"section-title"},[e.createElementVNode("text",{class:"title-icon"},"｜"),e.createElementVNode("text",{class:"title-text"},"选择菜市场")]),e.createElementVNode("view",{class:"form-item picker-item compact"},[e.createElementVNode("view",{class:"item-label"},[e.createElementVNode("text",null,"所在地区")]),e.createElementVNode("picker",{mode:"multiSelector",range:n.multiArray,value:n.multiIndex,onChange:i[0]||(i[0]=(...e)=>r.bindMultiPickerChange&&r.bindMultiPickerChange(...e)),onColumnchange:i[1]||(i[1]=(...e)=>r.bindMultiPickerColumnChange&&r.bindMultiPickerColumnChange(...e))},[e.createElementVNode("view",{class:"compact-picker"},[e.createElementVNode("view",null,[e.createElementVNode("text",{class:"province"},e.toDisplayString(n.multiArray[0][n.multiIndex[0]]||"省"),1),e.createElementVNode("text",{class:"separator"},"/"),e.createElementVNode("text",{class:"city"},e.toDisplayString(n.multiArray[1][n.multiIndex[1]]||"市"),1),e.createElementVNode("text",{class:"separator"},"/"),e.createElementVNode("text",{class:"district"},e.toDisplayString(n.multiArray[2][n.multiIndex[2]]||"区"),1)]),e.createElementVNode("view",null,[e.createVNode(l,{type:"arrowright",size:"18",color:"#999"})])])],40,["range","value"])]),e.createElementVNode("view",{class:"form-item picker-item"},[e.createElementVNode("view",{class:"item-label"},[e.createElementVNode("text",null,"菜市场")]),e.createElementVNode("picker",{mode:"selector",range:n.marketList,value:n.selectedMarketIndex,onChange:i[2]||(i[2]=(...e)=>r.bindMarketChange&&r.bindMarketChange(...e))},[e.createElementVNode("view",{class:"picker-content"},[e.createElementVNode("text",{class:"picker-text"},e.toDisplayString(n.marketList[n.selectedMarketIndex]||"请选择菜市场"),1),e.createVNode(l,{type:"arrowright",size:"18",color:"#999"})])],40,["range","value"])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"item-label"},[e.createElementVNode("text",null,"附近提取点")]),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":i[3]||(i[3]=e=>n.formData.pickaddress=e),type:"text",placeholder:"请输入该菜市场五公里范围内提货点","placeholder-style":"color: #c0c4cc"},null,512),[[e.vModelText,n.formData.pickaddress]])])]),e.createElementVNode("view",{class:"form-card"},[e.createElementVNode("view",{class:"section-title"},[e.createElementVNode("text",{class:"title-icon"},"｜"),e.createElementVNode("text",{class:"title-text"},"预卖信息")]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"item-label"},[e.createElementVNode("text",null,"预卖价&市场价")]),e.createElementVNode("view",{style:{display:"flex"}},[e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":i[4]||(i[4]=e=>n.formData.price=e),placeholder:"请输入预卖价","placeholder-style":"color: #c0c4cc"},null,512),[[e.vModelText,n.formData.price,void 0,{number:!0}]]),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":i[5]||(i[5]=e=>n.formData.presaleprice=e),type:"number",placeholder:"请输入市场价","placeholder-style":"color: #c0c4cc"},null,512),[[e.vModelText,n.formData.presaleprice,void 0,{number:!0}]])])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"item-label"},[e.createElementVNode("text",null,"库存&单位")]),e.createElementVNode("view",{style:{display:"flex","justify-content":"space-around"}},[e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":i[6]||(i[6]=e=>n.formData.goodstotal=e),type:"number",placeholder:"请输入库存","placeholder-style":"color: #c0c4cc "},null,512),[[e.vModelText,n.formData.goodstotal,void 0,{number:!0}]]),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":i[7]||(i[7]=e=>n.formData.unit=e),type:"text",placeholder:"请输入单位","placeholder-style":"color: #c0c4cc"},null,512),[[e.vModelText,n.formData.unit]])])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"item-label"},[e.createElementVNode("text",null,"上市开始时间")]),e.createVNode(c,{type:"date",modelValue:n.formData.sellbegintime,"onUpdate:modelValue":i[8]||(i[8]=e=>n.formData.sellbegintime=e),"return-type":"timestamp"},null,8,["modelValue"])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"item-label"},[e.createElementVNode("text",null,"上市结束时间")]),e.createVNode(c,{type:"date","return-type":"timestamp",modelValue:n.formData.sellendtime,"onUpdate:modelValue":i[9]||(i[9]=e=>n.formData.sellendtime=e)},null,8,["modelValue"])])]),e.createElementVNode("view",{class:"form-card"},[e.createElementVNode("view",{class:"section-title"},[e.createElementVNode("text",{class:"title-icon"},"｜"),e.createElementVNode("text",{class:"title-text"},"卖家信息")]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"item-label"},[e.createElementVNode("text",null,"联系人")]),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":i[10]||(i[10]=e=>n.formData.contactpeople=e),type:"text",placeholder:"请输入联系人","placeholder-style":"color: #c0c4cc"},null,512),[[e.vModelText,n.formData.contactpeople]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"item-label"},[e.createElementVNode("text",null,"联系电话")]),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":i[11]||(i[11]=e=>n.formData.contactphone=e),type:"number",placeholder:"请输入联系电话","placeholder-style":"color: #c0c4cc"},null,512),[[e.vModelText,n.formData.contactphone]])])]),e.createElementVNode("view",{class:"submit-wrapper"},[e.createElementVNode("button",{class:e.normalizeClass(["submit-btn",{disabled:n.isSubmitting}]),onClick:i[12]||(i[12]=(...e)=>r.submit&&r.submit(...e))},[e.createTextVNode(e.toDisplayString(n.isSubmitting?"提交中...":"立即提交")+" ",1),n.isSubmitting?(e.openBlock(),e.createElementBlock("text",{key:0,class:"loading-icon"},"◌")):e.createCommentVNode("",!0)],2)])])}],["__scopeId","data-v-4dae9b5c"]]),zl={name:"two",data:()=>({multiArray:[[],[],[]],multiIndex:[0,0,0],categoryList:["请选择分类"],categoryIdMap:{},selectedCategory:"请选择分类",provinceList:[],cityList:[],districtList:[],marketList:[],marketIdMap:{},selectedMarketIndex:0,area_id:null,market_id:null,isSubmitting:!1,formData:{sellstatus:2,farmersgoods_id:null,market_id:null,area_id:null,unit:null,ispresale:2,sellbegintime:null,sellendtime:null,presaleprice:null,price:null,goodstotal:null,contactpeople:null,contactphone:null,pickaddress:null}}),mounted(){this.initializePicker(),this.fetchCategories(),this.fetchMarkets()},methods:{submit(){this.$emit("open","代销")},async initializePicker(){try{const e=await this.fetchProvinces();this.multiArray[0]=e.map((e=>e.name));const t=await this.fetchCities(e[0].id);this.multiArray[1]=t.map((e=>e.name));const a=await this.fetchAreas(t[0].id);this.multiArray[2]=a.map((e=>e.name)),this.multiIndex=[0,0,0]}catch(e){t("error","at subPackages/aHouseholder/beListed/componment/two.vue:196","Failed to initialize picker:",e)}},async fetchProvinces(){try{const e=await l.citylist({level:1,limit:100});if(200===e.code)return this.provinceList=e.data.listdata,this.provinceList;throw new Error("Failed to fetch provinces")}catch(e){throw t("error","at subPackages/aHouseholder/beListed/componment/two.vue:212","Failed to fetch provinces:",e),e}},async fetchCities(e){try{const a=await l.citytree(e);return 200===a.code&&Array.isArray(a.data)?a.data:(t("error","at subPackages/aHouseholder/beListed/componment/two.vue:224","No cities data found"),[])}catch(a){return t("error","at subPackages/aHouseholder/beListed/componment/two.vue:228","Failed to fetch cities:",a),[]}},async fetchAreas(e){try{const a=await l.citytree(e);return 200===a.code&&Array.isArray(a.data)?a.data:(t("error","at subPackages/aHouseholder/beListed/componment/two.vue:240","No areas data found"),[])}catch(a){return t("error","at subPackages/aHouseholder/beListed/componment/two.vue:244","Failed to fetch areas:",a),[]}},bindMultiPickerChange(e){this.multiIndex=e.detail.value;const a=this.multiArray[0][this.multiIndex[0]],i=this.multiArray[1][this.multiIndex[1]],o=this.multiArray[2][this.multiIndex[2]],s=this.districtList[this.multiIndex[2]].id;t("log","at subPackages/aHouseholder/beListed/componment/two.vue:254","选择的省市区:",a,i,o),this.area_id=s,this.fetchMarkets(s)},async bindMultiPickerColumnChange(e){const t=e.detail.column,a=e.detail.value;if(this.multiIndex[t]=a,0===t){const e=this.provinceList[a].id,t=await this.fetchCities(e);this.cityList=t,this.multiArray[1]=t.map((e=>e.name)),this.multiArray[2]=t?t[0].Children.map((e=>e.name)):[],this.multiIndex[1]=0,this.multiIndex[2]=0}else if(1===t){const e=this.cityList[a].id,t=await this.fetchAreas(e);this.districtList=t,this.multiArray[2]=t.map((e=>e.name)),this.multiIndex[2]=0}this.multiIndex=[...this.multiIndex]},async fetchMarkets(e){try{const a=100,i=await l.marketlist(e,a);200===i.code?(this.marketData=i.data.listdata,this.marketList=i.data.listdata.map((e=>e.marketname)),this.marketIdMap=this.marketData.reduce(((e,t)=>(e[t.marketname]=t.id,e)),{})):t("error","at subPackages/aHouseholder/beListed/componment/two.vue:297","Failed to fetch markets:",i.message)}catch(a){t("error","at subPackages/aHouseholder/beListed/componment/two.vue:300","Failed to fetch markets:",a)}},bindMarketChange(e){this.selectedMarketIndex=e.detail.value;const t=this.marketList[this.selectedMarketIndex];this.market_id=this.marketIdMap[t]||null},async fetchCategories(){try{const e=await l.cglist();if(200!==e.code)throw new Error("Failed to fetch categories");{const t=e.data.listdata;this.categoryList=["请选择分类",...t.map((e=>e.title))],this.categoryIdMap=t.reduce(((e,t)=>(e[t.title]=t.id,e)),{})}}catch(e){t("error","at subPackages/aHouseholder/beListed/componment/two.vue:324","Failed to fetch categories:",e)}}}};const $l=W(zl,[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K),c=a(e.resolveDynamicComponent("uni-datetime-picker"),Ot);return e.openBlock(),e.createElementBlock("view",{class:"me-container"},[e.createElementVNode("view",{class:"form-card"},[e.createElementVNode("view",{class:"section-title"},[e.createElementVNode("text",{class:"title-icon"},"｜"),e.createElementVNode("text",{class:"title-text"},"选择菜市场")]),e.createElementVNode("view",{class:"form-item picker-item compact"},[e.createElementVNode("view",{class:"item-label"},[e.createElementVNode("text",null,"所在地区")]),e.createElementVNode("picker",{mode:"multiSelector",range:n.multiArray,value:n.multiIndex,onChange:i[0]||(i[0]=(...e)=>r.bindMultiPickerChange&&r.bindMultiPickerChange(...e)),onColumnchange:i[1]||(i[1]=(...e)=>r.bindMultiPickerColumnChange&&r.bindMultiPickerColumnChange(...e))},[e.createElementVNode("view",{class:"compact-picker"},[e.createElementVNode("view",null,[e.createElementVNode("text",{class:"province"},e.toDisplayString(n.multiArray[0][n.multiIndex[0]]||"省"),1),e.createElementVNode("text",{class:"separator"},"/"),e.createElementVNode("text",{class:"city"},e.toDisplayString(n.multiArray[1][n.multiIndex[1]]||"市"),1),e.createElementVNode("text",{class:"separator"},"/"),e.createElementVNode("text",{class:"district"},e.toDisplayString(n.multiArray[2][n.multiIndex[2]]||"区"),1)]),e.createElementVNode("view",null,[e.createVNode(l,{type:"arrowright",size:"18",color:"#999"})])])],40,["range","value"])]),e.createElementVNode("view",{class:"form-item picker-item"},[e.createElementVNode("view",{class:"item-label"},[e.createElementVNode("text",null,"菜市场")]),e.createElementVNode("picker",{mode:"selector",range:n.marketList,value:n.selectedMarketIndex,onChange:i[2]||(i[2]=(...e)=>r.bindMarketChange&&r.bindMarketChange(...e))},[e.createElementVNode("view",{class:"picker-content"},[e.createElementVNode("text",{class:"picker-text"},e.toDisplayString(n.marketList[n.selectedMarketIndex]||"请选择菜市场"),1),e.createVNode(l,{type:"arrowright",size:"18",color:"#999"})])],40,["range","value"])])]),e.createElementVNode("view",{class:"form-card"},[e.createElementVNode("view",{class:"section-title"},[e.createElementVNode("text",{class:"title-icon"},"｜"),e.createElementVNode("text",{class:"title-text"},"预卖信息")]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"item-label"},[e.createElementVNode("text",null,"预卖价&市场价")]),e.createElementVNode("view",{style:{display:"flex"}},[e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":i[3]||(i[3]=e=>t.contactpeople=e),placeholder:"请输入预卖价","placeholder-style":"color: #c0c4cc"},null,512),[[e.vModelText,t.contactpeople]]),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":i[4]||(i[4]=e=>t.contactphone=e),type:"number",placeholder:"请输入市场价","placeholder-style":"color: #c0c4cc"},null,512),[[e.vModelText,t.contactphone]])])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"item-label"},[e.createElementVNode("text",null,"库存&单位")]),e.createElementVNode("view",{style:{display:"flex","justify-content":"space-around"}},[e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":i[5]||(i[5]=e=>t.contactphone=e),type:"number",placeholder:"请输入库存","placeholder-style":"color: #c0c4cc "},null,512),[[e.vModelText,t.contactphone]]),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":i[6]||(i[6]=e=>t.contactphone=e),type:"number",placeholder:"请输入单位","placeholder-style":"color: #c0c4cc"},null,512),[[e.vModelText,t.contactphone]])])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"item-label"},[e.createElementVNode("text",null,"上市开始时间")]),e.createVNode(c,{type:"date",onChange:t.change},null,8,["onChange"])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"item-label"},[e.createElementVNode("text",null,"上市结束时间")]),e.createVNode(c,{type:"date",onChange:t.change},null,8,["onChange"])])]),e.createElementVNode("view",{class:"form-card"},[e.createElementVNode("view",{class:"section-title"},[e.createElementVNode("text",{class:"title-icon"},"｜"),e.createElementVNode("text",{class:"title-text"},"卖家信息")]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"item-label"},[e.createElementVNode("text",null,"联系人")]),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":i[7]||(i[7]=e=>t.contactphone=e),type:"number",placeholder:"请输入联系人","placeholder-style":"color: #c0c4cc"},null,512),[[e.vModelText,t.contactphone]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"item-label"},[e.createElementVNode("text",null,"联系电话")]),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":i[8]||(i[8]=e=>t.contactphone=e),type:"number",placeholder:"请输入联系电话","placeholder-style":"color: #c0c4cc"},null,512),[[e.vModelText,t.contactphone]])])]),e.createElementVNode("view",{class:"submit-wrapper"},[e.createElementVNode("button",{class:e.normalizeClass(["submit-btn",{disabled:n.isSubmitting}]),onClick:i[9]||(i[9]=(...e)=>r.submit&&r.submit(...e))},[e.createTextVNode(e.toDisplayString(n.isSubmitting?"提交中...":"立即提交")+" ",1),n.isSubmitting?(e.openBlock(),e.createElementBlock("text",{key:0,class:"loading-icon"},"◌")):e.createCommentVNode("",!0)],2)])])}],["__scopeId","data-v-0b2fd5a1"]]),jl={name:"three",data:()=>({multiArray:[[],[],[]],multiIndex:[0,0,0],categoryList:["请选择分类"],categoryIdMap:{},selectedCategory:"请选择分类",provinceList:[],cityList:[],districtList:[],marketList:[],marketIdMap:{},selectedMarketIndex:0,area_id:null,market_id:null,isSubmitting:!1,formData:{sellstatus:3,farmersgoods_id:null,market_id:null,area_id:null,unit:null,ispresale:2,sellbegintime:null,sellendtime:null,presaleprice:null,price:null,goodstotal:null,contactpeople:null,contactphone:null,pickaddress:null}}),mounted(){this.initializePicker(),this.fetchCategories(),this.fetchMarkets()},methods:{submit(){this.$emit("open","自销")},async initializePicker(){try{const e=await this.fetchProvinces();this.multiArray[0]=e.map((e=>e.name));const t=await this.fetchCities(e[0].id);this.multiArray[1]=t.map((e=>e.name));const a=await this.fetchAreas(t[0].id);this.multiArray[2]=a.map((e=>e.name)),this.multiIndex=[0,0,0]}catch(e){t("error","at subPackages/aHouseholder/beListed/componment/three.vue:200","Failed to initialize picker:",e)}},async fetchProvinces(){try{const e=await l.citylist({level:1,limit:100});if(200===e.code)return this.provinceList=e.data.listdata,this.provinceList;throw new Error("Failed to fetch provinces")}catch(e){throw t("error","at subPackages/aHouseholder/beListed/componment/three.vue:216","Failed to fetch provinces:",e),e}},async fetchCities(e){try{const a=await l.citytree(e);return 200===a.code&&Array.isArray(a.data)?a.data:(t("error","at subPackages/aHouseholder/beListed/componment/three.vue:228","No cities data found"),[])}catch(a){return t("error","at subPackages/aHouseholder/beListed/componment/three.vue:232","Failed to fetch cities:",a),[]}},async fetchAreas(e){try{const a=await l.citytree(e);return 200===a.code&&Array.isArray(a.data)?a.data:(t("error","at subPackages/aHouseholder/beListed/componment/three.vue:244","No areas data found"),[])}catch(a){return t("error","at subPackages/aHouseholder/beListed/componment/three.vue:248","Failed to fetch areas:",a),[]}},bindMultiPickerChange(e){this.multiIndex=e.detail.value;const a=this.multiArray[0][this.multiIndex[0]],i=this.multiArray[1][this.multiIndex[1]],o=this.multiArray[2][this.multiIndex[2]],s=this.districtList[this.multiIndex[2]].id;t("log","at subPackages/aHouseholder/beListed/componment/three.vue:258","选择的省市区:",a,i,o),this.area_id=s,this.fetchMarkets(s)},async bindMultiPickerColumnChange(e){const t=e.detail.column,a=e.detail.value;if(this.multiIndex[t]=a,0===t){const e=this.provinceList[a].id,t=await this.fetchCities(e);this.cityList=t,this.multiArray[1]=t.map((e=>e.name)),this.multiArray[2]=t?t[0].Children.map((e=>e.name)):[],this.multiIndex[1]=0,this.multiIndex[2]=0}else if(1===t){const e=this.cityList[a].id,t=await this.fetchAreas(e);this.districtList=t,this.multiArray[2]=t.map((e=>e.name)),this.multiIndex[2]=0}this.multiIndex=[...this.multiIndex]},async fetchMarkets(e){try{const a=100,i=await l.marketlist(e,a);200===i.code?(this.marketData=i.data.listdata,this.marketList=i.data.listdata.map((e=>e.marketname)),this.marketIdMap=this.marketData.reduce(((e,t)=>(e[t.marketname]=t.id,e)),{})):t("error","at subPackages/aHouseholder/beListed/componment/three.vue:301","Failed to fetch markets:",i.message)}catch(a){t("error","at subPackages/aHouseholder/beListed/componment/three.vue:304","Failed to fetch markets:",a)}},bindMarketChange(e){this.selectedMarketIndex=e.detail.value;const t=this.marketList[this.selectedMarketIndex];this.market_id=this.marketIdMap[t]||null},async fetchCategories(){try{const e=await l.cglist();if(200!==e.code)throw new Error("Failed to fetch categories");{const t=e.data.listdata;this.categoryList=["请选择分类",...t.map((e=>e.title))],this.categoryIdMap=t.reduce(((e,t)=>(e[t.title]=t.id,e)),{})}}catch(e){t("error","at subPackages/aHouseholder/beListed/componment/three.vue:328","Failed to fetch categories:",e)}},bindCategoryChange(e){const t=e.detail.value;this.selectedCategory=this.categoryList[t],this.category_id=this.categoryIdMap[this.selectedCategory]}}};const Ul=W({mixins:[pt],components:{oneVue:Rl,twoVue:$l,threeVue:W(jl,[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K),c=a(e.resolveDynamicComponent("uni-datetime-picker"),Ot);return e.openBlock(),e.createElementBlock("view",{class:"me-container"},[e.createElementVNode("view",{class:"form-card"},[e.createElementVNode("view",{class:"section-title"},[e.createElementVNode("text",{class:"title-icon"},"｜"),e.createElementVNode("text",{class:"title-text"},"选择菜市场")]),e.createElementVNode("view",{class:"form-item picker-item compact"},[e.createElementVNode("view",{class:"item-label"},[e.createElementVNode("text",null,"所在地区")]),e.createElementVNode("picker",{mode:"multiSelector",range:n.multiArray,value:n.multiIndex,onChange:i[0]||(i[0]=(...e)=>r.bindMultiPickerChange&&r.bindMultiPickerChange(...e)),onColumnchange:i[1]||(i[1]=(...e)=>r.bindMultiPickerColumnChange&&r.bindMultiPickerColumnChange(...e))},[e.createElementVNode("view",{class:"compact-picker"},[e.createElementVNode("view",null,[e.createElementVNode("text",{class:"province"},e.toDisplayString(n.multiArray[0][n.multiIndex[0]]||"省"),1),e.createElementVNode("text",{class:"separator"},"/"),e.createElementVNode("text",{class:"city"},e.toDisplayString(n.multiArray[1][n.multiIndex[1]]||"市"),1),e.createElementVNode("text",{class:"separator"},"/"),e.createElementVNode("text",{class:"district"},e.toDisplayString(n.multiArray[2][n.multiIndex[2]]||"区"),1)]),e.createElementVNode("view",null,[e.createVNode(l,{type:"arrowright",size:"18",color:"#999"})])])],40,["range","value"])]),e.createElementVNode("view",{class:"form-item picker-item"},[e.createElementVNode("view",{class:"item-label"},[e.createElementVNode("text",null,"菜市场")]),e.createElementVNode("picker",{mode:"selector",range:n.marketList,value:n.selectedMarketIndex,onChange:i[2]||(i[2]=(...e)=>r.bindMarketChange&&r.bindMarketChange(...e))},[e.createElementVNode("view",{class:"picker-content"},[e.createElementVNode("text",{class:"picker-text"},e.toDisplayString(n.marketList[n.selectedMarketIndex]||"请选择菜市场"),1),e.createVNode(l,{type:"arrowright",size:"18",color:"#999"})])],40,["range","value"])])]),e.createElementVNode("view",{class:"form-card"},[e.createElementVNode("view",{class:"section-title"},[e.createElementVNode("text",{class:"title-icon"},"｜"),e.createElementVNode("text",{class:"title-text"},"商品信息")]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"item-label"},[e.createElementVNode("text",null,"联系人")]),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":i[3]||(i[3]=e=>t.contactphone=e),type:"number",placeholder:"请输入联系人","placeholder-style":"color: #c0c4cc"},null,512),[[e.vModelText,t.contactphone]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"item-label"},[e.createElementVNode("text",null,"联系电话")]),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":i[4]||(i[4]=e=>t.contactphone=e),type:"number",placeholder:"请输入联系电话","placeholder-style":"color: #c0c4cc"},null,512),[[e.vModelText,t.contactphone]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"item-label"},[e.createElementVNode("text",null,"预卖价")]),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":i[5]||(i[5]=e=>t.contactpeople=e),placeholder:"请输入预卖价","placeholder-style":"color: #c0c4cc"},null,512),[[e.vModelText,t.contactpeople]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"item-label"},[e.createElementVNode("text",null,"市场价")]),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":i[6]||(i[6]=e=>t.contactphone=e),type:"number",placeholder:"请输入市场价","placeholder-style":"color: #c0c4cc"},null,512),[[e.vModelText,t.contactphone]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"item-label"},[e.createElementVNode("text",null,"库存")]),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":i[7]||(i[7]=e=>t.contactphone=e),type:"number",placeholder:"请输入库存","placeholder-style":"color: #c0c4cc"},null,512),[[e.vModelText,t.contactphone]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"item-label"},[e.createElementVNode("text",null,"单位")]),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":i[8]||(i[8]=e=>t.contactphone=e),type:"number",placeholder:"请输入单位","placeholder-style":"color: #c0c4cc"},null,512),[[e.vModelText,t.contactphone]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"item-label"},[e.createElementVNode("text",null,"提货点")]),e.withDirectives(e.createElementVNode("input",{class:"form-input","onUpdate:modelValue":i[9]||(i[9]=e=>t.contactphone=e),type:"number",placeholder:"请输入提货点","placeholder-style":"color: #c0c4cc"},null,512),[[e.vModelText,t.contactphone]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"item-label"},[e.createElementVNode("text",null,"上市开始时间")]),e.createVNode(c,{type:"date",onChange:t.change},null,8,["onChange"])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"item-label"},[e.createElementVNode("text",null,"上市结束时间")]),e.createVNode(c,{type:"date",onChange:t.change},null,8,["onChange"])])]),e.createElementVNode("view",{class:"submit-wrapper"},[e.createElementVNode("button",{class:e.normalizeClass(["submit-btn",{disabled:n.isSubmitting}]),onClick:i[10]||(i[10]=(...e)=>r.submit&&r.submit(...e))},[e.createTextVNode(e.toDisplayString(n.isSubmitting?"提交中...":"立即提交")+" ",1),n.isSubmitting?(e.openBlock(),e.createElementBlock("text",{key:0,class:"loading-icon"},"◌")):e.createCommentVNode("",!0)],2)])])}],["__scopeId","data-v-d8535286"]]),describeVue:W({props:{show:Boolean,title:{type:String,default:"说明"},content:String,steps:Array,agreement:String,cancelText:{type:String,default:"不同意"},confirmText:{type:String,default:"同意"},cancelColor:{type:String,default:"#666"},confirmColor:{type:String,default:"#2196F3"},showIcon:{type:Boolean,default:!0},requireAgreement:Boolean},data:()=>({isAgreed:!1}),methods:{handleConfirm(){this.$emit("agree")},handleCancel(){this.$emit("disagree")},handleBackdropClick(){this.$emit("disagree")}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",null,[e.withDirectives(e.createElementVNode("view",{class:e.normalizeClass(["modal-backdrop",{"backdrop-active":o.show}]),onClick:i[2]||(i[2]=(...e)=>r.handleBackdropClick&&r.handleBackdropClick(...e))},[e.createElementVNode("view",{class:e.normalizeClass(["modal-container",{"container-active":o.show}])},[e.createElementVNode("view",{class:"modal-card"},[e.createElementVNode("view",{class:"modal-header"},[e.createElementVNode("text",{class:"header-title"},e.toDisplayString(o.title),1),e.createElementVNode("view",{style:{display:"flex"}},[e.createVNode(l,{type:"info-filled",size:"30"}),e.createTextVNode("注意！请详细阅读说明 ")])]),e.createElementVNode("scroll-view",{class:"content-wrapper","scroll-y":"","scroll-with-animation":!0},[o.content?(e.openBlock(),e.createElementBlock("text",{key:0,class:"content-text"},e.toDisplayString(o.content),1)):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"action-buttons"},[e.createElementVNode("button",{class:"btn cancel-btn",onClick:i[0]||(i[0]=(...e)=>r.handleCancel&&r.handleCancel(...e))},e.toDisplayString(o.cancelText),1),e.createElementVNode("button",{class:"btn confirm-btn",style:e.normalizeStyle({backgroundColor:o.confirmColor}),onClick:i[1]||(i[1]=(...e)=>r.handleConfirm&&r.handleConfirm(...e))},e.toDisplayString(o.confirmText),5)])])],2)],2),[[e.vShow,o.show]])])}],["__scopeId","data-v-c564e2cd"]])},data:()=>({show:!1,content:"\n\t\t\t\t第一\n\t\t\t\t第二\n\t\t\t\t第三\n\t\t\t\t第四\n\t\t\t\t第五\n\t\t\t\t第五\n\t\t\t\t第五\n\t\t\t\t第五\n\t\t\t\t第五\n\t\t\t\t第五\n\t\t\t\t第五\n\t\t\t\t第五\n\t\t\t\t第五\n\t\t\t\t第五\n\t\t\t\t第五\n\t\t\t\t第五\n\t\t\t\t第五\n\t\t\t\t第五\n\t\t\t\t第五\n\t\t\t\t第五\n\t\t\t\t",selectIndex:0,typeList:[{id:1,name:"自销",active:!0,refName:"oneRef"},{id:2,name:"提货点",active:!1,refName:"twoRef"},{id:2,name:"批发",active:!1,refName:"threeRef"}],dishId:null}),onLoad({pramas:e}){this.dishId=JSON.parse(e).id},methods:{Open(e){this.show=!0},Close(){this.show=!1},agree(e){uni.showToast({icon:"loading",title:"正在处理......"}),this.typeList.filter((e=>{setTimeout((async()=>{if(e.active){let a=this.$refs[e.refName].formData;a.farmersgoods_id=this.dishId,a.market_id=this.$refs[e.refName].marketIdMap[this.$refs[e.refName].marketList[this.$refs[e.refName].selectedMarketIndex]],a.area_id=this.$refs[e.refName].area_id,a={...a,isshow:2,ispresale:2},t("log","at subPackages/aHouseholder/beListed/beListed.vue:158",a),200==(await l.foodOnSale(a)).code?(uni.showToast({icon:"success",title:"提交成功"}),setTimeout((()=>{this.customizeBack()}),1e3)):setTimeout((()=>{uni.showToast({icon:"error",title:"提交异常！！！！"})}),1e3)}}),1e3)})),this.Close()},disagree(){this.Close()},selectItem(e,t){this.typeList.filter((e=>{e.active=!1})),this.selectIndex=t,e.active=!0}}},[["render",function(t,a,i,o,s,n){const r=e.resolveComponent("one-vue"),l=e.resolveComponent("two-vue"),c=e.resolveComponent("three-vue"),d=e.resolveComponent("describe-vue");return e.openBlock(),e.createElementBlock("view",{class:"bigBox"},[e.createElementVNode("view",{class:"title"}," 请选择方式 "),e.createElementVNode("view",{style:{display:"flex",margin:"30rpx","justify-content":"space-around"}},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.typeList,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"typeItem",onClick:e=>n.selectItem(t,a),style:e.normalizeStyle([t.active?{background:"linear-gradient(135deg, #2d8cf0, #53a1f3)",color:"white"}:{}])},e.toDisplayString(t.name),13,["onClick"])))),256))]),e.withDirectives(e.createVNode(r,{onOpen:n.Open,ref:"oneRef"},null,8,["onOpen"]),[[e.vShow,0==s.selectIndex]]),e.withDirectives(e.createVNode(l,{onOpen:n.Open,ref:"twoRef"},null,8,["onOpen"]),[[e.vShow,1==s.selectIndex]]),e.withDirectives(e.createVNode(c,{onOpen:n.Open,ref:"threeRef"},null,8,["onOpen"]),[[e.vShow,2==s.selectIndex]]),e.createVNode(d,{show:s.show,content:s.content,onAgree:n.agree,onDisagree:n.disagree},null,8,["show","content","onAgree","onDisagree"])])}]]);const ql=W({data:()=>({activeCategory:1,categories:[{label:"自销",value:1},{label:"代提",value:2},{label:"批发",value:3}],dishes:[],scrollHeight:600,scrollLeft:0,loading:!0,queryData:{ispresale:2,page:1,limit:10,sellstatus:1},isNoMore:!1}),mounted(){this.loadData(),this.calcScrollHeight()},watch:{activeCategory(e,t){this.isNoMore=!1,this.dishes=[],this.queryData.sellstatus=e,this.queryData.page=1,this.loadData()}},methods:{initQueryData(e=1){this.queryData={page:1,limit:10,sellstatus:e},this.isNoMore=!1,this.dishes=[],t("log","at subPackages/aHouseholder/alreadyListed/alreadyListed.vue:96",this.queryData)},changePage(){this.queryData.page++,this.loadData()},async loadData(){try{if(!this.isNoMore){const e=await l.presaleList(this.queryData);200==e.code&&(this.dishes=[...this.dishes,...e.data.listdata],this.isNoMore=e.data.listdata.length<=this.queryData.limit)}}catch(e){t("error","at subPackages/aHouseholder/alreadyListed/alreadyListed.vue:112",e)}finally{this.loading=!1}},calcScrollHeight(){const e=uni.getSystemInfoSync(),t=uni.createSelectorQuery().in(this);t.select(".category-tabs").boundingClientRect(),t.exec((t=>{var a;const i=(null==(a=t[0])?void 0:a.height)||60;this.scrollHeight=e.windowHeight-i-10}))},switchCategory(e,t){this.activeCategory=e,this.$nextTick((()=>{const e=uni.createSelectorQuery().in(this);e.select(`.tab-item:nth-child(${t+1})`).boundingClientRect(),e.exec((e=>{e[0]&&(this.scrollLeft=e[0].left-50)}))}))},async handleOffShelf(e){try{let a=await l.XiaShiCity({id:e,isshow:1,ispresale:1});t("log","at subPackages/aHouseholder/alreadyListed/alreadyListed.vue:151",a),200==a.code?(uni.showToast({title:"下架成功",icon:"success"}),this.initQueryData(this.activeCategory),this.loadData()):uni.showToast({title:"下架失败",icon:"error"})}catch(a){uni.showToast({title:"操作失败",icon:"none"})}},handleImageError(e){e.image="/static/default-dish.png"},onRefresh(){this.loadData(),setTimeout((()=>{uni.stopPullDownRefresh()}),1e3)}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("scroll-view",{class:"category-tabs","scroll-x":"","scroll-with-animation":"","scroll-left":s.scrollLeft},[e.createElementVNode("view",{class:"tab-wrapper"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.categories,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:e.normalizeClass(["tab-item",s.activeCategory===t.value?"active":""]),onClick:e=>n.switchCategory(t.value,a)},e.toDisplayString(t.label),11,["onClick"])))),128))])],8,["scroll-left"]),e.createElementVNode("scroll-view",{class:"dish-list","scroll-y":"",style:e.normalizeStyle({height:s.scrollHeight+"px"}),onScrolltolower:a[0]||(a[0]=(...e)=>n.changePage&&n.changePage(...e))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.dishes,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:t.id,class:"dish-card"},[e.createElementVNode("image",{class:"dish-image",src:t.imglogo,mode:"aspectFill"},null,8,["src"]),e.createElementVNode("view",{class:"dish-content"},[e.createElementVNode("text",{class:"dish-name"},e.toDisplayString(t.goodsname),1),e.createElementVNode("text",{class:"dish-price"},"¥"+e.toDisplayString(t.price),1),e.createElementVNode("text",{class:"dish-stock"},"库存: "+e.toDisplayString(t.goodstotal)+e.toDisplayString(t.unit),1),e.createElementVNode("button",{class:"off-shelf-btn",onClick:e=>n.handleOffShelf(t.id)}," 下架 ",8,["onClick"])])])))),128)),s.loading||0!==s.dishes.length?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-wrapper"},[e.createElementVNode("image",{class:"empty-image",src:ri}),e.createElementVNode("text",{class:"empty-text"},"暂无上架商品")]))],36)])}],["__scopeId","data-v-8c526240"]]),Hl={data:()=>({searchText:"",categories:[{label:"所有分类",value:""},{label:"菜类",value:""},{label:"肉类",value:""}],selectedCategoryIndex:0,distances:[{label:"离我最近",value:""},{label:"离我最远",value:""}],selectedDistanceIndex:0,goodsList:[],page:1,loading:!1,noMore:!1,queryData:{page:1,limit:10}}),onLoad(){this.loadData()},methods:{async loadData(){if(!this.loading&&!this.noMore){this.loading=!0;try{const e=await l.wholesaleList(this.queryData);if(this.goodsList=e.data.listdata,0===e.data.listdata.length)return void(this.noMore=!0);this.page++}catch(e){t("log","at subPackages/Wholesale/supply/supply.vue:146",e)}finally{this.loading=!1}}},handleSearch(){this.resetList(),this.loadData()},handleReset(){this.searchText="",this.selectedCategoryIndex=0,this.selectedDistanceIndex=0,this.resetList(),this.loadData()},loadMore(){this.noMore||this.loadData()},resetList(){this.goodsList=[],this.page=1,this.noMore=!1},contactNow(){uni.showToast({title:"已发送联系请求",icon:"none"})},goDetail(e){uni.navigateTo({url:`/pages/goods/detail?id=${e}`})},categoryChange(e){this.selectedCategoryIndex=e.detail.value,this.resetList(),this.loadData()}}};const Wl=W(Hl,[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"supply-container"},[e.createElementVNode("view",{class:"filter-section"},[e.createElementVNode("view",{class:"search-bar"},[e.withDirectives(e.createElementVNode("input",{class:"search-input",type:"text",placeholder:"请输入关键字","onUpdate:modelValue":i[0]||(i[0]=e=>n.searchText=e)},null,512),[[e.vModelText,n.searchText]]),e.createElementVNode("button",{class:"search-btn",onClick:i[1]||(i[1]=(...e)=>r.handleSearch&&r.handleSearch(...e))},"搜索"),e.createElementVNode("button",{class:"reset-btn",onClick:i[2]||(i[2]=(...e)=>r.handleReset&&r.handleReset(...e))},"重置")]),e.createElementVNode("view",{class:"filter-group"},[e.createElementVNode("picker",{onChange:i[3]||(i[3]=(...e)=>r.categoryChange&&r.categoryChange(...e)),range:n.categories,"range-key":"label"},[e.createElementVNode("view",{class:"filter-btn"},e.toDisplayString(n.categories[n.selectedCategoryIndex].label),1)],40,["range"]),e.createElementVNode("picker",{range:n.distances,"range-key":"label"},[e.createElementVNode("view",{class:"filter-btn"},e.toDisplayString(n.distances[n.selectedDistanceIndex].label),1)],8,["range"])])]),e.createElementVNode("scroll-view",{class:"goods-list","scroll-y":"",onScrolltolower:i[5]||(i[5]=(...e)=>r.loadMore&&r.loadMore(...e)),"scroll-with-animation":!0},[e.createElementVNode("view",{class:"goods-grid"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.goodsList,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"goods-card",key:a,onClick:e=>r.goDetail(t.id)},[e.createElementVNode("view",{class:"image-container"},[e.createElementVNode("image",{class:"goods-image",src:t.selllogo,mode:"aspectFill","lazy-load":!0},null,8,["src"]),t.tag?(e.openBlock(),e.createElementBlock("view",{key:0,class:"goods-tag"},e.toDisplayString(t.tag),1)):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"goods-content"},[e.createElementVNode("text",{class:"goods-title"},e.toDisplayString(t.selltitle),1),e.createElementVNode("view",{class:"price-section"},[e.createElementVNode("text",{class:"current-price"},"￥"+e.toDisplayString(t.marketprice),1),t.price?(e.openBlock(),e.createElementBlock("text",{key:0,class:"original-price"}," ￥"+e.toDisplayString(t.price),1)):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"action-bar"},[e.createElementVNode("view",{class:"sales-info"},[e.createVNode(l,{type:"shop",size:"12",color:"#666"}),e.createElementVNode("text",null,e.toDisplayString(t.stoptime)+"人付款",1)]),e.createElementVNode("view",{class:"contact-btn",onClick:i[4]||(i[4]=e.withModifiers(((...e)=>r.contactNow&&r.contactNow(...e)),["stop"]))},[e.createElementVNode("text",null,"询底价"),e.createVNode(l,{type:"arrow-right",size:"14",color:"#fff"})])]),e.createElementVNode("view",{class:"location-info"},[e.createVNode(l,{type:"location",size:"12",color:"#666"}),e.createElementVNode("text",null,e.toDisplayString(t.selladdress),1)])])],8,["onClick"])))),128))]),e.createElementVNode("view",{class:"load-status"},[n.loading?(e.openBlock(),e.createElementBlock("text",{key:0,class:"loading-text"},"加载中...")):n.noMore?(e.openBlock(),e.createElementBlock("text",{key:1,class:"no-more"},"—— 没有更多了 ——")):e.createCommentVNode("",!0)])],32)])}]]),Gl={mixins:[pt],data:()=>({categories:[{label:"全部采购",value:"all"},{label:"肉类",value:"material"},{label:"蔬菜",value:"equipment"},{label:"蛋类",value:"service"}],sortOptions:[{label:"智能排序",value:"default"},{label:"预算最高",value:"budget_desc"},{label:"最新发布",value:"newest"}],selectedCategory:{label:"全部采购",value:"all"},selectedSort:{label:"智能排序",value:"default"},purchaseList:[],page:1,loading:!1,noMore:!1,query:{area_id:null,stoptime:null,page:1,limit:20},selectedCategoryIndex:0,distances:[{label:"离我最近",value:""},{label:"离我最远",value:""}],categories:[{label:"所有分类",value:""},{label:"菜类",value:""},{label:"肉类",value:""}]}),created(){this.loadData()},methods:{async loadData(){if(!this.loading&&!this.noMore){this.loading=!0;try{let e=await l.buyinfoList(this.query);this.purchaseList=[...this.purchaseList,...e.data.listdata],t("log","at subPackages/Wholesale/purchase/purchase.vue:181",this.purchaseList),this.page++,this.noMore=this.page>2}finally{this.loading=!1}}},generateDeadline(){const e=new Date;return e.setDate(e.getDate()+Math.floor(7*Math.random()+3)),`${e.getMonth()+1}月${e.getDate()}日`},categoryChange(e){this.selectedCategory=this.categories[e.detail.value],this.resetList()},sortChange(e){this.selectedSort=this.sortOptions[e.detail.value],this.resetList()},resetList(){this.page=1,this.purchaseList=[],this.noMore=!1,this.loadData()},viewDetail(e){uni.navigateTo({url:`/pages/purchase/detail?id=${e}`})},contactSupplier(e){uni.showActionSheet({items:["在线沟通","电话联系","邮件联系"],success:e=>t("log","at subPackages/Wholesale/purchase/purchase.vue:227","联系方式:",e.tapIndex)})}}};const Jl=W(Gl,[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"purchase-container"},[e.createElementVNode("view",{class:"filter-bar"},[e.createElementVNode("view",{class:"search"},[e.createVNode(l,{type:"search",style:{margin:"10rpx","font-size":"33rpx"}}),e.createElementVNode("input",{class:"serchInput",type:"text",placeholder:"请输入关键字"}),e.createElementVNode("view",{style:{display:"flex"}},[e.createElementVNode("button",{class:"btn",type:"primary"},"搜索"),e.createElementVNode("button",{class:"btn",type:"warn"},"重置")])]),e.createElementVNode("view",{class:"filter-group"},[e.createElementVNode("picker",{onChange:i[0]||(i[0]=(...e)=>r.categoryChange&&r.categoryChange(...e)),range:n.categories,"range-key":"label"},[e.createElementVNode("view",{class:"filter-btn"},[e.createVNode(l,{type:"tags",size:"16",color:"#3a7afe"}),e.createElementVNode("text",{class:"btn-text"},e.toDisplayString(n.categories[n.selectedCategoryIndex].label),1),e.createVNode(l,{type:"arrowdown",size:"14",color:"#3a7afe"})])],40,["range"]),e.createElementVNode("picker",{range:n.distances,"range-key":"label"},[e.createElementVNode("view",{class:"filter-btn"},[e.createVNode(l,{type:"tags",size:"16",color:"#3a7afe"}),e.createElementVNode("text",{class:"btn-text"},e.toDisplayString(n.distances[n.selectedCategoryIndex].label),1),e.createVNode(l,{type:"arrowdown",size:"14",color:"#3a7afe"})])],8,["range"])])]),e.createElementVNode("scroll-view",{class:"purchase-list","scroll-y":"",onScrolltolower:i[1]||(i[1]=(...e)=>t.loadMore&&t.loadMore(...e))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.purchaseList,((a,i)=>(e.openBlock(),e.createElementBlock("view",{class:"purchase-card",key:i,onClick:e=>r.viewDetail(a.id)},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("view",{class:"header-left"},[e.createElementVNode("text",{class:"title"},e.toDisplayString(a.infotitle),1)])]),e.createElementVNode("view",{class:"detail-row"},[e.createElementVNode("view",{class:"detail-item"},[e.createVNode(l,{type:"balance",size:"18",color:"#999"}),e.createElementVNode("text",{class:"detail-text"},"数量:"+e.toDisplayString(a.infonumber)+e.toDisplayString(a.unit),1)])]),e.createElementVNode("view",{class:"company-info"},[e.createElementVNode("view",{class:"company-detail"},[e.createElementVNode("text",{class:"company-name"},e.toDisplayString(a.buyaddress),1)])]),e.createElementVNode("view",{class:"card-footer"},[e.createElementVNode("view",{class:"deadline"},[e.createVNode(l,{type:"calendar",size:"16",color:"#666"}),e.createElementVNode("text",null,e.toDisplayString(t.initDate(a.stoptime))+" 截止",1)]),e.createElementVNode("view",{class:"action-btn",onClick:e.withModifiers((e=>r.contactSupplier(a.id)),["stop"])},[e.createElementVNode("text",null,"立即报价"),e.createVNode(l,{type:"arrow-right",size:"14",color:"#fff"})],8,["onClick"])])],8,["onClick"])))),128)),e.createElementVNode("view",{class:"load-status"},[n.loading?(e.openBlock(),e.createElementBlock("text",{key:0,class:"loading-text"},"加载中...")):n.noMore?(e.openBlock(),e.createElementBlock("text",{key:1,class:"no-more"},"- 已显示全部内容 -")):e.createCommentVNode("",!0)])],32)])}],["__scopeId","data-v-8932c12d"]]),Yl={mixins:[pt],data:()=>({multiArray:[[],[],[]],selectedCountry:"china",multiIndex:[0,0,0],formData:{selltitle:null,content:null,sellnumber:0,unit:0,selladdress:null,price:0,marketprice:0,category_id:null,selllogo:null},categories:[],submitting:!1,imageStyles:{width:200,height:200,border:{color:"#eee",width:1,style:"solid"}},formRules:{selltitle:{rules:[{required:!0,errorMessage:"标题不能为空"},{minLength:5,maxLength:30,errorMessage:"长度需5-30个字符"}]},category:{rules:[{validate:e=>3===(null==e?void 0:e.length),errorMessage:"请完整选择三级分类"}]}}}),mounted(){this.initializePicker(),this.fetchCategories()},methods:{initFormData(){this.formData={selltitle:null,content:null,sellnumber:0,unit:0,selladdress:null,price:0,marketprice:0,category_id:null,selllogo:null}},async fetchCategories(){const e=await l.cglist();this.categories=e.data.listdata.map((e=>({value:e.id,text:e.content})))},async bindMultiPickerColumnChange(e){const t=e.detail.column,a=e.detail.value;if("china"===this.selectedCountry){if(0===t){const e=this.provinceList[a];if(e&&void 0!==e.id){const t=await this.fetchCities(e.id);if(this.multiArray[1]=t.map((e=>e.name)),t.length>0){const e=await this.fetchAreas(t[0].id);this.multiArray[2]=e.map((e=>e.name))}else this.multiArray[2]=[]}this.multiIndex[1]=0,this.multiIndex[2]=0}else if(1===t){const e=this.cityList[a];if(e&&void 0!==e.id){const t=await this.fetchAreas(e.id);this.multiArray[2]=t.map((e=>e.name))}else this.multiArray[2]=[];this.multiIndex[2]=0}}else if("overseas"===this.selectedCountry)if(0===t){const e=this.overseasCountries[a];e&&void 0!==e.id&&await this.fetchOverseasCities(e.id),this.multiArray[2]=[],this.multiIndex[1]=0,this.multiIndex[2]=0}else 1===t&&(this.multiArray[2]=[],this.multiIndex[2]=0);this.multiIndex[t]=a,this.multiIndex=[...this.multiIndex]},async bindMultiPickerChange(e){this.formData.area_id=this.districtList[this.multiIndex[2]].id},async fetchCities(e){try{const a=await l.citytree(e);return 200===a.code&&Array.isArray(a.data)?(this.cityList=a.data,a.data):(t("error","at subPackages/Wholesale/addSupply/addSupply.vue:157","No cities data found"),[])}catch(a){return t("error","at subPackages/Wholesale/addSupply/addSupply.vue:161","Failed to fetch cities:",a),[]}},async fetchAreas(e){try{const a=await l.citytree(e);return 200===a.code&&Array.isArray(a.data)?(this.districtList=a.data,a.data):(t("error","at subPackages/Wholesale/addSupply/addSupply.vue:172","No areas data found"),[])}catch(a){return t("error","at subPackages/Wholesale/addSupply/addSupply.vue:176","Failed to fetch areas:",a),[]}},async fetchProvinces(){try{const e=await l.citylist({level:1,limit:100});if(200===e.code)return this.provinceList=e.data.listdata,this.provinceList;throw new Error("Failed to fetch provinces")}catch(e){throw t("error","at subPackages/Wholesale/addSupply/addSupply.vue:193","Failed to fetch provinces:",e),e}},async initializePicker(){try{const e=await this.fetchProvinces();this.multiArray[0]=e.map((e=>e.name));const t=await this.fetchCities(e[0].id);this.multiArray[1]=t.map((e=>e.name));const a=await this.fetchAreas(t[0].id);this.multiArray[2]=a.map((e=>e.name)),this.multiIndex=[0,0,0]}catch(e){t("log","at subPackages/Wholesale/addSupply/addSupply.vue:207",e)}},uploadcuisine(){uni.chooseImage({count:1,sizeType:["compressed","original"],sourceType:["album","camera"],success:async e=>{const a=e.tempFilePaths;if(t("log","at subPackages/Wholesale/addSupply/addSupply.vue:219",e),a.length>0){const{upload:t,request:i}=Ae({uploadPath:"/group1/upload",file:e.tempFiles[0],tempFilePaths:a[0]});t().then((e=>{var t=JSON.parse(e);this.formData.selllogo=o+t.data.path}))}}})},async handleSubmit(){200==(await l.publishWholesale(this.formData)).code?(uni.showToast({title:"发布成功",icon:"success"}),this.initFormData(),setTimeout((()=>{this.customizeBack()}),2e3)):uni.showToast({title:"发布失败",icon:"error"})}}};const Kl=W(Yl,[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"create-container"})}]]),Zl={mixins:[pt],data:()=>({multiArray:[[],[],[]],selectedCountry:"china",multiIndex:[0,0,0],formData:{infotitle:"",infonumber:null,unit:null,stoptime:"",byaddress:"",buyaddress:"",area_id:null,content:""},units:[{value:"件",text:"件"},{value:"吨",text:"吨"},{value:"箱",text:"箱"},{value:"斤",text:"斤"}],districtList:[],today:Date.now()}),mounted(){this.initializePicker()},options:{stylelsolation:"shared"},methods:{async bindMultiPickerColumnChange(e){const t=e.detail.column,a=e.detail.value;if("china"===this.selectedCountry){if(0===t){const e=this.provinceList[a];if(e&&void 0!==e.id){const t=await this.fetchCities(e.id);if(this.multiArray[1]=t.map((e=>e.name)),t.length>0){const e=await this.fetchAreas(t[0].id);this.multiArray[2]=e.map((e=>e.name))}else this.multiArray[2]=[]}this.multiIndex[1]=0,this.multiIndex[2]=0}else if(1===t){const e=this.cityList[a];if(e&&void 0!==e.id){const t=await this.fetchAreas(e.id);this.multiArray[2]=t.map((e=>e.name))}else this.multiArray[2]=[];this.multiIndex[2]=0}}else if("overseas"===this.selectedCountry)if(0===t){const e=this.overseasCountries[a];e&&void 0!==e.id&&await this.fetchOverseasCities(e.id),this.multiArray[2]=[],this.multiIndex[1]=0,this.multiIndex[2]=0}else 1===t&&(this.multiArray[2]=[],this.multiIndex[2]=0);this.multiIndex[t]=a,this.multiIndex=[...this.multiIndex]},async bindMultiPickerChange(e){this.formData.area_id=this.districtList[this.multiIndex[2]].id},async fetchProvinces(){try{const e=await l.citylist({level:1,limit:100});if(200===e.code)return this.provinceList=e.data.listdata,this.provinceList;throw new Error("Failed to fetch provinces")}catch(e){throw t("error","at subPackages/Wholesale/addPurchase/addPurchase.vue:198","Failed to fetch provinces:",e),e}},async fetchCities(e){try{const a=await l.citytree(e);return 200===a.code&&Array.isArray(a.data)?(this.cityList=a.data,a.data):(t("error","at subPackages/Wholesale/addPurchase/addPurchase.vue:209","No cities data found"),[])}catch(a){return t("error","at subPackages/Wholesale/addPurchase/addPurchase.vue:213","Failed to fetch cities:",a),[]}},async fetchAreas(e){try{const a=await l.citytree(e);return 200===a.code&&Array.isArray(a.data)?(this.districtList=a.data,a.data):(t("error","at subPackages/Wholesale/addPurchase/addPurchase.vue:224","No areas data found"),[])}catch(a){return t("error","at subPackages/Wholesale/addPurchase/addPurchase.vue:228","Failed to fetch areas:",a),[]}},async submitForm(){this.formData.buyaddress=this.multiArray[0][this.multiIndex[0]]+"-"+this.multiArray[1][this.multiIndex[1]]+"-"+this.multiArray[2][this.multiIndex[2]],t("log","at subPackages/Wholesale/addPurchase/addPurchase.vue:238",this.formData);let e=await l.buyinfoAdd(this.formData);200!=e.code?uni.showToast({icon:"error",title:e.msg||e.message}):(setTimeout((()=>{this.customizeBack()}),2e3),uni.showToast({icon:"success",title:e.msg||e.message}))},async initializePicker(){try{const e=await this.fetchProvinces();this.multiArray[0]=e.map((e=>e.name));const t=await this.fetchCities(e[0].id);this.multiArray[1]=t.map((e=>e.name));const a=await this.fetchAreas(t[0].id);this.multiArray[2]=a.map((e=>e.name)),this.multiIndex=[0,0,0]}catch(e){t("log","at subPackages/Wholesale/addPurchase/addPurchase.vue:267",e)}}}};const Ql=W(Zl,[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-section"),Yt),c=a(e.resolveDynamicComponent("uni-easyinput"),He),d=e.resolveComponent("goods-picker"),u=a(e.resolveDynamicComponent("uni-popup"),Ya),m=a(e.resolveDynamicComponent("uni-forms-item"),tl),h=a(e.resolveDynamicComponent("uni-data-select"),el),p=a(e.resolveDynamicComponent("uni-datetime-picker"),Ot),g=a(e.resolveDynamicComponent("uni-forms"),Gi);return e.openBlock(),e.createElementBlock("view",{class:"purchase-container"},[e.createVNode(g,{ref:"form"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"section"},[e.createVNode(l,{title:"采购明细",type:"line"}),e.createVNode(m,{label:"商品名称",required:"",name:"infotitle"},{default:e.withCtx((()=>[e.createVNode(c,{modelValue:n.formData.infotitle,"onUpdate:modelValue":i[0]||(i[0]=e=>n.formData.infotitle=e),placeholder:"请输入商品名称",onFocus:i[1]||(i[1]=e=>t.showGoodsPicker=!0)},null,8,["modelValue"]),e.createVNode(u,{ref:"goodsPopup",type:"dialog"},{default:e.withCtx((()=>[e.createVNode(d,{onSelect:t.handleGoodsSelect},null,8,["onSelect"])])),_:1},512)])),_:1}),e.createVNode(m,{label:"采购量",required:"",name:"quantity"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"quantity-input"},[e.createVNode(c,{type:"number",modelValue:n.formData.infonumber,"onUpdate:modelValue":i[2]||(i[2]=e=>n.formData.infonumber=e),modelModifiers:{number:!0},placeholder:"请输入数量"},null,8,["modelValue"]),e.createVNode(h,{modelValue:n.formData.unit,"onUpdate:modelValue":i[3]||(i[3]=e=>n.formData.unit=e),localdata:n.units,class:"unit-select",placeholder:"单位"},null,8,["modelValue","localdata"])])])),_:1}),e.createVNode(m,{label:"采购要求",name:"requirements"},{default:e.withCtx((()=>[e.createVNode(c,{type:"textarea",modelValue:n.formData.content,"onUpdate:modelValue":i[4]||(i[4]=e=>n.formData.content=e),placeholder:"请输入规格、材质等要求",maxlength:500},null,8,["modelValue"])])),_:1}),e.createVNode(m,{label:"收货地址",required:"",name:"deliveryAddress",class:"range-picker"},{default:e.withCtx((()=>[e.createElementVNode("picker",{class:"picker",mode:"multiSelector",range:n.multiArray,value:n.multiIndex,onChange:i[5]||(i[5]=(...e)=>r.bindMultiPickerChange&&r.bindMultiPickerChange(...e)),onColumnchange:i[6]||(i[6]=(...e)=>r.bindMultiPickerColumnChange&&r.bindMultiPickerColumnChange(...e))},[e.createElementVNode("view",{style:{"font-size":"25rpx"}},e.toDisplayString(n.multiArray[0][n.multiIndex[0]])+" - "+e.toDisplayString(n.multiArray[1][n.multiIndex[1]])+" -"+e.toDisplayString("overseas"===n.selectedCountry?"":n.multiArray[2][n.multiIndex[2]]),1)],40,["range","value"])])),_:1}),e.createVNode(m,{label:"详细地址",name:"byaddress"},{default:e.withCtx((()=>[e.createVNode(c,{modelValue:n.formData.byaddress,"onUpdate:modelValue":i[7]||(i[7]=e=>n.formData.byaddress=e),placeholder:"请输入详细地址"},null,8,["modelValue"])])),_:1}),e.createVNode(m,{label:"报价截止",required:"",name:"stoptime"},{default:e.withCtx((()=>[e.createVNode(p,{type:"date",modelValue:n.formData.stoptime,"onUpdate:modelValue":i[8]||(i[8]=e=>n.formData.stoptime=e),start:n.today,"return-type":"timestamp"},null,8,["modelValue","start"])])),_:1})]),e.createElementVNode("button",{type:"primary",onClick:i[9]||(i[9]=(...e)=>r.submitForm&&r.submitForm(...e))},"提交采购单")])),_:1},512)])}],["__scopeId","data-v-64993a72"]]);const Xl=W({data:()=>({supplyCount:15,purchaseCount:8,totalSupply:238,totalPurchase:156}),methods:{navToMySupply(){uni.navigateTo({url:"/subPackages/Wholesale/mySupply/mySupply"})},navToMyPurchase(){uni.navigateTo({url:"/subPackages/Wholesale/myProcurement/myProcurement"})}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"header-bar"},[e.createElementVNode("text",{class:"page-title"},"我的批发")]),e.createElementVNode("scroll-view",{"scroll-y":"",class:"main-content"},[e.createElementVNode("view",{class:"nav-card supply-card",onClick:i[0]||(i[0]=(...e)=>r.navToMySupply&&r.navToMySupply(...e))},[e.createElementVNode("view",{class:"card-inner"},[e.createVNode(l,{type:"shop-filled",size:"48",color:"#fff"}),e.createElementVNode("view",{class:"card-content"},[e.createElementVNode("text",{class:"card-title"},"我的供应")]),e.createVNode(l,{type:"right",size:"28",color:"#fff"})])]),e.createElementVNode("view",{class:"nav-card purchase-card",onClick:i[1]||(i[1]=(...e)=>r.navToMyPurchase&&r.navToMyPurchase(...e))},[e.createElementVNode("view",{class:"card-inner"},[e.createVNode(l,{type:"cart-filled",size:"48",color:"#fff"}),e.createElementVNode("view",{class:"card-content"},[e.createElementVNode("text",{class:"card-title"},"我的采购")]),e.createVNode(l,{type:"right",size:"28",color:"#fff"})])])])])}]]);const ec=W({data:()=>({queryData:{page:1,limit:10},dataTotal:null,noMore:!1,supplyData:[],statusConfig:{1:{text:"供应中",color:"#4cd964"},2:{text:"已下架",color:"#909399"}}}),onLoad(){this.getData()},methods:{async getData(){let e=await l.mySupplyData(this.queryData);t("log","at subPackages/Wholesale/mySupply/mySupply.vue:91",e),200==e.code&&(this.dataTotal=e.data.totalnum,this.supplyData=[...this.supplyData,...e.data.listdata])}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"supply-container"},[e.createElementVNode("view",{class:"header-bg"},[e.createElementVNode("view",{class:"header-content"},[e.createElementVNode("text",{class:"title"},"我的供应"),e.createElementVNode("text",{class:"count"},"共"+e.toDisplayString(n.dataTotal)+"条记录",1)])]),e.createElementVNode("scroll-view",{"scroll-y":"",class:"card-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.supplyData,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.id,class:e.normalizeClass(["supply-card","status-"+t.status])},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("image",{src:t.selllogo,class:"product-thumb",mode:"aspectFill"},null,8,["src"])]),e.createElementVNode("view",{class:"card-body"},[e.createElementVNode("view",{class:"main-info"},[e.createElementVNode("text",{class:"product-name"},e.toDisplayString(t.selltitle),1),e.createElementVNode("view",{class:"specs"},[e.createElementVNode("view",{class:"spec-item"},[e.createVNode(l,{type:"wallet",size:"16",color:"#666"}),e.createElementVNode("text",{class:"price"},"¥"+e.toDisplayString(t.price.toFixed(2))+"/"+e.toDisplayString(t.unit),1)]),e.createElementVNode("view",{class:"spec-item"},[e.createVNode(l,{type:"shop",size:"16",color:"#666"}),e.createElementVNode("text",null,"库存 "+e.toDisplayString(t.sellnumber)+e.toDisplayString(t.unit),1)])])]),e.createElementVNode("view",{class:"supply-details"},[e.createElementVNode("view",{class:"detail-item"},[e.createVNode(l,{type:"location",size:"14",color:"#666"}),e.createElementVNode("text",{class:"address"},e.toDisplayString(t.selladdress),1)])])])],2)))),128)),n.supplyData.length?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("image",{src:"/static/empty-supply.png",class:"empty-img"}),e.createElementVNode("text",{class:"empty-text"},"暂无供应信息")]))])])}],["__scopeId","data-v-4c5a5972"]]);const tc=W({mixins:[pt],data:()=>({dataTotal:null,listData:[],statusConfig:{1:{text:"报价中",color:"#007AFF"},2:{text:"已截单",color:"#4cd964"},3:{text:"已完成",color:"#909399"}},noMore:!1,queryData:{page:1,limit:10}}),methods:{async getData(){let e=await l.myProcurementData(this.queryData);t("log","at subPackages/Wholesale/myProcurement/myProcurement.vue:98",e),200==e.code&&(this.dataTotal=e.data.totalnum,this.listData=[...this.listData,...e.data.listdata])}},async onLoad(){this.getData()}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"purchase-list"},[e.createElementVNode("view",{class:"app-bar"},[e.createElementVNode("text",{class:"title"},"我的采购"),e.createElementVNode("view",{class:"stats"},[e.createElementVNode("text",{class:"count"},e.toDisplayString(n.dataTotal)+"条记录",1),e.createVNode(l,{type:"filter",size:"20",color:"#fff"})])]),e.createElementVNode("scroll-view",{"scroll-y":"",class:"card-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.listData,((a,i)=>(e.openBlock(),e.createElementBlock("view",{key:a.id,class:e.normalizeClass(["purchase-card","status-"+a.status])},[e.createElementVNode("view",{class:"card-content"},[e.createElementVNode("view",{class:"status-bar"},[e.createElementVNode("view",{class:"status-tag"},[e.createElementVNode("view",{class:"dot",style:e.normalizeStyle({backgroundColor:n.statusConfig[1].color})},null,4),e.createTextVNode(" "+e.toDisplayString(n.statusConfig[1].text),1)])]),e.createElementVNode("view",{class:"main-info"},[e.createElementVNode("text",{class:"product-name"},e.toDisplayString(a.infotitle),1),e.createElementVNode("view",{class:"specs"},[e.createElementVNode("view",{class:"spec-item"},[e.createVNode(l,{type:"shop",size:"16",color:"#666"}),e.createElementVNode("text",null,e.toDisplayString(a.infonumber)+e.toDisplayString(a.unit),1)]),e.createElementVNode("view",{class:"spec-item"},[e.createVNode(l,{type:"calendar",size:"16",color:"#666"}),e.createElementVNode("text",null,e.toDisplayString(t.initDate(a.stoptime))+"截止",1)])])]),e.createElementVNode("view",{class:"address-info"},[e.createVNode(l,{type:"location",size:"16",color:"#666"}),e.createElementVNode("text",{class:"address"},e.toDisplayString(a.buyaddress),1)]),e.createElementVNode("view",{class:"address-info"},[e.createTextVNode(" 注: "),e.createElementVNode("text",{class:"address"},e.toDisplayString(a.content),1)]),e.createElementVNode("view",{class:"supplier-info"},[e.createElementVNode("text",{class:"quote-count"},e.toDisplayString(1)+"家已报价")])])],2)))),128))])])}],["__scopeId","data-v-f5f5f28a"]]);const ac=W({},[["render",function(e,t){return null}]]);const ic=W({mixins:[pt],data:()=>({distances:[{label:"离我最近",value:""},{label:"离我最远",value:""}],pricesort:[{label:"价格最高",value:""},{label:"价格最少",value:""}],selectedCategoryIndex:0,selectedCategoryId:0,activeCategory:0,categories:[],goodsData:[],cartCount:0,queryData:{category_id:null,goodsname:null,page:1,limit:5},isLoading:!1,isRefreshing:!1,noMore:!1,isRefresh:null}),onLoad(){this.getGoodsData(),this.fetchCategories()},methods:{intiQuery(){this.queryData={category_id:null,goodsname:null,page:1,limit:5}},startSearch(){this.queryData.category_id=null,this.noMore=!1,this.goodsData=[],this.getGoodsData()},stopSearch(){this.noMore=!1,this.goodsData=[],this.intiQuery(),this.getGoodsData()},goToDynamics(e){t("log","at subPackages/shoppingPageList/villageZone/villageZone.vue:196",e),uni.navigateTo({url:`/pages/dynamics/dynamics?id=${e.id}`})},switchClass(e){t("log","at subPackages/shoppingPageList/villageZone/villageZone.vue:202",e),this.selectedCategoryId=e,this.goodsData=[],this.noMore=!1,this.intiQuery(),this.queryData.category_id=this.categories[e].id,this.getGoodsData()},async fetchCategories(){const e=await l.cglist();t("log","at subPackages/shoppingPageList/villageZone/villageZone.vue:212",e),this.categories=[{title:"全部"},...e.data.listdata]},async getGoodsData(e=!1){if(!(this.isLoading||!e&&this.noMore)){this.isLoading=!0;try{const{code:e,data:t}=await l.presaleList(this.queryData);if(200===e){const e=t.listdata.map((e=>({...e,goodsname:e.goodsname||"新品预售",imglogo:e.imglogo||"/static/default-goods.png",presaleprice:e.presaleprice||10,price:e.price||0,sold:e.sold||1,unit:e.unit||"件",organic:!!e.organic})));this.goodsData=[...this.goodsData,...e],this.noMore=e.length<this.queryData.limit}}finally{this.isLoading=!1,this.isRefreshing=!1}}},particleStyle:e=>1,calcDiscount:e=>(e.price/e.presaleprice*10).toFixed(1),addToCart(e){uni.navigateTo({url:`/subPackages/shoppingPageList/prePurchaseDeposit/prePurchaseDeposit?query=${JSON.stringify(e)}`})},loadMore(){this.noMore||(this.queryData.page++,this.getGoodsData())},gotoCart(){uni.navigateTo({url:"/pages/cart/index"})}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K),c=a(e.resolveDynamicComponent("uni-load-more"),me);return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{style:{display:"flex","align-items":"center"}},[e.createElementVNode("view",{class:"search-bar"},[e.createElementVNode("view",{style:{display:"flex","align-items":"center","border-radius":"20rpx"}},[e.createElementVNode("view",{style:{padding:"20rpx"}},[e.createVNode(l,{color:"#999999",size:"20",type:"search"})]),e.withDirectives(e.createElementVNode("input",{type:"text",placeholder:"搜索菜品","onUpdate:modelValue":i[0]||(i[0]=e=>n.queryData.goodsname=e)},null,512),[[e.vModelText,n.queryData.goodsname]])])]),e.createElementVNode("view",{style:{"background-color":"#007aff",color:"white",width:"120rpx",height:"80rpx","line-height":"80rpx","text-align":"center","border-radius":"10rpx",margin:"0 10rpx 0 0"},onClick:i[1]||(i[1]=(...e)=>r.startSearch&&r.startSearch(...e))}," 搜索"),e.createElementVNode("view",{style:{"background-color":"red",color:"white",width:"120rpx",height:"80rpx","line-height":"80rpx","text-align":"center","border-radius":"10rpx",margin:"0 10rpx 0 0"},onClick:i[2]||(i[2]=(...e)=>r.stopSearch&&r.stopSearch(...e))}," 清空")]),e.createElementVNode("view",{class:"filter-group"},[e.createElementVNode("picker",{onChange:i[3]||(i[3]=(...e)=>t.categoryChange&&t.categoryChange(...e)),range:n.pricesort,"range-key":"label"},[e.createElementVNode("view",{class:"filter-btn"},[e.createVNode(l,{type:"tags",size:"16",color:"#3a7afe"}),e.createElementVNode("text",{class:"btn-text"},e.toDisplayString(n.pricesort[n.selectedCategoryIndex].label),1),e.createVNode(l,{type:"arrowdown",size:"14",color:"#3a7afe"})])],40,["range"]),e.createElementVNode("picker",{range:n.distances,"range-key":"label"},[e.createElementVNode("view",{class:"filter-btn"},[e.createVNode(l,{type:"tags",size:"16",color:"#3a7afe"}),e.createElementVNode("text",{class:"btn-text"},e.toDisplayString(n.distances[n.selectedCategoryIndex].label),1),e.createVNode(l,{type:"arrowdown",size:"14",color:"#3a7afe"})])],8,["range"])]),e.createElementVNode("view",{class:"uni-margin-wrap"},[e.createElementVNode("scroll-view",{class:"category-nav","scroll-x":"true"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.categories,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:t.id,class:e.normalizeClass(["swiper-item",["nav-item",n.selectedCategoryId===a?"active":""]])},[e.createElementVNode("view",{class:"item-title",onClick:e=>r.switchClass(a)},[e.createElementVNode("text",{class:e.normalizeClass(["classify",{selected:t.id===n.selectedCategoryId}])},e.toDisplayString(t.title),3)],8,["onClick"])],2)))),128))])]),e.createElementVNode("scroll-view",{class:"goods-scroll","scroll-y":"",onScrolltolower:i[4]||(i[4]=(...e)=>r.loadMore&&r.loadMore(...e))},[e.createElementVNode("view",{class:"goods-waterfall"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.goodsData,((a,i)=>(e.openBlock(),e.createElementBlock("view",{key:i,class:"goods-card",style:e.normalizeStyle({animationDelay:i%10*.1+"s"})},[e.createElementVNode("view",{class:"card-header",onClick:e=>r.goToDynamics(a)},[e.createElementVNode("image",{src:a.imglogo,class:"goods-image",mode:"aspectFill"},null,8,["src"]),a.tag?(e.openBlock(),e.createElementBlock("view",{key:0,class:"ribbon"},[e.createElementVNode("text",null,e.toDisplayString(a.tag),1),e.createElementVNode("view",{class:"ribbon-tail"})])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"sales-progress"},[e.createElementVNode("progress",{percent:a.goodstotal>0?Math.min(a.selltotal/a.goodstotal*100,100):0,"stroke-width":"4",activeColor:"#ff6b6b"},null,8,["percent"]),e.createElementVNode("text",null,"已售"+e.toDisplayString(a.selltotal)+"/"+e.toDisplayString(a.goodstotal)+e.toDisplayString(a.unit),1)])],8,["onClick"]),e.createElementVNode("view",{class:"card-body"},[e.createElementVNode("view",{class:"title-row"},[e.createElementVNode("text",{class:"title"},e.toDisplayString(a.goodsname),1),a.organic?(e.openBlock(),e.createBlock(l,{key:0,type:"star-filled",color:"#ffd700",size:"18"})):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"price-section"},[e.createElementVNode("text",{class:"current"},"¥"+e.toDisplayString(a.price),1),e.createElementVNode("text",{class:"original"},"¥"+e.toDisplayString(a.presaleprice),1),e.createElementVNode("text",{class:"discount"},e.toDisplayString(r.calcDiscount(a))+"折",1),e.createElementVNode("view",{class:"title"},"上市时间:"+e.toDisplayString(t.initDate(a.sellbegintime)),1)])]),e.createElementVNode("view",{class:"card-footer"},[e.createElementVNode("button",{class:"cart-btn",onClick:e=>r.addToCart(a)}," 点击预购 ",8,["onClick"])])],4)))),128))]),e.createElementVNode("view",{class:"loading-state"},[e.createVNode(c,{status:n.isLoading?"loading":n.noMore?"noMore":"more",contentText:{contentdown:"上拉显示更多",contentrefresh:"正在加载",contentnomore:"没有更多了"}},null,8,["status"])])],32)])}],["__scopeId","data-v-0fba52e4"]]);const oc=W({mixins:[pt],data:()=>({distances:[{label:"离我最近",value:""},{label:"离我最远",value:""}],categories:[{label:"菜品最多",value:""},{label:"菜品最少",value:""}],selectedCategoryIndex:0,searchKey:"",isRefreshing:!1,farmers:[],formdata:{page:1,limit:100,farmersname:null},isSearch:!1}),async onLoad(){let e=uni.getStorageSync("userlocation");if(e){let{longitude:t,latitude:a}=JSON.parse(e);this.formdata.lat=a,this.formdata.lng=t}this.getData()},computed:{},methods:{goToRouter(e){uni.navigateTo({url:e})},intiQuery(){this.formdata={page:1,limit:100,farmersname:null}},startSearch(){this.farmers=[],this.getData()},stopSearch(){this.farmers=[],this.intiQuery(),this.getData()},async getData(){let e=await l.farmersList(this.formdata);(e.code=200)&&(this.farmers=[...this.farmers,...e.data.listdata]),t("log","at subPackages/shoppingPageList/nearbyFarmers/nearbyFarmers.vue:203",this.farmers)},handleContact(e){uni.makePhoneCall({phoneNumber:e.phone})},navigateToDetail(e){uni.navigateTo({url:`/subPackages/shoppingPageList/merchantDetails/merchantDetails?query=${JSON.stringify(e)}`})}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"search-bar"},[e.createElementVNode("view",{style:{display:"flex"}},[e.createElementVNode("view",{style:{display:"flex","background-color":"rgb(245, 245, 245)","align-items":"center","border-radius":"20rpx"}},[e.createElementVNode("view",{style:{padding:"20rpx"}},[e.createVNode(l,{color:"#999999",size:"20",type:"search"})]),e.withDirectives(e.createElementVNode("input",{type:"text",placeholder:"搜索农户姓名或地址","onUpdate:modelValue":i[0]||(i[0]=e=>n.formdata.farmersname=e)},null,512),[[e.vModelText,n.formdata.farmersname]])]),e.createElementVNode("view",{style:{"background-color":"#007aff",color:"white",width:"120rpx",height:"80rpx","line-height":"80rpx","text-align":"center","border-radius":"10rpx",margin:"10rpx"},onClick:i[1]||(i[1]=(...e)=>r.startSearch&&r.startSearch(...e))}," 搜索"),e.createElementVNode("view",{style:{"background-color":"red",color:"white",width:"120rpx",height:"80rpx","line-height":"80rpx","text-align":"center","border-radius":"10rpx",margin:"10rpx"},onClick:i[2]||(i[2]=(...e)=>r.stopSearch&&r.stopSearch(...e))}," 清空")]),e.createElementVNode("view",{class:"filter-group"},[e.createElementVNode("picker",{onChange:i[3]||(i[3]=(...e)=>t.categoryChange&&t.categoryChange(...e)),range:n.categories,"range-key":"label"},[e.createElementVNode("view",{class:"filter-btn"},[e.createVNode(l,{type:"tags",size:"16",color:"#3a7afe"}),e.createElementVNode("text",{class:"btn-text"},e.toDisplayString(n.categories[n.selectedCategoryIndex].label),1),e.createVNode(l,{type:"arrowdown",size:"14",color:"#3a7afe"})])],40,["range"]),e.createElementVNode("picker",{range:n.distances,"range-key":"label"},[e.createElementVNode("view",{class:"filter-btn"},[e.createVNode(l,{type:"tags",size:"16",color:"#3a7afe"}),e.createElementVNode("text",{class:"btn-text"},e.toDisplayString(n.distances[n.selectedCategoryIndex].label),1),e.createVNode(l,{type:"arrowdown",size:"14",color:"#3a7afe"})])],8,["range"]),e.createElementVNode("view",{onClick:i[4]||(i[4]=e=>r.goToRouter("/subPackages/shoppingPageList/statisticsMap/statisticsMap")),style:{position:"absolute",right:"40rpx","background-color":"#007aff",padding:"10rpx",color:"white","border-radius":"10rpx"}},"地图查看")])]),e.createElementVNode("scroll-view",{class:"list-container","scroll-y":"","refresher-triggered":n.isRefreshing},[e.createElementVNode("view",{class:"farmer-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.farmers,((a,i)=>(e.openBlock(),e.createElementBlock("view",{key:a.id,class:"farmer-card"},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("view",{class:"header-info"},[e.createElementVNode("text",{class:"name"},e.toDisplayString(a.name),1),e.createElementVNode("view",{class:"location"},[e.createVNode(l,{type:"location",size:"16",color:"#666"}),e.createTextVNode(" "+e.toDisplayString(a.address),1)])])]),e.createElementVNode("view",{class:"card-body"},[e.createElementVNode("view",null,[e.createElementVNode("view",{class:"info-item"},[e.createElementVNode("text",{class:"label"},"农户名称:"),e.createElementVNode("text",{class:"value"},e.toDisplayString(a.farmersname),1)]),e.createElementVNode("view",{class:"info-item"},[e.createElementVNode("text",{class:"label"},"所属地区："),e.createElementVNode("text",{class:"value"},e.toDisplayString(a.area_name),1)]),e.createElementVNode("view",{class:"info-item"},[e.createElementVNode("text",{class:"label"},"加入时间："),e.createElementVNode("text",{class:"value"},e.toDisplayString(t.initDate(a.createtime)),1)]),e.createElementVNode("view",{class:"info-item"},[e.createElementVNode("text",{class:"label"},"所售类目："),e.createElementVNode("text",{class:"value"},e.toDisplayString(a.category_name),1)]),e.createElementVNode("view",{class:"info-item"},[e.createElementVNode("text",{class:"label"},"所售商品："),e.createElementVNode("text",{class:"value"},e.toDisplayString("5个"))]),e.createElementVNode("view",{class:"info-item"},[e.createElementVNode("text",{class:"label"},"距离您有："),e.createElementVNode("text",{class:"value"},e.toDisplayString(a.distance.toFixed(1)||"")+"km",1)])]),e.createElementVNode("image",{style:{width:"150rpx",height:"150rpx"},src:a.logo?a.logo:"https://b0.bdstatic.com/0df6c8c7f109aa7b67e7cb15e6f8d025.jpg@h_1280"},null,8,["src"])]),e.createElementVNode("view",{class:"card-footer"},[e.createElementVNode("button",{class:"detail-btn",onClick:e=>r.navigateToDetail(a),style:{"border-color":"#007aff",color:"#007aff"}}," 查看详情 ",8,["onClick"])])])))),128)),0===n.farmers.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-container"},[e.createElementVNode("text",{class:"empty-text"},"暂无相关农户信息")])):e.createCommentVNode("",!0)])],8,["refresher-triggered"])])}],["__scopeId","data-v-191be3fd"]]);const sc=W({data:()=>({banners:[{img:"https://img2.baidu.com/it/u=3794887849,1985339825&fm=253&fmt=auto&app=138&f=JPEG?w=537&h=500",title:"大山里的希望果园"},{img:"https://img.tusij.com/qiantu_assets/user_download_ue/2021-05-17/qt_bb0f4a635fde3dfb99161a1f193df968_39881.jpg?auth_key=2342036953-0-0-5365a15afbb4e023df1aacbbdb5b36de&x-oss-process=image/resize,m_fixed,h_934,w_700/crop,x_0,y_0,w_700,h_476",title:"乡村振兴在行动"}],products:[{id:1,cover:"https://img2.baidu.com/it/u=1634565536,1061025085&fm=253&fmt=auto&app=138&f=JPEG?w=800&h=1067",title:"农家自采天然蜂蜜",region:"海南琼海",progress:78,price:39.9,originalPrice:58,sold:2560,farmer:{name:"王伟",avatar:"https://p2-pro.a.yximgs.com/uhead/AB/2025/04/01/16/BMjAyNTA0MDExNjQyNDZfMTQ1NDAxNDI5MV8yX2hkMTg5XzE1MA==_s.jpg"}}]})},[["render",function(t,a,i,o,s,n){const r=e.resolveComponent("u-tag"),l=e.resolveComponent("u-line-progress");return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("swiper",{class:"banner",autoplay:"",circular:"","indicator-dots":""},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.banners,((t,a)=>(e.openBlock(),e.createElementBlock("swiper-item",{key:a},[e.createElementVNode("image",{src:t.img,class:"banner-img",mode:"aspectFill"},null,8,["src"]),e.createElementVNode("view",{class:"banner-label"},e.toDisplayString(t.title),1)])))),128))]),e.createElementVNode("view",{class:"dashboard"},[e.createElementVNode("view",{class:"data-item"},[e.createElementVNode("text",{class:"value"},"832"),e.createTextVNode(),e.createElementVNode("text",{class:"label"},"帮扶农户")]),e.createElementVNode("view",{class:"data-item"},[e.createElementVNode("text",{class:"value"},"2360万"),e.createTextVNode(),e.createElementVNode("text",{class:"label"},"累计销售额")]),e.createElementVNode("view",{class:"data-item"},[e.createElementVNode("text",{class:"value"},"98%"),e.createTextVNode(),e.createElementVNode("text",{class:"label"},"好评率")])]),e.createElementVNode("view",{class:"product-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.products,(a=>(e.openBlock(),e.createElementBlock("view",{key:a.id,class:"product-card",onClick:e=>t.viewDetail(a.id)},[e.createElementVNode("view",{class:"badge"},"助农补贴"),e.createElementVNode("image",{src:a.cover,class:"cover"},null,8,["src"]),e.createElementVNode("view",{class:"info"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("text",{class:"title"},e.toDisplayString(a.title),1),e.createTextVNode(),e.createVNode(r,{text:a.region,size:"mini",type:"warning"},null,8,["text"])]),e.createElementVNode("view",{class:"farmer-info"},[e.createElementVNode("image",{src:a.farmer.avatar,class:"avatar"},null,8,["src"]),e.createTextVNode(),e.createElementVNode("text",{class:"name"},e.toDisplayString(a.farmer.name),1)]),e.createElementVNode("view",{class:"progress"},[e.createElementVNode("text",{class:"label"},"助农进度"),e.createTextVNode(),e.createVNode(l,{percent:a.progress,"show-text":!1,height:"10","active-color":"#ff7900"},null,8,["percent"]),e.createTextVNode(),e.createElementVNode("text",{class:"percent"},e.toDisplayString(a.progress)+"%",1)]),e.createElementVNode("view",{class:"footer"},[e.createElementVNode("view",{class:"price"},[e.createElementVNode("text",{class:"current"},"¥"+e.toDisplayString(a.price),1),e.createTextVNode(),e.createElementVNode("text",{class:"original"},"¥"+e.toDisplayString(a.originalPrice),1)]),e.createTextVNode(),e.createElementVNode("text",{class:"sold"},"已助力"+e.toDisplayString(a.sold)+"件",1)])])],8,["onClick"])))),128))])])}],["__scopeId","data-v-a987b011"]]);const nc=W({data:()=>({activeNav:0,categories:[{name:"蔬菜"},{name:"水果"},{name:"水产"},{name:"肉类"}],productList:[{id:1,cover:"https://qcloud.dpfile.com/pc/wjwuf0kuNAC-9AUfBkdUJL5dT3d8GGcuGlPpgYqjMJQDY_ZFhBScrG7sKiYM3WjS.jpg",title:"海南叶椰子 现摘现发",price:8.8,originalPrice:12.6,unit:"个",sales:3280,progress:82,origin:"海南万宁",isNew:!0}]}),methods:{switchNav(e){this.activeNav=e},navToDetail(e){uni.navigateTo({url:`/pages/detail?id=${e}`})},addToCart(e){uni.showToast({title:`已加入助农清单：${e.title}`,icon:"none"})}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"search-bar"},[e.createVNode(l,{type:"search",size:"20",color:"#999"}),e.createElementVNode("input",{class:"search-input",placeholder:"搜索产品","placeholder-class":"placeholder-style"})]),e.createElementVNode("scroll-view",{"scroll-x":"",class:"nav-scroll"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.categories,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:e.normalizeClass(["nav-item",n.activeNav===a?"active":""]),onClick:e=>r.switchNav(a)},e.toDisplayString(t.name),11,["onClick"])))),128))]),e.createElementVNode("view",{class:"product-grid"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.productList,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:"product-card",onClick:e=>r.navToDetail(t.id)},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("image",{class:"product-img",src:t.cover,mode:"aspectFill"},null,8,["src"]),e.createElementVNode("view",{class:"tag-wrap"},[e.createElementVNode("text",{class:"origin-tag"},e.toDisplayString(t.origin),1),t.isNew?(e.openBlock(),e.createElementBlock("text",{key:0,class:"new-tag"},"新品")):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"card-body"},[e.createElementVNode("text",{class:"product-title"},e.toDisplayString(t.title),1),e.createElementVNode("view",{class:"price-wrap"},[e.createElementVNode("text",{class:"current-price"},"¥"+e.toDisplayString(t.price),1),e.createElementVNode("text",{class:"old-price"},"¥"+e.toDisplayString(t.originalPrice),1)]),e.createElementVNode("view",{class:"sales-wrap"},[e.createElementVNode("progress",{percent:t.progress,"stroke-width":"4",activeColor:"#FF9900",backgroundColor:"#EEE"},null,8,["percent"]),e.createElementVNode("text",{class:"sales-text"},"已售"+e.toDisplayString(t.sales)+e.toDisplayString(t.unit),1)])]),e.createElementVNode("view",{class:"card-footer"},[e.createVNode(l,{type:"shop",size:"18",color:"#666"}),e.createElementVNode("button",{class:"buy-btn",onClick:e.withModifiers((e=>r.addToCart(t)),["stop"])},"询价",8,["onClick"])])],8,["onClick"])))),128))])])}],["__scopeId","data-v-bce11fdb"]]);const rc=W({data:()=>({shop:{id:"SH2023",rent:15e3,area:120,address:"岳松路88号",type:"临街商铺",height:5.8,width:8,managementFee:3.5,freeRentPeriod:30,images:["https://img1.baidu.com/it/u=819157245,3100371643&fm=253&fmt=auto&app=138&f=JPEG?w=800&h=1067","https://img1.baidu.com/it/u=819157245,3100371643&fm=253&fmt=auto&app=138&f=JPEG?w=800&h=1067"],location:{latitude:39.90923,longitude:116.42843}},formData:{name:"",phone:"",time:""},markers:[{id:1,latitude:39.90923,longitude:116.42843,iconPath:"https://img1.baidu.com/it/u=819157245,3100371643&fm=253&fmt=auto&app=138&f=JPEG?w=800&h=1067",width:30,height:30}]}),methods:{handleViewPanorama(){uni.navigateTo({url:"/pages/panorama/index?id=SH2023"})},handleCall(){uni.makePhoneCall({phoneNumber:"400-1234-5678"})},async handleSubmit(){if(!this.formData.name||!this.formData.phone)return uni.showToast({title:"请填写完整信息",icon:"none"});uni.showLoading({title:"提交中..."});try{await this.$http.post("/booking",{shopId:this.shop.id,...this.formData}),uni.showToast({title:"预约成功"}),this.formData={name:"",phone:"",time:""}}catch(ms){uni.showToast({title:"提交失败",icon:"none"})}finally{uni.hideLoading()}}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K),c=a(e.resolveDynamicComponent("uni-section"),Yt),d=a(e.resolveDynamicComponent("uni-easyinput"),He),u=a(e.resolveDynamicComponent("uni-forms-item"),tl),m=a(e.resolveDynamicComponent("uni-datetime-picker"),Ot),h=a(e.resolveDynamicComponent("uni-forms"),Gi);return e.openBlock(),e.createElementBlock("view",{class:"rental-page"},[e.createElementVNode("swiper",{class:"swiper",autoplay:"",circular:""},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.shop.images,((t,a)=>(e.openBlock(),e.createElementBlock("swiper-item",{key:a},[e.createElementVNode("image",{src:t,mode:"aspectFill",class:"swiper-img"},null,8,["src"])])))),128))]),e.createElementVNode("view",{class:"core-info"},[e.createElementVNode("view",{class:"price-section"},[e.createElementVNode("text",{class:"price"},"¥"+e.toDisplayString(n.shop.rent)+"/月",1),e.createElementVNode("text",{class:"area"},e.toDisplayString(n.shop.area)+"㎡",1)]),e.createElementVNode("view",{class:"meta-info"},[e.createElementVNode("text",{class:"location"},[e.createVNode(l,{type:"location",size:"16",color:"#666"}),e.createTextVNode(" "+e.toDisplayString(n.shop.address),1)]),e.createElementVNode("text",{class:"type"},e.toDisplayString(n.shop.type),1)])]),e.createVNode(c,{title:"房源信息",type:"line"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"detail-grid"},[e.createElementVNode("view",{class:"grid-item"},[e.createElementVNode("text",{class:"label"},"层高"),e.createElementVNode("text",{class:"value"},e.toDisplayString(n.shop.height)+"m",1)]),e.createElementVNode("view",{class:"grid-item"},[e.createElementVNode("text",{class:"label"},"面宽"),e.createElementVNode("text",{class:"value"},e.toDisplayString(n.shop.width)+"m",1)]),e.createElementVNode("view",{class:"grid-item"},[e.createElementVNode("text",{class:"label"},"物业费"),e.createElementVNode("text",{class:"value"},"¥"+e.toDisplayString(n.shop.managementFee)+"/月",1)]),e.createElementVNode("view",{class:"grid-item"},[e.createElementVNode("text",{class:"label"},"免租期"),e.createElementVNode("text",{class:"value"},e.toDisplayString(n.shop.freeRentPeriod)+"天",1)])])])),_:1}),e.createVNode(c,{title:"位置信息",type:"line"},{default:e.withCtx((()=>[e.createElementVNode("map",{style:{width:"100%",height:"300rpx"},"show-location":""})])),_:1}),e.createElementVNode("view",{class:"booking-form"},[e.createVNode(c,{title:"预约看房",type:"line"}),e.createVNode(h,{modelValue:n.formData},{default:e.withCtx((()=>[e.createVNode(u,{label:"您的姓名",required:"","label-width":"80"},{default:e.withCtx((()=>[e.createVNode(d,{modelValue:n.formData.name,"onUpdate:modelValue":i[0]||(i[0]=e=>n.formData.name=e),placeholder:"请输入姓名"},null,8,["modelValue"])])),_:1}),e.createVNode(u,{label:"联系电话",required:"","label-width":"80"},{default:e.withCtx((()=>[e.createVNode(d,{modelValue:n.formData.phone,"onUpdate:modelValue":i[1]||(i[1]=e=>n.formData.phone=e),type:"number",placeholder:"请输入手机号"},null,8,["modelValue"])])),_:1}),e.createVNode(u,{label:"预约时间",required:"","label-width":"80"},{default:e.withCtx((()=>[e.createVNode(m,{type:"datetime",modelValue:n.formData.time,"onUpdate:modelValue":i[2]||(i[2]=e=>n.formData.time=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["modelValue"])]),e.createElementVNode("view",{class:"footer-bar"},[e.createElementVNode("button",{class:"contact-btn",onClick:i[3]||(i[3]=(...e)=>r.handleCall&&r.handleCall(...e))},[e.createVNode(l,{type:"phone",size:"20",color:"#fff"}),e.createTextVNode(" 立即联系 ")]),e.createElementVNode("button",{class:"booking-btn",onClick:i[4]||(i[4]=(...e)=>r.handleSubmit&&r.handleSubmit(...e))}," 提交预约 ")])])}],["__scopeId","data-v-c64fb9c9"]]);const lc=W({data:()=>({currentFilter:"all",filterOptions:[{label:"全部",value:"all"},{label:"待出租",value:"available"},{label:"已出租",value:"leased"}],stallData:[],loading:!1,noMore:!1}),computed:{filteredStalls(){return this.stallData.filter((e=>"all"===this.currentFilter||e.status===this.currentFilter))}},mounted(){this.loadData()},methods:{async loadData(){this.loading=!0;try{await new Promise((e=>setTimeout(e,500))),this.stallData=this.getMockData()}finally{this.loading=!1,this.noMore=!0}},getMockData:()=>[{id:1,number:"A-01",status:"leased",price:2400,area:8,location:"蔬菜区主通道",suitable:"绿叶蔬菜专营",image:"https://img1.baidu.com/it/u=819157245,3100371643&fm=253&fmt=auto&app=138&f=JPEG?w=800&h=1067",features:["智能电子秤","扫码溯源"]},{id:2,number:"B-02",status:"available",price:2400,area:8,location:"肉类边柜区",suitable:"冷冻肉制品",image:"https://img1.baidu.com/it/u=819157245,3100371643&fm=253&fmt=auto&app=138&f=JPEG?w=800&h=1067",features:["独立冷藏柜","押金1.5万"]},{id:3,number:"C-01",status:"leased",price:2400,area:12,location:"水产鲜活区",suitable:"活鱼现杀",image:"https://img1.baidu.com/it/u=819157245,3100371643&fm=253&fmt=auto&app=138&f=JPEG?w=800&h=1067",features:["循环水系统","日交易200斤+"]},{id:4,number:"H-02",status:"available",price:2400,area:10,location:"熟食区",suitable:"早餐",image:"https://img1.baidu.com/it/u=819157245,3100371643&fm=253&fmt=auto&app=138&f=JPEG?w=800&h=1067",features:["粉汤","炒粉","猪脚饭"]}],changeFilter(e){this.currentFilter=e},loadMore(){this.noMore},viewDetail(e){uni.navigateTo({url:"/subPackages/shoppingPageList/rentalStorefront/rentalStorefront"})}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"market-header"},[e.createElementVNode("view",{class:"market-info"},[e.createElementVNode("text",{class:"market-name"},"定安-塔岭农贸菜市场"),e.createElementVNode("text",{class:"market-status"},"营业中")]),e.createVNode(l,{type:"map-pin",size:"20",color:"#666"})]),e.createElementVNode("view",{class:"status-filter"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.filterOptions,((t,a)=>(e.openBlock(),e.createElementBlock("button",{key:a,class:e.normalizeClass(["filter-btn",{active:n.currentFilter===t.value}]),onClick:e=>r.changeFilter(t.value)},e.toDisplayString(t.label),11,["onClick"])))),128))]),e.createElementVNode("scroll-view",{"scroll-y":"",class:"stall-list",onScrolltolower:i[0]||(i[0]=(...e)=>r.loadMore&&r.loadMore(...e))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.filteredStalls,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:"stall-item",onClick:e=>r.viewDetail(t.id)},[e.createElementVNode("image",{src:t.image,class:"stall-image",mode:"aspectFill"},null,8,["src"]),e.createElementVNode("view",{class:"info-container"},[e.createElementVNode("view",{class:"top-info"},[e.createElementVNode("text",{class:"stall-number"},e.toDisplayString(t.number),1),e.createElementVNode("view",{class:e.normalizeClass(["status-tag",t.status])},e.toDisplayString("leased"===t.status?"已出租":"待出租"),3)]),e.createElementVNode("view",{class:"core-info"},[e.createElementVNode("text",{class:"price"},"¥"+e.toDisplayString(t.price.toLocaleString())+"/月",1),e.createElementVNode("text",{class:"area"},e.toDisplayString(t.area)+"㎡",1)]),e.createElementVNode("view",{class:"detail-info"},[e.createElementVNode("view",{class:"info-row"},[e.createVNode(l,{type:"location",size:"14",color:"#666"}),e.createElementVNode("text",{class:"location"},e.toDisplayString(t.location),1)]),e.createElementVNode("view",{class:"info-row"},[e.createVNode(l,{type:"shop",size:"14",color:"#666"}),e.createElementVNode("text",null,e.toDisplayString(t.suitable),1)])]),e.createElementVNode("view",{class:"feature-tags"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.features,((t,a)=>(e.openBlock(),e.createElementBlock("text",{key:a,class:"tag"}," #"+e.toDisplayString(t),1)))),128))])])],8,["onClick"])))),128)),e.createElementVNode("view",{class:"loading-status"},[n.loading?(e.openBlock(),e.createElementBlock("text",{key:0},"加载中...")):n.noMore?(e.openBlock(),e.createElementBlock("text",{key:1},"已加载全部"+e.toDisplayString(r.filteredStalls.length)+"个摊位",1)):e.createCommentVNode("",!0)])],32)])}],["__scopeId","data-v-f60726c9"]]);const cc=W({data:()=>({activeStatus:"all",statusTabs:[{label:"全部",value:"all"},{label:"待提货",value:"wait_pickup"},{label:"已完成",value:"completed"}],orders:[],loading:!1,noMore:!1,statusMap:{wait_pickup:"待提货",completed:"已完成",canceled:"已取消"}}),computed:{filteredOrders(){return"all"===this.activeStatus?this.orders:this.orders.filter((e=>e.status===this.activeStatus))},processingCount(){return this.orders.filter((e=>["wait_pay","wait_pickup"].includes(e.status))).length},totalAmount(){return this.orders.reduce(((e,t)=>e+(t.deposit+t.finalPayment)),0).toFixed(2)}},mounted(){this.loadData()},methods:{async loadData(){this.loading=!0;try{await new Promise((e=>setTimeout(e,100))),this.orders=this.getMockData()}finally{this.loading=!1}},getMockData:()=>[{id:1,orderNo:"xcbdsc20251128001",status:"completed",goodsImage:"https://img1.baidu.com/it/u=2670186960,2836929917&fm=253&fmt=auto&app=138&f=JPEG?w=667&h=500",goodsName:"定安黑猪",quantity:2,deposit:60,finalPayment:196,pickupPoint:"猪肉铺小吴",pickupTime:"12月5日 14:00-18:00"}],changeStatus(e){this.activeStatus=e},onRefresh(){this.loadData()},loadMore(){this.noMore},viewDetail(e){uni.navigateTo({url:`/pages/preorder/detail?id=${e}`})},payFinal(e){uni.showModal({title:"支付尾款",content:"确认支付尾款金额？",success:e=>{e.confirm}})}}},[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("text",{class:"title"},"我的预购订单"),e.createElementVNode("view",{class:"stats"},[e.createElementVNode("text",null,"进行中 "+e.toDisplayString(r.processingCount)+" 笔",1),e.createElementVNode("text",null,"总金额 ¥"+e.toDisplayString(r.totalAmount),1)])]),e.createElementVNode("view",{class:"status-tabs"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.statusTabs,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.value,class:e.normalizeClass(["tab-item",{active:n.activeStatus===t.value}]),onClick:e=>r.changeStatus(t.value)},[e.createElementVNode("text",null,e.toDisplayString(t.label),1),n.activeStatus===t.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"indicator"})):e.createCommentVNode("",!0)],10,["onClick"])))),128))]),e.createElementVNode("scroll-view",{"scroll-y":"",class:"order-list",onRefresherrefresh:i[0]||(i[0]=(...e)=>r.onRefresh&&r.onRefresh(...e)),onScrolltolower:i[1]||(i[1]=(...e)=>r.loadMore&&r.loadMore(...e)),"refresher-enabled":""},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.filteredOrders,(a=>(e.openBlock(),e.createElementBlock("view",{key:a.id,class:"order-item",onClick:e=>r.viewDetail(a.id)},[e.createElementVNode("view",{class:"order-header"},[e.createElementVNode("text",{class:"order-no"},"订单号："+e.toDisplayString(a.orderNo),1),e.createElementVNode("view",{class:e.normalizeClass(["status-tag",a.status])},e.toDisplayString(n.statusMap[a.status]),3)]),e.createElementVNode("view",{class:"goods-info"},[e.createElementVNode("image",{src:a.goodsImage,class:"goods-image"},null,8,["src"]),e.createElementVNode("view",{class:"goods-detail"},[e.createElementVNode("text",{class:"goods-name"},e.toDisplayString(a.goodsName),1),e.createElementVNode("text",{class:"quantity"},"x"+e.toDisplayString(a.quantity),1),e.createElementVNode("view",{class:"price-info"},[e.createElementVNode("text",{class:"deposit"},"定金：¥"+e.toDisplayString(a.deposit),1),e.createElementVNode("text",{class:"final"},"尾款：¥"+e.toDisplayString(a.finalPayment),1)])])]),e.createElementVNode("view",{class:"footer-info"},[e.createElementVNode("text",{class:"pickup-info"},[e.createVNode(l,{type:"shop",size:"14"}),e.createTextVNode(" "+e.toDisplayString(a.pickupPoint)+" · "+e.toDisplayString(a.pickupTime),1)]),e.createElementVNode("view",{class:"actions"},["wait_pay"===a.status?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn mini",onClick:e.withModifiers((e=>r.payFinal(a.id)),["stop"])}," 支付尾款 ",8,["onClick"])):e.createCommentVNode("",!0),"completed"===a.status?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn mini",onClick:e.withModifiers((e=>t.applyAfterSales(a.id)),["stop"])}," 申请售后 ",8,["onClick"])):e.createCommentVNode("",!0)])])],8,["onClick"])))),128)),e.createElementVNode("view",{class:"loading-status"},[n.loading?(e.openBlock(),e.createElementBlock("text",{key:0},"加载中...")):n.noMore?(e.openBlock(),e.createElementBlock("text",{key:1},"没有更多订单了")):e.createCommentVNode("",!0)])],32)])}],["__scopeId","data-v-273a8d29"]]),dc={mixins:[pt],data:()=>({product:{},productImages:[],currentSwiperIndex:0,showDetail:!1,showTraceability:!1,showFullRules:!1,selectedPoint:null,deliveryPoints:[{id:1,name:"绿鲜社区店",address:"朝阳区光华路8号底商",pickupTime:"09:00-21:00"},{id:2,name:"智慧生活超市",address:"海淀区中关村大街12号",pickupTime:"08:30-22:00"},{id:3,name:"生鲜便利店",address:"西城区西单北大街109号",pickupTime:"10:00-20:00"}],shortRules:["定金支付后不可退换","提货时需出示订单二维码","预售商品到货后统一配送"],fullRules:["定金支付后不可退换，如商品未按约定时间到货，系统将自动退款并补偿5元优惠券","提货时需出示订单二维码，核对身份信息后方可提货，代提需提供双方有效证件","预售商品到货后将统一配送到您选择的提货点，到货后会通过短信通知，请在3天内提货","预订商品数量有限，每个用户ID限购5份，超出部分将按原价结算，不享受预售优惠","商品保质期为到货后3天，请在保质期内提货并食用，逾期未提视为自动放弃","如对商品质量有异议，请在提货后24小时内联系客服处理，逾期将不再受理"],fromData:{farmer_id:"",goods_num:1,price:0,payprice:0,payway:2,goods_arr:[],money:0},query:{farmersgoods_id:null,page:1,limit:10}}),onLoad({query:e}){const t="string"==typeof e?JSON.parse(e):e;this.product=t||{},this.query.farmersgoods_id=t.farmersgoods_id,this.getData(),this.fromData.farmer_id=this.product.id||"",this.fromData.money=parseFloat(this.product.price)||0,this.deliveryPoints.length>0&&(this.selectedPoint=this.deliveryPoints[0].id)},computed:{totalAmount(){return isNaN(this.fromData.money)||isNaN(this.fromData.goods_num)||this.fromData.goods_num<1?0:new lt(this.fromData.money).mul(this.fromData.goods_num).toNumber()}},methods:{async getData(){let e=await l.goodsinfoList(this.query);this.productImages=[this.product.imglogo],e.data.listdata.forEach((e=>{e.imgs.split(",").length>1&&this.productImages.length<10&&(t("log","at subPackages/shoppingPageList/prePurchaseDeposit/prePurchaseDeposit.vue:336",e.imgs.split(",")),this.productImages=[...this.productImages,...e.imgs.split(",")])}))},onSwiperChange(e){this.currentSwiperIndex=e.detail.current},toggleDetail(){this.showDetail=!this.showDetail},selectPoint(e){this.selectedPoint=e},onKeyInput(e){const t=e.detail.value.trim(),a=parseInt(t);this.fromData.goods_num=isNaN(a)||a<1?1:a},minusGoods_num(){this.fromData.goods_num>1&&this.fromData.goods_num--},addGoods_num(){this.fromData.goods_num++},addToCart(){uni.showToast({title:"已加入购物车",icon:"success",duration:1500})},async handleSubmit(){var e;if(this.selectedPoint)if(this.fromData.goods_num<1)uni.showToast({title:"购买数量不能小于1",icon:"none",duration:2e3});else if(this.fromData.money<=0)uni.showToast({title:"商品价格异常，请刷新",icon:"none",duration:2e3});else{this.fromData.price=this.totalAmount,this.fromData.payprice=this.totalAmount,this.fromData.goods_arr=[{goods_id:this.product.id||"",goodsname:this.product.goodsname||"",goodsnum:this.fromData.goods_num,price:this.fromData.price,pay_time:Date.now()}];try{const t=await l.prePurchaseOrder(this.fromData);200===t.code&&(null==(e=t.data)?void 0:e.out_trade_no)?this.startPayment(t.data.out_trade_no):(uni.showToast({title:t.msg||"订单提交失败",icon:"error",duration:2e3}),this.fromData.goods_arr=[])}catch(a){t("error","at subPackages/shoppingPageList/prePurchaseDeposit/prePurchaseDeposit.vue:439","提交订单异常：",a),uni.showToast({title:"网络异常，请稍后重试",icon:"error",duration:2e3}),this.fromData.goods_arr=[]}}else uni.showToast({title:"请选择提货点",icon:"none",duration:2e3})},async startPayment(e){try{const t=await l.wechatpay({out_trade_no:e});if(200===t.code&&t.data){const e={...t.data,timeStamp:t.data.timeStamp.toString(),nonceStr:t.data.nonceStr||"",package:t.data.package||"",signType:t.data.signType||"MD5",paySign:t.data.paySign||""};uni.requestPayment({...e,success:()=>{uni.showToast({title:"预订成功",icon:"success",duration:2e3}),setTimeout((()=>uni.navigateBack({delta:1})),2e3)},fail:()=>{uni.showToast({title:"支付已取消",icon:"none",duration:2e3})},complete:()=>{this.fromData.goods_arr=[]}})}else 202===t.code?await this.bindOpenIDAndPay(e):uni.showToast({title:t.msg||"获取支付参数失败",icon:"error",duration:2e3})}catch(a){t("error","at subPackages/shoppingPageList/prePurchaseDeposit/prePurchaseDeposit.vue:504","支付异常：",a),uni.showToast({title:"支付服务异常",icon:"error",duration:2e3})}},async bindOpenIDAndPay(e){try{const t=await new Promise(((e,t)=>{uni.login({provider:"weixin",success:e,fail:t})}));if(t.code){200===(await l.bindingOpenid({code:t.code})).code?await this.startPayment(e):uni.showToast({title:"账号绑定失败",icon:"none",duration:2e3})}else uni.showToast({title:"获取微信登录信息失败",icon:"none",duration:2e3})}catch(a){t("error","at subPackages/shoppingPageList/prePurchaseDeposit/prePurchaseDeposit.vue:548","绑定OpenID异常：",a),uni.showToast({title:"绑定服务异常",icon:"none",duration:2e3})}}}};const uc=W(dc,[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K),c=a(e.resolveDynamicComponent("uni-popup"),Ya);return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"carousel-container"},[e.createElementVNode("swiper",{class:"product-swiper","indicator-dots":"",autoplay:"",interval:"3000",duration:"500",circular:"",onChange:i[0]||(i[0]=(...e)=>r.onSwiperChange&&r.onSwiperChange(...e))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.productImages,((t,a)=>(e.openBlock(),e.createElementBlock("swiper-item",{key:a},[e.createElementVNode("image",{src:t,mode:"aspectFill",class:"carousel-image"},null,8,["src"])])))),128))],32),e.createElementVNode("view",{class:"carousel-counter"},e.toDisplayString(n.currentSwiperIndex+1)+"/"+e.toDisplayString(n.productImages.length),1)]),e.createElementVNode("view",{class:"product-base-info"},[e.createElementVNode("text",{class:"product-name"},e.toDisplayString(n.product.goodsname||"未命名商品"),1),e.createElementVNode("view",{class:"price-section"},[e.createElementVNode("text",{class:"current-price"},"¥"+e.toDisplayString(n.product.price||0),1),n.product.originalPrice?(e.openBlock(),e.createElementBlock("text",{key:0,class:"original-price"},"¥"+e.toDisplayString(n.product.originalPrice),1)):e.createCommentVNode("",!0),e.createElementVNode("text",{class:"product-unit"},e.toDisplayString(n.product.unit),1),e.createElementVNode("view",{class:"sales-volume"},"已售 "+e.toDisplayString(n.product.sales||0)+" 件",1)])]),e.createElementVNode("view",{class:"traceability-card",onClick:i[1]||(i[1]=e=>n.showTraceability=!0)},[e.createElementVNode("view",{class:"traceability-header"},[e.createElementVNode("text",{class:"trace-title"},"基础信息"),e.createVNode(l,{type:"right",size:"16",color:"#999"})]),e.createElementVNode("view",{class:"trace-content"},[e.createElementVNode("view",{class:"detail-text"},e.toDisplayString(n.product.content||"暂无信息"),1)])]),e.createElementVNode("view",{class:"detail-panel"},[e.createElementVNode("view",{class:"panel-header",onClick:i[2]||(i[2]=(...e)=>r.toggleDetail&&r.toggleDetail(...e))},[e.createElementVNode("text",{class:"panel-title"},"溯源信息"),e.createVNode(l,{type:"down",size:"18",color:"#999",class:e.normalizeClass({rotate:n.showDetail})},null,8,["class"])]),n.showDetail?(e.openBlock(),e.createElementBlock("view",{key:0,class:"panel-content"},[e.createElementVNode("view",{class:"detail-text"},e.toDisplayString(n.product.fromcontent||"暂无信息"),1)])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"purchase-card"},[e.createElementVNode("view",{class:"form-group quantity-group"},[e.createElementVNode("text",{class:"form-label"},"购买数量"),e.createElementVNode("view",{class:"quantity-selector"},[e.createElementVNode("button",{class:e.normalizeClass(["quantity-btn minus",{disabled:n.fromData.goods_num<=1}]),onClick:i[3]||(i[3]=(...e)=>r.minusGoods_num&&r.minusGoods_num(...e))},[e.createVNode(l,{type:"minus",size:"20"})],2),e.withDirectives(e.createElementVNode("input",{class:"quantity-input",type:"digit","onUpdate:modelValue":i[4]||(i[4]=e=>n.fromData.goods_num=e),onInput:i[5]||(i[5]=(...e)=>r.onKeyInput&&r.onKeyInput(...e)),placeholder:"请输入数量"},null,544),[[e.vModelText,n.fromData.goods_num]]),e.createElementVNode("button",{class:"quantity-btn plus",onClick:i[6]||(i[6]=(...e)=>r.addGoods_num&&r.addGoods_num(...e))},[e.createVNode(l,{type:"plus",size:"20"})])])])]),e.createElementVNode("view",{class:"rules-card"},[e.createElementVNode("text",{class:"section-title"},"预售规则"),e.createElementVNode("view",{class:"rules-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.shortRules,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:"rule-item"},[e.createVNode(l,{type:"circle",size:"12",color:"#1890FF",class:"rule-icon"}),e.createElementVNode("text",{class:"rule-text"},e.toDisplayString(t),1)])))),128)),e.createElementVNode("view",{class:"view-more",onClick:i[7]||(i[7]=e=>n.showFullRules=!0)},[e.createElementVNode("text",null,"查看全部规则"),e.createVNode(l,{type:"right",size:"14",color:"#1890FF"})])])]),e.createElementVNode("view",{class:"footer"},[e.createElementVNode("view",{class:"total-info"},[e.createElementVNode("text",{class:"total-label"},"总计："),e.createElementVNode("text",{class:"total-amount"},"¥"+e.toDisplayString(r.totalAmount.toFixed(2)),1)]),e.createElementVNode("button",{class:"submit-btn",onClick:i[8]||(i[8]=(...e)=>r.handleSubmit&&r.handleSubmit(...e)),disabled:!n.selectedPoint}," 立即预订 ",8,["disabled"])]),e.createVNode(c,{modelValue:n.showTraceability,"onUpdate:modelValue":i[10]||(i[10]=e=>n.showTraceability=e),mode:"bottom",class:"trace-popup"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"popup-header"},[e.createElementVNode("text",{class:"popup-title"},"商品全程溯源"),e.createVNode(l,{type:"close",size:"22",color:"#999",onClick:i[9]||(i[9]=e=>n.showTraceability=!1)})]),e.createElementVNode("view",{class:"trace-detail"},[e.createElementVNode("view",{class:"trace-qrcode"},[e.createElementVNode("image",{src:"/static/images/trace-qrcode.png",mode:"widthFix"}),e.createElementVNode("text",null,"扫码查看完整溯源信息")]),e.createElementVNode("view",{class:"trace-process"},[e.createElementVNode("text",{class:"process-title"},"生长周期"),e.createElementVNode("view",{class:"process-steps"},[e.createElementVNode("view",{class:"process-step active"},[e.createElementVNode("view",{class:"step-dot"}),e.createElementVNode("view",{class:"step-line"}),e.createElementVNode("view",{class:"step-info"},[e.createElementVNode("text",{class:"step-time"},"3月15日"),e.createElementVNode("text",{class:"step-desc"},"播种育苗")])]),e.createElementVNode("view",{class:"process-step active"},[e.createElementVNode("view",{class:"step-dot"}),e.createElementVNode("view",{class:"step-line"}),e.createElementVNode("view",{class:"step-info"},[e.createElementVNode("text",{class:"step-time"},"5月20日"),e.createElementVNode("text",{class:"step-desc"},"开花结果")])]),e.createElementVNode("view",{class:"process-step active"},[e.createElementVNode("view",{class:"step-dot"}),e.createElementVNode("view",{class:"step-line"}),e.createElementVNode("view",{class:"step-info"},[e.createElementVNode("text",{class:"step-time"},"6月30日"),e.createElementVNode("text",{class:"step-desc"},"成熟采收")])]),e.createElementVNode("view",{class:"process-step active"},[e.createElementVNode("view",{class:"step-dot"}),e.createElementVNode("view",{class:"step-info"},[e.createElementVNode("text",{class:"step-time"},"7月1日"),e.createElementVNode("text",{class:"step-desc"},"质检包装")])])])]),e.createElementVNode("view",{class:"farmer-info"},[e.createElementVNode("text",{class:"farmer-title"},"生产者信息"),e.createElementVNode("view",{class:"farmer-card"},[e.createElementVNode("image",{src:"/static/images/farmer-avatar.png",mode:"widthFix",class:"farmer-avatar"}),e.createElementVNode("view",{class:"farmer-details"},[e.createElementVNode("text",{class:"farmer-name"},e.toDisplayString(n.product.trace&&n.product.trace.farmer||"张建国"),1),e.createElementVNode("text",{class:"farmer-cert"},"已认证种植户"),e.createElementVNode("text",{class:"farmer-experience"},"15年种植经验 | 绿色种植认证")]),e.createElementVNode("view",{class:"verify-tag"},[e.createVNode(l,{type:"verified",size:"18",color:"#1890FF"}),e.createElementVNode("text",null,"已实名认证")])])])])])),_:1},8,["modelValue"]),e.createVNode(c,{modelValue:n.showFullRules,"onUpdate:modelValue":i[12]||(i[12]=e=>n.showFullRules=e),mode:"center",class:"rules-popup"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"rules-popup-header"},[e.createElementVNode("text",null,"预售规则详情"),e.createVNode(l,{type:"close",size:"22",color:"#999",onClick:i[11]||(i[11]=e=>n.showFullRules=!1)})]),e.createElementVNode("view",{class:"rules-popup-content"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.fullRules,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"full-rule-item",key:a},[e.createElementVNode("text",{class:"rule-number"},e.toDisplayString(a+1)+".",1),e.createElementVNode("text",{class:"rule-content"},e.toDisplayString(t),1)])))),128))])])),_:1},8,["modelValue"])])}],["__scopeId","data-v-802430bf"]]);const mc=W({mixins:[pt],data:()=>({merchantInfo:{},presaleList:[],queryData:{page:1,limit:10},isLogin:!0,showDetail:!1}),onLoad({query:e}){this.merchantInfo=JSON.parse(e),t("log","at subPackages/shoppingPageList/merchantDetails/merchantDetails.vue:41",this.merchantInfo.lat),this.merchantInfo.lat=this.merchantInfo.lat-.1,this.merchantInfo.markers=[{id:1,longitude:this.merchantInfo.lng,latitude:this.merchantInfo.lat,iconPath:"../../../static/selectlocation.png",width:30,height:30}],this.queryData.farmers_id=parseInt(this.merchantInfo.id),this.getPresaleData();uni.getStorageSync("token")||(this.isLogin=!1)},methods:{toggleDetail(){this.showDetail=!this.showDetail},gotoGoods(e){uni.navigateTo({url:`/pages/dynamics/dynamics?id=${e}`})},async getPresaleData(){let e=await l.presaleList(this.queryData);200==e.code&&(this.presaleList=[...this.presaleList,...e.data.listdata])},goToBuy(e){const t=JSON.parse(JSON.stringify(e));t.cover=null;let a=JSON.stringify(t);uni.navigateTo({url:`/subPackages/shoppingPageList/prePurchaseDeposit/prePurchaseDeposit?query=${a}`})}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"container"})}]]),hc={mixins:[pt],data:()=>({activeCategory:0,searchText:"",scrollHeight:0,categories:[],query:{category_name:null,page:1,limit:10},newsList:[],isNext:!1}),mounted(){this.calcScrollHeight(),this.initClassification(),this.getData()},watch:{activeCategory(e,t){this.query.page=1,this.isNext=!1,this.query.category_name=this.categories[e].name,this.getData(!0)}},methods:{changePage(){this.isNext||(this.query.page+=1,this.getData())},async initClassification(){let e=await l.classification({});if(200==e.code){let a=e.data.map(((e,t)=>({id:t,name:e})));t("log","at subPackages/shoppingPageList/realTimeInfo/realTimeInfo.vue:102",a),this.categories=[{id:-1,name:"全部"},...a]}},async getData(e=!1){let t=await l.informationData(this.query);200==t.code&&(this.newsList=e?t.data.listdata:[...this.newsList,...t.data.listdata],this.isNext=t.data.listdata.length<this.query.limit)},calcScrollHeight(){const e=uni.getSystemInfoSync();this.scrollHeight=e.windowHeight-180},switchCategory(e){this.activeCategory=e,this.query.category_name=this.categories[e].name},onSearchInput(e){this.searchText=e.detail.value.trim()},navigateToDetail(e){let t=encodeURIComponent(e.content);uni.navigateTo({url:`/subPackages/shoppingPageList/realTimeInfoDetail/realTimeInfoDetail?content=${t}&createtime=${this.initTime(e.createtime)}`})}}};const pc=W(hc,[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"news-container"},[e.createElementVNode("view",{class:"search-bar"},[e.createElementVNode("view",{class:"search-box"},[e.createVNode(l,{type:"search",size:"18",color:"#999"}),e.createElementVNode("input",{class:"search-input",placeholder:"请输入关键词搜索","placeholder-class":"placeholder",onInput:i[0]||(i[0]=(...e)=>r.onSearchInput&&r.onSearchInput(...e))},null,32)])]),e.createElementVNode("scroll-view",{class:"category-nav","scroll-x":""},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.categories,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:t.id,class:e.normalizeClass(["category-item",{active:n.activeCategory===a}]),onClick:e=>r.switchCategory(a)},[e.createTextVNode(e.toDisplayString(t.name)+" ",1),n.activeCategory===a?(e.openBlock(),e.createElementBlock("view",{key:0,class:"indicator"})):e.createCommentVNode("",!0)],10,["onClick"])))),128))]),e.createElementVNode("scroll-view",{class:"news-list","scroll-y":"",style:e.normalizeStyle({height:n.scrollHeight+"px"}),onScrolltolower:i[1]||(i[1]=(...e)=>r.changePage&&r.changePage(...e))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.newsList,(a=>(e.openBlock(),e.createElementBlock("view",{key:a.id,class:"news-item",onClick:e=>r.navigateToDetail(a)},[e.createElementVNode("image",{class:"news-image",src:a.cover?a.cover:"https://img0.baidu.com/it/u=3524251599,1183611687&fm=253&fmt=auto&app=138&f=GIF?w=285&h=285",mode:"aspectFill"},null,8,["src"]),e.createElementVNode("view",{class:"news-content"},[e.createElementVNode("text",{class:"news-title"},e.toDisplayString(a.title),1),e.createElementVNode("text",{class:"news-summary"},e.toDisplayString(a.description),1),e.createElementVNode("view",{class:"news-meta"},[e.createElementVNode("text",{class:"meta-item"},e.toDisplayString(t.initTime(a.createtime)),1),e.createElementVNode("view",{class:"meta-item"},[e.createVNode(l,{type:"hand-up",size:"14"}),e.createElementVNode("text",null,e.toDisplayString(a.likeCount),1)])])])],8,["onClick"])))),128))],36)])}],["__scopeId","data-v-39703cad"]]);const gc=W({mixins:[pt],data:()=>({createtime:"",detailData:"正在加载中...."}),onLoad({content:e,createtime:t}){this.createtime=t},methods:{removeAllSpaces:e=>String(e).replace(/\s+/g,"")}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"content"},[e.createElementVNode("text",{style:{"font-size":"25rpx","font-weight":"bold"}},"发布时间:"+e.toDisplayString(t.initTime(s.createtime)),1)])}]]);const fc=W({data:()=>({})},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"me-container"},[e.createElementVNode("view",{class:"title"}," 喜讯 "),e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"one"},"为了营造一个轻松,愉悦,有趣味的购物消费场景,我们塔岭农贸市场管理处从2024年11月1日开始,开展购物消费，系统随机摇号产生幸运者,获赠消费积分活动.具体规定如下:"),e.createElementVNode("view",{class:"one"},"一、凡是到塔岭农贸市场购物消费的市民,都可以扫打卡二维码,同一个电话号码一天可以扫码打卡两次：上午一次.时间:6:00-12:00,下午一次.时间:12:00-21:00。"),e.createElementVNode("view",{class:"one"}," 二、每周日晚上23.00,根据市民上一周每一次的打卡记录信息,自动随机摇号抽选出一、二、三档共十二名幸运者。打卡次数越多,选中的几率越大。 一档：1名,获赠1000个积分。 二档：3名,分别获赠500个积分。 三档：8名,分别获赠300个分。 "),e.createElementVNode("view",{class:"one"},"三、1个积分等同于0.1元现金价值.积分不能兑换现金.也不能转赠,获赠积分的凭被抽选中的手机号,在塔岭农贸市场购物消费使用(由于系统还在建设升级的原因，仅限在“农链天下”小程序加盟商户进行消费使用)。"),e.createElementVNode("view",{class:"one"},"四、积分可以单独使用,也可以和现金同时使用。"),e.createElementVNode("view",{class:"one"},"五、积分有效期为180个日历天数,从获赠积分即时算起，超时不使用，剩余的积分全部清零。"),e.createElementVNode("view",{class:"one"}," 六、每次抽选结果及个人积分信息，在“农链天下”小程序中都可以查询。 "),e.createElementVNode("view",{class:"one"}," 七、参与积分活动的行为都属于个人自愿行为，无任何强迫因素在内。 "),e.createElementVNode("view",{class:"one"}," 八.本活动的解释权由塔岭农贸市场管理处负责。 ")]),e.createElementVNode("view",{class:"luokuan"},[e.createElementVNode("view",{class:"bomen"}," 塔岭农贸市场办公室 "),e.createElementVNode("view",{class:"dateTime"},"2024.11.01 ")])])}]]),yc={data:()=>({markers:[],location:{latitude:null,longitude:null},formdata:{page:1,limit:1e3}}),onLoad(e){uni.getLocation({altitude:!0,isHighAccuracy:!0,highAccuracy:!0,type:"gcj02",success:e=>{this.location.longitude=e.longitude,this.location.latitude=e.latitude,this.mapKey=!0,t("log","at subPackages/shoppingPageList/statisticsMap/statisticsMap.vue:43",this.location),this.markers.push({id:1,label:{content:"当前位置",fontSize:25},longitude:this.location.longitude,latitude:this.location.latitude,iconPath:"../../../static/selectlocation.png",width:30,height:30}),this.getData()},fail(e){t("log","at subPackages/shoppingPageList/statisticsMap/statisticsMap.vue:49",e)}})},methods:{async getData(){let e=await l.farmersList(this.formdata);if(e.code=200){let t=e.data.listdata.map(((e,t)=>({id:t+2,longitude:e.lng,latitude:e.lat,iconPath:"../../../static/selectlocation.png",width:30,height:30,label:{content:e.farmersname,fontSize:25}})));this.markers=[...this.markers,...t]}}}};const vc=W(yc,[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{style:{width:"100%",height:"100vh"}},[e.createElementVNode("map",{style:{width:"100%",height:"100vh"},markers:s.markers,latitude:s.location.latitude,longitude:s.location.longitude,callout:{content:"111"}},null,8,["markers","latitude","longitude"])])}]]);const wc=W({data:()=>({applicationList:[{id:1,farmerName:"王启俊",farmAddress:"海南省定安县雷鸣镇",productName:"黑猪肉粽子",yield:150,price:5.8,deliveryType:"农户自配送",applyTime:"2023-08-20 09:30",status:0,avatar:"/static/avatar1.png"}]}),filters:{statusText:e=>({0:"待处理",1:"已同意",2:"已拒绝"}[e]||"未知状态")},methods:{statusClass:e=>({"status-pending":0===e,"status-approved":1===e,"status-rejected":2===e}),handleAccept(e){uni.showModal({title:"确认操作",content:"确定同意该代销申请吗？",success:e=>{e.confirm}})},handleReject(e){uni.showModal({title:"确认操作",content:"确定拒绝该代销申请吗？",confirmColor:"red",success:e=>{e.confirm}})}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"header-card"},[e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("text",{class:"stat-number"},"12"),e.createElementVNode("text",{class:"stat-label"},"今日申请")]),e.createElementVNode("view",{class:"stat-divider"}),e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("text",{class:"stat-number"},"3"),e.createElementVNode("text",{class:"stat-label"},"待处理")])]),e.createElementVNode("scroll-view",{"scroll-y":"",class:"list-container"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.applicationList,((a,i)=>(e.openBlock(),e.createElementBlock("view",{key:i,class:"application-card"},[e.createElementVNode("view",{class:"user-info"},[e.createElementVNode("view",{class:"user-detail"},[e.createElementVNode("text",{class:"user-name"},e.toDisplayString(a.farmerName),1),e.createElementVNode("text",{class:"user-address"},e.toDisplayString(a.farmAddress),1)]),e.createElementVNode("view",{class:e.normalizeClass(["status-tag",n.statusClass(a.status)])},e.toDisplayString(a.status|t.statusText),3)]),e.createElementVNode("view",{class:"product-info"},[e.createElementVNode("view",{class:"info-row"},[e.createElementVNode("text",{class:"info-label"},"产品名称："),e.createElementVNode("text",{class:"info-value"},e.toDisplayString(a.productName),1)]),e.createElementVNode("view",{class:"info-row"},[e.createElementVNode("text",{class:"info-label"},"库存："),e.createElementVNode("text",{class:"info-value"},e.toDisplayString(a.yield)+"公斤",1)]),e.createElementVNode("view",{class:"info-row"},[e.createElementVNode("text",{class:"info-label"},"期望单价："),e.createElementVNode("text",{class:"info-value"},"￥"+e.toDisplayString(a.price)+"/公斤",1)]),e.createElementVNode("view",{class:"info-row"},[e.createElementVNode("text",{class:"info-label"},"配送方式："),e.createElementVNode("text",{class:"info-value"},e.toDisplayString(a.deliveryType),1)])]),0===a.status?(e.openBlock(),e.createElementBlock("view",{key:0,class:"action-buttons"},[e.createElementVNode("button",{class:"btn reject-btn",onClick:e=>n.handleReject(a.id)},"拒绝申请",8,["onClick"]),e.createElementVNode("button",{class:"btn accept-btn",onClick:e=>n.handleAccept(a.id)},"同意代销",8,["onClick"])])):e.createCommentVNode("",!0),e.createElementVNode("text",{class:"apply-time"},"申请时间："+e.toDisplayString(a.applyTime),1)])))),128))])])}],["__scopeId","data-v-5f9966ce"]]),kc={mixins:[pt],data:()=>({showList:[],currentFilter:"全部",filterOptions:["全部","申请中","已完成"],page:1,pageSize:10,total:0,loadStatus:"loading",query:{page:1,limit:10,status:0}}),methods:{initMockData(){this.loadData()},statusChange(e){switch(this.showList=[],this.currentFilter=this.filterOptions[e.detail.value],t("log","at subPackages/boothOwner/billRecord/billRecord.vue:73",e.detail.value),e.detail.value){case 0:this.query.status=0;break;case 1:this.query.status=1;break;case 2:this.query.status=2}this.query.page=1,this.loadData()},async loadData(){let e=await l.shopmoneylist(this.query);200==e.code&&(this.total=e.data.totalnum,this.showList=[...this.showList,...e.data.listdata],this.loadStatus=e.data.listdata.length<this.query.limit?"more":"loading")},loadMore(){"more"===this.loadStatus&&(this.query.page+=1,this.loadData())}},mounted(){this.initMockData()}};const Ec=W(kc,[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("text",{class:"total-count"},"共 "+e.toDisplayString(n.total)+" 条提现记录",1),e.createElementVNode("picker",{onChange:i[0]||(i[0]=(...e)=>r.statusChange&&r.statusChange(...e)),range:n.filterOptions},[e.createElementVNode("view",{class:"filter-btn"},[e.createTextVNode(e.toDisplayString(n.currentFilter)+" ",1),e.createVNode(l,{type:"arrowdown",size:"14",color:"#666"})])],40,["range"])]),e.createElementVNode("scroll-view",{"scroll-y":"",class:"record-list",onScrolltolower:i[1]||(i[1]=(...e)=>r.loadMore&&r.loadMore(...e))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.showList,((a,i)=>(e.openBlock(),e.createElementBlock("view",{key:a.id,class:"record-card"},[e.createElementVNode("view",{class:"card-content"},[e.createElementVNode("view",{class:"left-section"},[e.createElementVNode("text",{class:"time"},e.toDisplayString(t.initTime(a.createtime)),1),e.createElementVNode("text",{class:"amount"},"¥"+e.toDisplayString(a.shopmoney.toFixed(2)),1)]),e.createElementVNode("view",{class:"status",style:e.normalizeStyle(1==a.status?"background: #FFF3E0;color: #FFA726;":"background: #E8F5E9;color: #4CAF50;")},e.toDisplayString(1===a.status?"申请中":"已完成"),5)])])))),128)),e.createElementVNode("view",{class:"load-more"},e.toDisplayString("loading"===n.loadStatus?"正在加载...":"没有更多数据了"),1)],32)])}]]),Nc={data:()=>({form:{notifyEnabled:!0,wechatPayEnabled:!0,pointsPayEnabled:!1,pointsRatio:10,deliveryEnabled:!0},showRatioPicker:!1,messageStatusText:null,messageStatus:""}),onLoad(){this.loadSettings()},methods:{switchMessage(){uni.requestSubscribeMessage({tmplIds:["PN8Vc4Z5rWUHi05A6F-J73TkkpF4iHxkEtA6bIoFUPw"],success:e=>{"accept"==e["PN8Vc4Z5rWUHi05A6F-J73TkkpF4iHxkEtA6bIoFUPw"]?(this.messageStatus=!1,this.messageStatusText="已订阅"):(this.messageStatus=!0,this.messageStatusText="订阅")},fail:e=>{t("log","at subPackages/boothOwner/storeSettings/storeSettings.vue:124",e)}})},loadSettings(){try{const e=uni.getStorageSync("shopSettings");e&&(this.form={...this.form,...e})}catch(ms){t("error","at subPackages/boothOwner/storeSettings/storeSettings.vue:133","加载设置失败:",ms)}},setForm(e,t){this.form[e]=t,this.saveSettings()},saveSettings(){try{uni.setStorageSync("shopSettings",this.form),uni.showToast({title:"设置已保存",icon:"none"})}catch(ms){uni.showToast({title:"保存失败",icon:"none"})}},saveRatio(){this.showRatioPicker=!1,this.saveSettings()}}};const bc=W(Nc,[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"settings-group"},[e.createElementVNode("text",{class:"group-title"},"允许支付方式"),e.createElementVNode("view",{class:"setting-item"},[e.createElementVNode("text",null,"微信支付"),e.createElementVNode("switch",{checked:s.form.wechatPayEnabled,onChange:a[0]||(a[0]=e=>n.setForm("wechatPayEnabled",e.detail.value)),color:"#4CD964"},null,40,["checked"])]),e.createElementVNode("view",{class:"setting-item"},[e.createElementVNode("text",null,"积分支付"),e.createElementVNode("switch",{checked:s.form.pointsPayEnabled,onChange:a[1]||(a[1]=e=>n.setForm("pointsPayEnabled",e.detail.value)),color:"#4CD964"},null,40,["checked"])])]),e.createElementVNode("view",{class:"settings-group"},[e.createElementVNode("text",{class:"group-title"},"支持配送方式"),e.createElementVNode("view",{class:"setting-item"},[e.createElementVNode("text",null,"送货上门"),e.createElementVNode("switch",{checked:s.form.deliveryEnabled,onChange:a[2]||(a[2]=e=>n.setForm("deliveryEnabled",e.detail.value)),color:"#4CD964"},null,40,["checked"])]),e.createElementVNode("view",{class:"setting-item"},[e.createElementVNode("text",null,"客户自取"),e.createElementVNode("switch",{color:"#4CD964"})])])])}],["__scopeId","data-v-888fccb3"]]),Vc={data:()=>({user:{Headimgurl:"",nickname:"",phone:"",sex:""},sexOptions:["未知","男","女"],isSubmitting:!1}),onShow(){this.checkToken()&&uni.navigateTo({url:"/pages/login/login"})},onLoad(){const e=uni.getStorageSync("token");e?l.getUserProfile(e).then((e=>{t("log","at subPackages/settings/user-edit/user-edit.vue:85","用户数据:",e.data),this.user=e.data,this.user.nickname=e.data.name,this.user.sex=this.mapSexFromBackend(e.data.sex)})).catch((e=>{t("error","at subPackages/settings/user-edit/user-edit.vue:91","获取用户数据失败",e),uni.showToast({title:"获取用户数据失败",icon:"none"})})):uni.showToast({title:"请先登录",icon:"none"})},methods:{checkToken:()=>!uni.getStorageSync("token"),handleSexChange(e){this.user.sex=Number(e.detail.value)},mapSexFromBackend:e=>2===e?2:1===e?1:0,mapSexToBackend:e=>2===e?2:1===e?1:0,chooseImage(){uni.chooseImage({count:1,sizeType:["compressed","original"],sourceType:["album","camera"],success:e=>{const a=e.tempFilePaths;if(a.length>0){t("log","at subPackages/settings/user-edit/user-edit.vue:126",a);const{upload:i,request:s}=Ae({uploadPath:"/group1/upload",tempFilePaths:a[0],file:e.tempFiles[0]});i().then((e=>{var t=JSON.parse(e);this.user.Headimgurl=o+t.data.path}))}}})},submitForm(){this.isSubmitting=!0,l.editUserProfile(this.user).then((e=>{t("log","at subPackages/settings/user-edit/user-edit.vue:158","修改成功",e),uni.showToast({title:"修改成功",icon:"success"})})).catch((e=>{t("error","at subPackages/settings/user-edit/user-edit.vue:165","修改失败",e),uni.showToast({title:"修改失败",icon:"none"})})).finally((()=>{this.isSubmitting=!1}))}}};const Sc=W(Vc,[["render",function(t,i,o,s,n,r){const l=a(e.resolveDynamicComponent("uni-icons"),K);return e.openBlock(),e.createElementBlock("view",{class:"me-container"},[e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"avatar"},[e.createElementVNode("view",{class:"title"},"头像"),e.createElementVNode("view",{class:"avatar-box",onClick:i[0]||(i[0]=(...e)=>r.chooseImage&&r.chooseImage(...e))},[e.createElementVNode("image",{src:n.user.Headimgurl||"http://h5.xcbdsc.com/static/morentouxiang.jpg",class:"avatar-image",mode:"aspectFill"},null,8,["src"])])]),e.createElementVNode("view",{class:"name"},[e.createElementVNode("view",{class:"title"},"昵称"),e.createElementVNode("view",{class:"name-item"},[e.withDirectives(e.createElementVNode("input",{class:"input-text",type:"text",placeholder:"请输入昵称","onUpdate:modelValue":i[1]||(i[1]=e=>n.user.nickname=e)},null,512),[[e.vModelText,n.user.nickname]]),e.createVNode(l,{class:"rigicon",type:"right",size:"14",color:"rgb(229, 229, 229)"})])]),e.createElementVNode("view",{class:"phone"},[e.createElementVNode("view",{class:"title"},"电话"),e.createElementVNode("view",{class:"name-item"},[e.withDirectives(e.createElementVNode("input",{class:"input-text",type:"text",placeholder:"请输入电话","onUpdate:modelValue":i[2]||(i[2]=e=>n.user.phone=e)},null,512),[[e.vModelText,n.user.phone]]),e.createVNode(l,{class:"rigicon",type:"right",size:"14",color:"rgb(229, 229, 229)"})])]),e.createElementVNode("view",{class:"sex"},[e.createElementVNode("view",{class:"title"},"性别"),e.createElementVNode("view",{class:"name-item"},[e.createElementVNode("picker",{class:"input-text",range:n.sexOptions,onChange:i[3]||(i[3]=(...e)=>r.handleSexChange&&r.handleSexChange(...e))},e.toDisplayString(n.sexOptions[n.user.sex]),41,["range"]),e.createVNode(l,{class:"rigicon",type:"right",size:"14",color:"rgb(229, 229, 229)"})])]),e.createElementVNode("button",{class:"submit",onClick:i[4]||(i[4]=(...e)=>r.submitForm&&r.submitForm(...e)),disabled:n.isSubmitting}," 提交 ",8,["disabled"])])])}]]);const xc=W({data:()=>({formData:{phone:"",verificationCode:"",newPassword:"",confirmPassword:""},showPassword:!1,codeBtnText:"获取验证码",canSendCode:!0,countdown:0,phoneError:"",passwordError:"",confirmError:"",message:"",isError:!1}),computed:{formValid(){return!this.phoneError&&!this.passwordError&&!this.confirmError&&this.formData.phone&&this.formData.verificationCode&&this.formData.newPassword&&this.formData.confirmPassword}},onLoad(e){e.phone&&(this.formData.phone=e.phone)},methods:{validatePhone(){this.formData.phone?/^1[3-9]\d{9}$/.test(this.formData.phone)?this.phoneError="":this.phoneError="手机号格式不正确":this.phoneError="手机号不能为空"},validatePassword(){this.formData.newPassword?/^(?=.*[a-zA-Z])(?=.*\d).{8,20}$/.test(this.formData.newPassword)?this.passwordError="":this.passwordError="需包含字母和数字，8-20位":this.passwordError="密码不能为空",this.formData.confirmPassword&&(this.formData.confirmPassword!==this.formData.newPassword?this.passwordError="两次输入密码不一致":this.passwordError="")},validateConfirm(){this.formData.confirmPassword!==this.formData.newPassword?this.confirmError="两次输入密码不一致":this.confirmError=""},togglePassword(){this.showPassword=!this.showPassword},async sendVerificationCode(){if(this.phoneError||!this.formData.phone)return;this.startCountdown();let e=await l.sendText({phonenumber:this.formData.phone});200==e.code?uni.showToast({icon:"success",title:"短信已发送至您的手机,请注意查收"}):uni.showToast({icon:"error",title:e.msg})},startCountdown(){this.canSendCode=!1,this.countdown=60,this.codeBtnText=`${this.countdown}秒后重发`;const e=setInterval((()=>{if(this.countdown<=0)return clearInterval(e),this.canSendCode=!0,void(this.codeBtnText="获取验证码");this.countdown--,this.codeBtnText=`${this.countdown}秒后重发`}),1e3)},async handleSubmit(){await l.editPwd({phone:this.formData.phone,codenum:this.formData.verificationCode,psw:this.formData.newPassword}),this.showMessage("密码重置成功",!1),setTimeout((()=>{uni.navigateBack()}),1500)},showMessage(e,t=!0){this.message=e,this.isError=t,setTimeout((()=>{this.message=""}),2e3)}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("text",{class:"title"},"重置密码"),e.createElementVNode("text",{class:"subtitle"},"请验证手机号并设置新密码")]),e.createElementVNode("view",{class:"form"},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"item-label"},"手机号"),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>s.formData.phone=e),type:"number",placeholder:"请输入手机号",maxlength:"11",onInput:a[1]||(a[1]=(...e)=>n.validatePhone&&n.validatePhone(...e))},null,544),[[e.vModelText,s.formData.phone]]),s.phoneError?(e.openBlock(),e.createElementBlock("text",{key:0,class:"error-tip"},e.toDisplayString(s.phoneError),1)):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"item-label"},"验证码"),e.createElementVNode("view",{class:"code-input"},[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":a[2]||(a[2]=e=>s.formData.verificationCode=e),type:"number",placeholder:"请输入验证码",maxlength:"6"},null,512),[[e.vModelText,s.formData.verificationCode]]),e.createElementVNode("button",{class:e.normalizeClass(["code-btn",{disabled:!s.canSendCode}]),disabled:!s.canSendCode,onClick:a[3]||(a[3]=(...e)=>n.sendVerificationCode&&n.sendVerificationCode(...e))},e.toDisplayString(s.codeBtnText),11,["disabled"])])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"item-label"},"新密码"),e.createElementVNode("view",{class:"password-input"},[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":a[4]||(a[4]=e=>s.formData.newPassword=e),type:"text",placeholder:"8-20位字母数字组合",maxlength:"20",onInput:a[5]||(a[5]=(...e)=>n.validatePassword&&n.validatePassword(...e))},null,544),[[e.vModelText,s.formData.newPassword]]),e.createElementVNode("image",{class:"eye-icon",src:s.showPassword?"/static/eye-open.png":"/static/eye-close.png",onClick:a[6]||(a[6]=(...e)=>n.togglePassword&&n.togglePassword(...e))},null,8,["src"])]),s.passwordError?(e.openBlock(),e.createElementBlock("text",{key:0,class:"error-tip"},e.toDisplayString(s.passwordError),1)):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"item-label"},"确认密码"),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":a[7]||(a[7]=e=>s.formData.confirmPassword=e),type:"'text'",placeholder:"请再次输入密码",onInput:a[8]||(a[8]=(...e)=>n.validateConfirm&&n.validateConfirm(...e))},null,544),[[e.vModelText,s.formData.confirmPassword]]),s.confirmError?(e.openBlock(),e.createElementBlock("text",{key:0,class:"error-tip"},e.toDisplayString(s.confirmError),1)):e.createCommentVNode("",!0)]),e.createElementVNode("button",{class:e.normalizeClass(["submit-btn",{disabled:!n.formValid}]),onClick:a[9]||(a[9]=(...e)=>n.handleSubmit&&n.handleSubmit(...e))}," 确认重置 ",2)]),s.message?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["message-box",{error:s.isError}])},e.toDisplayString(s.message),3)):e.createCommentVNode("",!0)])}],["__scopeId","data-v-785b502a"]]);const Cc=W({data:()=>({}),methods:{}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",null," 关于我们 ")}]]);const Dc=W({data:()=>({latestVersion:"2.0.0",currentVersion:"1.0.0",downloadPercent:0,updating:!1,updateContent:["关闭线上调试"],downloading:!1}),computed:{buttonLabel(){return this.updating?`更新中 ${this.downloadPercent}%`:"立即体验新版本"},progressPhrase(){return["正在连接更新服务器...","发现可用更新包","正在优化性能模块","校验文件完整性","准备就绪"][Math.min(Math.floor(this.downloadPercent/25),4)]},contentList(){return this.updateContent.filter(Boolean).map((e=>e.trim()))},btnText(){return this.updating?100===this.downloadPercent?"安装中...":`下载中 ${this.downloadPercent}%`:"立即更新"}},mounted(){},methods:{initUpdateManager(){if(!wx.canIUse("getUpdateManager"))return;const e=wx.getUpdateManager();e.onCheckForUpdate((t=>{t.hasUpdate&&(this.showUpdatePage=!0,this.registerListeners(e))}))},registerListeners(e){e.onUpdateReady((()=>{this.downloadPercent=100,this.applyUpdate(e)})),e.onUpdateFailed((()=>{uni.showToast({title:"更新失败",icon:"none",duration:2e3}),this.updating=!1})),this.simulateProgress()},handleUpdate(){this.updating=!0,this.simulateProgress(),wx.showLoading({title:"准备更新",mask:!0}),100===this.downloadPercent&&this.applyUpdate(wx.getUpdateManager())},applyUpdate(e){uni.showModal({title:"更新提示",content:"新版本已就绪，立即重启应用？",confirmText:"立即重启",success:t=>{t.confirm&&e.applyUpdate()},complete:()=>{this.updating=!1,wx.hideLoading()}})},simulateProgress(){let e=0;const t=setInterval((()=>{e<95?(e+=Math.floor(15*Math.random()+5),this.downloadPercent=Math.min(e,95)):clearInterval(t)}),1e3)}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"modern-update"},[e.createElementVNode("view",{class:"background-wave"}),e.createElementVNode("view",{class:"update-card"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("view",{class:"icon-container"},[e.createElementVNode("image",{class:"update-icon",src:"/static/rocket.svg",mode:"aspectFit"}),e.createElementVNode("view",{class:"shine-effect"})])]),e.createElementVNode("view",{class:"version-info"},[e.createElementVNode("text",{class:"version-label"},"新版本"),e.createElementVNode("text",{class:"version-number"},"v"+e.toDisplayString(s.latestVersion),1)]),e.createElementVNode("scroll-view",{class:"changelog","scroll-y":""},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.updateContent,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:"changelog-item"},[e.createElementVNode("image",{class:"item-icon",src:"/static/check-circle.svg"}),e.createElementVNode("text",{class:"item-text"},e.toDisplayString(t),1)])))),128))]),s.updating?(e.openBlock(),e.createElementBlock("view",{key:0,class:"progress-container"},[e.createElementVNode("view",{class:"progress-bar",style:e.normalizeStyle({width:s.downloadPercent+"%"})},[e.createElementVNode("view",{class:"progress-pulse"})],4),s.updating?(e.openBlock(),e.createElementBlock("text",{key:0,class:"progress-text"},e.toDisplayString(n.progressPhrase),1)):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"update-button",disabled:s.updating,onClick:a[0]||(a[0]=(...e)=>n.handleUpdate&&n.handleUpdate(...e))},e.toDisplayString(n.buttonLabel),9,["disabled"])])])}],["__scopeId","data-v-476ddfe5"]]);const Tc=W({data:()=>({addressData:[],formData:{page:1,limit:10}}),onShow(){this.getAddressData()},methods:{async getAddressData(){let e=await l.myaddressData(this.formData);200==e.code&&(this.addressData=e.data.listdata)},addNewAddress(){uni.navigateTo({url:"/subPackages/settings/addAddress/addAddress?isEdit=false"})},editAddress(e){t("log","at subPackages/settings/myAddress/myAddress.vue:39",e);let a=JSON.stringify(e);uni.navigateTo({url:`/subPackages/settings/addAddress/addAddress?isEdit=true&jsonData=${a}`})},deleteAddress(e){uni.showModal({title:"确认删除",content:"确定要删除这个地址吗？",success:async a=>{if(t("log","at subPackages/settings/myAddress/myAddress.vue:51",a),a.confirm){let a=await l.delMyAddress({id:e.Id});t("log","at subPackages/settings/myAddress/myAddress.vue:54",a),200==a.code?(uni.showToast({icon:"success",title:a.message||a.msg}),this.getAddressData()):uni.showToast({icon:"error",title:a.message||a.msg})}}})},toggleDefault(e){this.addressData.forEach((e=>e.isDefault=!1)),this.addressData[e].isDefault=!0}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"address-page"})}],["__scopeId","data-v-c2b33157"]]);const _c={mixins:[pt],components:{fegionSelection:W({name:"fegionSelection",data:()=>({areaData:[[],[],[]],areaIndex:[0,0,0],provinceList:[],cityLevelList:[]}),mounted(){this.initPicker()},methods:{bindPickerChange({detail:e}){if(0===e.column)t("log","at components/fegionSelection/fegionSelection.vue:40",this.provinceList[e.value],"索引"),this.getCitytreeData(this.provinceList[e.value].id)},async getCitytreeData(e){let t=await l.citytree(e);200==t.code&&(this.cityLevelList=t.data,this.areaData[1]=this.cityLevelList.map((e=>e.name)))},async initPicker(){try{const e=await l.citylist({level:1,limit:100});if(200===e.code)return this.provinceList=e.data.listdata,this.areaData[0]=this.provinceList.map((e=>e.shortname)),this.provinceList;throw new Error("Failed to fetch provinces")}catch(e){throw t("error","at components/fegionSelection/fegionSelection.vue:69","Failed to fetch provinces:",e),e}}}},[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",null,[e.createElementVNode("picker",{mode:"multiSelector",value:s.areaIndex,range:s.areaData,onColumnchange:a[0]||(a[0]=(...e)=>n.bindPickerChange&&n.bindPickerChange(...e))},[e.createElementVNode("view",{class:"uni-input"},e.toDisplayString(s.areaData[0])+"-"+e.toDisplayString(s.areaData[1][s.areaIndex[1]])+"-"+e.toDisplayString(s.areaData[2][s.areaIndex[2]]),1)],40,["value","range"])])}]])},data:()=>({mapKey:!1,selectedCountry:"china",multiArray:[[],[],[]],area_id:null,multiIndex:[0,0,0],isEdit:!1,formData:{area_id:null,phone:null,phonename:null,address:null,isshow:1},error:{phonename:!1,phone:!1,region:!1,detail:!1},location:{latitude:null,longitude:null},markers:[]}),onLoad(e){uni.getLocation({altitude:!0,isHighAccuracy:!0,highAccuracy:!0,type:"gcj02",success:e=>{this.location.longitude=e.longitude,this.location.latitude=e.latitude-.005,this.mapKey=!0,t("log","at subPackages/settings/addAddress/addAddress.vue:127",this.location),this.markers.push({id:1,longitude:this.location.longitude,latitude:this.location.latitude+.005,iconPath:"../../../static/selectlocation.png",width:30,height:30}),t("log","at subPackages/settings/addAddress/addAddress.vue:129",this.markers)},fail(e){t("log","at subPackages/settings/addAddress/addAddress.vue:145",e)}}),this.initializePicker(),JSON.parse(e.isEdit)&&(this.isEdit=!0,this.formData=JSON.parse(e.jsonData))},methods:{selectLocation(){uni.chooseLocation({success:e=>{this.formData.address=e.address},fail(e){t("log","at subPackages/settings/addAddress/addAddress.vue:166",e)}})},async fetchCities(e){try{const a=await l.citytree(e);return 200===a.code&&Array.isArray(a.data)?(this.cityList=a.data,a.data):(t("error","at subPackages/settings/addAddress/addAddress.vue:177","No cities data found"),[])}catch(a){return t("error","at subPackages/settings/addAddress/addAddress.vue:181","Failed to fetch cities:",a),[]}},async fetchAreas(e){try{const a=await l.citytree(e);return 200===a.code&&Array.isArray(a.data)?(this.districtList=a.data,a.data):(t("error","at subPackages/settings/addAddress/addAddress.vue:192","No areas data found"),[])}catch(a){return t("error","at subPackages/settings/addAddress/addAddress.vue:196","Failed to fetch areas:",a),[]}},async fetchMarkets(e){try{const a=100,i=await l.marketlist(e,a);200===i.code&&Array.isArray(i.data.listdata)?(this.marketList=i.data.listdata.map((e=>e.marketname)),this.marketIdMap=i.data.listdata.reduce(((e,t)=>(e[t.marketname]=t.id,e)),{})):(t("error","at subPackages/settings/addAddress/addAddress.vue:212","No market data found"),this.marketList=[],this.marketIdMap={})}catch(a){t("error","at subPackages/settings/addAddress/addAddress.vue:217","Failed to fetch markets:",a),this.marketList=[],this.marketIdMap={}}},async fetchProvinces(){try{const e=await l.citylist({level:1,limit:100});if(200===e.code)return this.provinceList=e.data.listdata,this.provinceList;throw new Error("Failed to fetch provinces")}catch(e){throw t("error","at subPackages/settings/addAddress/addAddress.vue:235","Failed to fetch provinces:",e),e}},async bindMultiPickerChange(e){var t,a,i,o;if(this.multiIndex=e.detail.value,"china"===this.selectedCountry){const e=this.multiIndex[1],i=(null==(t=this.cityList[e])?void 0:t.id)||null;i&&(await this.fetchAreas(i),this.area_id=(null==(a=this.districtList[this.multiIndex[2]])?void 0:a.id)||null,await this.fetchMarkets(this.area_id))}else if("overseas"===this.selectedCountry){const e=this.multiIndex[0];this.overseasCountryId=(null==(i=this.overseasCountries[e])?void 0:i.id)||null;const t=this.multiIndex[1];this.overseasCountryId&&(await this.fetchOverseasCities(this.overseasCountryId),this.overseasCityId=(null==(o=this.overseasCities[t])?void 0:o.id)||null)}},async initializePicker(){try{if("china"===this.selectedCountry){const e=await this.fetchProvinces();if(this.multiArray[0]=e.map((e=>e.name)),e.length>0){const t=await this.fetchCities(e[0].id);if(this.multiArray[1]=t.map((e=>e.name)),t.length>0){const e=await this.fetchAreas(2);this.multiArray[2]=e.map((e=>e.name))}}this.multiIndex=[0,0,0]}else if("overseas"===this.selectedCountry){const e=await this.fetchOverseas();this.multiArray[0]=e.map((e=>e.shortname)),this.multiArray[1]=[],this.multiArray[2]=[],this.multiIndex=[0,0,0]}}catch(e){t("error","at subPackages/settings/addAddress/addAddress.vue:289","Failed to initialize picker:",e)}this.fetchMarkets(2313),this.selectedMarketIndex=1},async bindMultiPickerColumnChange(e){const t=e.detail.column,a=e.detail.value;if("china"===this.selectedCountry){if(0===t){const e=this.provinceList[a];if(e&&void 0!==e.id){const t=await this.fetchCities(e.id);if(this.multiArray[1]=t.map((e=>e.name)),t.length>0){const e=await this.fetchAreas(t[0].id);this.multiArray[2]=e.map((e=>e.name))}else this.multiArray[2]=[]}this.multiIndex[1]=0,this.multiIndex[2]=0}else if(1===t){const e=this.cityList[a];if(e&&void 0!==e.id){const t=await this.fetchAreas(e.id);this.multiArray[2]=t.map((e=>e.name))}else this.multiArray[2]=[];this.multiIndex[2]=0}}else if("overseas"===this.selectedCountry)if(0===t){const e=this.overseasCountries[a];e&&void 0!==e.id&&await this.fetchOverseasCities(e.id),this.multiArray[2]=[],this.multiIndex[1]=0,this.multiIndex[2]=0}else 1===t&&(this.multiArray[2]=[],this.multiIndex[2]=0);this.multiIndex[t]=a,this.multiIndex=[...this.multiIndex]},toggleDefault(e){this.formData.isshow=e.detail.value?2:1},validateForm(){},async handleSubmit(){let e=null;this.formData.area_id=this.area_id,e=this.isEdit?await l.editMyAddress(this.formData):await l.addMyAddress(this.formData),200==e.code?uni.showToast({title:"保存成功",icon:"success",success:()=>{setTimeout((()=>{this.customizeBack()}),1500)}}):uni.showToast({title:"请求异常",icon:"error",success:()=>{setTimeout((()=>{this.customizeBack()}),1500)}})}}};const Pc=W(_c,[["render",function(t,a,i,o,s,n){return e.openBlock(),e.createElementBlock("view",{class:"address-edit-page"},[s.mapKey?(e.openBlock(),e.createElementBlock("map",{key:0,latitude:s.location.latitude,longitude:s.location.longitude,markers:s.markers,style:{width:"100%",height:"100vh",position:"absolute"}},null,8,["latitude","longitude","markers"])):e.createCommentVNode("",!0),e.createElementVNode("scroll-view",{"scroll-y":"",class:"form-container",style:{"margin-top":"150rpx"}},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"收货人"),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>s.formData.phonename=e),placeholder:"请输入收货人姓名",class:e.normalizeClass(["input",{error:s.error.phonename}])},null,2),[[e.vModelText,s.formData.phonename]]),s.error.phonename?(e.openBlock(),e.createElementBlock("text",{key:0,class:"error-msg"},"请输入收货人姓名")):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"联系电话"),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>s.formData.phone=e),placeholder:"请输入手机号码",type:"number",class:e.normalizeClass(["input",{error:s.error.phone}])},null,2),[[e.vModelText,s.formData.phone]]),s.error.phone?(e.openBlock(),e.createElementBlock("text",{key:0,class:"error-msg"},"请输入正确手机号")):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"所在地区"),e.createElementVNode("picker",{class:"picker",mode:"multiSelector",range:s.multiArray,value:s.multiIndex,onChange:a[2]||(a[2]=(...e)=>n.bindMultiPickerChange&&n.bindMultiPickerChange(...e)),onColumnchange:a[3]||(a[3]=(...e)=>n.bindMultiPickerColumnChange&&n.bindMultiPickerColumnChange(...e))},[e.createElementVNode("view",{class:"picker-text"},e.toDisplayString(s.multiArray[0][s.multiIndex[0]])+" - "+e.toDisplayString(s.multiArray[1][s.multiIndex[1]])+" -"+e.toDisplayString("overseas"===s.selectedCountry?"":s.multiArray[2][s.multiIndex[2]]),1)],40,["range","value"]),s.error.region?(e.openBlock(),e.createElementBlock("text",{key:0,class:"error-msg"},"请选择所在地区")):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"详细地址"),e.withDirectives(e.createElementVNode("textarea",{"onUpdate:modelValue":a[4]||(a[4]=e=>s.formData.address=e),placeholder:"街道、楼牌号等详细信息",class:e.normalizeClass(["textarea",{error:s.error.address}]),onClick:a[5]||(a[5]=(...e)=>n.selectLocation&&n.selectLocation(...e))},null,2),[[e.vModelText,s.formData.address]])]),e.createElementVNode("view",{class:"form-item switch-item"},[e.createElementVNode("text",{class:"label"},"默认地址"),e.createElementVNode("switch",{checked:1!=s.formData.isshow,onChange:a[6]||(a[6]=(...e)=>n.toggleDefault&&n.toggleDefault(...e)),color:"#1a73e8"},null,40,["checked"])]),e.createElementVNode("view",{class:"save-footer"},[e.createElementVNode("button",{class:"save-btn",onClick:a[7]||(a[7]=(...e)=>n.handleSubmit&&n.handleSubmit(...e))},"保存地址")])])])}],["__scopeId","data-v-3f4f5332"]]);function Ic(...e){const t=e.map((e=>"object"==typeof e?JSON.stringify(e,null,2):String(e))).join(" ");try{const e=`[${(new Date).toLocaleString()}] ${t}\n`,a="_doc/jpush_log.txt";plus.io.requestFileSystem(plus.io.PRIVATE_DOC,(t=>{t.root.getFile(a,{create:!0},(t=>{t.createWriter((t=>{t.onwrite=()=>{},t.onerror=e=>{},t.seek(t.length||0),t.write(e)}),(e=>{}))}),(e=>{}))}),(e=>{}))}catch(ms){}}__definePage("pages/index1/index1",J),__definePage("pages/index/index",fe),__definePage("pages/login/login",ye),__definePage("pages/register/register",we),__definePage("pages/select/select",ke),__definePage("pages/sVegetables/sVegetables",Ee),__definePage("pages/user/user",Le),__definePage("pages/ShopDetails/ShopDetails",ft),__definePage("pages/Apply/Apply",vt),__definePage("pages/Buy/Buy",Rt),__definePage("pages/publish/publish",$t),__definePage("pages/release/release",Ut),__definePage("pages/stalllist/stalllist",qt),__definePage("pages/coupons/coupons",Ht),__definePage("pages/lottery/lottery",Wt),__definePage("pages/rules/rules",Gt),__definePage("pages/jackpot/jackpot",Jt),__definePage("pages/orders/orders",Ka),__definePage("pages/Stalls-dishes/Stalls-dishes",Za),__definePage("pages/Listed-Dishes/Listed-Dishes",Qa),__definePage("pages/usecoupons/usecoupons",Xa),__definePage("pages/Clock/Clock",ei),__definePage("pages/clock-records/clock-records",ti),__definePage("pages/MyPoints-records/MyPoints-records",ai),__definePage("pages/Ownerorders/Ownerorders",ii),__definePage("pages/wallet/wallet",oi),__definePage("pages/Points/Points",si),__definePage("pages/pointspayouts/pointspayouts",ni),__definePage("pages/Settrecords/Settrecords",li),__definePage("pages/editshop/editshop",di),__definePage("pages/bankCard/bankCard",mi),__definePage("pages/addCard/addCard",hi),__definePage("pages/onlineBooth/onlineBooth",vi),__definePage("pages/boothOwner/boothOwner",wi),__definePage("pages/aHouseholder/aHouseholder",ki),__definePage("pages/userServiceAgreement/userServiceAgreement",Ei),__definePage("pages/privacyAgreement/privacyAgreement",Ni),__definePage("pages/OpenAccountSharing/OpenAccountSharing",bi),__definePage("pages/arrangeNotification/arrangeNotification",Vi),__definePage("pages/weChatCashwWithdrawal/weChatCashwWithdrawal",xi),__definePage("pages/billRecord/billRecord",Di),__definePage("pages/wholesale/wholesale",Ti),__definePage("pages/prizeDraw/prizeDraw",_i),__definePage("pages/preSale/preSale",Yi),__definePage("pages/additionalinformation/additionalinformation",ol),__definePage("pages/Presalemenulist/Presalemenulist",sl),__definePage("pages/dynamics/dynamics",nl),__definePage("pages/demo/demo",rl),__definePage("pages/merchantComplaints/merchantComplaints",ll),__definePage("pages/myComplaint/myComplaint",cl),__definePage("pages/complaintDetails/complaintDetails",dl),__definePage("pages/settings/settings",ml),__definePage("pages/commodityDetail/commodityDetail",hl),__definePage("pages/invitation/invitation",pl),__definePage("pages/earningsRecord/earningsRecord",gl),__definePage("pages/certification/certification",yl),__definePage("pages/agent/agent",vl),__definePage("subPackages/PaymentModule/PaymentMethod/PaymentMethod",wl),__definePage("subPackages/PaymentModule/collectOnDelivery/collectOnDelivery",kl),__definePage("subPackages/agent/cooperation/cooperation",Nl),__definePage("subPackages/agent/datacenter/datacenter",Vl),__definePage("subPackages/agent/AgentRevenue/AgentRevenue",Sl),__definePage("subPackages/aHouseholder/additionalInformation/additionalInformation",xl),__definePage("subPackages/aHouseholder/publishDishes/publishDishes",Cl),__definePage("subPackages/aHouseholder/Traceability/Traceability",Tl),__definePage("subPackages/aHouseholder/lookTraceability/lookTraceability",_l),__definePage("subPackages/aHouseholder/PreSoldDishesList/PreSoldDishesList",Ml),__definePage("subPackages/aHouseholder/modifyPreSoldDishes/modifyPreSoldDishes",Ol),__definePage("subPackages/aHouseholder/beListed/beListed",Ul),__definePage("subPackages/aHouseholder/alreadyListed/alreadyListed",ql),__definePage("subPackages/Wholesale/supply/supply",Wl),__definePage("subPackages/Wholesale/purchase/purchase",Jl),__definePage("subPackages/Wholesale/addSupply/addSupply",Kl),__definePage("subPackages/Wholesale/addPurchase/addPurchase",Ql),__definePage("subPackages/Wholesale/wholesaleNavigation/wholesaleNavigation",Xl),__definePage("subPackages/Wholesale/mySupply/mySupply",ec),__definePage("subPackages/Wholesale/myProcurement/myProcurement",tc),__definePage("subPackages/Wholesale/quotation/quotation",ac),__definePage("subPackages/shoppingPageList/villageZone/villageZone",ic),__definePage("subPackages/shoppingPageList/nearbyFarmers/nearbyFarmers",oc),__definePage("subPackages/shoppingPageList/agriculturalAssistanceZone/agriculturalAssistanceZone",sc),__definePage("subPackages/shoppingPageList/official/official",nc),__definePage("subPackages/shoppingPageList/rentalStorefront/rentalStorefront",rc),__definePage("subPackages/shoppingPageList/rentalStorefrontList/rentalStorefrontList",lc),__definePage("subPackages/shoppingPageList/prePurchaseOrder/prePurchaseOrder",cc),__definePage("subPackages/shoppingPageList/prePurchaseDeposit/prePurchaseDeposit",uc),__definePage("subPackages/shoppingPageList/merchantDetails/merchantDetails",mc),__definePage("subPackages/shoppingPageList/realTimeInfo/realTimeInfo",pc),__definePage("subPackages/shoppingPageList/realTimeInfoDetail/realTimeInfoDetail",gc),__definePage("subPackages/shoppingPageList/freeGroceryShopping/freeGroceryShopping",fc),__definePage("subPackages/shoppingPageList/statisticsMap/statisticsMap",vc),__definePage("subPackages/boothOwner/salesApplication/salesApplication",wc),__definePage("subPackages/boothOwner/billRecord/billRecord",Ec),__definePage("subPackages/boothOwner/storeSettings/storeSettings",bc),__definePage("subPackages/settings/user-edit/user-edit",Sc),__definePage("subPackages/settings/updatePwd/updatePwd",xc),__definePage("subPackages/settings/aboutUs/aboutUs",Cc),__definePage("subPackages/settings/version/version",Dc),__definePage("subPackages/settings/myAddress/myAddress",Tc),__definePage("subPackages/settings/addAddress/addAddress",Pc);const Bc={data:()=>({jpushModule:null,registrationID:"",connectStatus:"未连接"}),methods:{initJPush(){try{if(Ic("开始初始化 JPush..."),this.jpushModule=(e="JG-JPush",weex.requireModule(e)),!this.jpushModule)return void Ic("[错误] JPush 初始化失败：无法获取插件实例。");this.jpushModule.initJPushService(),Ic("✅ JPush 服务已初始化。"),this.jpushModule.addConnectEventListener((e=>{this.connectStatus=e.connectEnable?"已连接":"未连接",Ic(`📡 JPush 连接状态: ${this.connectStatus}`),"已连接"===this.connectStatus&&this.getRegistrationID()})),this.jpushModule.addNotificationListener((e=>{Ic("📥 收到 JPush 通知:",e)})),this.checkNotificationPermission()}catch(ms){Ic(`[错误] JPush 初始化异常: ${ms.message}`)}var e},createCustomRingtoneChannel(){try{Ic("🚀 [铃声渠道] 函数已执行");const e=plus.android.runtimeMainActivity();if(plus.android.importClass("android.os.Build").SDK_INT<26)return void Ic("⚠️ [铃声渠道] Android < 8.0，不创建渠道");const t=plus.android.importClass("android.app.NotificationManager"),a=plus.android.importClass("android.app.NotificationChannel"),i=plus.android.importClass("android.net.Uri"),o=plus.android.importClass("android.media.AudioAttributes"),s=plus.android.importClass("android.media.RingtoneManager"),n=e.getSystemService(e.NOTIFICATION_SERVICE),r=e.getPackageName(),l=e.getResources(),c="custom_ringtone",d="订单语音通知",u="播放自定义通知铃声",m=l.getIdentifier("custom_ringtone","raw",r);if(Ic("🎵 [铃声渠道] 铃声资源 ID = "+m),0===m)return void Ic("❌ [铃声渠道] 找不到自定义铃声，请检查路径：nativeResources/android/res/raw/custom_ringtone.mp3");const h=i.parse(`android.resource://${r}/${m}`);Ic("🔗 [铃声渠道] 铃声 URI = "+h.toString());try{Ic("🎧 [铃声渠道] 系统解析铃声成功: "+s.getRingtone(e,h).getTitle(e))}catch(ms){Ic("⚠️ [铃声渠道] 系统解析铃声失败: "+ms.message)}let p=n.getNotificationChannel(c);if(p)Ic("⚠️ [铃声渠道] 渠道已存在（不会更新铃声）。如需更新：卸载重装 App");else{Ic("📢 [铃声渠道] 渠道不存在 → 开始创建");const e=(new o.Builder).setContentType(o.CONTENT_TYPE_SONIFICATION).setUsage(o.USAGE_NOTIFICATION).build();p=new a(c,d,t.IMPORTANCE_HIGH),p.setDescription(u),p.enableLights(!0),p.enableVibration(!0),p.setSound(h,e),n.createNotificationChannel(p),Ic("✅ [铃声渠道] 渠道创建完成")}const g=n.getNotificationChannel(c);Ic("🔍 [铃声渠道] 最终渠道铃声 = "+g.getSound()),Ic("🔍 [铃声渠道] 重要性 = "+g.getImportance())}catch(ms){Ic("❌ [铃声渠道] 异常："+ms.message)}},getRegistrationID(){this.jpushModule&&this.jpushModule.getRegistrationID((e=>{e.registerID?(this.registrationID=e.registerID,uni.setStorageSync("registerID",this.registrationID),Ic(`✅ 获取 RegistrationID 成功: ${this.registrationID}`)):Ic(`[错误] 获取 RegistrationID 失败: ${e.errMsg}`)}))},checkNotificationPermission(){const e=plus.android.runtimeMainActivity();plus.android.importClass("android.app.NotificationManager");const t=e.getSystemService(e.NOTIFICATION_SERVICE);plus.android.invoke(t,"areNotificationsEnabled")?Ic("🔔 通知权限已开启"):(Ic("⚠️ 通知权限未开启"),this.noticMsgTool())},noticMsgTool(){uni.showModal({title:"通知权限提醒",content:"您还没有开启通知权限，无法接收消息，请前往设置！",showCancel:!1,confirmText:"去设置",success:e=>{e.confirm&&this.openNotificationSettings()}})},openNotificationSettings(){const e=plus.android.runtimeMainActivity(),t=plus.android.importClass("android.content.Intent"),a=plus.android.importClass("android.os.Build"),i=plus.android.importClass("android.provider.Settings"),o=plus.android.importClass("android.net.Uri");try{const s=new t;a.VERSION.SDK_INT>=26?(s.setAction(i.ACTION_APP_NOTIFICATION_SETTINGS),s.putExtra(i.EXTRA_APP_PACKAGE,e.getPackageName())):a.VERSION.SDK_INT>=21?(s.setAction(i.ACTION_APP_NOTIFICATION_SETTINGS),s.putExtra("app_package",e.getPackageName()),s.putExtra("app_uid",e.getApplicationInfo().uid)):(s.setAction(i.ACTION_APPLICATION_DETAILS_SETTINGS),s.setData(o.parse("package:"+e.getPackageName()))),e.startActivity(s)}catch(ms){Ic(`[错误] 打开通知设置失败: ${ms.message}`);const o=new t(i.ACTION_SETTINGS);e.startActivity(o)}}},onLaunch(){uni.$globalMethods={getRegistrationID:()=>this.getRegistrationID()};try{const e=plus.android.runtimeMainActivity();plus.android.importClass(e);const t=e.getResources();plus.android.importClass(t);const a=e.getPackageName(),i=plus.android.invoke(t,"getIdentifier","custom_ringtone","raw",a);Ic("铃声资源 ID = "+i),i||Ic("❌ 资源不存在，请检查是否正确放入 raw 目录")}catch(ms){Ic("❌ 错误："+ms)}this.initJPush(),this.createCustomRingtoneChannel()},onShow(){this.jpushModule&&!this.registrationID&&this.getRegistrationID()},onHide:function(){t("log","at App.vue:356","App Hide")}},Ac={data:()=>({shareParams:{path:"/pages/index/index",title:"分享给朋友",imageUrl:"",desc:"",content:""}}),onShareAppMessage(e){return{title:this.shareParams.title,path:this.shareParams.path,imageUrl:this.shareParams.imageUrl,desc:this.shareParams.desc,content:this.shareParams.content,success(e){uni.showToast({title:"分享成功"})},fail(e){uni.showToast({title:"分享失败",icon:"none"})}}},onShareTimeline(e){return{title:this.shareParams.title,path:this.shareParams.path,imageUrl:this.shareParams.imageUrl,success(e){uni.showToast({title:"分享成功"})},fail(e){uni.showToast({title:"分享失败",icon:"none"})}}}},Mc=function(){const t=e.effectScope(!0),a=t.run((()=>e.ref({})));let i=[],o=[];const s=e.markRaw({install(e){Ge(s),s._a=e,e.provide(Je,s),e.config.globalProperties.$pinia=s,o.forEach((e=>i.push(e))),o=[]},use(e){return this._a?i.push(e):o.push(e),this},_p:i,_a:null,_e:t,_s:new Map,state:a});return s}();const{app:Lc,Vuex:Oc,Pinia:Fc}=function(){const t=e.createVueApp(Bc);return t.mixin(Ac),t.use(Mc),{app:t}}();uni.Vuex=Oc,uni.Pinia=Fc,Lc.provide("__globalStyles",__uniConfig.styles),Lc._component.mpType="app",Lc._component.render=()=>{},Lc.mount("#app")}(Vue);
